{"version":3,"sources":["../../src/extensions/adapt-article-reveal/js/adapt-article-reveal.js","../../src/extensions/adapt-audio/js/adapt-audio.js","../../src/extensions/adapt-background-video/js/inlineVideo.js","../../src/extensions/adapt-background-video/js/video.js","../../src/extensions/adapt-background-video/js/iPhoneVideo.js","../../src/extensions/adapt-background-video/js/container.js","../../src/extensions/adapt-background-video/js/adapt-background-video.js","../../src/extensions/adapt-backgroundVideo/js/backgroundVideoView.js","../../src/extensions/adapt-backgroundVideo/js/adapt-backgroundVideo.js","../../src/extensions/adapt-component-animate/js/adapt-component-animate.js","../../src/extensions/adapt-contrib-assessment/js/adapt-assessmentArticleView.js","../../src/extensions/adapt-contrib-assessment/js/adapt-assessmentQuestionBank.js","../../src/extensions/adapt-contrib-assessment/js/adapt-assessmentArticleModel.js","../../src/extensions/adapt-contrib-assessment/js/assessment.js","../../src/extensions/adapt-contrib-assessment/js/adapt-assessmentArticleExtension.js","../../src/extensions/adapt-contrib-bookmarking/js/adapt-contrib-bookmarking.js","../../src/extensions/adapt-contrib-languagePicker/js/accessibilityView.js","../../src/extensions/adapt-contrib-languagePicker/js/languagePickerView.js","../../src/extensions/adapt-contrib-languagePicker/js/languagePickerDrawerView.js","../../src/extensions/adapt-contrib-languagePicker/js/languagePickerNavView.js","../../src/extensions/adapt-contrib-languagePicker/js/languagePickerModel.js","../../src/extensions/adapt-contrib-languagePicker/js/adapt-languagePicker.js","../../src/extensions/adapt-contrib-pageLevelProgress/js/completionCalculations.js","../../src/extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressMenuView.js","../../src/extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressView.js","../../src/extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressNavigationView.js","../../src/extensions/adapt-contrib-pageLevelProgress/js/adapt-contrib-pageLevelProgress.js","../../src/extensions/adapt-contrib-resources/js/adapt-contrib-resourcesView.js","../../src/extensions/adapt-contrib-resources/js/adapt-contrib-resourcesHelpers.js","../../src/extensions/adapt-contrib-resources/js/adapt-contrib-resources.js","../../src/extensions/adapt-contrib-spoor/js/scorm/API.js","../../src/extensions/adapt-contrib-spoor/js/scorm/wrapper.js","../../src/extensions/adapt-contrib-spoor/js/scorm/logger.js","../../src/extensions/adapt-contrib-spoor/js/scorm.js","../../src/extensions/adapt-contrib-spoor/js/serializers/default.js","../../src/extensions/adapt-contrib-spoor/js/serializers/scormSuspendDataSerializer.js","../../src/extensions/adapt-contrib-spoor/js/serializers/questions.js","../../src/extensions/adapt-contrib-spoor/js/adapt-stateful-session.js","../../src/extensions/adapt-contrib-spoor/js/adapt-offlineStorage-scorm.js","../../src/extensions/adapt-contrib-spoor/js/adapt-contrib-spoor.js","../../src/extensions/adapt-contrib-trickle/js/trickleView.js","../../src/extensions/adapt-contrib-trickle/js/pageView.js","../../src/extensions/adapt-contrib-trickle/js/lib/adaptModelExtension.js","../../src/extensions/adapt-contrib-trickle/js/handlers/buttonView.js","../../src/extensions/adapt-contrib-trickle/js/handlers/button.js","../../src/extensions/adapt-contrib-trickle/js/handlers/completion.js","../../src/extensions/adapt-contrib-trickle/js/handlers/notify.js","../../src/extensions/adapt-contrib-trickle/js/handlers/resize.js","../../src/extensions/adapt-contrib-trickle/js/handlers/tutor.js","../../src/extensions/adapt-contrib-trickle/js/handlers/visibility.js","../../src/extensions/adapt-contrib-trickle/js/handlers/done.js","../../src/extensions/adapt-contrib-trickle/js/adapt-contrib-trickle.js","../../src/extensions/adapt-contrib-tutor/js/adapt-contrib-tutor.js","../../src/extensions/adapt-devtools/js/devtools-model.js","../../src/extensions/adapt-devtools/js/hinting.js","../../src/extensions/adapt-devtools/js/is-question-supported.js","../../src/extensions/adapt-devtools/js/auto-answer.js","../../src/extensions/adapt-devtools/js/pass-half-fail.js","../../src/extensions/adapt-devtools/js/toggle-banking.js","../../src/extensions/adapt-devtools/js/map.js","../../src/extensions/adapt-devtools/js/utils.js","../../src/extensions/adapt-devtools/js/end-trickle.js","../../src/extensions/adapt-devtools/js/toggle-feedback.js","../../src/extensions/adapt-devtools/js/toggle-alt-text.js","../../src/extensions/adapt-devtools/js/unlock.js","../../src/extensions/adapt-devtools/js/enable.js","../../src/extensions/adapt-devtools/js/adapt-devtools.js","../../src/extensions/adapt-editorial/js/lib/Backbone.Inherit.js","../../src/extensions/adapt-editorial/js/lib/raf.js","../../src/extensions/adapt-editorial/js/tiles/tile.js","../../src/extensions/adapt-editorial/js/adapt-editorialArticleView.js","../../src/extensions/adapt-editorial/js/adapt-editorialArticleModel.js","../../src/extensions/adapt-editorial/js/tiles/e-group.js","../../src/extensions/adapt-editorial/js/lib/jquery.resize.js","../../src/extensions/adapt-editorial/js/lib/jquery.backgroundimage.js","../../src/extensions/adapt-editorial/js/tiles/lightbox.js","../../src/extensions/adapt-editorial/js/tiles/e-text.js","../../src/extensions/adapt-editorial/js/lib/jquery.dimensions.js","../../src/extensions/adapt-editorial/js/tiles/media.js","../../src/extensions/adapt-editorial/js/tiles/e-image.js","../../src/extensions/adapt-editorial/js/lib/mediaelement-and-player.min.js","../../src/extensions/adapt-editorial/js/tiles/e-video.js","../../src/extensions/adapt-editorial/js/tiles/tiles.js","../../src/extensions/adapt-editorial/js/adapt-editorialArticleExtension.js","../../src/extensions/adapt-forceLoad/js/adapt-forceLoad.js","../../src/extensions/adapt-hide-navigation-bar/js/adapt-hide-navigation-bar.js","../../src/extensions/adapt-inspector/js/adapt-inspector.js","../../src/extensions/adapt-ios-fastclick/js/lib/fastclick.js","../../src/extensions/adapt-ios-fastclick/js/adapt-ios.js","../../src/extensions/adapt-lightbox/js/adapt-lightbox-view.js","../../src/extensions/adapt-lightbox/js/adapt-lightbox-view-extension.js","../../src/extensions/adapt-lightbox/js/libs/jquery.dimensions.js","../../src/extensions/adapt-lightbox/js/libs/jquery.backgroundimage.js","../../src/extensions/adapt-lightbox/js/libs/jquery.scrollBarSize.js","../../src/extensions/adapt-lightbox/js/adapt-lightbox.js","../../src/extensions/adapt-menu-controller/js/adapt-menu-controller.js","../../src/extensions/adapt-navigation-title/js/navigation.js","../../src/extensions/adapt-navigation-title/js/adapt-navigation-title.js","../../src/extensions/adapt-pageIncompletePrompt/js/adapt-pageIncompletePrompt.js","../../src/extensions/adapt-speedtest/js/speedtest.min.js","../../src/extensions/adapt-speedtest/js/adapt-speedtest.js","../../src/extensions/adapt-tutor/js/tutorOverlay.js","../../src/extensions/adapt-tutor/js/adapt-tutor.js","../../src/components/adapt-article-reveal/js/adapt-article-reveal.js","../../src/components/adapt-articleBlockSlider/js/adapt-articleView.js","../../src/components/adapt-articleBlockSlider/js/adapt-articleModel.js","../../src/components/adapt-articleBlockSlider/js/lib/jquery.resize.js","../../src/components/adapt-articleBlockSlider/js/adapt-articleExtension.js","../../src/components/adapt-articleBlockSlider/js/articleBlockSlider.js","../../src/components/adapt-audio/js/adapt-audio.js","../../src/components/adapt-backgroundScroll/js/adapt-backgroundScroll.js","../../src/components/adapt-blinds/js/adapt-blinds.js","../../src/components/adapt-contrib-accordion/js/adapt-contrib-accordion.js","../../src/components/adapt-contrib-assessmentResults/js/adapt-contrib-assessmentResults.js","../../src/components/adapt-contrib-blank/js/adapt-contrib-blank.js","../../src/components/adapt-contrib-slider/js/adapt-contrib-slider.js","../../src/components/adapt-contrib-confidenceSlider/js/adapt-contrib-confidenceSlider.js","../../src/components/adapt-contrib-flipcard/js/adapt-contrib-flipcard.js","../../src/components/adapt-contrib-mcq/js/adapt-contrib-mcq.js","../../src/components/adapt-contrib-gmcq/js/adapt-contrib-gmcq.js","../../src/components/adapt-contrib-graphic/js/adapt-contrib-graphic.js","../../src/components/adapt-contrib-hotgraphic/js/adapt-contrib-hotgraphic.js","../../src/components/adapt-contrib-matching/js/adapt-contrib-matching.js","../../src/components/adapt-contrib-media/js/adapt-contrib-media.js","../../src/components/adapt-contrib-narrative/js/adapt-contrib-narrative.js","../../src/components/adapt-contrib-text/js/adapt-contrib-text.js","../../src/components/adapt-contrib-textInput/js/adapt-contrib-textInput.js","../../src/components/adapt-expose/js/adapt-expose.js","../../src/components/adapt-hotgrid/js/adapt-hotgrid.js","../../src/components/adapt-narrativeStrip/js/adapt-narrativeStrip.js","../../src/components/adapt-native-media/js/adapt-native-media.js","../../src/components/adapt-peelBackHotspot/js/draggabilly.js","../../src/components/adapt-peelBackHotspot/js/adapt-peelBackHotspot.js","../../src/components/adapt-ppq/js/draggabilly.js","../../src/components/adapt-ppq/js/adapt-ppq.js","../../src/components/adapt-questionStrip/js/adapt-questionStrip.js","../../src/components/adapt-slidingPuzzle/js/adapt-slidingPuzzle.js","../../src/components/adapt-tabs/js/adapt-tabs.js","../../src/components/adapt-timedSequence/js/adapt-timed-sequence.js","../../src/components/adapt-youtube/js/adapt-youtube.js","../../src/menu/adapt-contrib-boxMenu/js/adapt-contrib-boxmenu.js","../../src/theme/adapt-contrib-vanilla/js/theme-block.js","../../src/theme/adapt-contrib-vanilla/js/vanilla.js","../../src/plugins.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC7LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC7JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACldA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACjYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACnPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACnJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AChEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACvDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACvEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACxrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AClUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC/MA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC1JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AClGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACnCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACvEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AChJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC9CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC3FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACtEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACvEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACrDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC90BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACjqBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACzEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACvFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACtrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC/KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACzMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC3JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACzIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC5GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AChSA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC9KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACtWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACnGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACtIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AChEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC5FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AChFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACrHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACvIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACpJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACtQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACzGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC7DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC9VA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACxEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACzCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACnEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC5HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC/DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACzEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACpWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC7NA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AClZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACnLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC1LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC5JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACzZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACrMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AChFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACxEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACtNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AChLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC1TA;AACA;AACA;AACA;AACA;AACA;AACA,ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACxLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACz0BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACzYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACpHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACxEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACzZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACzFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AClHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACtEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC7DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACrLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACvqBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACjEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC3EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC7LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC9dA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACrKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC5CA;AACA;AACA;AACA;AACA;AACA;AACA,ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACxJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACjIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACtMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC7HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC9RA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACjjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC1WA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACjKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC1VA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AClHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC5EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACnTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC9RA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACjZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AChXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC9FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACvSA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC7FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACrHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACzSA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AClFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACx7CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACneA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACx+CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACxgBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC5YA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AClWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACzHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACrMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACrKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC5EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"plugins.js","sourcesContent":["/*\r\n* adapt-contrib-article-reveal\r\n* License - http://github.com/adaptlearning/adapt_framework/LICENSE\r\n* Maintainers - Stuart Nicholls <stuart@stuartnicholls.com>, Mohammed Salamat Ali <Mohammed.SalamatAli@kineo.com>\r\n*/\r\ndefine('extensions/adapt-article-reveal/js/adapt-article-reveal',[\r\n    'core/js/adapt'\r\n], function(Adapt) {\r\n\r\n    var ArticleRevealView = Backbone.View.extend({\r\n\r\n        className: \"article-reveal\",\r\n\r\n        events: {\r\n            \"click .article-reveal-open-button\":\"revealArticle\",\r\n            \"click .article-reveal-close-button\":\"closeArticle\"\r\n        },\r\n\r\n        initialize: function () {\r\n\t\t\tif (this.model.get('_articleReveal') && this.model.get('_articleReveal')._isEnabled) {\r\n\t\t\t\tthis.render();\r\n\t\t\t\tthis.setup();\r\n\t\t\t\tthis.listenTo(Adapt, \"remove\", this.remove);\r\n\t\t\t\tthis.listenTo(Adapt, 'device:changed', this.setDeviceSize);\r\n\t\t\t\tAdapt.on(\"page:scrollTo\", _.bind(this.onProgressBarScrollTo, this));\r\n\t\t\t}\r\n        },\r\n\r\n        render: function () {\r\n            var data = this.model.toJSON();\r\n            var template = Handlebars.templates[\"adapt-article-reveal\"];\r\n            $(this.el).html(template(data)).prependTo('.' + this.model.get(\"_id\"));\r\n\r\n            var incomplete = this.model.findDescendants(\"components\").where({_isComplete:false});\r\n            if (incomplete.length === 0) this.setOpenButtonState();\r\n\r\n            return this;\r\n        },\r\n\r\n        setup: function(event) {\r\n            if (event) event.preventDefault();\r\n            //prevent drag on buttons\r\n            this.preventDrag();\r\n\r\n            //hide articles\r\n            var $articleInner = $(\".\" + this.model.get(\"_id\") + \" > .article-inner \");\r\n\r\n            var incomplete = this.model.findDescendants(\"components\").where({_isComplete:false});\r\n            if (incomplete.length > 0){\r\n                $articleInner.css({display:\"none\"});\r\n\r\n                //hide the components inside the article\r\n                this.toggleisVisible( false );\r\n            }\r\n            this.setDeviceSize();\r\n        },\r\n\r\n        setDeviceSize: function() {\r\n            if (Adapt.device.screenSize === 'large' || Adapt.device.screenSize === 'medium') {\r\n                this.$el.addClass('desktop').removeClass('mobile');\r\n                this.model.set('_isDesktop', true);\r\n            } else {\r\n                this.$el.addClass('mobile').removeClass('desktop');\r\n                this.model.set('_isDesktop', false);\r\n            }\r\n            this.render();\r\n        },\r\n\r\n        setOpenButtonState: function() {\r\n            this.$(\".article-reveal-open-button\").addClass('visited show');\r\n            this.$(\".article-reveal-close-button\").addClass('show');\r\n        },\r\n\r\n        setClosedButtonState: function() {\r\n            this.$(\".article-reveal-open-button\").removeClass('show');\r\n        },\r\n\r\n        closeArticle: function(event) {\r\n            if (event) event.preventDefault();\r\n\r\n            this.setClosedButtonState();\r\n\r\n            //animate Close..\r\n            // this.$(\".article-reveal-close-button\").velocity(\"fadeOut\", 500);\r\n\r\n            //..and set components to isVisible false\r\n            this.$el.siblings(\".article-inner\").velocity(\"slideUp\", 600, _.bind(function() {\r\n                this.toggleisVisible(false);\r\n            }, this));\r\n            this.$el.velocity(\"scroll\", {\r\n                duration: 600,\r\n                offset: -$(\".navigation\").outerHeight()\r\n            });\r\n            this.$(\".article-reveal-open-button\").focus();\r\n            this.$(\".article-reveal-close-button\").removeClass('show');\r\n        },\r\n\r\n        revealArticle: function(event) {\r\n            if (event) event.preventDefault();\r\n            if(this.$el.closest(\".article\").hasClass(\"locked\")) return; // in conjunction with pageLocking\r\n\r\n            this.setOpenButtonState();\r\n\r\n            //animate reveal\r\n            Adapt.trigger(\"article:revealing\", this);\r\n            this.$el.siblings(\".article-inner\").velocity(\"slideDown\", 800, _.bind(function() {\r\n                Adapt.trigger(\"article:revealed\", this);\r\n                // Call window resize to force components to rerender -\r\n                // fixes components that depend on being visible for setting up layout\r\n                $(window).resize();\r\n            }, this));\r\n            this.$el.velocity(\"scroll\", {\r\n                delay: 400,\r\n                duration: 800,\r\n                offset: this.$el.height() - $(\".navigation\").outerHeight()\r\n            });\r\n            // this.$(\".article-reveal-close-button\").velocity(\"fadeIn\", {\r\n            //     delay: 400,\r\n            //     duration: 500\r\n            // });\r\n\r\n            //set components to isVisible true\r\n            this.toggleisVisible(true);\r\n        },\r\n\r\n        /**\r\n         * Toggles the visibility of the components inside the article\r\n         */\r\n        toggleisVisible: function(view) {\r\n            var allComponents = this.model.findDescendants('components');\r\n            allComponents.each(function(component) {\r\n                component.setLocking(\"_isVisible\", false);\r\n                component.set('_isVisible', view, {\r\n                    pluginName:\"_articleReveal\"\r\n                });\r\n            });\r\n        },\r\n\r\n        preventDrag: function() {\r\n            $(\".article-reveal-open-button\").on(\"dragstart\", function(event) {\r\n                event.preventDefault();\r\n            });\r\n            $(\".article-reveal-close-button\").on(\"dragstart\", function(event) {\r\n                event.preventDefault();\r\n            });\r\n        },\r\n\r\n        // Handles the Adapt page scrollTo event\r\n        onProgressBarScrollTo: function(componentSelector) {\r\n            if (typeof componentSelector == \"object\") componentSelector = componentSelector.selector;\r\n            var allComponents = this.model.findDescendants('components');\r\n            var componentID = componentSelector;\r\n            if(componentID.indexOf('.') === 0) componentID = componentID.slice(1);\r\n            allComponents.each(_.bind(function(component){\r\n                if(component.get('_id') === componentID && !component.get('_isVisible')){\r\n                    this.revealComponent(componentSelector);\r\n                    return;\r\n                }\r\n            }, this));\r\n        },\r\n\r\n        revealComponent: function(componentSelector) {\r\n            this.setOpenButtonState();\r\n\r\n            this.toggleisVisible(true);\r\n\r\n            $(\".\" + this.model.get(\"_id\") + \" > .article-inner \").slideDown(0);\r\n\r\n            this.$(\".article-reveal-close-button\").fadeIn(1);\r\n\r\n            $(window).scrollTo($(componentSelector), {\r\n                offset:{\r\n                    top:-$('.navigation').height()\r\n                }\r\n            }).resize();\r\n        }\r\n\r\n    });\r\n\r\n    Adapt.on('articleView:postRender', function(view) {\r\n        if (view.model.get(\"_articleReveal\")) {\r\n            new ArticleRevealView({\r\n                model:view.model\r\n            });\r\n        }\r\n    });\r\n\r\n});\r\n\n","/*\r\n * adapt-audio\r\n * License - http://github.com/cgkineo/adapt_framework/LICENSE\r\n */\r\ndefine('extensions/adapt-audio/js/adapt-audio',['require','coreJS/adapt','backbone'],function(require) {\r\n\r\n    var Adapt = require('coreJS/adapt');\r\n    var Backbone = require('backbone');\r\n\r\n    var AudioView = Backbone.View.extend({\r\n\r\n        className: \"extension-audio\",\r\n\r\n        initialize: function() {\r\n            this.render();\r\n            this.listenTo(Adapt, 'audio', this.onAudioInvoked);\r\n            this.listenTo(Adapt, 'audio:stop', this.onAudioStop);\r\n\r\n            if (Modernizr.audio) {\r\n                this.audio = new Audio();\r\n\r\n                $(this.audio).on('ended', _.bind(this.onAudioEnded, this));\r\n            } else if ($(\"#audioPlayer\")[0] == undefined) {\r\n                this.embedFlashAudioPlayer();\r\n            }\r\n        },\r\n\r\n        render: function() {\r\n            var template = Handlebars.templates[\"audio\"]\r\n            this.$el.html(template()).appendTo('#wrapper');\r\n            return this;\r\n        },\r\n\r\n        embedFlashAudioPlayer: function() {\r\n\r\n            window.onFlashAudioFinished = _.bind(this.onAudioEnded, this);\r\n\r\n            var params = {\r\n                swliveconnect: \"true\",\r\n                allowscriptaccess: \"always\"\r\n            };\r\n\r\n            var attributes = {\r\n                id: \"audioPlayer\",\r\n                name: \"audioPlayer\"\r\n            };\r\n\r\n            swfobject.embedSWF(\"assets/audioplayer.swf\", \"flashPlayer\", \"1\", \"1\", \"8.0.22\", \"assets/express_install.swf\", false, params, attributes);\r\n\r\n            console.log($(\"#audioPlayer\")[0]);\r\n        },\r\n\r\n        onAudioCtrlsClick: function(event) {\r\n            if (event) event.preventDefault();\r\n            Adapt.trigger('audio', event.currentTarget);\r\n        },\r\n\r\n        play: function() {\r\n            try {\r\n                if (this.audio) this.audio.play();\r\n                else {\r\n                    $(\"#audioPlayer\")[0].loadAudio(this.$active.data('mp3'));\r\n                }\r\n            } catch (e) {\r\n                console.error(\"play error\");\r\n            }\r\n        },\r\n\r\n        pause: function() {\r\n            try {\r\n                if (this.audio) this.audio.pause();\r\n                else {\r\n                    $(\"#audioPlayer\")[0].controlAudio(\"pause\");\r\n                }\r\n            } catch (e) {\r\n                console.error(\"pause error\");\r\n            }\r\n        },\r\n\r\n        stop: function() {\r\n            try {\r\n                if (this.audio) {\r\n                    this.audio.pause();\r\n                    this.audio.currentTime = 0;\r\n                } else {\r\n                    $(\"#audioPlayer\")[0].controlAudio(\"pause\");\r\n                }\r\n            } catch (e) {\r\n                console.error(\"stop error\");\r\n            }\r\n        },\r\n\r\n        onAudioInvoked: function(el) {\r\n            var $el = $(el);\r\n\r\n            if (this.$active && this.$active.is($el)) {\r\n                if (this.$active.hasClass('play')) {\r\n                    this.$active.addClass('pause').removeClass('play');\r\n                    this.play();\r\n                } else {\r\n                    this.$active.addClass('play').removeClass('pause');\r\n                    this.pause();\r\n                }\r\n            } else {\r\n                if (this.$active) {\r\n                    this.$active.addClass('play').removeClass('pause');\r\n                    this.pause();\r\n                }\r\n\r\n                this.$active = $el;\r\n                this.$active.addClass('pause').removeClass('play');\r\n\r\n                if (Modernizr.audio) {\r\n                    if (this.audio.canPlayType('audio/ogg')) this.audio.src = this.$active.data('ogg');\r\n                    if (this.audio.canPlayType('audio/mpeg')) this.audio.src = this.$active.data('mp3');\r\n                }\r\n\r\n                this.play();\r\n            }\r\n        },\r\n\r\n        onAudioEnded: function() {\r\n            if (this.$active) {\r\n                this.$active.addClass('play').removeClass('pause');\r\n            }\r\n            this.stop();\r\n        },\r\n\r\n        onAudioStop: function(el) {\r\n\r\n            if (el == null || el == undefined) {\r\n                // console.log('stop any audio currently playing');\r\n                if (this.$active) {\r\n                    this.$active.addClass('play').removeClass('pause');\r\n                    this.stop();\r\n                }\r\n            } else if (this.$active && (this.$active.is(el) || this.$active.parents(el).length > 0)) {\r\n                // console.log('stop audio for specific element/descendents if currently playing');\r\n                if (this.$active) {\r\n                    this.$active.addClass('play').removeClass('pause');\r\n                    this.stop();\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n\r\n    Adapt.once(\"app:dataLoaded\", function() {\r\n        new AudioView();\r\n    });\r\n\r\n    Adapt.on('router:location', function() {\r\n        Adapt.trigger('audio:stop');\r\n    });\r\n\r\n});\r\n\n","'use strict';\r\n\r\n(function (factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        // AMD. Register as an anonymous module.\r\n        define('extensions/adapt-background-video/js/inlineVideo',['jquery'], factory);\r\n    } else if (typeof module === 'object' && module.exports) {\r\n        // Node/CommonJS\r\n        module.exports = function( root, jQuery ) {\r\n            if ( jQuery === undefined ) {\r\n                // require('jQuery') returns a factory that requires window to\r\n                // build a jQuery instance, we normalize how we use modules\r\n                // that require this pattern but the window provided is a noop\r\n                // if it's defined (how jquery works)\r\n                if ( typeof window !== 'undefined' ) {\r\n                    jQuery = require('jquery');\r\n                }\r\n                else {\r\n                    jQuery = require('jquery')(root);\r\n                }\r\n            }\r\n            factory(jQuery);\r\n            return jQuery;\r\n        };\r\n    } else {\r\n        // Browser globals\r\n        factory(jQuery);\r\n    }\r\n}(function ($) {\r\n\r\n    if ($.fn.inlinevideo) return;\r\n\r\n    //RAF\r\n    if (!window.requestAnimationFrame) {\r\n        window.requestAnimationFrame = (function() {\r\n            return window.webkitRequestAnimationFrame ||\r\n                window.mozRequestAnimationFrame ||\r\n                window.oRequestAnimationFrame ||\r\n                window.msRequestAnimationFrame ||\r\n                function( callback, element ) {\r\n                    return window.setTimeout( callback, 1000 / 60 );\r\n                };\r\n        })();\r\n    }\r\n    if (!window.cancelRequestAnimationFrame) {\r\n        window.cancelRequestAnimationFrame = (function() {\r\n            return window.webkitCancelRequestAnimationFrame ||\r\n                window.mozCancelRequestAnimationFrame ||\r\n                window.oCancelRequestAnimationFrame ||\r\n                window.msCancelRequestAnimationFrame ||\r\n                clearTimeout;\r\n        })();\r\n    }\r\n\r\n    var extend = function(a,b) {\r\n        for (var k in b) {\r\n            a[k] = b[k];\r\n        }\r\n        return a;\r\n    };\r\n\r\n    //APPLE iPhone/iOS Detection\r\n    var APPLE_DETECTION = {\r\n        initialize: function() {\r\n            this.ua = window.navigator.userAgent.toLowerCase();\r\n            this.isAndroid = (this.ua.match(/android/i) !== null);\r\n            this.isiPad = (this.ua.match(/ipad/i) !== null);\r\n            this.isiPhone = (this.ua.match(/iphone/i) !== null);\r\n            this.isBlackBerry10 = (this.ua.match(/bb10/i) !== null);\r\n            this.isiOS = this.isiPhone || this.isiPad;\r\n            this.version = parseFloat(\r\n                ('' + (/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(this.ua) || [0,''])[1])\r\n                .replace('undefined', '3_2').replace('_', '.').replace('_', '')\r\n            ) || false;\r\n            delete this.initialize;\r\n\r\n            if (APPLE_DETECTION.test) {\r\n                APPLE_DETECTION.isAndroid = true;\r\n                // APPLE_DETECTION.isiPhone = true;\r\n                // APPLE_DETECTION.version = 9;\r\n            }\r\n        }\r\n\r\n    };\r\n\r\n    //INLINE VIDEO ELEMENT\r\n    window.InlineVideo = function InlineVideo(videoElement, options) {\r\n        var inlineVideoElement = document.createElement('inlinevideo');\r\n        inlineVideoElement._videoElement = videoElement;\r\n        $.extend(inlineVideoElement, InlineVideo.prototype);\r\n        return InlineVideo.initialize.call(inlineVideoElement, options);\r\n    };\r\n\r\n    var uid = 0;\r\n\r\n    extend(InlineVideo, {\r\n\r\n        initialize: function(options) {\r\n        \r\n            this._uid = uid++;\r\n            this._wasPlayClicked = false;\r\n            this._lastTime = 0;\r\n            this._lastTriggerTime = 0;\r\n            this._videoElement.playbackRate = 2;\r\n            \r\n            // replace the video with inlineVideo element\r\n            $(this).addClass('inlinevideocontainer');\r\n            $(this._videoElement).addClass(\"inlined\").replaceWith(this).removeAttr(\"style\");\r\n            $(this._videoElement).removeAttr(\"controls\");\r\n            this._$ = $(this);\r\n            this._$.append(this._videoElement);\r\n\r\n            if (options.mute) this.volume = 0;\r\n\r\n            this._audioElem = document.createElement('audio');\r\n            $(this._audioElem).removeAttr(\"controls\");\r\n            $(this._audioElem).attr(\"loop\", $(this._videoElement).attr(\"loop\"));\r\n            $(this._audioElem).attr(\"mute\", $(this._videoElement).attr(\"mute\"));\r\n            this._audioElem.src = $(this._videoElement).find(\"source[type='video/mp4']\").attr(\"audio\");\r\n\r\n            var player = [this._audioElem];\r\n            this._$.append(player);\r\n\r\n            var __ = this;\r\n\r\n            this._videoElement.onloadstart = function() {\r\n\r\n            }; // fires when the loading starts\r\n            this._videoElement.onloadedmetadata = function() { \r\n\r\n                __._metaLoaded = true;\r\n                if (__._wasPlayClicked) {\r\n                    //if meta is loaded with play click\r\n                    __._isLoaded = true;\r\n                    if (__.paused) return;\r\n                    __.play();\r\n                }\r\n\r\n            }; //  when we have metadata about the video\r\n            this._videoElement.onloadeddata = function() {\r\n\r\n            }; // when we have the first frame\r\n            this._videoElement.onprogress = function() { \r\n\r\n                if (!__._isLoaded) return;\r\n                var end = __._videoElement.buffered.end(0);\r\n                var sofar = parseFloat(((end / __._videoElement.duration) * 100));\r\n\r\n                //add waiting icon in here\r\n            };\r\n\r\n            this.options = options || {};\r\n            if (this.options.showScrubBar) {\r\n                InlineVideo.showScrubBar.call(this);\r\n            }\r\n\r\n            $.fn.inlinevideo.players[this._uid] = this;\r\n\r\n            return this;\r\n        },\r\n\r\n        playLoop: function() {\r\n            var __ = this;\r\n            var time = Date.now();\r\n            var elapsed = (time - this._lastTime) / 1000;\r\n            var loop = $(this._videoElement).attr(\"loop\");\r\n\r\n            if (this._isDestroyed) return;\r\n\r\n            if (this.currentTime === undefined) this.currentTime = 0;\r\n\r\n            var currentTime = this.currentTime + elapsed;\r\n\r\n            // render\r\n            if (elapsed >= (1/25)) {\r\n                var outByTime = Math.abs(this._audioElem.currentTime - currentTime);\r\n                if (outByTime > 1) {\r\n                    //skip audio if out of sync\r\n                    this._audioElem.currentTime = currentTime;\r\n                }\r\n            }\r\n\r\n            // if we are at the end of the video stop\r\n            //var currentTime = (Math.round(parseFloat(this._videoElement.currentTime)*10000)/10000);\r\n            var duration = (Math.round(parseFloat(this._videoElement.duration)*10000)/10000);\r\n            \r\n            if (loop && currentTime >= duration) {\r\n                this._audioElem.currentTime = 0;\r\n                this._videoElement.currentTime = 0;\r\n                this._lastTime = time;\r\n                this.currentTime = 0;\r\n                currentTime = 0;\r\n            } else if (currentTime <= duration - 0.1) {\r\n\r\n                //seek video\r\n                if (elapsed >= (1/25)) {\r\n                    this._videoElement.currentTime = currentTime;\r\n                    this._lastTime = time;\r\n                    this.currentTime = currentTime;\r\n                }\r\n            }\r\n\r\n            var triggerElapsed = (time - this._lastTriggerTime) / 1000;\r\n            if (triggerElapsed >= 1/4) {\r\n                setTimeout(function() {\r\n                    $(__).triggerHandler(\"timeupdate\");\r\n                    InlineVideo.updateScrubBar.call(__);\r\n                }, 0);\r\n                this._lastTriggerTime = time;\r\n                this.currentTime = currentTime;\r\n            }\r\n\r\n            if (currentTime >= duration && !loop) {\r\n                this.pause();\r\n                this.currentTime = currentTime;\r\n                $(this).triggerHandler(\"ended\");\r\n                InlineVideo.updateScrubBar.call(__);\r\n                return;\r\n            }\r\n\r\n            this._animationRequest = requestAnimationFrame(function() {\r\n                if (__._isDestroyed) return;\r\n                InlineVideo.playLoop.call(__);\r\n            });\r\n        }\r\n\r\n    });\r\n\r\n    extend(InlineVideo.prototype, {\r\n\r\n        volume: 1,\r\n\r\n        paused: true,\r\n\r\n        play: function(e) { \r\n            //console.log(\"played\");\r\n            //can only be run from click\r\n            this._wasPlayClicked = true;\r\n\r\n            if (this._metaLoaded && !this._isLoaded) {\r\n                //if meta loaded but play not clicked\r\n                this._videoElement.play();\r\n                this._videoElement.pause();\r\n                this._videoElement.currentTime = 0;\r\n                this._isLoaded = true;\r\n            }\r\n\r\n            if (!this._isLoaded) {\r\n                //meta not captured on startup, load meta data\r\n                this._videoElement.load();\r\n\r\n                //mske sure to play the audio on click\r\n                if (this._audioElem.networkState !== 3 && this.volume !== 0) {\r\n                    this._audioElem.currentTime = 0;\r\n                    this._audioElem.play();\r\n                    this._audioElem.pause();\r\n                    this._audioElem.currentTime = 0;\r\n                }\r\n                this.paused = false;\r\n                return;\r\n            }\r\n\r\n            this._lastTime = Date.now();\r\n            var duration = (Math.round(parseFloat(this._videoElement.duration)*10000)/10000);\r\n            if (this.currentTime >= duration) {\r\n                this.currentTime = 0;\r\n                this._videoElement.currentTime = 0;\r\n                if (this._audioElem.networkState !== 3) {\r\n                    this._audioElem.currentTime = 0;\r\n                }\r\n            }\r\n\r\n            var __ = this;\r\n            if (this._audioElem.networkState !== 3 && this.volume !== 0) {\r\n                this._audioElem.play();\r\n            }\r\n            \r\n            this._animationRequest = requestAnimationFrame(function() {\r\n                InlineVideo.playLoop.call(__);\r\n            });\r\n\r\n            setTimeout(function() {\r\n                __.paused = false;\r\n                $(__).triggerHandler(\"play\")\r\n            }, 0);\r\n\r\n        },\r\n\r\n        pause: function() {\r\n           // console.log(\"paused\");\r\n            cancelAnimationFrame(this._animationRequest);\r\n            this._animationRequest = null;\r\n            if (this._audioElem.networkState !== 3) {\r\n                this._audioElem.pause();\r\n            }\r\n            this.paused = true;\r\n            var __ = this;\r\n            setTimeout(function() {\r\n                $(__).triggerHandler(\"pause\")\r\n            }, 0);\r\n        },\r\n\r\n        setCurrentTime: function(seconds) {\r\n            if (seconds === undefined) return;\r\n            this._videoElement.currentTime = seconds;\r\n            if (this._audioElem.networkState !== 3) {\r\n                this._audioElem.currentTime = seconds;\r\n            }\r\n            this._lastTime = Date.now();\r\n            this.currentTime = seconds;\r\n        },\r\n\r\n        mute: function() {\r\n            this.volume = 0;\r\n            if (this._audioElem.networkState !== 3) {\r\n                this._audioElem.pause();\r\n            }\r\n        },\r\n\r\n        unmute: function() {\r\n            this.volume = 1;\r\n            if (!this.paused) {\r\n                if (this._audioElem.networkState !== 3) {\r\n                    this._audioElem.play();\r\n                }\r\n            }\r\n        },\r\n\r\n        isPaused: function() {\r\n            return this.paused;\r\n        },\r\n\r\n        getVolume: function() {\r\n            return this.volume;\r\n        },\r\n\r\n        setVolume: function(int) {\r\n            if (int < 1) this.volume = 0;\r\n            if (int >= 1) this.volume = 1;\r\n            if (this.volume === 0) {\r\n                if (this._audioElem.networkState !== 3) {\r\n                    this._audioElem.pause();\r\n                }\r\n            }\r\n        },\r\n\r\n        destroy: function() {\r\n            this._isDestroyed = true;\r\n            $(this._videoElement).removeClass(\"inlined\");\r\n            InlineVideo.removeScrubBar.call(this);\r\n            delete $.fn.inlinevideo.players[this._uid];\r\n        }\r\n\r\n    });\r\n\r\n    extend(InlineVideo, {\r\n\r\n        _scrubBar: '<div class=\"inlinevideo-scrub-bar\"><div class=\"outer\"><div class=\"container\"><div class=\"inner\" style=\"width:0px;\"></div></div></div></div>',\r\n\r\n        showScrubBar: function() {\r\n            this._$scrubBar = $(InlineVideo._scrubBar);\r\n            $(this).append(this._$scrubBar);\r\n            this._$scrubBar.find(\".container\").attr(\"data-player\", this._uid).on(\"click\", InlineVideo.clickScrubBar);\r\n        },\r\n\r\n        clickScrubBar: function(e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n\r\n            var $container = $(e.currentTarget);\r\n\r\n            var playerid = $container.attr(\"data-player\");\r\n            var player = $.fn.inlinevideo.players[playerid];\r\n\r\n            var position = $container.offset();\r\n            var clientX = e.clientX;\r\n            switch (e.type) {\r\n            case \"touchstart\":\r\n            case \"touchmove\":\r\n            case \"touchend\":\r\n                if (e.originalEvent.changedTouches) {\r\n                    clientX = e.originalEvent.changedTouches[0].clientX;\r\n                } else {\r\n                    clientX = e.originalEvent.layerX;\r\n                }\r\n            }\r\n\r\n            var leftPX = (clientX - position.left);\r\n            var barWidth = $container.width();\r\n\r\n            var markSeconds = player._videoElement.duration;\r\n            var passedSeconds = player.currentTime;\r\n\r\n            var gotoSeconds = (leftPX/barWidth) * markSeconds;\r\n\r\n            player.setCurrentTime(gotoSeconds);\r\n        },\r\n\r\n        updateScrubBar: function() {\r\n            if (!this._$scrubBar) return;\r\n            var width = (100 / this._videoElement.duration) * this._videoElement.currentTime;\r\n            this._$scrubBar.find(\".inner\").css(\"width\", width+\"%\");\r\n        },\r\n\r\n        removeScrubBar: function() {\r\n            if (!this._$scrubBar) return;\r\n            this._$scrubBar.find(\".container\").off(\"click\", InlineVideo.clickScrubBar);\r\n        }\r\n\r\n    });\r\n\r\n    extend(InlineVideo.prototype, {\r\n\r\n        _$scrubBar: null\r\n\r\n    });\r\n\r\n    //Inline video styling\r\n    var injectStyling = function() {\r\n        //hide user controls\r\n        if(!$(\"style.inlinevideo\").length) {\r\n            var css = [\r\n                \".inlinevideo-scrub-bar { position: absolute; top:auto; bottom: 0; left: 0; right: 0; height: 28px; }\",\r\n                \".inlinevideo-scrub-bar .outer { opacity: 1; transition: opacity 1s; -webkit-transition: opacity 1s; background: black; position: absolute; top: 0; left: 0; padding: 9px 5px; bottom: 0; right: 0; }\",\r\n                \".inlinevideo-scrub-bar .container { height:100%; background: #333; background: rgba(50, 50, 50, 0.8); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgba(30, 30, 30, 0.8)), to(rgba(60, 60, 60, 0.8))); background: -webkit-linear-gradient(top, rgba(30, 30, 30, 0.8), rgba(60, 60, 60, 0.8)); background: -moz-linear-gradient(top, rgba(30, 30, 30, 0.8), rgba(60, 60, 60, 0.8)); background: -o-linear-gradient(top, rgba(30, 30, 30, 0.8), rgba(60, 60, 60, 0.8)); background: -ms-linear-gradient(top, rgba(30, 30, 30, 0.8), rgba(60, 60, 60, 0.8)); background: linear-gradient(rgba(30, 30, 30, 0.8), rgba(60, 60, 60, 0.8)); border-radius: 2px; cursor: pointer; }\",\r\n                \".inlinevideo-scrub-bar .inner {background: #fff; background: rgba(255, 255, 255, 0.8); background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgba(255, 255, 255, 0.9)), to(rgba(200, 200, 200, 0.8))); background: -webkit-linear-gradient(top, rgba(255, 255, 255, 0.9), rgba(200, 200, 200, 0.8)); background: -moz-linear-gradient(top, rgba(255, 255, 255, 0.9), rgba(200, 200, 200, 0.8)); background: -o-linear-gradient(top, rgba(255, 255, 255, 0.9), rgba(200, 200, 200, 0.8)); background: -ms-linear-gradient(top, rgba(255, 255, 255, 0.9), rgba(200, 200, 200, 0.8)); background: linear-gradient(rgba(255, 255, 255, 0.9), rgba(200, 200, 200, 0.8)); width:0%; height:100%; }\",\r\n                \"inlinevideo { display:inline-block; position:relative; } inlinevideo video {width:100%;height:auto;} inlinevideo audio {display:none;} video.inlined::-webkit-media-controls {display: none !important;} video.inlined::-webkit-media-controls-start-playback-button { display: none !important;-webkit-appearance: none;}\"\r\n            ];\r\n\r\n            $(\"head\").append(\"<style class='inlinevideo'>\"+css.join(\" \")+\"</style>\");\r\n        }\r\n    };\r\n\r\n    $.fn.inlinevideo = function(options) {\r\n        if (!((APPLE_DETECTION.isiPhone && APPLE_DETECTION.version > 8) || true)) return false;\r\n        \r\n        var $this = $(this);\r\n        var $items = $([]);\r\n\r\n        $items = $items.add($this.find(\"video:not(.inlined)\"));\r\n        $items = $items.add($this.filter(\"video:not(.inlined)\"));\r\n\r\n        $items.each(function(index, item) {\r\n\r\n            injectStyling();\r\n            \r\n            $(item).addClass(\"inlinevideo\");\r\n\r\n            var inlineVideo = new InlineVideo(item, options);\r\n            if (typeof options.success === \"function\") options.success(inlineVideo, options);\r\n\r\n        });\r\n\r\n\r\n\r\n        return true;\r\n    };\r\n    $.fn.inlinevideo.players = {};\r\n\r\n    APPLE_DETECTION.test = false;\r\n    APPLE_DETECTION.initialize();\r\n\r\n    extend($.fn.inlinevideo, APPLE_DETECTION);\r\n\r\n}));\r\n\n","define('extensions/adapt-background-video/js/video',[\r\n    \"./inlineVideo\"\r\n], function() {\r\n\r\n    var mep_defaults = {\r\n        \"poster\": \"\",\r\n        \"showPosterWhenEnded\": false,\r\n        \"defaultVideoWidth\": 480,\r\n        \"defaultVideoHeight\": 270,\r\n        \"videoWidth\": -1,\r\n        \"videoHeight\": -1,\r\n        \"defaultAudioWidth\": 400,\r\n        \"defaultAudioHeight\": 30,\r\n        \"defaultSeekBackwardInterval\": \"(media.duration * 0.05)\",\r\n        \"defaultSeekForwardInterval\": \"(media.duration * 0.05)\",\r\n        \"audioWidth\": -1,\r\n        \"audioHeight\": -1,\r\n        \"startVolume\": 1,\r\n        \"loop\": true,\r\n        \"autoRewind\": true,\r\n        \"enableAutosize\": true,\r\n        \"alwaysShowHours\": false,\r\n        \"showTimecodeFrameCount\": false,\r\n        \"framesPerSecond\": 12.5,\r\n        \"autosizeProgress\" : true,\r\n        \"alwaysShowControls\": false,\r\n        \"hideVideoControlsOnLoad\": true,\r\n        \"clickToPlayPause\": false,\r\n        \"iPadUseNativeControls\": false,\r\n        \"iPhoneUseNativeControls\": false,\r\n        \"AndroidUseNativeControls\": false,\r\n        \"features\": [],\r\n        \"isVideo\": true,\r\n        \"enableKeyboard\": true,\r\n        \"pauseOtherPlayers\": false,\r\n        \"startLanguage\": \"\",\r\n        \"tracksText\": \"\",\r\n        \"hideCaptionsButtonWhenEmpty\": true,\r\n        \"toggleCaptionsButtonWhenOnlyOne\": false,\r\n        \"slidesSelector\": \"\"\r\n    };\r\n\r\n    var uid = 0;\r\n\r\n    var tagpool = [];\r\n    var poolUid = 0;\r\n    var attributes = [ \"preload\", \"poster\", \"width\", \"height\", \"style\", \"src\", \"controls\", \"loop\" ];\r\n\r\n\r\n    var Video = Backbone.View.extend({\r\n\r\n        fromPool: false,\r\n        ratioHeight: 9,\r\n        ratioWidth: 16,\r\n\r\n        className: function() {\r\n            return \"video-widget a11y-ignore-aria\";\r\n        },\r\n\r\n        initialize: function(options) {\r\n            this.uid = uid++;\r\n            this.preRender();\r\n            this.render();\r\n            _.defer(_.bind(function() {\r\n                this.postRender();\r\n            }, this));\r\n\r\n            this.setupRatio();\r\n        },\r\n\r\n        setupRatio: function() {\r\n\r\n            var ratio = \"16:9\";\r\n            if (this.model.get(\"_ratio\")) ratio = this.model.get(\"_ratio\");\r\n            \r\n            var colonIndex = ratio.indexOf(\":\");\r\n\r\n            this.ratioWidth = parseFloat( ratio.substr(0, colonIndex) );\r\n            this.ratioHeight = parseFloat( ratio.substr(colonIndex+1, ratio.length) );\r\n            \r\n        },\r\n\r\n        preRender: function() {\r\n            var speed = \"fast\";\r\n            if (speedtest) speed = speedtest.low_name;\r\n\r\n            var isAndroid = $.fn.inlinevideo.isAndroid;\r\n            var isiOS = $.fn.inlinevideo.isiOS;\r\n            if (isAndroid || isiOS) {\r\n                //force android and ios to use lower quality videos\r\n                //this is to limit the amount of memoery required\r\n                console.log(\"Forcing low quality videos\");\r\n                speed = \"slow\";\r\n            }\r\n            this.model.get(\"_media\").extension = \"mp4\";\r\n            if (isAndroid) {\r\n                console.log(\"Forcing webm videos\");\r\n                this.model.get(\"_media\").extension = \"webm\";\r\n            }\r\n\r\n            this.model.set(\"speed\", speed);\r\n        },\r\n\r\n        render: function() {\r\n            var template = Handlebars.templates[this.constructor.template];\r\n            var output = template(this.model.toJSON());\r\n            this.$el.html(output);\r\n        },\r\n\r\n        postRender: function() {\r\n            if ($.fn.inlinevideo.isiPad || $.fn.inlinevideo.isAndroid) {\r\n                //force ipads to reuse video tags \r\n                //ipads have a 16 tag play limit before they need to be reused\r\n                //TODO: this needs to be extended into the track rendering and playing\r\n                //maximum two tracks rendered\r\n                if (tagpool.length > 0) {\r\n                    this.fromPool = true;\r\n                    var $reused = tagpool.pop();\r\n                    console.log(\"not fresh\", $reused);\r\n                    for (var i = 0, l = attributes.length; i < l; i++) {\r\n                        var attr = attributes[i];\r\n                        $reused.removeAttr(attr);\r\n                    }\r\n                    $reused.html(\"\").append(this.$(\"video\").children());\r\n                    var $unused = this.$(\"video\");\r\n                    for (var i = 0, l = attributes.length; i < l; i++) {\r\n                        var attr = attributes[i];\r\n                        $reused.attr(attr, $unused.attr(attr));\r\n                    }\r\n                    $unused.replaceWith($reused);\r\n                    $reused.removeAttr(\"mute\");\r\n                    console.log(\"reuse\", $reused[0].poolUid);\r\n                } else {\r\n                    console.log(\"fresh\", this.$(\"video\"));\r\n                }\r\n            }\r\n\r\n            this.setupPlayer();\r\n        },\r\n\r\n        setupPlayer: function() {\r\n            if (!this.model.get('_playerOptions')) this.model.set('_playerOptions', {});\r\n\r\n            var modelOptions = _.extend({}, mep_defaults);\r\n\r\n            modelOptions.pluginPath = 'assets/';\r\n\r\n            if (this.model.get(\"features\")) modelOptions.features = this.model.get(\"features\");\r\n\r\n            modelOptions.success = _.bind(this.onPlayerReady, this);\r\n\r\n            if (this.model.get('_autoRewind')) {\r\n                modelOptions.autoRewind = true;\r\n            }\r\n\r\n            if (this.model.get('_alwaysShowControls')) {\r\n                modelOptions.alwaysShowControls = true;\r\n            }\r\n\r\n            if (this.model.get('loop')) {\r\n                modelOptions.loop = true;\r\n            }\r\n\r\n            if (this.model.get('mute')) {\r\n                modelOptions.startVolume = 0;\r\n                modelOptions.volume = 0;\r\n            }\r\n\r\n            if (this.model.get('_useClosedCaptions')) {\r\n                modelOptions.startLanguage = this.model.get('_startLanguage') === undefined ? 'en' : this.model.get('_startLanguage');\r\n            }\r\n\r\n            this.addMediaTypeClass();\r\n\r\n            // create the player\r\n            this.$('video').mediaelementplayer(modelOptions);\r\n\r\n            // We're streaming - set ready now, as success won't be called above\r\n            if (this.model.get('_media').source) {\r\n                this.$('.media-widget').addClass('external-source');\r\n                this.setReadyStatus();\r\n            }\r\n        },\r\n\r\n        addMediaTypeClass: function() {\r\n            var media = this.model.get(\"_media\");\r\n            if (media.type) {\r\n                var typeClass = media.type.replace(/\\//, \"-\");\r\n                this.$(\".media-widget\").addClass(typeClass);\r\n            }\r\n        },\r\n\r\n        setupEventListeners: function() {\r\n            this.videoElement.addEventListener(\"start\", _.bind(this.onEventFired, this));\r\n            this.videoElement.addEventListener(\"play\", _.bind(this.onEventFired, this));\r\n            this.videoElement.addEventListener(\"ended\", _.bind(this.onEventFired, this));\r\n            this.videoElement.addEventListener('timeupdate', _.bind(this.onEventFired, this));\r\n        },\r\n\r\n        onEventFired: function(e) {\r\n            if (this.isRemoved) return;\r\n            switch (e.type) {\r\n            case \"timeupdate\":\r\n                if (this.model.get(\"mute\")) this.videoElement.setVolume(0);\r\n                var currentSeconds = Math.ceil(this.videoElement.currentTime*10)/10;\r\n                if (this.triggerSeconds !== currentSeconds) {\r\n                    //console.log(\"seconds videoElement\", this.uid, currentSeconds);\r\n                    this.trigger(\"seconds\", this, currentSeconds);\r\n                    this.triggerSeconds = currentSeconds\r\n                }\r\n                break;\r\n            case \"ended\":\r\n                if ($(\"html\").is(\".iPhone\")) {\r\n                    this.$(\"video\")[0].webkitExitFullScreen();\r\n                }\r\n                this.trigger(\"finish\", this);\r\n                break;\r\n            case \"play\":\r\n                this.trigger(\"play\", this);\r\n                break;\r\n            default:\r\n                debugger;\r\n            }\r\n        },\r\n\r\n        play: function(seekTo) {\r\n            if (!this.videoElement) return;\r\n            if (this.$(\"video\")[0].poolUid === undefined) {\r\n                this.$(\"video\")[0].poolUid = poolUid++;\r\n            }\r\n            console.log(\"playing\", this.$(\"video\")[0].poolUid);\r\n            this.setCurrentSeconds(seekTo, true);\r\n            this.hasPlayed = true;\r\n            this.videoElement.pause();\r\n            this.videoElement.play();\r\n            this.setCurrentSeconds(seekTo, true);\r\n            console.log(\"videoElement\", this.uid, \"played\");\r\n            if (this.model.get(\"mute\")) this.videoElement.setVolume(0);\r\n\r\n            if (this.model.get('_alwaysShowControls')) {\r\n                this.videoElement.player.showControls();\r\n                this.$(\".mejs-controls\").css(\"display\", \"block\");\r\n            }\r\n        },\r\n\r\n        setCurrentSeconds: function(seekTo) {\r\n            if (!this.videoElement) return;\r\n            if (seekTo === undefined) return;\r\n            try {\r\n                this.videoElement.player.setCurrentTime(seekTo);\r\n            } catch(e) {}\r\n        },\r\n\r\n        pause: function() {\r\n            if (!this.videoElement) return;\r\n            console.log(\"videoElement\", this.uid, \"paused\");\r\n            this.videoElement.pause();\r\n            if ($(\"html\").is(\".iPhone\")) {\r\n                this.$(\"video\")[0].webkitExitFullScreen();\r\n            }\r\n        },\r\n\r\n        mute: function() {\r\n            if (!this.videoElement) return;\r\n            this.videoElement.setVolume(0);\r\n        },\r\n\r\n        unmute: function() {\r\n            if (!this.videoElement) return;\r\n            this.videoElement.setVolume(1);\r\n        },\r\n\r\n        isPaused: function() {\r\n            if (!this.videoElement) return;\r\n            return this.videoElement.paused;\r\n        },\r\n\r\n        getVolume: function() {\r\n            if (!this.videoElement) return;\r\n            return this.videoElement.volume;\r\n        },\r\n\r\n        setVolume: function(int) {\r\n            if (!this.videoElement) return;\r\n            this.videoElement.setVolume(int);\r\n        },\r\n\r\n        hasVolume: function() {\r\n            return true;\r\n        },\r\n\r\n        remove: function() {\r\n            this.isRemoved = true;\r\n            if ($.fn.inlinevideo.isiPad || $.fn.inlinevideo.isAndroid) {\r\n                if (this.$(\"video\")[0].poolUid !== undefined) {\r\n                    tagpool.push(this.$(\"video\"));\r\n                    console.log(\"pooling\", this.$(\"video\")[0].poolUid);\r\n                }               \r\n            }\r\n\r\n            this.videoElement.player.remove();\r\n            if ($(\"html\").is(\".ie8\")) {\r\n                var obj = this.$(\"object\")[0];\r\n                if (obj) {\r\n                    obj.style.display = \"none\";\r\n                }\r\n            }\r\n            if (this.videoElement) {\r\n                $(this.videoElement.pluginElement).remove();\r\n                delete this.videoElement;\r\n            }\r\n            Backbone.View.prototype.remove.call(this);\r\n        },\r\n\r\n        onPlayerReady: function (videoElement, domObject) {\r\n            this.videoElement = videoElement;\r\n\r\n            if (!this.videoElement.player) {\r\n                this.videoElement.player =  mejs.players[this.$('.mejs-container').attr('id')];\r\n            }\r\n\r\n            if (this.model.get('_alwaysShowControls')) {\r\n                this.videoElement.player.showControls();\r\n                this.$(\".mejs-controls\").css(\"display\", \"block\");\r\n            }\r\n\r\n            this.setupEventListeners();\r\n\r\n            this.trigger(\"ready\", this);\r\n        },\r\n\r\n        resize: function($parent) {\r\n\r\n            var width = $parent.width(), height= $parent.height();\r\n\r\n            var videoRatio  = this.ratioWidth / this.ratioHeight;\r\n            var parentRatio = width / height;\r\n\r\n            var isWiderRatio = (videoRatio <= parentRatio);\r\n\r\n            this.$el.css({\r\n                width: \"\",\r\n                height: \"\"\r\n            });\r\n\r\n            _.defer(_.bind(function() {\r\n                if (isWiderRatio) {\r\n                    var forceHeight = width / videoRatio;\r\n                    var topOffset = -((forceHeight - height) / 2)\r\n                    this.$el.css({\r\n                        width: width,\r\n                        height: forceHeight,\r\n                        top: topOffset,\r\n                        left: 0\r\n                    });\r\n                    this.$(\".mejs-container, object\").css({\r\n                        width: width,\r\n                        height: forceHeight,\r\n                    })\r\n                } else {\r\n                    var forceWidth = height * videoRatio;\r\n                    var leftOffset = -((forceWidth - width) / 2)\r\n                    this.$el.css({\r\n                        width: forceWidth,\r\n                        height: height,\r\n                        left: leftOffset,\r\n                        top: 0\r\n                    });    \r\n                    this.$(\".mejs-container, object\").css({\r\n                        width: forceWidth,\r\n                        height: height,\r\n                    })\r\n                }\r\n            }, this));\r\n            \r\n        }\r\n\r\n    },{\r\n        template: \"background-video\"\r\n    });\r\n\r\n    return Video;\r\n\r\n});\r\n\n","define('extensions/adapt-background-video/js/iPhoneVideo',[],function() {\r\n\r\n    var uid = 0;\r\n\r\n    var tagpool = [];\r\n    var poolUid = 0;\r\n    var attributes = [ \"preload\", \"poster\", \"width\", \"height\", \"style\", \"src\", \"controls\", \"loop\" ];\r\n\r\n    var Video = Backbone.View.extend({\r\n\r\n        volume: 1,\r\n\r\n        className: function() {\r\n            return \"video-widget a11y-ignore-aria\";\r\n        },\r\n\r\n        initialize: function(options) {\r\n            this.uid = uid++;\r\n\r\n            this.preRender();\r\n            this.render();\r\n            _.defer(_.bind(function() {\r\n                this.postRender();\r\n            }, this));\r\n\r\n            this.setupRatio();\r\n        },\r\n\r\n        setupRatio: function() {\r\n\r\n            var ratio = \"16:9\";\r\n            if (this.model.get(\"_ratio\")) ratio = this.model.get(\"_ratio\");\r\n            \r\n            var colonIndex = ratio.indexOf(\":\");\r\n\r\n            this.ratioWidth = parseFloat( ratio.substr(0, colonIndex) );\r\n            this.ratioHeight = parseFloat( ratio.substr(colonIndex+1, ratio.length) );\r\n            \r\n        },\r\n\r\n        preRender: function() {\r\n            var speed = \"fast\";\r\n            if (speedtest) speed = speedtest.low_name;\r\n            var isiPhone = $.fn.inlinevideo.isiPhone;\r\n            var isiOS = $.fn.inlinevideo.isiOS;\r\n            this.model.get(\"_media\").extension = \"mp4\";\r\n            if (isiPhone || isiOS) {\r\n                console.log(\"Forcing low quality videos\");\r\n                speed = \"slow\";\r\n            }\r\n\r\n            this.model.set(\"speed\", speed);\r\n        },\r\n\r\n        render: function() {\r\n            var template = Handlebars.templates[this.constructor.template];\r\n            var output = template(this.model.toJSON());\r\n            this.$el.html(output);\r\n        },\r\n\r\n        postRender: function() {\r\n            if (tagpool.length > 0) {\r\n                this.fromPool = true;\r\n                var $reused = tagpool.pop();\r\n                console.log(\"not fresh\", $reused);\r\n                for (var i = 0, l = attributes.length; i < l; i++) {\r\n                    var attr = attributes[i];\r\n                    $reused.removeAttr(attr);\r\n                }\r\n                $reused.html(\"\").append(this.$(\"video\").children());\r\n                var $unused = this.$(\"video\");\r\n                for (var i = 0, l = attributes.length; i < l; i++) {\r\n                    var attr = attributes[i];\r\n                    $reused.attr(attr, $unused.attr(attr));\r\n                }\r\n                $unused.replaceWith($reused);\r\n                $reused.removeAttr(\"mute\");\r\n                console.log(\"reuse\", $reused[0].poolUid);\r\n            } else {\r\n                console.log(\"fresh\", this.$(\"video\"));\r\n            }\r\n\r\n            this.setupPlayer();\r\n        },\r\n\r\n        setupPlayer: function() {\r\n\r\n            var modelOptions = {};\r\n            modelOptions.success = _.bind(this.onPlayerReady, this);\r\n            modelOptions.showScrubBar = false;\r\n            modelOptions.mute = this.model.get(\"mute\");\r\n            modelOptions.loop = this.model.get(\"loop\");\r\n\r\n            // create the player\r\n            this.$('video').inlinevideo(modelOptions);\r\n        },\r\n\r\n        setupEventListeners: function() {\r\n            $(this.videoElement).on(\"play\", _.bind(this.onEventFired, this));\r\n            $(this.videoElement).on(\"ended\", _.bind(this.onEventFired, this));\r\n            $(this.videoElement).on('timeupdate', _.bind(this.onEventFired, this));\r\n        },\r\n\r\n        onEventFired: function(e) {\r\n            if (this.isRemoved) return;\r\n            switch (e.type) {\r\n            case \"timeupdate\":\r\n                var currentSeconds = Math.ceil(this.videoElement.currentTime*10)/10;\r\n                if (this.triggerSeconds !== currentSeconds) {\r\n                    //console.log(\"seconds iPhoneVideoElement\", this.uid, currentSeconds);\r\n                    this.trigger(\"seconds\", this, currentSeconds);\r\n                    this.triggerSeconds = currentSeconds\r\n                }\r\n                break;\r\n            case \"ended\":\r\n                this.trigger(\"finish\", this);\r\n                break;\r\n            case \"play\":\r\n                this.trigger(\"play\", this);\r\n                break;\r\n            default:\r\n                debugger;\r\n            }\r\n        },\r\n\r\n        play: function(seekTo) {\r\n            if (this.$(\"video\")[0].poolUid === undefined) {\r\n                this.$(\"video\")[0].poolUid = poolUid++;\r\n            }\r\n            this.setCurrentSeconds(seekTo);\r\n            this.hasPlayed = true;\r\n            this.videoElement.play();\r\n        },\r\n\r\n        setCurrentSeconds: function(seekTo) {\r\n            this.videoElement.setCurrentTime(seekTo);\r\n        },\r\n\r\n        pause: function() {\r\n            this.videoElement.pause()\r\n        },\r\n\r\n        mute: function() {\r\n            this.videoElement.setVolume(0);\r\n        },\r\n\r\n        unmute: function() {\r\n            this.videoElement.setVolume(1);\r\n        },\r\n\r\n        isPaused: function() {\r\n            return this.videoElement.paused;\r\n        },\r\n\r\n        getVolume: function() {\r\n            return this.volume;\r\n        },\r\n\r\n        setVolume: function(int) {\r\n            this.volume = int;\r\n            if (this.volume < 1) this.volume = 0;\r\n            if (this.volume >= 1) this.volume = 1;\r\n            this.videoElement.setVolume(this.volume);\r\n        },\r\n\r\n        remove: function() {\r\n            this.isRemoved = true;\r\n            if (this.$(\"video\")[0].poolUid !== undefined) {\r\n                tagpool.push(this.$(\"video\"));\r\n                console.log(\"pooling\", this.$(\"video\")[0].poolUid);\r\n            }\r\n\r\n            if (this.videoElement) {\r\n                this.videoElement.destroy();\r\n                $(this.videoElement).remove();\r\n                delete this.videoElement;\r\n            }\r\n            Backbone.View.prototype.remove.call(this);\r\n        },\r\n\r\n        onPlayerReady: function (videoElement) {\r\n            this.videoElement = videoElement;\r\n\r\n            this.setupEventListeners();\r\n\r\n            this.trigger(\"ready\", this);\r\n        },\r\n\r\n        resize: function($parent) {\r\n\r\n            var width = $parent.width(), height= $parent.height();\r\n\r\n            var videoRatio  = this.ratioWidth / this.ratioHeight;\r\n            var parentRatio = width / height;\r\n\r\n            var isWiderRatio = (videoRatio <= parentRatio);\r\n\r\n            this.$el.css({\r\n                width: \"\",\r\n                height: \"\"\r\n            });\r\n\r\n            _.defer(_.bind(function() {\r\n                if (isWiderRatio) {\r\n                    var forceHeight = width / videoRatio;\r\n                    var topOffset = -((forceHeight - height) / 2)\r\n                    this.$el.css({\r\n                        width: width,\r\n                        height: forceHeight,\r\n                        top: topOffset,\r\n                        left: 0\r\n                    });\r\n                    this.$(\"inlinevideo\").css({\r\n                        width: width,\r\n                        height: forceHeight,\r\n                    })\r\n                } else {\r\n                    var forceWidth = height * videoRatio;\r\n                    var leftOffset = -((forceWidth - width) / 2)\r\n                    this.$el.css({\r\n                        width: forceWidth,\r\n                        height: height,\r\n                        left: leftOffset,\r\n                        top: 0\r\n                    });    \r\n                    this.$(\"inlinevideo\").css({\r\n                        width: forceWidth,\r\n                        height: height,\r\n                    })\r\n                }\r\n            }, this));\r\n            \r\n        }\r\n\r\n    },{\r\n        template: \"background-video\"\r\n    });\r\n\r\n\r\n    return Video;\r\n\r\n});\r\n\n","define('extensions/adapt-background-video/js/container',[\r\n\t'core/js/adapt',\r\n\t'./video',\r\n\t'./iPhoneVideo',\r\n\t'handlebars'\r\n], function(Adapt, Video, IPhoneVideo, Handlebars) {\r\n\r\n\t$(\"body\").on(\"mousedown touchstart\", function() {\r\n\t\tAdapt.trigger(\"clickjack\");\r\n\t});\r\n\r\n\tvar Container = Backbone.View.extend({\r\n\r\n\t\tvideos: null,\r\n\r\n\t\tinitialize: function() {\r\n\t\t\tthis.videos = {};\r\n\t\t\tthis.setUpEventListeners();\r\n\t\t\tthis.render();\r\n\t\t},\r\n\r\n\t\tsetUpEventListeners: function() {\r\n\t\t\tthis.resize = _.debounce(_.bind(this.resize, this), 17);\r\n\t\t\tthis.listenTo(Adapt, \"device:resize\", this.resize);\r\n\t\t\tthis.listenTo(Adapt, \"clickjack\", this.onClickJack);\r\n\t\t},\r\n\r\n\t\trender: function() {\r\n\t\t\tvar template = Handlebars.templates['background-video-container'];\r\n\t\t\tthis.$el.append(template());\r\n\t\t},\r\n\r\n\t\tresize: function() {\r\n\t\t\tfor (var k in this.videos) {\r\n\t\t\t\tvar video = this.videos[k];\r\n\t\t\t\tvideo.resize(this.$el);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tclassName: function() {\r\n\t\t\treturn \"background-video-container\";\r\n\t\t},\r\n\r\n\t\tadd: function(options) {\r\n\t\t\tif (!options) return;\r\n\r\n\t\t\toptions.loop = true;\r\n\t\t\toptions.mute = true;\r\n\t\t\toptions.showScrubBar = false;\r\n\r\n\t\t\tvar video;\r\n\r\n\t\t\tif ($.fn.inlinevideo.isiOS || $(\"html\").is(\".Safari\")) {\r\n\t\t\t\tvideo = new IPhoneVideo({\r\n\t\t\t\t\tmodel: new Backbone.Model(options),\r\n\t\t\t\t\t$parent: this.$el\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tvideo = new Video({\r\n\t\t\t\t\tmodel: new Backbone.Model(options),\r\n\t\t\t\t\t$parent: this.$el\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tthis.videos[options.name] = video;\r\n\r\n\t\t\tthis.$(\".background-video-inner\").append(video.$el);\r\n\r\n\t\t\tvideo.resize(this.$el);\r\n\r\n\t\t\tthis.listenTo(video, \"ready\", this.onVideoReady);\r\n\t\t\tthis.listenTo(video, \"seconds\", this.onVideoTick);\r\n\t\t},\r\n\r\n\t\tplay: function(videoName) {\r\n\t\t\tif (!this.videos[videoName]) return;\r\n\r\n\t\t\tvar video = this.videos[videoName];\r\n\t\t\tif (video.hasPlayed || this.isReady) {\r\n\t\t\t\tthis.tryPlay(video);\r\n\t\t\t} else {\r\n\t\t\t\tvideo.playWhenReady = true;\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tpause: function(videoName) {\r\n\t\t\tif (!this.videos[videoName]) return;\r\n\r\n\t\t\tvar video = this.videos[videoName];\r\n\t\t\tvideo.pause();\r\n\t\t},\r\n\r\n\t\tonVideoReady: function(video) {\r\n\t\t\tif (video.playWhenReady) {\r\n\t\t\t\tthis.tryPlay(video);\r\n\t\t\t}\r\n\t\t\tthis.isReady = true;\r\n\t\t\tthis.trigger(\"ready\");\r\n\t\t},\r\n\r\n\t\tonVideoTick: function(video, seconds) {\r\n\t\t\tthis.trigger(\"tick\", video, seconds);\r\n\t\t},\r\n\r\n\t\ttryPlay: function(video) {\r\n\t\t\t//try {\r\n\t\t\t\tvideo.shouldBePlaying = true;\r\n\t\t\t\t_.defer(function() {\r\n\t\t\t\t\tvideo.play(0);\r\n\t\t\t\t});\r\n\t\t\t//} catch(e) {\r\n\t\t\t\t//alert(e);\t\r\n\t\t\t//}\r\n\t\t},\r\n\r\n\t\tonClickJack: function() {\r\n\t\t\tfor (var k in this.videos) {\r\n\t\t\t\tvar video = this.videos[k];\r\n\t\t\t\tif (video.shouldBePlaying) {\r\n\t\t\t\t\tvideo.play();\r\n\t\t\t\t\tvideo.shouldBePlaying = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tclear: function() {\r\n\t\t\tfor (var k in this.videos) {\r\n\t\t\t\tvar video = this.videos[k];\r\n\t\t\t\tvideo.remove();\r\n\t\t\t\tdelete this.videos[k];\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tremove: function() {\r\n\t\t\tthis.clear();\r\n\t\t\tBackbone.View.prototype.remove.call(this);\r\n\t\t}\r\n\r\n\r\n\t},{\r\n\t\ttemplate: \"background-video-container\"\r\n\t});\r\n\r\n\treturn Container;\r\n\r\n});\n","define('extensions/adapt-background-video/js/adapt-background-video',[\r\n\t'./container'\r\n], function(Container) {\r\n\r\n\tvar container = new Container();\r\n\r\n    window.BackgroundVideoContainer = Container;\r\n\r\n});\r\n\n","define('extensions/adapt-backgroundVideo/js/backgroundVideoView',[\r\n    'coreJS/adapt',\r\n    'coreViews/componentView'\r\n], function(Adapt, ComponentView) {\r\n\r\n    var BackgroundVideoView = Backbone.View.extend({\r\n        el: function() {\r\n            return Handlebars.templates['backgroundVideo'](this.model.toJSON());\r\n        },\r\n    });\r\n    return BackgroundVideoView;\r\n});\r\n\n","define('extensions/adapt-backgroundVideo/js/adapt-backgroundVideo',[\r\n    \"coreJS/adapt\",\r\n    './backgroundVideoView'\r\n], function(Adapt, BackgroundVideoView) {\r\n\r\n    Adapt.on('blockView:postRender', function(view) {\r\n        var model = view.model;\r\n        var theme = model.get(\"_theme\");\r\n        if (theme && theme._backgroundVideo) {\r\n            view.$el.addClass('backgroundVideo').prepend(new BackgroundVideoView({ model: model }).$el);\r\n        }\r\n\r\n    });\r\n});\r\n\n","/*\r\n * adapt-contrib-tutor\r\n * License - http://github.com/adaptlearning/adapt_framework/blob/master/LICENSE\r\n * Maintainers - Kevin Corry <kevinc@learningpool.com>, Daryl Hedley <darylhedley@hotmail.com>,\r\n *               Himanshu Rajotia <himanshu.rajotia@exultcorp.com>\r\n */\r\ndefine('extensions/adapt-component-animate/js/adapt-component-animate',[\r\n    'coreJS/adapt'\r\n],function(Adapt) {\r\n\r\n    Adapt.on('componentView:preRender', function(view) {\r\n        var model = view.model;\r\n        if (!model.get(\"_componentAnimate\") || model.get(\"_componentAnimate\")._isEnabled === false ) return;\r\n        setupView(view);\r\n\r\n    });\r\n\r\n    function setupView(view) {\r\n        view.$el.css({\r\n            \"visibility\": \"hidden\"\r\n        });\r\n\r\n        var config = view.model.get(\"_componentAnimate\");\r\n\r\n        if (!config._start) return;\r\n        view.$el.velocity(config._start, { duration: 0 });\r\n    }\r\n\r\n    Adapt.on('componentView:postRender', function(view) {\r\n\r\n        var model = view.model;\r\n        if (!model.get(\"_componentAnimate\") || model.get(\"_componentAnimate\")._isEnabled === false ) return;\r\n\r\n        view._animateOnscreen =  _.bind(onscreen, this, view);\r\n        view.$el.on(\"onscreen\", view._animateOnscreen);\r\n    \r\n    });\r\n\r\n    function onscreen(view, event, measurements) {\r\n        var config = view.model.get(\"_componentAnimate\");\r\n        config._startHeight = config._startHeight || 50;\r\n        if (measurements.percentFromTop > config._startHeight) return;\r\n        animateView(view);\r\n    }\r\n\r\n    function animateView(view) {\r\n\r\n        var config = view.model.get(\"_componentAnimate\");\r\n        view.$el.off(\"onscreen\", view._animateOnscreen);\r\n\r\n        config._options = config._options || {};\r\n\r\n        config._options.begin = function() {\r\n            view.$el.css({\r\n                \"visibility\": \"visible\"\r\n            });\r\n        };\r\n\r\n        view.$el.velocity(config._command, config._options);\r\n\r\n    }\r\n\r\n});\r\n\n","define('extensions/adapt-contrib-assessment/js/adapt-assessmentArticleView',[\n    'coreJS/adapt',\n    'coreViews/articleView'\n], function(Adapt, AdaptArticleView) {\n\n    var AssessmentView = {\n\n        postRender: function() {\n            AdaptArticleView.prototype.postRender.call(this);\n            if (this.model.isAssessmentEnabled()) {\n                this._setupEventListeners();\n\n                var config = this.model.getConfig();\n                if (config && config._questions && config._questions._canShowMarking === false) {\n                    this.$el.addClass('no-marking');\n                }\n            }\n            this.$el.addClass('assessment');\n        },\n\n        _setupEventListeners: function() {\n            this.listenTo(Adapt, \"assessments:complete\", this._onAssessmentComplete);\n            this.listenTo(Adapt, \"assessments:reset\", this._onAssessmentReset);\n            this.listenTo(Adapt, \"remove\", this._onRemove);\n        },\n\n        _removeEventListeners: function() {\n            this.stopListening(Adapt, \"assessments:complete\", this._onAssessmentComplete);\n            this.stopListening(Adapt, \"assessments:reset\", this._onAssessmentReset);\n        },\n\n        _onAssessmentComplete: function(state, model) {\n            if (state.id != this.model.get(\"_assessment\")._id) return;\n\n            console.log(\"assessment complete\", state, model);\n\n        },\n\n        _onAssessmentReset: function(state, model) {\n            if (state.id != this.model.get(\"_assessment\")._id) return;\n\n            console.log(\"assessment reset\", state, model);\n\n        },\n\n        _onRemove: function() {\n            this._removeEventListeners();\n        }\n\n    };\n\n    return AssessmentView;\n\n});\n\n","define('extensions/adapt-contrib-assessment/js/adapt-assessmentQuestionBank',['require'],function(require) {\n    \n    var QuestionBank = function(quizBankid, articleId, numQuestionBlocks, uniqueQuestions) {\n\n        this._id = quizBankid;\n        this._articleId = articleId;\n        this._numQuestionBlocks = numQuestionBlocks;\n        this._uniqueQuestions = uniqueQuestions;\n        this.questionBlocks = [];\n        this.unUsedQuestionBlocks = undefined;\n        this.usedQuestionBlocks = [];\n\n    };\n\n    QuestionBank.prototype = {\n\n        getID: function() {\n            return this._id;\n        },\n\n        addBlock: function(block) {\n            this.questionBlocks.push(block);\n        },\n\n        getRandomQuestionBlocks: function() {\n            this.checkResetUnunsedBlocks();\n\n            var questionBlocks = [];\n            var usedQuestionBlocks = this.usedQuestionBlocks.slice(0);\n\n            for (var i = 0; i < this._numQuestionBlocks; i++) {\n                var question = this.getRandomQuestion();\n                if (question !== undefined) {\n                    questionBlocks.push(question);\n                } else {\n                    if (usedQuestionBlocks.length === 0) break;\n                    var index = Math.floor(Math.random() * (usedQuestionBlocks.length-1));\n                    question = usedQuestionBlocks.splice(index,1)[0];\n                    questionBlocks.push(question);\n                }\n            }\n                \n            return questionBlocks;\n        },\n\n        checkResetUnunsedBlocks: function() {\n            if (this.unUsedQuestionBlocks !== undefined && this._uniqueQuestions) return;\n            \n            this.unUsedQuestionBlocks = this.questionBlocks.slice(0);\n        },\n\n        getRandomQuestion: function() {\n            if (this.unUsedQuestionBlocks !== undefined && this.unUsedQuestionBlocks.length < 1) {\n               console.warn(\"assessment:\"+this._articleId+\" No more unique questions for _assessment._quizBankID \" + this._id);\n               return undefined;\n            }\n\n            var index = Math.round(Math.random() * (this.unUsedQuestionBlocks.length-1));\n            var questionBlock = this.unUsedQuestionBlocks[index];\n            this.usedQuestionBlocks.push(questionBlock);\n\n            this.unUsedQuestionBlocks.splice(index, 1);\n\n            return questionBlock;\n        }\n        \n    };\n\n    return QuestionBank;\n\n});\n","define('extensions/adapt-contrib-assessment/js/adapt-assessmentArticleModel',[\n    'coreJS/adapt',\n    './adapt-assessmentQuestionBank'\n], function(Adapt, QuestionBank) {\n\n\n    var givenIdCount = 0;\n    var assessmentConfigDefaults = {\n        \"_isEnabled\":true,\n        \"_questions\": {\n            \"_resetType\": \"soft\",\n            \"_canShowFeedback\": false,\n            \"_canShowMarking\": false,\n            \"_canShowModelAnswer\": false\n        },\n        \"_isPercentageBased\" : true,\n        \"_scoreToPass\" : 100,\n        \"_includeInTotalScore\": true,\n        \"_assessmentWeight\": 1,\n        \"_isResetOnRevisit\": true,\n        \"_reloadPageOnReset\": true,\n        \"_attempts\": \"infinite\"\n    };\n\n    var AssessmentModel = {\n\n    //Private functions\n\n        _postInitialize: function() {\n            if (!this.isAssessmentEnabled()) return;\n\n            var assessmentConfig = this.getConfig();\n\n            _.extend(this, {\n                '_currentQuestionComponents': null,\n                \"_originalChildModels\": null,\n                \"_questionBanks\": null,\n                \"_forceResetOnRevisit\": false\n            });\n\n            var attemptsLeft;\n            switch (assessmentConfig._attempts) {\n                case \"infinite\": case 0: case undefined: case -1: case null:\n                     attemptsLeft = \"infinite\";\n                    break;\n                default:\n                    attemptsLeft = assessmentConfig._attempts;\n                    break;\n            }\n\n\n            //if assessment passed required and assessment included in total\n            //set attemptsleft to infinite\n            var centralAssessmentState = Adapt.assessment.getState();\n\n            if (assessmentConfig._includeInTotalScore &&\n                centralAssessmentState.requireAssessmentPassed) {\n                attemptsLeft = \"infinite\";\n            }\n\n            this.set({\n                '_currentQuestionComponentIds': [],\n                '_assessmentCompleteInSession': false,\n                '_attemptInProgress': false,\n                \"_isAssessmentComplete\": false,\n                '_numberOfQuestionsAnswered': 0,\n                '_lastAttemptScoreAsPercent': 0,\n                \"_attempts\": attemptsLeft,\n                \"_attemptsLeft\": attemptsLeft,\n                \"_attemptsSpent\": 0\n            });\n\n            this.listenToOnce(Adapt, \"app:dataReady\", this._onDataReady);\n            this.listenTo(Adapt, \"remove\", this._onRemove);\n\n        },\n\n        init: function() {\n            //save original children\n            this._originalChildModels = this.getChildren().models;\n            //collect all question components\n            this._currentQuestionComponents = this.findDescendants(\"components\").where({_isQuestionType: true});\n            var currentQuestionsCollection = new Backbone.Collection(this._currentQuestionComponents);\n            this.set(\"_currentQuestionComponentIds\", currentQuestionsCollection.pluck(\"_id\"));\n\n            this._setAssessmentOwnershipOnChildrenModels();\n\n        },\n\n        _setAssessmentOwnershipOnChildrenModels: function() {\n            //mark all children components as belonging to an assessment\n            for (var i = 0, l = this._originalChildModels.length; i < l; i++) {\n                var blockModel = this._originalChildModels[i];\n                blockModel.set({\n                    _isPartOfAssessment: true\n                });\n                //make sure components are set to _isPartOfAssessment for plp checking\n                blockModel.setOnChildren({\n                    _isPartOfAssessment: true\n                });\n            }\n        },\n        \n\n        _onDataReady: function() {\n            //register assessment\n            Adapt.assessment.register(this);\n        },\n\n        _setupAssessmentData: function(force) {\n            var assessmentConfig = this.getConfig();\n            var state = this.getState();\n            var shouldResetAssessment = (!this.get(\"_attemptInProgress\") && !state.isPass)\n                                || force == true;\n\n            var quizModels;\n            if (shouldResetAssessment) {\n                this.set(\"_numberOfQuestionsAnswered\", 0);\n                this.set(\"_isAssessmentComplete\", false);\n                this.set(\"_assessmentCompleteInSession\", false);\n                this.set(\"_score\", 0);\n                this.getChildren().models = this._originalChildModels;\n                if(assessmentConfig._banks && \n                        assessmentConfig._banks._isEnabled && \n                        assessmentConfig._banks._split.length > 1) {\n\n                    quizModels = this._setupBankedAssessment();\n                } else if(assessmentConfig._randomisation && \n                        assessmentConfig._randomisation._isEnabled) {\n\n                    quizModels = this._setupRandomisedAssessment();\n                }\n            }\n\n            if (!quizModels) {\n                // leave the order as before, completed or not\n                quizModels = this.getChildren().models;\n            } else if ( quizModels.length === 0 ) {\n                quizModels = this.getChildren().models;\n                console.warn(\"assessment: Not enough unique questions to create a fresh assessment, using last selection\");\n            }\n\n            this.getChildren().models = quizModels;\n\n            this._currentQuestionComponents = this.findDescendants('components').where({_isQuestionType: true});\n            var currentQuestionsCollection = new Backbone.Collection(this._currentQuestionComponents);\n            this.set(\"_currentQuestionComponentIds\", currentQuestionsCollection.pluck(\"_id\"));\n\n            var shouldResetQuestions = (assessmentConfig._isResetOnRevisit !== false && !state.isPass) \n                                        || force == true;\n\n            if (shouldResetAssessment || shouldResetQuestions) {\n                this._resetQuestions();\n                this.set(\"_attemptInProgress\", true);\n                Adapt.trigger('assessments:reset', this.getState(), this);\n            }\n            \n            if (!state.isComplete) {\n                this.set(\"_attemptInProgress\", true);\n            }\n            \n            this._overrideQuestionComponentSettings();\n            this._setupQuestionListeners();\n            this._checkNumberOfQuestionsAnswered();\n            this._updateQuestionsState();\n\n            Adapt.assessment.saveState();\n\n        },\n\n        _setupBankedAssessment: function() {\n            var assessmentConfig = this.getConfig();\n\n            this._setupBanks();\n\n            //get random questions from banks\n            var questionModels = [];\n            for (var bankId in this._questionBanks) {\n                var questionBank = this._questionBanks[bankId];\n                var questions = questionBank.getRandomQuestionBlocks();\n                questionModels = questionModels.concat(questions);\n            }\n\n            //if overall question order should be randomized\n            if (assessmentConfig._banks._randomisation) {\n                questionModels = _.shuffle(questionModels);\n            }\n\n            return questionModels;\n        },\n\n        _setupBanks: function() {\n            var assessmentConfig = this.getConfig();\n            var banks = assessmentConfig._banks._split.split(\",\");\n\n            this._questionBanks = [];\n\n            //build fresh banks\n            for (var i = 0, l = banks.length; i < l; i++) {\n                var bank = banks[i];\n                var bankId = (i+1);\n                var questionBank = new QuestionBank(bankId, \n                                                this.get(\"_id\"), \n                                                bank, \n                                                true);\n\n                this._questionBanks[bankId] = questionBank;\n            }\n\n            //add blocks to banks\n            var children = this.getChildren().models;\n            for (var i = 0, l = children.length; i < l; i++) {\n                var blockModel = children[i];\n                var blockAssessmentConfig = blockModel.get('_assessment');\n                var bankId = blockAssessmentConfig._quizBankID;\n                this._questionBanks[bankId].addBlock(blockModel);\n            }\n\n        },\n\n        _setupRandomisedAssessment: function() {\n            var assessmentConfig = this.getConfig();\n\n            var randomisationModel = assessmentConfig._randomisation;\n            var blockModels = this.getChildren().models;\n            \n            var questionModels = _.shuffle(blockModels);\n\n            questionModels = questionModels.slice(0, randomisationModel._blockCount);\n            \n            return questionModels;\n        },\n\n        _overrideQuestionComponentSettings: function() {\n            var questionConfig = this.getConfig()._questions;\n            var questionComponents = this._currentQuestionComponents;\n\n            var newSettings = {};\n            if(questionConfig.hasOwnProperty('_canShowFeedback')) {\n                newSettings._canShowFeedback = questionConfig._canShowFeedback;\n            }\n\n            if(questionConfig.hasOwnProperty('_canShowModelAnswer')) {\n                newSettings._canShowModelAnswer = questionConfig._canShowModelAnswer;\n            }\n\n            if (questionConfig.hasOwnProperty('_canShowMarking')) {\n                newSettings._canShowMarking = questionConfig._canShowMarking;\n            }\n\n            if(!_.isEmpty(newSettings)) {\n                for (var i = 0, l = questionComponents.length; i < l; i++) {\n                    questionComponents[i].set(newSettings, { pluginName: \"_assessment\" });\n                }\n            }\n\n        },\n\n        _setupQuestionListeners: function() {\n            var questionComponents = this._currentQuestionComponents;\n            for (var i = 0, l = questionComponents.length; i < l; i++) {\n                var question = questionComponents[i];\n                if (question.get(\"_isInteractionComplete\")) continue;\n                this.listenTo(question, 'change:_isInteractionComplete', this._onQuestionCompleted);\n            }\n        },\n\n        _checkNumberOfQuestionsAnswered: function() {\n            var questionComponents = this._currentQuestionComponents;\n            var numberOfQuestionsAnswered = 0;\n            for (var i = 0, l = questionComponents.length; i < l; i++) {\n                var question = questionComponents[i];\n                if (question.get(\"_isInteractionComplete\")) {\n                    numberOfQuestionsAnswered++;\n                }\n            }\n            this.set(\"_numberOfQuestionsAnswered\", numberOfQuestionsAnswered);\n        },\n\n        _removeQuestionListeners: function() {\n            var questionComponents = this._currentQuestionComponents;\n            for (var i = 0, l = questionComponents.length; i < l; i++) {\n                var question = questionComponents[i];\n                this.stopListening(question, 'change:_isInteractionComplete', this._onQuestionCompleted);\n            }\n        },\n\n        _onQuestionCompleted: function(questionModel, value) {\n            if (value === false) return;\n            if(!questionModel.get('_isInteractionComplete')) return;\n\n            var numberOfQuestionsAnswered = this.get(\"_numberOfQuestionsAnswered\");\n            numberOfQuestionsAnswered++;\n            this.set(\"_numberOfQuestionsAnswered\", numberOfQuestionsAnswered);\n\n            this._updateQuestionsState();\n            Adapt.assessment.saveState();\n\n            this._checkAssessmentComplete();\n        },\n\n        _checkAssessmentComplete: function() {\n            var numberOfQuestionsAnswered = this.get(\"_numberOfQuestionsAnswered\");\n\n            var allQuestionsAnswered = numberOfQuestionsAnswered >= this._currentQuestionComponents.length;\n            if (!allQuestionsAnswered) return;\n            \n            this._onAssessmentComplete();\n        },\n\n        _onAssessmentComplete: function() {\n            var assessmentConfig = this.getConfig();\n\n            this.set(\"_attemptInProgress\", false);\n            this._spendAttempt();\n\n            var scoreAsPercent = this._getScoreAsPercent();\n            var score = this._getScore();\n            var maxScore = this._getMaxScore();\n\n            this.set({\n                '_scoreAsPercent': scoreAsPercent,\n                '_score': score,\n                '_maxScore': maxScore,\n                '_lastAttemptScoreAsPercent': scoreAsPercent,\n                '_assessmentCompleteInSession': true,\n                '_isAssessmentComplete': true\n            });\n\n            this._updateQuestionsState();\n\n            this._checkIsPass();\n\n            this._removeQuestionListeners();\n            \n            Adapt.trigger('assessments:complete', this.getState(), this);\n        },\n\n        _updateQuestionsState: function() {\n            var questions = [];\n\n            var questionComponents = this._currentQuestionComponents;\n            for (var i = 0, l = questionComponents.length; i < l; i++) {\n                var questionComponent = questionComponents[i];\n\n                var questionModel = {\n                    _id: questionComponent.get(\"_id\"),\n                    _isCorrect: questionComponent.get(\"_isCorrect\") === undefined ? null : questionComponent.get(\"_isCorrect\")\n                };\n\n                //build array of questions\n                questions.push(questionModel);\n\n            }\n            \n            this.set({\n                '_questions': questions\n            });\n        },\n\n        _checkIsPass: function() {\n            var assessmentConfig = this.getConfig();\n\n            var isPercentageBased = assessmentConfig._isPercentageBased;\n            var scoreToPass = assessmentConfig._scoreToPass;\n\n            var scoreAsPercent = this.get(\"_scoreAsPercent\");\n            var score = this.get(\"_score\");\n\n            var isPass = false;\n            if (score && scoreAsPercent) {\n                if (isPercentageBased) {\n                    isPass = (scoreAsPercent >= scoreToPass) ? true : false;\n                } else {\n                    isPass = (score >= scoreToPass) ? true : false;\n                }\n            }\n\n            this.set(\"_isPass\", isPass);\n        },\n\n        _isAttemptsLeft: function() {\n            var assessmentConfig = this.getConfig();\n\n            var isAttemptsEnabled = assessmentConfig._attempts && assessmentConfig._attempts != \"infinite\";\n\n            if (!isAttemptsEnabled) return true;\n\n            if (this.get('_attemptsLeft') === 0) return false;\n        \n            return true;\n        },\n\n        _spendAttempt: function() {\n            if (!this._isAttemptsLeft()) return false;\n\n            var attemptsSpent = this.get(\"_attemptsSpent\");\n            attemptsSpent++;\n            this.set(\"_attemptsSpent\", attemptsSpent);\n\n            if (this.get('_attempts') == \"infinite\") return true;\n\n            var attemptsLeft = this.get('_attemptsLeft');\n            attemptsLeft--;\n            this.set('_attemptsLeft', attemptsLeft);\n\n            return true;\n        },\n\n        _getScore: function() {\n            var score = 0;\n            var questionComponents = this._currentQuestionComponents;\n            for (var i = 0, l = questionComponents.length; i < l; i++) {\n                var question = questionComponents[i];\n                if (question.get('_isCorrect') && \n                    question.get('_questionWeight')) {\n                    score += question.get('_questionWeight');\n                }\n            }\n            return score;\n        },\n        \n        _getMaxScore: function() {\n            var maxScore = 0;\n            var questionComponents = this._currentQuestionComponents;\n            for (var i = 0, l = questionComponents.length; i < l; i++) {\n                var question = questionComponents[i];\n                if (question.get('_questionWeight')) {\n                    maxScore += question.get('_questionWeight');\n                }\n            }\n            return maxScore;\n        },\n        \n        _getScoreAsPercent: function() {\n            if (this._getMaxScore() === 0) return 0;\n            return Math.round((this._getScore() / this._getMaxScore()) * 100);\n        },\n\n        _getLastAttemptScoreAsPercent: function() {\n            return this.get('_lastAttemptScoreAsPercent');\n        },\n\n        _checkReloadPage: function() {\n            if (!this.canResetInPage()) return false;\n\n            var parentId = this.getParent().get(\"_id\");\n            var currentLocation = Adapt.location._currentId;\n\n            //check if on assessment page and should rerender page\n            if (currentLocation != parentId) return false;\n            if (!this.get(\"_isReady\")) return false;\n\n            return true;\n        },\n\n        _reloadPage: function() {\n            this._forceResetOnRevisit = true;\n\n            Backbone.history.navigate(\"#/id/\"+Adapt.location._currentId, { replace:true, trigger: true });\n        },\n\n        _resetQuestions: function() {\n            var assessmentConfig = this.getConfig();\n            var questionComponents = this._currentQuestionComponents;\n\n            for (var i = 0, l = questionComponents.length; i < l; i++) {\n                var question = questionComponents[i];\n                question.reset(assessmentConfig._questions._resetType, true);\n            }\n        },\n\n        _onRemove: function() {\n            this._removeQuestionListeners();\n        },\n\n\n\n        _setCompletionStatus: function() {\n            this.set({\n                \"_isComplete\": true,\n                \"_isInteractionComplete\": true,\n            });\n        },\n\n        _checkIfQuestionsWereRestored: function() {\n            if (this.get(\"_assessmentCompleteInSession\")) return;\n            if (!this.get(\"_isAssessmentComplete\")) return;\n\n            //fix for courses that do not remember the user selections\n            //force assessment to reset if user revisits an assessment page in a new session which is completed\n            var wereQuestionsRestored = true;\n\n            var questions = this.get(\"_questions\");\n            for (var i = 0, l = questions.length; i < l; i++) {\n                var question = questions[i];\n                var questionModel = Adapt.findById(question._id);\n                if (!questionModel.get(\"_isSubmitted\")) {\n                    wereQuestionsRestored = false;\n                    break;\n                }\n            }\n        \n            if (!wereQuestionsRestored) {\n                this.set(\"_assessmentCompleteInSession\", true);\n                return true;\n            }\n\n            return false;\n        },\n\n\n    //Public Functions\n\n        isAssessmentEnabled: function() {\n            if (this.get(\"_assessment\") && \n                this.get(\"_assessment\")._isEnabled) return true;\n            return false;\n        },\n\n        canResetInPage: function() {\n            var assessmentConfig = this.getConfig();\n            if (assessmentConfig._reloadPageOnReset === false) return false;\n            return true;\n        },\n\n        reset: function(force) {\n            var assessmentConfig = this.getConfig();\n\n            //check if forcing reset via page revisit or force parameter\n            force = this._forceResetOnRevisit || force == true;\n            this._forceResetOnRevisit = false;\n\n            var isPageReload = this._checkReloadPage();\n\n            //stop resetting if not complete or not allowed\n            if (this.get(\"_assessmentCompleteInSession\") && \n                    !assessmentConfig._isResetOnRevisit && \n                    !isPageReload && \n                    !force) return false;\n            \n            //check if new session and questions not restored\n            var wereQuestionsRestored = this._checkIfQuestionsWereRestored();\n            force = force || wereQuestionsRestored;\n            // the assessment is going to be reset so we must reset attempts\n            // otherwise assessment may not be set up properly in next session\n            if (wereQuestionsRestored && !this._isAttemptsLeft()) {\n                this.set({'_attemptsLeft':this.get('_attempts')});\n                this.set({'_attemptsSpent':0});\n            }\n\n            //stop resetting if no attempts left\n            if (!this._isAttemptsLeft() && !force) return false;\n\n            if (!isPageReload) {\n                //only perform this section when not attempting to reload the page\n                this._setupAssessmentData(force);\n            } else {\n                this._reloadPage();\n            }\n\n            return true;\n        },\n\n        getSaveState: function() {\n            var state = this.getState();\n            var questions = state.questions;\n            var indexByIdQuestions = _.indexBy(questions, \"_id\");\n\n            for (var id in indexByIdQuestions) {\n                indexByIdQuestions[id] = indexByIdQuestions[id]._isCorrect\n            }\n\n            var saveState = [\n                state.isComplete ? 1:0,\n                state.attemptsSpent,\n                state.maxScore,\n                state.score,\n                state.attemptInProgress ? 1:0,\n                indexByIdQuestions\n            ];\n\n            return saveState;\n        },\n\n        setRestoreState: function(restoreState) {\n            var isComplete = restoreState[0] == 1 ? true : false;\n            var attempts = this.get(\"_attempts\");\n            var attemptsSpent = restoreState[1];\n            var maxScore = restoreState[2];\n            var score = restoreState[3];\n            var attemptInProgress = restoreState[4] == 1 ? true : false;\n            var scoreAsPercent;\n\n            var indexByIdQuestions = restoreState[5];\n\n            var blockIds = {};\n            for (var id in indexByIdQuestions) {\n                var blockId = Adapt.findById(id).get(\"_parentId\");\n                blockIds[blockId] = Adapt.findById(blockId);\n            }\n            var restoredChildrenModels = _.values(blockIds);\n            \n            if (indexByIdQuestions) this.getChildren().models = restoredChildrenModels;\n\n\n            this.set(\"_isAssessmentComplete\", isComplete);\n            this.set(\"_assessmentCompleteInSession\", false);\n            this.set(\"_attemptsSpent\", attemptsSpent );\n            this.set(\"_attemptInProgress\", attemptInProgress )\n\n            if (attempts == \"infinite\") this.set(\"_attemptsLeft\", \"infinite\");\n            else this.set(\"_attemptsLeft\" , attempts - attemptsSpent);\n\n            this.set(\"_maxScore\", maxScore || this._getMaxScore());\n            this.set(\"_score\", score || 0);\n\n            if (score) {\n                scoreAsPercent = Math.round( score / maxScore  * 100);\n            } else {\n                scoreAsPercent = 0;\n            }\n        \n            this.set(\"_scoreAsPercent\", scoreAsPercent);\n            this.set(\"_lastAttemptScoreAsPercent\", scoreAsPercent)\n\n            \n            var questions = [];\n            for (var id in indexByIdQuestions) {\n                questions.push({\n                    _id: id,\n                    _isCorrect: indexByIdQuestions[id]\n                });\n            }\n\n            \n\n            this.set(\"_questions\", questions);\n            this._checkIsPass();\n\n        },\n\n        getState: function() {\n            //return the current state of the assessment\n            //create snapshot of values so as not to create memory leaks\n            var assessmentConfig = this.getConfig();\n\n            var state = {\n                id: assessmentConfig._id,\n                type: \"article-assessment\",\n                pageId: this.getParent().get(\"_id\"),\n                isEnabled: assessmentConfig._isEnabled,\n                isComplete: this.get(\"_isAssessmentComplete\"),\n                isPercentageBased: assessmentConfig._isPercentageBased,\n                scoreToPass: assessmentConfig._scoreToPass,\n                score: this.get(\"_score\"),\n                scoreAsPercent: this.get(\"_scoreAsPercent\"),\n                maxScore: this.get(\"_maxScore\"),\n                isPass: this.get(\"_isPass\"),\n                includeInTotalScore: assessmentConfig._includeInTotalScore,\n                assessmentWeight: assessmentConfig._assessmentWeight,\n                attempts: this.get(\"_attempts\"),\n                attemptsSpent: this.get(\"_attemptsSpent\"),\n                attemptsLeft: this.get(\"_attemptsLeft\"),\n                attemptInProgress: this.get(\"_attemptInProgress\"),\n                lastAttemptScoreAsPercent: this.get('_lastAttemptScoreAsPercent'),\n                questions: this.get(\"_questions\"),\n                questionModels: new Backbone.Collection(this._currentQuestionComponents)\n            };\n\n            return state;\n        },\n\n        getConfig: function() {\n            var assessmentConfig = this.get(\"_assessment\");\n            \n            if (!assessmentConfig) {\n                assessmentConfig = $.extend(true, {}, assessmentConfigDefaults);\n            } else {\n                assessmentConfig = $.extend(true, {}, assessmentConfigDefaults, assessmentConfig);\n            }\n            \n            if (assessmentConfig._id === undefined) {\n                assessmentConfig._id = \"givenId\"+(givenIdCount++);\n            }\n            \n            this.set(\"_assessment\", assessmentConfig);\n\n            return assessmentConfig;\n        }\n        \n    };\n\n    return AssessmentModel;\n});\n\n","define('extensions/adapt-contrib-assessment/js/assessment',[\n    'coreJS/adapt'\n], function(Adapt) {\n\n    /*\n        Here we setup a registry for all assessments\n    */\n\n    var assessmentsConfigDefaults = {\n        \"_postTotalScoreToLms\": true,\n        \"_isPercentageBased\": true,\n        \"_scoreToPass\": 100,\n        \"_requireAssessmentPassed\": false,\n        \"_isDefaultsLoaded\": true\n    };\n\n    Adapt.assessment = _.extend({\n\n    //Private functions\n\n        _assessments: _.extend([], {\n            _byPageId: {},\n            _byAssessmentId: {}\n        }),\n\n        initialize: function() {\n            this.listenTo(Adapt, \"assessments:complete\", this._onAssessmentsComplete);\n            this.listenTo(Adapt, \"router:location\", this._checkResetAssessmentsOnRevisit);\n            this.listenTo(Adapt, \"app:dataReady\", this._onDataReady);\n        },\n\n        _onAssessmentsComplete: function(state) {\n            var assessmentId = state.id;\n\n            state.isComplete = true;\n\n            if (assessmentId === undefined) return;\n\n            if (!this._getStateByAssessmentId(assessmentId)) {\n                console.warn(\"assessments: state was not registered when assessment was created\");\n            }\n\n            this.saveState();\n\n            this._setPageProgress();\n\n            this._checkAssessmentsComplete();\n\n            //need to add spoor assessment state saving\n\n        },\n\n        _restoreModelState: function(assessmentModel) {\n\n            if (!this._saveStateModel) {\n                this._saveStateModel = Adapt.offlineStorage.get(\"assessment\");\n            }\n            if (this._saveStateModel) {\n                var state = assessmentModel.getState();\n                if (this._saveStateModel[state.id]) {\n                    assessmentModel.setRestoreState(this._saveStateModel[state.id]);\n                }\n            }\n\n        },\n\n        _checkResetAssessmentsOnRevisit: function(toObject) {\n            /* \n                Here we hijack router:location to reorganise the assessment blocks \n                this must happen before trickle listens to block completion\n            */\n            if (toObject._contentType !== \"page\") return;\n\n            //initialize assessment on page visit before pageView:preRender (and trickle)\n            var pageAssessmentModels = this._getAssessmentByPageId(toObject._currentId);\n            if (pageAssessmentModels === undefined) return;\n\n            for (var i = 0, l = pageAssessmentModels.length; i < l; i++) {\n                var pageAssessmentModel = pageAssessmentModels[i];\n                pageAssessmentModel.reset();\n            }\n\n            this._setPageProgress();\n        },\n\n        _onDataReady: function() {\n            this._assessments = _.extend([], {\n                _byPageId: {},\n                _byAssessmentId: {}\n            });\n        },\n\n        _checkAssessmentsComplete: function() {\n            var allAssessmentsComplete = true;\n            var assessmentToPostBack = 0;\n            var states = this._getStatesByAssessmentId();\n\n            var assessmentStates = [];\n\n            for (var id in states) {\n                var state = states[id];\n                if (!state.includeInTotalScore) continue;\n                if (!state.isComplete) {\n                    allAssessmentsComplete = false;\n                    break;\n                }\n                assessmentToPostBack++;\n                assessmentStates.push(state);\n            }\n\n            if (!allAssessmentsComplete || assessmentToPostBack === 0) return false;\n\n            if (assessmentToPostBack === 1) {\n                this._setupSingleAssessmentConfiguration(assessmentStates[0]);\n            }\n\n            this._postScoreToLms();\n\n            return true;\n        },\n\n        _setupSingleAssessmentConfiguration: function(assessmentState) {\n            var assessmentsConfig = Adapt.course.get(\"_assessment\");\n            $.extend(true, assessmentsConfig, {\n                \"_postTotalScoreToLms\": assessmentState.includeInTotalScore,\n                \"_isPercentageBased\": assessmentState.isPercentageBased,\n                \"_scoreToPass\": assessmentState.scoreToPass\n            });\n            Adapt.course.set(\"_assessment\", assessmentsConfig);\n        },\n        \n        _postScoreToLms: function() {\n            var assessmentsConfig = this.getConfig();\n            if (assessmentsConfig._postTotalScoreToLms === false) return;\n            \n            var completionState = this.getState();\n            //post completion to spoor\n            _.defer(function() {\n                Adapt.trigger(\"assessment:complete\", completionState);\n            });\n        },\n\n        _getAssessmentByPageId: function(pageId) {\n            return this._assessments._byPageId[pageId];\n        },\n\n        _getStateByAssessmentId: function(assessmentId) {\n            return this._assessments._byAssessmentId[assessmentId].getState();\n        },\n\n        _getStatesByAssessmentId: function() {\n            var states = {};\n            for (var i = 0, l = this._assessments.length; i < l; i++) {\n                var assessmentModel = this._assessments[i];\n                var state = assessmentModel.getState();\n                states[state.id] = state;\n            }\n            return states;\n        },\n\n        _setPageProgress: function() {\n            //set _subProgressTotal and _subProgressComplete on pages that have assessment progress indicator requirements\n            \n            var requireAssessmentPassed = this.getConfig()._requireAssessmentPassed;\n\n            for (var k in this._assessments._byPageId) {\n\n                var assessments = this._assessments._byPageId[k];\n\n                var assessmentsTotal = assessments.length;\n                var assessmentsPassed = 0;\n\n                for (var i = 0, l = assessments.length; i < l; i++) {\n                    var assessmentState = assessments[i].getState();\n\n                    var isComplete;\n\n                    if (requireAssessmentPassed) {\n                        \n                        if (!assessmentState.includeInTotalScore) {\n                            isComplete = assessmentState.isComplete;\n                        } else if (assessmentState.isPass) {\n                            isComplete = assessmentState.isComplete;\n                        }\n\n                    } else {\n\n                        isComplete = assessmentState.isComplete;\n                    }\n\n                    if ( isComplete ) {\n                        assessmentsPassed+=1; \n                    }\n                }\n\n                try {\n                    var pageModel = Adapt.findById(k);\n                    pageModel.set(\"_subProgressTotal\", assessmentsTotal);\n                    pageModel.set(\"_subProgressComplete\", assessmentsPassed);\n                } catch(e) {\n\n                }\n\n            }\n        },\n\n\n    //Public functions\n\n        register: function(assessmentModel) {\n            var state = assessmentModel.getState();\n            var assessmentId = state.id;\n            var pageId = state.pageId;\n\n            if (this._assessments._byPageId[pageId] === undefined) {\n                this._assessments._byPageId[pageId] = [];\n            }\n            this._assessments._byPageId[pageId].push(assessmentModel);\n\n            if (assessmentId) {\n                this._assessments._byAssessmentId[assessmentId] = assessmentModel;\n            }\n\n            this._assessments.push(assessmentModel);\n\n            this._restoreModelState(assessmentModel);\n\n            Adapt.trigger(\"assessments:register\", state, assessmentModel);\n\n            this._setPageProgress();\n        },\n\n        get: function(id) {\n            if (id === undefined) {\n                return this._assessments.slice(0);\n            } else {\n                return this._assessments._byAssessmentId[id];\n            }\n        },\n\n        saveState: function() {\n\n            this._saveStateModel = {};\n            for (var i = 0, assessmentModel; assessmentModel = this._assessments[i++];) {\n                var state = assessmentModel.getState();\n                this._saveStateModel[state.id] = assessmentModel.getSaveState();\n            }\n\n            Adapt.offlineStorage.set(\"assessment\", this._saveStateModel);\n        },\n\n        getConfig: function () {\n            var assessmentsConfig = Adapt.course.get(\"_assessment\");\n\n            if (assessmentsConfig && assessmentsConfig._isDefaultsLoaded) {\n                return assessmentsConfig;\n            }\n\n            if (assessmentsConfig === undefined) {\n                assessmentsConfig = $.extend(true, {}, assessmentsConfigDefaults);\n            } else {\n                assessmentsConfig = $.extend(true, {}, assessmentsConfigDefaults, assessmentsConfig);\n            }\n\n            Adapt.course.set(\"_assessment\", assessmentsConfig);\n\n            return assessmentsConfig;\n        },\n        \n        getState: function() {\n            var assessmentsConfig = this.getConfig();\n\n            var score = 0;\n            var maxScore = 0;\n            var isPass = false;\n            var totalAssessments = 0;\n\n            var states = this._getStatesByAssessmentId();\n\n            var assessmentsComplete = 0;\n\n            for (var id in states) {\n                var state = states[id];\n                if (!state.includeInTotalScore) continue;\n                if (state.isComplete) assessmentsComplete++;\n                totalAssessments++;\n                maxScore += state.maxScore / state.assessmentWeight;\n                score += state.score / state.assessmentWeight;\n                isPass = isPass === false ? false : state.isPass;\n            }\n\n            var isComplete = assessmentsComplete == totalAssessments;\n            \n            var scoreAsPercent = Math.round((score / maxScore) * 100);\n\n            if ((assessmentsConfig._scoreToPass || 100) && isComplete) {\n                if (assessmentsConfig._isPercentageBased || true) {\n                    if (scoreAsPercent >= assessmentsConfig._scoreToPass) isPass = true;\n                } else {\n                    if (score >= assessmentsConfig._scoreToPass) isPass = true;\n                }\n            }\n\n            return {\n                isComplete: isComplete,\n                isPercentageBased: assessmentsConfig._isPercentageBased,\n                requireAssessmentPassed: assessmentsConfig._requireAssessmentPassed,\n                isPass: isPass,\n                scoreAsPercent: scoreAsPercent,\n                maxScore: maxScore,\n                score: score,\n                assessmentsComplete: assessmentsComplete,\n                assessments: totalAssessments\n            };\n        },\n\n    }, Backbone.Events);\n\n    Adapt.assessment.initialize();\n\n});\n\n","define('extensions/adapt-contrib-assessment/js/adapt-assessmentArticleExtension',[\n    'coreJS/adapt',\n    'coreViews/articleView',\n    'coreModels/articleModel',\n    './adapt-assessmentArticleView',\n    './adapt-assessmentArticleModel',\n    './assessment',\n], function(Adapt, ArticleView, ArticleModel, AdaptAssessmentArticleView, AdaptAssessmentArticleModel) {\n\n    /*  \n        Here we are extending the articleView and articleModel in Adapt.\n        This is to accomodate the assessment functionality on the article.\n        The advantage of this method is that the assessment behaviour can utilize all of the predefined article behaviour in both the view and the model.\n    */  \n\n    //Extends core/js/views/articleView.js\n    var ArticleViewInitialize = ArticleView.prototype.initialize;\n    ArticleView.prototype.initialize = function(options) {\n        if (this.model.get(\"_assessment\") && this.model.get(\"_assessment\")._isEnabled === true) {\n            //extend the articleView with new functionality\n            _.extend(this, AdaptAssessmentArticleView);\n        }\n        //initialize the article in the normal manner\n        return ArticleViewInitialize.apply(this, arguments);\n    };\n\n    //Extends core/js/models/articleModel.js\n    var ArticleModelInitialize = ArticleModel.prototype.initialize;\n    ArticleModel.prototype.initialize = function(options) {\n        if (this.get(\"_assessment\") && this.get(\"_assessment\")._isEnabled === true) {\n            //extend the articleModel with new functionality\n            _.extend(this, AdaptAssessmentArticleModel);\n\n            //initialize the article in the normal manner\n            var returnValue = ArticleModelInitialize.apply(this, arguments);\n\n            //initialize assessment article\n            this._postInitialize();\n\n            return returnValue;\n        }\n\n        //initialize the article in the normal manner if no assessment\n        return ArticleModelInitialize.apply(this, arguments);\n    };\n\n});\n\n","define('extensions/adapt-contrib-bookmarking/js/adapt-contrib-bookmarking',[\n    'coreJS/adapt'\n], function(Adapt) {\n\n    var Bookmarking = _.extend({\n\n        bookmarkLevel: null,\n        watchViewIds: null,\n        watchViews: [],\n        restoredLocationID: null,\n        currentLocationID: null,\n\n        initialize: function () {\n            this.listenToOnce(Adapt, \"router:location\", this.onAdaptInitialize);\n        },\n\n        onAdaptInitialize: function() {\n            if (!this.checkIsEnabled()) return;\n            this.setupEventListeners();\n            this.checkRestoreLocation();\n        },\n\n        checkIsEnabled: function() {\n            var courseBookmarkModel = Adapt.course.get('_bookmarking');\n            if (!courseBookmarkModel || !courseBookmarkModel._isEnabled) return false;\n            if (!Adapt.offlineStorage) return false;\n            return true;\n        },\n\n        setupEventListeners: function() {\n            this._onScroll = _.debounce(_.bind(this.checkLocation, Bookmarking), 1000);\n            this.listenTo(Adapt, 'menuView:ready', this.setupMenu);\n            this.listenTo(Adapt, 'pageView:preRender', this.setupPage);\n        },\n\n        checkRestoreLocation: function() {\n            this.restoredLocationID = Adapt.offlineStorage.get(\"location\");\n\n            if (!this.restoredLocationID || this.restoredLocationID === \"undefined\") return;\n\n            this.listenToOnce(Adapt, \"pageView:ready menuView:ready\", this.restoreLocation);\n        },\n\n        restoreLocation: function() {\n            _.defer(_.bind(function() {\n                this.stopListening(Adapt, \"pageView:ready menuView:ready\", this.restoreLocation);\n\n                if (this.restoredLocationID == Adapt.location._currentId) return;\n\n                try {\n                    var model = Adapt.findById(this.restoredLocationID);\n                } catch (error) {\n                    return;\n                }\n                \n                if (!model) return;\n\n                var locationOnscreen = $(\".\" + this.restoredLocationID).onscreen();\n                var isLocationOnscreen = locationOnscreen && (locationOnscreen.percentInview > 0);\n                var isLocationFullyInview = locationOnscreen && (locationOnscreen.percentInview === 100);\n                if (isLocationOnscreen && isLocationFullyInview) return;\n\n                this.showPrompt();\n            }, this));\n        },\n\n        showPrompt: function() {\n            var courseBookmarkModel = Adapt.course.get('_bookmarking');\n            if (!courseBookmarkModel._buttons) {\n                courseBookmarkModel._buttons = {\n                    yes: \"Yes\",\n                    no: \"No\"\n                };\n            }\n            if (!courseBookmarkModel._buttons.yes) courseBookmarkModel._buttons.yes = \"Yes\";\n            if (!courseBookmarkModel._buttons.no) courseBookmarkModel._buttons.no = \"No\";\n\n\n            this.listenToOnce(Adapt, \"bookmarking:continue\", this.navigateToPrevious);\n            this.listenToOnce(Adapt, \"bookmarking:cancel\", this.navigateCancel);\n\n            var promptObject = {\n                title: courseBookmarkModel.title,\n                body: courseBookmarkModel.body,\n                _prompts:[\n                    {\n                        promptText: courseBookmarkModel._buttons.yes,\n                        _callbackEvent: \"bookmarking:continue\",\n                    },\n                    {\n                        promptText: courseBookmarkModel._buttons.no,\n                        _callbackEvent: \"bookmarking:cancel\",\n                    }\n                ],\n                _showIcon: true\n            }\n\n            if (Adapt.config.get(\"_accessibility\") && Adapt.config.get(\"_accessibility\")._isActive) {\n                $(\".loading\").show();\n                $(\"#a11y-focuser\").focus();\n                $(\"body\").attr(\"aria-hidden\", true);\n                _.delay(function() {\n                    $(\".loading\").hide();\n                    $(\"body\").removeAttr(\"aria-hidden\");\n                    Adapt.trigger('notify:prompt', promptObject);\n                }, 3000);\n            } else {\n                Adapt.trigger('notify:prompt', promptObject);\n            }\n        },\n\n        navigateToPrevious: function() {\n            _.defer(_.bind(function() {\n                var isSinglePage = Adapt.contentObjects.models.length == 1; \n                Backbone.history.navigate('#/id/' + this.restoredLocationID, {trigger: true, replace: isSinglePage});\n            }, this));\n            \n            this.stopListening(Adapt, \"bookmarking:cancel\");\n        },\n\n        navigateCancel: function() {\n            this.stopListening(Adapt, \"bookmarking:continue\");\n        },\n\n        resetLocationID: function () {\n            this.setLocationID('');\n        },\n\n        setupMenu: function(menuView) {\n            var menuModel = menuView.model;\n            //set location as menu id unless menu is course, then reset location\n            if (menuModel.get(\"_parentId\")) return this.setLocationID(menuModel.get(\"_id\"));\n            else this.resetLocationID();\n        },\n        \n        setupPage: function (pageView) {\n            var hasPageBookmarkObject = pageView.model.has('_bookmarking');\n            var bookmarkModel = (hasPageBookmarkObject) ? pageView.model.get('_bookmarking') : Adapt.course.get('_bookmarking');\n            this.bookmarkLevel = bookmarkModel._level;\n\n            if (!bookmarkModel._isEnabled) {\n                this.resetLocationID();\n                return;\n            } else {\n                //set location as page id\n                this.setLocationID(pageView.model.get('_id'));\n\n                this.watchViewIds = pageView.model.findDescendants(this.bookmarkLevel+\"s\").pluck(\"_id\");\n                this.listenTo(Adapt, this.bookmarkLevel + \"View:postRender\", this.captureViews);\n                this.listenToOnce(Adapt, \"remove\", this.releaseViews);\n                $(window).on(\"scroll\", this._onScroll);\n            }\n        },\n\n        captureViews: function (view) {\n            this.watchViews.push(view);\n        },\n\n        setLocationID: function (id) {\n            if (!Adapt.offlineStorage) return;\n            if (this.currentLocationID == id) return;\n            Adapt.offlineStorage.set(\"location\", id);\n            this.currentLocationID = id;\n        },\n\n        releaseViews: function () {\n            this.watchViews.length = 0;\n            this.watchViewIds.length = 0;\n            this.stopListening(Adapt, 'remove', this.releaseViews);\n            this.stopListening(Adapt, this.bookmarkLevel + 'View:postRender', this.captureViews);\n            $(window).off(\"scroll\", this._onScroll);\n        },\n\n        checkLocation: function() {\n            var highestOnscreen = 0;\n            var highestOnscreenLocation = \"\";\n\n            var locationObjects = [];\n            for (var i = 0, l = this.watchViews.length; i < l; i++) {\n                var view = this.watchViews[i];\n\n                var isViewAPageChild = (_.indexOf(this.watchViewIds, view.model.get(\"_id\")) > -1 );\n\n                if ( !isViewAPageChild ) continue;\n\n                var element = $(\".\" + view.model.get(\"_id\"));\n                var isVisible = (element.is(\":visible\"));\n\n                if (!isVisible) continue;\n\n                var measurements = element.onscreen();\n                if (measurements.percentInview > highestOnscreen) {\n                    highestOnscreen = measurements.percentInview;\n                    highestOnscreenLocation = view.model.get(\"_id\");\n                }\n            }\n\n            //set location as most inview component\n            if (highestOnscreenLocation) this.setLocationID(highestOnscreenLocation);\n        }\n\n    }, Backbone.Events)\n\n    Bookmarking.initialize();\n\n});\n\n","define('extensions/adapt-contrib-languagePicker/js/accessibilityView',[\n    'core/js/adapt'\n], function(Adapt) {\n\n    var AccessibilityView = Backbone.View.extend({\n\n        el: '#accessibility-toggle',\n\n        events: {\n            'click' : 'toggleAccessibility'\n        },\n\n        initialize: function() {\n            this.setupHelpers();\n\n            this.setupUsageInstructions();\n\n            if(Adapt.offlineStorage.ready) {\n                this.onOfflineStorageReady();\n            } else {\n                Adapt.once('offlineStorage:ready', _.bind(this.onOfflineStorageReady, this));\n            }\n        },\n\n        onOfflineStorageReady: function() {\n            Adapt.config.get(\"_accessibility\")._isActive = Adapt.offlineStorage.get('a11y') || false;\n\n            this.configureAccessibility();\n\n            this.render();\n        },\n\n        render: function() {\n            var hasAccessibility = Adapt.config.has('_accessibility')\n                && Adapt.config.get('_accessibility')._isEnabled;\n\n            if (!hasAccessibility) {\n                return;\n            } else {\n                var isActive = Adapt.config.get('_accessibility')._isActive;\n                var offLabel = this.model.get(\"_accessibility\") && this.model.get(\"_accessibility\").accessibilityToggleTextOff;\n                var onLabel = this.model.get(\"_accessibility\") && this.model.get(\"_accessibility\").accessibilityToggleTextOn;\n\n                var toggleText = isActive ? offLabel : onLabel;\n\n                this.$el.html(toggleText).attr('aria-label', $.a11y_normalize(toggleText));\n\n                if (isActive) {\n                    $(\"html\").addClass('accessibility');\n                    $(\"#accessibility-instructions\").a11y_focus();\n                } else {\n                    $(\"html\").removeClass('accessibility');\n                }\n            }\n        },\n\n        toggleAccessibility: function(event) {\n            if(event) event.preventDefault();\n\n            var hasAccessibility = Adapt.config.get('_accessibility')._isActive;\n\n            var toggleAccessibility = (hasAccessibility) ? false : true;\n\n            Adapt.config.get('_accessibility')._isActive = toggleAccessibility;\n\n            this.configureAccessibility();\n\n            this.setupUsageInstructions();\n\n            this.render();\n\n            this.trigger('accessibility:toggle');\n        },\n\n        setupHelpers: function() {\n            var config = Adapt.config.get(\"_accessibility\");\n\n            Handlebars.registerHelper('a11y_text', function(text) {\n                //ALLOW ENABLE/DISABLE OF a11y_text HELPER\n                if (config && config._isTextProcessorEnabled === false) {\n                    return text;\n                } else {\n                    return $.a11y_text(text);\n                }\n            });\n        },\n\n        configureAccessibility: function() {\n\n            var isActive = Adapt.config.get('_accessibility')._isActive;\n\n            if (!Modernizr.touch && (Adapt.offlineStorage.get('a11y') !== isActive)) {\n                Adapt.offlineStorage.set(\"a11y\", isActive);\n            }\n\n            if (isActive) {\n\n                _.extend($.a11y.options, {\n                    isTabbableTextEnabled: true,\n                    isUserInputControlEnabled: true,\n                    isFocusControlEnabled: true,\n                    isFocusLimited: true,\n                    isRemoveNotAccessiblesEnabled: true,\n                    isAriaLabelFixEnabled: true,\n                    isFocusWrapEnabled: true,\n                    isScrollDisableEnabled: true,\n                    isScrollDisabledOnPopupEnabled: false,\n                    isSelectedAlertsEnabled: true,\n                    isAlertsEnabled: true\n                });\n            } else {\n                _.extend($.a11y.options, {\n                    isTabbableTextEnabled: false,\n                    isUserInputControlEnabled: true,\n                    isFocusControlEnabled: true,\n                    isFocusLimited: false,\n                    isRemoveNotAccessiblesEnabled: true,\n                    isAriaLabelFixEnabled: true,\n                    isFocusWrapEnabled: true,\n                    isScrollDisableEnabled: true,\n                    isScrollDisabledOnPopupEnabled: false,\n                    isSelectedAlertsEnabled: false,\n                    isAlertsEnabled: false\n                });\n            }\n\n            $.a11y.ready();\n        },\n\n        setupUsageInstructions: function() {\n            if (!this.model.get(\"_accessibility\") || !this.model.get(\"_accessibility\")._accessibilityInstructions) {\n                $(\"#accessibility-instructions\").remove();\n                return;\n            }\n\n            var instructionsList =  this.model.get(\"_accessibility\")._accessibilityInstructions;\n\n            var usageInstructions;\n            if (instructionsList[Adapt.device.browser]) {\n                usageInstructions = instructionsList[Adapt.device.browser];\n            } else if (Modernizr.touch) {\n                usageInstructions = instructionsList.touch || \"\";\n            } else {\n                usageInstructions = instructionsList.notouch || \"\";\n            }\n\n           $(\"#accessibility-instructions\").html( usageInstructions );\n        }\n\n    });\n\n    return AccessibilityView;\n\n});\n","define('extensions/adapt-contrib-languagePicker/js/languagePickerView',[\n    'core/js/adapt',\n    './accessibilityView'\n], function(Adapt, accessibilityView) {\n    \n    var LanguagePickerView = Backbone.View.extend({\n        \n        events: {\n            'click .languagepicker-languages button': 'onLanguageClick'\n        },\n        \n        className: 'languagepicker',\n        \n        initialize: function () {\n            this.initializeAccessibility();\n            $(\"html\").addClass(\"in-languagepicker\");\n            this.listenTo(Adapt, 'remove', this.remove);\n            this.render();\n        },\n        \n        render: function () {\n            var data = this.model.toJSON();\n            var template = Handlebars.templates[this.constructor.template];\n            this.$el.html(template(data));\n            \n            document.title = this.model.get('title') || \"\";\n            \n            _.defer(_.bind(function () {\n                this.postRender();\n            }, this));\n        },\n        \n        postRender: function () {\n            $('.loading').hide();\n        },\n        \n        onLanguageClick: function (event) {\n            this.destroyAccessibility();\n            this.model.setLanguage($(event.target).val());\n        },\n\n        initializeAccessibility: function() {\n            this.accessibilityView = new accessibilityView({\n                model:this.model\n            });\n            \n            // we need to re-render if accessibility gets switched on\n            this.listenTo(this.accessibilityView, 'accessibility:toggle', this.render);\n        },\n\n        destroyAccessibility: function() {\n            this.accessibilityView.remove();\n        },\n\n        remove: function() {\n            $(\"html\").removeClass(\"in-languagepicker\");\n\n            Backbone.View.prototype.remove.apply(this, arguments);\n        }\n        \n    }, {\n        template: 'languagePickerView'\n    });\n\n    return LanguagePickerView;\n\n});\n\n","define('extensions/adapt-contrib-languagePicker/js/languagePickerDrawerView',[\n    'core/js/adapt',\n    'backbone'\n], function(Adapt, Backbone) {\n    \n    var LanguagePickerDrawerView = Backbone.View.extend({\n        \n        events: {\n            'click button': 'onButtonClick'\n        },\n        \n        initialize: function () {\n            this.listenTo(Adapt, 'remove', this.remove);\n            this.listenTo(Adapt, 'languagepicker:changelanguage:yes', this.onDoChangeLanguage);\n            this.listenTo(Adapt, 'languagepicker:changelanguage:no', this.onDontChangeLanguage);\n            this.render();\n        },\n        \n        render: function () {\n            var data = this.model.toJSON();\n            var template = Handlebars.templates[this.constructor.template];\n            this.$el.html(template(data));\n        },\n        \n        onButtonClick: function (event) {\n            var newLanguage = $(event.target).attr('data-language');\n            this.model.set('newLanguage', newLanguage);\n            var data = this.model.getLanguageDetails(newLanguage);\n            \n            var promptObject = {\n                _classes: \"dir-ltr\",\n                title: data.warningTitle,\n                body: data.warningMessage,\n                _prompts:[\n                    {\n                        promptText: data._buttons.yes,\n                        _callbackEvent: \"languagepicker:changelanguage:yes\"\n                    },\n                    {\n                        promptText: data._buttons.no,\n                        _callbackEvent: \"languagepicker:changelanguage:no\"\n                    }\n                ],\n                _showIcon: true\n            };\n\n            if (data._direction === 'rtl') {\n                promptObject._classes = \"dir-rtl\";\n            }\n            \n            //keep active element incase the user cancels - usually navigation bar icon\n            this.$finishFocus = $.a11y.state.focusStack.pop();\n            //move drawer close focus to #focuser\n            $.a11y.state.focusStack.push($(\"#focuser\"));\n\n            Adapt.once('drawer:closed', function() {\n                //wait for drawer to fully close\n                _.delay(function(){\n                    //show yes/no popup\n                    Adapt.once('popup:opened', function() {\n                        //move popup close focus to #focuser\n                        $.a11y.state.focusStack.pop();\n                        $.a11y.state.focusStack.push($(\"#focuser\"));\n                    });\n\n                    Adapt.trigger('notify:prompt', promptObject);\n                }, 250);\n            });\n\n            Adapt.trigger('drawer:closeDrawer');\n        },\n        \n        onDoChangeLanguage: function () {\n            // set default languge\n            var newLanguage = this.model.get('newLanguage');\n            this.model.setLanguage(newLanguage);\n            this.remove();\n        },\n        \n        onDontChangeLanguage: function () {\n            this.remove();\n\n            //wait for notify to close fully\n            _.delay(_.bind(function(){\n                //focus on navigation bar icon\n                this.$finishFocus.a11y_focus();\n            }, this), 500);\n\n        }\n        \n    }, {\n        template: 'languagePickerDrawerView'\n    });\n\n    return LanguagePickerDrawerView;\n\n});\n\n","define('extensions/adapt-contrib-languagePicker/js/languagePickerNavView',[\n    'core/js/adapt',\n    'backbone',\n    './languagePickerDrawerView'\n], function(Adapt, Backbone, LanguagePickerDrawerView) {\n    \n    var LanguagePickerNavView = Backbone.View.extend({\n        \n        tagName: 'button',\n        \n        className: function () {\n            var classNames = 'languagepicker-icon base icon';\n            var customClass = this.model.get('_languagePickerIconClass') || 'icon-language-2';\n\n            return classNames + ' ' + customClass;\n        },\n        \n        events: {\n            'click': 'onClick'\n        },\n        \n        initialize: function () {\n            this.listenTo(Adapt, 'remove', this.remove);\n        },\n        \n        onClick: function (event) {\n            Adapt.drawer.triggerCustomView(new LanguagePickerDrawerView({model: this.model}).$el, false);\n        }\n        \n    });\n\n    return LanguagePickerNavView;\n\n});\n\n","define('extensions/adapt-contrib-languagePicker/js/languagePickerModel',[\n        'core/js/adapt',\n        'backbone'\n], function (Adapt, Backbone) {\n    \n    var LanguagePickerModel = Backbone.Model.extend({\n        \n        defaults: {\n            \"_isEnabled\": false,\n            \"displayTitle\": \"\",\n            \"body\": \"\",\n            \"_languages\": []\n        },\n        \n        initialize: function () {\n            this.listenTo(Adapt.config, 'change:_activeLanguage', this.onConfigChange);\n        },\n\n        getLanguageDetails: function (language) {\n            var _languages = this.get('_languages');\n            return _.find(_languages, function (item) {\n                return (item._language == language);\n            });\n        },\n\n        setLanguage: function (language) {\n            Adapt.config.set({\n                '_activeLanguage': language,\n                '_defaultDirection': this.getLanguageDetails(language)._direction\n            });\n        },\n        \n        onConfigChange: function (model, value, options) {\n            this.markLanguageAsSelected(value);\n        },\n        \n        markLanguageAsSelected: function(language) {\n            var languages = this.get('_languages');\n\n            for (var i = 0; i < languages.length; i++) {\n                if (languages[i]._language === language) {\n                    languages[i]._isSelected = true;\n                } else {\n                    languages[i]._isSelected = false;\n                }\n            }\n\n            this.set('_languages', languages);\n        }\n        \n    });\n    \n    return LanguagePickerModel;\n    \n});\n\n","define('extensions/adapt-contrib-languagePicker/js/adapt-languagePicker',[\n    'core/js/adapt',\n    'backbone',\n    './languagePickerView',\n    './languagePickerNavView',\n    './languagePickerModel'\n], function(Adapt, Backbone, LanguagePickerView, LanguagePickerNavView, LanguagePickerModel) {\n\n    var languagePickerModel;\n\n    Adapt.once('configModel:dataLoaded', onConfigLoaded);\n\n    /**\n     * Once the Adapt config has loaded, check to see if the language picker is enabled. If it is:\n     * - stop the rest of the .json from loading\n     * - set up the language picker model\n     * - register for events to allow us to display the language picker icon in the navbar on pages and menus\n     * - wait for offline storage to be ready so that we can check to see if there's a stored language choice or not\n     */\n    function onConfigLoaded() {\n        if (!Adapt.config.has('_languagePicker')) return;\n        if (!Adapt.config.get('_languagePicker')._isEnabled) return;\n    \n        Adapt.config.set(\"_canLoadData\", false);\n\n        languagePickerModel = new LanguagePickerModel(Adapt.config.get('_languagePicker'));\n        \n        Adapt.on('router:page', setupNavigationView);\n        Adapt.on('router:menu', setupNavigationView);\n            \n        if(Adapt.offlineStorage.ready) {// on the offchance that it may already be ready...\n            onOfflineStorageReady();\n        } else {\n            Adapt.once('offlineStorage:ready', onOfflineStorageReady);\n        }\n    }\n\n    /**\n     * Once offline storage is ready, check to see if a language was previously selected by the user\n     * If it was, load it. If it wasn't, show the language picker\n     */\n    function onOfflineStorageReady() {\n        var storedLanguage = Adapt.offlineStorage.get(\"lang\");\n\n        if (storedLanguage) {\n            languagePickerModel.setLanguage(storedLanguage);\n        } else if (languagePickerModel.get('_showOnCourseLoad') === false) {\n            languagePickerModel.setLanguage(Adapt.config.get('_defaultLanguage'));\n        } else {\n            showLanguagePickerView();\n        }\n    }\n\n    function showLanguagePickerView () {\n        var languagePickerView = new LanguagePickerView({\n            model: languagePickerModel\n        });\n        \n        languagePickerView.$el.appendTo('#wrapper');\n    }\n    \n    function setupNavigationView () {\n        var languagePickerNavView = new LanguagePickerNavView({\n            model: languagePickerModel\n        });\n        \n        languagePickerNavView.$el.appendTo('.navigation-inner');\n    }\n    \n});\n\n","define('extensions/adapt-contrib-pageLevelProgress/js/completionCalculations',[\n    'coreJS/adapt'\n], function(Adapt) {\n    \n    // Calculate completion of a contentObject\n    function calculateCompletion(contentObjectModel) {\n\n        var viewType = contentObjectModel.get('_type'),\n            nonAssessmentComponentsTotal = 0,\n            nonAssessmentComponentsCompleted = 0,\n            assessmentComponentsTotal = 0,\n            assessmentComponentsCompleted = 0,\n            subProgressCompleted = 0,\n            subProgressTotal = 0,\n            isComplete = contentObjectModel.get(\"_isComplete\") ? 1 : 0;\n\n        // If it's a page\n        if (viewType == 'page') {\n            var children = contentObjectModel.findDescendants('components').where({'_isAvailable': true, '_isOptional': false});\n\n            var availableChildren = filterAvailableChildren(children);\n            var components = getPageLevelProgressEnabledModels(availableChildren);\n\n            var nonAssessmentComponents = getNonAssessmentComponents(components);\n\n            nonAssessmentComponentsTotal = nonAssessmentComponents.length | 0,\n            nonAssessmentComponentsCompleted = getComponentsCompleted(nonAssessmentComponents).length;\n\n            var assessmentComponents = getAssessmentComponents(components);\n\n            assessmentComponentsTotal = assessmentComponents.length | 0,\n            assessmentComponentsCompleted = getComponentsInteractionCompleted(assessmentComponents).length;\n\n            subProgressCompleted = contentObjectModel.get(\"_subProgressComplete\") || 0;\n            subProgressTotal = contentObjectModel.get(\"_subProgressTotal\") || 0;\n\n            var pageCompletion = {\n                \"subProgressCompleted\": subProgressCompleted,\n                \"subProgressTotal\": subProgressTotal,\n                \"nonAssessmentCompleted\": nonAssessmentComponentsCompleted,\n                \"nonAssessmentTotal\": nonAssessmentComponentsTotal,\n                \"assessmentCompleted\": assessmentComponentsCompleted,\n                \"assessmentTotal\": assessmentComponentsTotal\n            };\n\n            if (contentObjectModel.get(\"_pageLevelProgress\") && contentObjectModel.get(\"_pageLevelProgress\")._showPageCompletion !== false \n                && Adapt.course.get(\"_pageLevelProgress\") && Adapt.course.get(\"_pageLevelProgress\")._showPageCompletion !== false) {\n                //optionally add one point extra for page completion to eliminate incomplete pages and full progress bars\n                // if _showPageCompletion is true then the progress bar should also consider it so add 1 to nonAssessmentTotal\n                pageCompletion.nonAssessmentCompleted += isComplete;\n                pageCompletion.nonAssessmentTotal += 1;\n            }\n\n            return pageCompletion;\n        }\n        // If it's a sub-menu\n        else if (viewType == 'menu') {\n\n            _.each(contentObjectModel.get('_children').models, function(contentObject) {\n                var completionObject = calculateCompletion(contentObject);\n                subProgressCompleted += contentObjectModel.subProgressCompleted || 0;\n                subProgressTotal += contentObjectModel.subProgressTotal || 0;\n                nonAssessmentComponentsTotal += completionObject.nonAssessmentTotal;\n                nonAssessmentComponentsCompleted += completionObject.nonAssessmentCompleted;\n                assessmentComponentsTotal += completionObject.assessmentTotal;\n                assessmentComponentsCompleted += completionObject.assessmentCompleted;\n            });\n\n            return {\n                \"subProgressCompleted\": subProgressCompleted,\n                \"subProgressTotal\" : subProgressTotal,\n                \"nonAssessmentCompleted\": nonAssessmentComponentsCompleted,\n                \"nonAssessmentTotal\": nonAssessmentComponentsTotal,\n                \"assessmentCompleted\": assessmentComponentsCompleted,\n                \"assessmentTotal\": assessmentComponentsTotal,\n            };\n        }\n    }\n\n    function getNonAssessmentComponents(models) {\n        return _.filter(models, function(model) {\n            return !model.get('_isPartOfAssessment');\n        });\n    }\n\n    function getAssessmentComponents(models) {\n        return _.filter(models, function(model) {\n            return model.get('_isPartOfAssessment');\n        });\n    }\n\n    function getComponentsCompleted(models) {\n        return _.filter(models, function(item) {\n            return item.get('_isComplete');\n        });\n    }\n\n    function getComponentsInteractionCompleted(models) {\n        return _.filter(models, function(item) {\n            return item.get('_isInteractionComplete');\n        });\n    }\n\n    //Get only those models who were enabled for pageLevelProgress\n    function getPageLevelProgressEnabledModels(models) {\n        return _.filter(models, function(model) {\n            if (model.get('_pageLevelProgress')) {\n                return model.get('_pageLevelProgress')._isEnabled;\n            }\n        });\n    }\n\n    function unavailableInHierarchy(parents) {\n        if (parents.length > 0) {\n            var parentsAvailable = _.map(parents, function(parent) {\n                return parent.get('_isAvailable');\n            });\n            return _.indexOf(parentsAvailable, false) > -1;\n        } else {\n            return;\n        }\n    }\n\n    function filterAvailableChildren(children) {\n        var availableChildren = [];\n\n        for(var child=0; child < children.length; child++) {\n            var parents = children[child].getParents().models;\n            if (!unavailableInHierarchy(parents)) {\n                availableChildren.push(children[child]);\n            }\n        }\n\n        return availableChildren;\n    }\n\n    return {\n    \tcalculateCompletion: calculateCompletion,\n    \tgetPageLevelProgressEnabledModels: getPageLevelProgressEnabledModels,\n        filterAvailableChildren: filterAvailableChildren\n    };\n\n})\n;\n","define('extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressMenuView',['require','coreJS/adapt','backbone'],function(require) {\n\n    var Adapt = require('coreJS/adapt');\n    var Backbone = require('backbone');\n\n    var PageLevelProgressMenuView = Backbone.View.extend({\n\n        className: 'page-level-progress-menu-item',\n\n        initialize: function() {\n            this.listenTo(Adapt, 'remove', this.remove);\n\n            this.ariaText = '';\n            if (Adapt.course.get('_globals')._extensions && Adapt.course.get('_globals')._extensions._pageLevelProgress && Adapt.course.get('_globals')._extensions._pageLevelProgress.pageLevelProgressMenuBar) {\n                this.ariaText = Adapt.course.get('_globals')._extensions._pageLevelProgress.pageLevelProgressMenuBar + ' ';\n            }\n\n            this.render();\n\n            _.defer(_.bind(function() {\n                this.updateProgressBar();\n            }, this));\n        },\n\n        events: {\n        },\n\n        render: function() {\n            var data = this.model.toJSON();\n            _.extend(data, {\n                _globals: Adapt.course.get('_globals')\n            });\n            var template = Handlebars.templates['pageLevelProgressMenu'];\n\n            this.$el.html(template(data));\n            return this;\n        },\n\n        updateProgressBar: function() {\n            if (this.model.get('completedChildrenAsPercentage')) {\n                var percentageOfCompleteComponents = this.model.get('completedChildrenAsPercentage');\n            } else {\n                var percentageOfCompleteComponents = 0;\n            }\n\n            // Add percentage of completed components as an aria label attribute\n            this.$('.page-level-progress-menu-item-indicator-bar .aria-label').html(this.ariaText + Math.floor(percentageOfCompleteComponents) + '%');\n\n        },\n\n    });\n\n    return PageLevelProgressMenuView;\n\n});\n\n","define('extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressView',['require','coreJS/adapt','backbone'],function(require) {\n\n    var Adapt = require('coreJS/adapt');\n    var Backbone = require('backbone');\n\n    var PageLevelProgressView = Backbone.View.extend({\n\n        className: 'page-level-progress',\n\n        initialize: function() {\n            this.listenTo(Adapt, 'remove', this.remove);\n            this.render();\n        },\n\n        events: {\n            'click .page-level-progress-item button': 'scrollToPageElement'\n        },\n\n        scrollToPageElement: function(event) {\n            if(event && event.preventDefault) event.preventDefault();\n            var currentComponentSelector = '.' + $(event.currentTarget).attr('data-page-level-progress-id');\n            var $currentComponent = $(currentComponentSelector);\n            Adapt.once('drawer:closed', function() {\n                Adapt.scrollTo($currentComponent, { duration:400 });\n            });\n            Adapt.trigger('drawer:closeDrawer');\n        },\n\n        render: function() {\n            var components = this.collection.toJSON();\n            var data = {\n                components: components,\n                _globals: Adapt.course.get('_globals')\n            };\n            var template = Handlebars.templates['pageLevelProgress'];\n            this.$el.html(template(data));\n            this.$el.a11y_aria_label(true);\n            return this;\n        }\n\n    });\n\n    return PageLevelProgressView;\n\n});\n\n","define('extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressNavigationView',['require','coreJS/adapt','backbone','./completionCalculations','extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressView'],function(require) {\n\n    var Adapt = require('coreJS/adapt');\n    var Backbone = require('backbone');\n    var completionCalculations = require('./completionCalculations');\n\n    var PageLevelProgressView = require('extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressView');\n\n    var PageLevelProgressNavigationView = Backbone.View.extend({\n\n        tagName: 'button',\n\n        className: 'base page-level-progress-navigation',\n\n        initialize: function() {\n            this.listenTo(Adapt, 'remove', this.remove);\n            this.listenTo(Adapt, 'router:location', this.updateProgressBar);\n            this.listenTo(Adapt, 'pageLevelProgress:update', this.refreshProgressBar);\n            this.listenTo(this.collection, 'change:_isInteractionComplete', this.updateProgressBar);\n            this.listenTo(this.model, 'change:_isInteractionComplete', this.updateProgressBar);\n            this.$el.attr('role', 'button');\n            this.ariaText = '';\n            \n            if (Adapt.course.has('_globals') && Adapt.course.get('_globals')._extensions && Adapt.course.get('_globals')._extensions._pageLevelProgress && Adapt.course.get('_globals')._extensions._pageLevelProgress.pageLevelProgressIndicatorBar) {\n                this.ariaText = Adapt.course.get('_globals')._extensions._pageLevelProgress.pageLevelProgressIndicatorBar +  ' ';\n            }\n            \n            this.render();\n            \n            _.defer(_.bind(function() {\n                this.updateProgressBar();\n            }, this));\n        },\n\n        events: {\n            'click': 'onProgressClicked'\n        },\n\n        render: function() {\n            var components = this.collection.toJSON();\n            var data = {\n                components: components,\n                _globals: Adapt.course.get('_globals')\n            };            \n\n            var template = Handlebars.templates['pageLevelProgressNavigation'];\n            $('.navigation-drawer-toggle-button').after(this.$el.html(template(data)));\n            return this;\n        },\n        \n        refreshProgressBar: function() {\n            var currentPageComponents = this.model.findDescendants('components').where({'_isAvailable': true});\n            var availableChildren = completionCalculations.filterAvailableChildren(currentPageComponents);\n            var enabledProgressComponents = completionCalculations.getPageLevelProgressEnabledModels(availableChildren);\n            \n            this.collection = new Backbone.Collection(enabledProgressComponents);\n            this.updateProgressBar();\n        },\n\n        updateProgressBar: function() {\n            var completionObject = completionCalculations.calculateCompletion(this.model);\n            \n            //take all assessment, nonassessment and subprogress into percentage\n            //this allows the user to see if assessments have been passed, if assessment components can be retaken, and all other component's completion\n            \n            var completed = completionObject.nonAssessmentCompleted + completionObject.assessmentCompleted + completionObject.subProgressCompleted;\n            var total  = completionObject.nonAssessmentTotal + completionObject.assessmentTotal + completionObject.subProgressTotal;\n\n            var percentageComplete = Math.floor((completed / total)*100);\n\n\n            this.$('.page-level-progress-navigation-bar').css('width', percentageComplete + '%');\n\n            // Add percentage of completed components as an aria label attribute\n            this.$el.attr('aria-label', this.ariaText +  percentageComplete + '%');\n\n            // Set percentage of completed components to model attribute to update progress on MenuView\n            this.model.set('completedChildrenAsPercentage', percentageComplete);\n        },\n\n        onProgressClicked: function(event) {\n            if(event && event.preventDefault) event.preventDefault();\n            Adapt.drawer.triggerCustomView(new PageLevelProgressView({collection: this.collection}).$el, false);\n        }\n\n    });\n\n    return PageLevelProgressNavigationView;\n\n});\n\n","define('extensions/adapt-contrib-pageLevelProgress/js/adapt-contrib-pageLevelProgress',['require','coreJS/adapt','backbone','./completionCalculations','extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressMenuView','extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressNavigationView'],function(require) {\n\n    var Adapt = require('coreJS/adapt');\n    var Backbone = require('backbone');\n    var completionCalculations = require('./completionCalculations');\n\n    var PageLevelProgressMenuView = require('extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressMenuView');\n    var PageLevelProgressNavigationView = require('extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressNavigationView');\n\n    function setupPageLevelProgress(pageModel, enabledProgressComponents) {\n\n        new PageLevelProgressNavigationView({model: pageModel, collection:  new Backbone.Collection(enabledProgressComponents) });\n\n    }\n\n    // This should add/update progress on menuView\n    Adapt.on('menuView:postRender', function(view) {\n\n        if (view.model.get('_id') == Adapt.location._currentId) return;\n\n        // do not proceed until pageLevelProgress enabled on course.json\n        if (!Adapt.course.get('_pageLevelProgress') || !Adapt.course.get('_pageLevelProgress')._isEnabled) {\n            return;\n        }\n\n        var pageLevelProgress = view.model.get('_pageLevelProgress');\n        var viewType = view.model.get('_type');\n\n        // Progress bar should not render for course viewType\n        if (viewType == 'course') return;\n\n        if (pageLevelProgress && pageLevelProgress._isEnabled) {\n\n            var completionObject = completionCalculations.calculateCompletion(view.model);\n\n            //take all non-assessment components and subprogress info into the percentage\n            //this allows the user to see if the assessments are passed (subprogress) and all other components are complete\n            \n            var completed = completionObject.nonAssessmentCompleted + completionObject.subProgressCompleted;\n            var total = completionObject.nonAssessmentTotal + completionObject.subProgressTotal;\n\n            var percentageComplete = Math.floor((completed / total)*100);\n            \n            view.model.set('completedChildrenAsPercentage', percentageComplete);\n            view.$el.find('.menu-item-inner').append(new PageLevelProgressMenuView({model: view.model}).$el);\n\n        }\n\n    });\n\n    // This should add/update progress on page navigation bar\n    Adapt.on('router:page', function(pageModel) {\n\n        // do not proceed until pageLevelProgress enabled on course.json\n        if (!Adapt.course.get('_pageLevelProgress') || !Adapt.course.get('_pageLevelProgress')._isEnabled) {\n            return;\n        }\n\n        var currentPageComponents = pageModel.findDescendants('components').where({'_isAvailable': true});\n        var availableComponents = completionCalculations.filterAvailableChildren(currentPageComponents);\n        var enabledProgressComponents = completionCalculations.getPageLevelProgressEnabledModels(availableComponents);\n\n        if (enabledProgressComponents.length > 0) {\n            setupPageLevelProgress(pageModel, enabledProgressComponents);\n        }\n\n    });\n\n});\n\n","define('extensions/adapt-contrib-resources/js/adapt-contrib-resourcesView',['require','backbone','core/js/adapt'],function(require) {\n\n    var Backbone = require('backbone');\n    var Adapt = require('core/js/adapt');\n\n    var ResourcesView = Backbone.View.extend({\n\n        className: \"resources\",\n\n        initialize: function() {\n            this.listenTo(Adapt, 'remove', this.remove);\n            this.render();\n        },\n\n        events: {\n            'click .resources-filter button': 'onFilterClicked',\n            'click .resources-item-container button': 'onResourceClicked'\n        },\n\n        render: function() {\n            var collectionData = this.collection.toJSON();\n            var modelData = this.model.toJSON();\n            var template = Handlebars.templates[\"resources\"];\n            this.$el.html(template({model: modelData, resources:collectionData, _globals: Adapt.course.get('_globals')}));\n            _.defer(_.bind(this.postRender, this));\n            return this;\n        },\n\n        postRender: function() {\n            this.listenTo(Adapt, 'drawer:triggerCustomView', this.remove);\n        },\n\n        onFilterClicked: function(event) {\n            event.preventDefault();\n            var $currentTarget = $(event.currentTarget);\n            this.$('.resources-filter button').removeClass('selected');\n            var filter = $currentTarget.addClass('selected').attr('data-filter');\n            var items = [];\n\n            if (filter === 'all') {\n                items = this.$('.resources-item').removeClass('display-none');\n            } else {\n                this.$('.resources-item').removeClass('display-none').not(\".\" + filter).addClass('display-none');\n                items = this.$('.resources-item.' + filter);\n            }\n\n            if (items.length === 0) return;\n            $(items[0]).a11y_focus();\n        },\n\n        onResourceClicked: function(event) {\n            var data = $(event.currentTarget).data();\n\n            if (data.type !== 'document') {\n                window.top.open(data.href);\n                return;\n            }\n            var dummyLink = document.createElement('a');\n            dummyLink.download = data.filename;\n            dummyLink.href = data.href;\n\n            document.body.appendChild(dummyLink);\n            dummyLink.click();\n            document.body.removeChild(dummyLink);\n            delete dummyLink;\n        }\n    });\n\n    return ResourcesView;\n});\n\n","define('extensions/adapt-contrib-resources/js/adapt-contrib-resourcesHelpers',['require','handlebars'],function(require) {\n\n\tvar Handlebars = require('handlebars');\n\n\tHandlebars.registerHelper('if_collection_contains', function(collection, attribute, value, block) {\n\t\tvar makeBlockVisible = false;\n\n\t\t_.each(collection, function(resource) {\n\t\t\tif (resource[attribute] === value) {\n\t\t\t\tmakeBlockVisible = true;\n\t\t\t}\n\t\t});\n\t\tif(makeBlockVisible) {\n            return block.fn(this);\n        } else {\n            return block.inverse();\n        }\n    });\n\n    Handlebars.registerHelper('if_collection_contains_only_one_item', function(collection, attribute, block) {\n\t\tvar attributeCount = [];\n\n\t\t_.each(collection, function(resource) {\n\t\t\tvar resourceAttribute = resource[attribute];\n\t\t\tif (_.indexOf(attributeCount, resourceAttribute) === -1) {\n\t\t\t\tattributeCount.push(resourceAttribute);\n\t\t\t}\n\t\t});\n\n\t\tif (attributeCount.length <= 1) {\n\t\t\treturn block.fn(this);\n\t\t} else {\n\t\t\treturn block.inverse(this);\n\t\t}\n\n    });\n\n    Handlebars.registerHelper('return_column_layout_from_collection_length', function(collection, attribute) {\n\t\tvar attributeCount = [];\n\n\t\t_.each(collection, function(resource) {\n\t\t\tvar resourceAttribute = resource[attribute];\n\t\t\tif (_.indexOf(attributeCount, resourceAttribute) === -1) {\n\t\t\t\tattributeCount.push(resourceAttribute);\n\t\t\t}\n\t\t});\n\n\t\treturn (attributeCount.length + 1);\n\n    });\n\n})\n\t;\n","define('extensions/adapt-contrib-resources/js/adapt-contrib-resources',[\n    'backbone',\n    'core/js/adapt',\n    './adapt-contrib-resourcesView',\n    './adapt-contrib-resourcesHelpers'\n], function(Backbone, Adapt, ResourcesView, ResourcesHelpers) {\n\n    function setupResources(resourcesData) {\n\n        var resourcesModel = new Backbone.Model(resourcesData);\n        var resourcesCollection = new Backbone.Collection(resourcesModel.get('_resourcesItems'));\n\n        Adapt.on('resources:showResources', function() {\n            Adapt.drawer.triggerCustomView(new ResourcesView({\n                model: resourcesModel,\n                collection: resourcesCollection\n            }).$el);\n        });\n\n    }\n\n    function initResources() {\n\n        var courseResources = Adapt.course.get('_resources');\n\n        // do not proceed until resource set on course.json\n        if (!courseResources || courseResources._isEnabled === false) return;\n\n        var drawerObject = {\n            title: courseResources.title,\n            description: courseResources.description,\n            className: 'resources-drawer'\n        };\n\n        Adapt.drawer.addItem(drawerObject, 'resources:showResources');\n\n        setupResources(courseResources);\n\n    }\n\n    Adapt.once('app:dataReady', function() {\n        initResources();\n        Adapt.on('app:languageChanged', initResources);\n    });\n\n});\n\n","/*global console*/\n\n/* ===========================================================\n\npipwerks SCORM Wrapper for JavaScript\nv1.1.20160322\n\nCreated by Philip Hutchison, January 2008-2016\nhttps://github.com/pipwerks/scorm-api-wrapper\n\nCopyright (c) Philip Hutchison\nMIT-style license: http://pipwerks.mit-license.org/\n\nThis wrapper works with both SCORM 1.2 and SCORM 2004.\n\nInspired by APIWrapper.js, created by the ADL and\nConcurrent Technologies Corporation, distributed by\nthe ADL (http://www.adlnet.gov/scorm).\n\nSCORM.API.find() and SCORM.API.get() functions based\non ADL code, modified by Mike Rustici\n(http://www.scorm.com/resources/apifinder/SCORMAPIFinder.htm),\nfurther modified by Philip Hutchison\n\n=============================================================== */\n\n\nvar pipwerks = {};                                  //pipwerks 'namespace' helps ensure no conflicts with possible other \"SCORM\" variables\npipwerks.UTILS = {};                                //For holding UTILS functions\npipwerks.debug = { isActive: true };                //Enable (true) or disable (false) for debug mode\n\npipwerks.SCORM = {                                  //Define the SCORM object\n    version:    null,                               //Store SCORM version.\n    handleCompletionStatus: true,                   //Whether or not the wrapper should automatically handle the initial completion status\n    handleExitMode: true,                           //Whether or not the wrapper should automatically handle the exit mode\n    API:        { handle: null,\n                  isFound: false },                 //Create API child object\n    connection: { isActive: false },                //Create connection child object\n    data:       { completionStatus: null,\n                  exitStatus: null },               //Create data child object\n    debug:      {}                                  //Create debug child object\n};\n\n\n\n/* --------------------------------------------------------------------------------\n   pipwerks.SCORM.isAvailable\n   A simple function to allow Flash ExternalInterface to confirm\n   presence of JS wrapper before attempting any LMS communication.\n\n   Parameters: none\n   Returns:    Boolean (true)\n----------------------------------------------------------------------------------- */\n\npipwerks.SCORM.isAvailable = function(){\n    return true;\n};\n\n\n\n// ------------------------------------------------------------------------- //\n// --- SCORM.API functions ------------------------------------------------- //\n// ------------------------------------------------------------------------- //\n\n\n/* -------------------------------------------------------------------------\n   pipwerks.SCORM.API.find(window)\n   Looks for an object named API in parent and opener windows\n\n   Parameters: window (the browser window object).\n   Returns:    Object if API is found, null if no API found\n---------------------------------------------------------------------------- */\n\npipwerks.SCORM.API.find = function(win){\n\n    var API = null,\n        findAttempts = 0,\n        findAttemptLimit = 500,\n        traceMsgPrefix = \"SCORM.API.find\",\n        trace = pipwerks.UTILS.trace,\n        scorm = pipwerks.SCORM;\n\n    while ((!win.API && !win.API_1484_11) &&\n           (win.parent) &&\n           (win.parent != win) &&\n           (findAttempts <= findAttemptLimit)){\n\n                findAttempts++;\n                win = win.parent;\n\n    }\n\n    //If SCORM version is specified by user, look for specific API\n    if(scorm.version){\n\n        switch(scorm.version){\n\n            case \"2004\" :\n\n                if(win.API_1484_11){\n\n                    API = win.API_1484_11;\n\n                } else {\n\n                    trace(traceMsgPrefix +\": SCORM version 2004 was specified by user, but API_1484_11 cannot be found.\");\n\n                }\n\n                break;\n\n            case \"1.2\" :\n\n                if(win.API){\n\n                    API = win.API;\n\n                } else {\n\n                    trace(traceMsgPrefix +\": SCORM version 1.2 was specified by user, but API cannot be found.\");\n\n                }\n\n                break;\n\n        }\n\n    } else {                             //If SCORM version not specified by user, look for APIs\n\n        if(win.API_1484_11) {            //SCORM 2004-specific API.\n\n            scorm.version = \"2004\";      //Set version\n            API = win.API_1484_11;\n\n        } else if(win.API){              //SCORM 1.2-specific API\n\n            scorm.version = \"1.2\";       //Set version\n            API = win.API;\n\n        }\n\n    }\n\n    if(API){\n\n        trace(traceMsgPrefix +\": API found. Version: \" +scorm.version);\n        trace(\"API: \" +API);\n\n    } else {\n\n        trace(traceMsgPrefix +\": Error finding API. \\nFind attempts: \" +findAttempts +\". \\nFind attempt limit: \" +findAttemptLimit);\n\n    }\n\n    return API;\n\n};\n\n\n/* -------------------------------------------------------------------------\n   pipwerks.SCORM.API.get()\n   Looks for an object named API, first in the current window's frame\n   hierarchy and then, if necessary, in the current window's opener window\n   hierarchy (if there is an opener window).\n\n   Parameters:  None.\n   Returns:     Object if API found, null if no API found\n---------------------------------------------------------------------------- */\n\npipwerks.SCORM.API.get = function(){\n\n    var API = null,\n        win = window,\n        scorm = pipwerks.SCORM,\n        find = scorm.API.find,\n        trace = pipwerks.UTILS.trace;\n\n    API = find(win);\n\n    if(!API && win.parent && win.parent != win){\n        API = find(win.parent);\n    }\n\n    if(!API && win.top && win.top.opener){\n        API = find(win.top.opener);\n    }\n\n    //Special handling for Plateau\n    //Thanks to Joseph Venditti for the patch\n    if(!API && win.top && win.top.opener && win.top.opener.document) {\n        API = find(win.top.opener.document);\n    }\n\n    if(API){\n        scorm.API.isFound = true;\n    } else {\n        trace(\"API.get failed: Can't find the API!\");\n    }\n\n    return API;\n\n};\n\n\n/* -------------------------------------------------------------------------\n   pipwerks.SCORM.API.getHandle()\n   Returns the handle to API object if it was previously set\n\n   Parameters:  None.\n   Returns:     Object (the pipwerks.SCORM.API.handle variable).\n---------------------------------------------------------------------------- */\n\npipwerks.SCORM.API.getHandle = function() {\n\n    var API = pipwerks.SCORM.API;\n\n    if(!API.handle && !API.isFound){\n\n        API.handle = API.get();\n\n    }\n\n    return API.handle;\n\n};\n\n\n\n// ------------------------------------------------------------------------- //\n// --- pipwerks.SCORM.connection functions --------------------------------- //\n// ------------------------------------------------------------------------- //\n\n\n/* -------------------------------------------------------------------------\n   pipwerks.SCORM.connection.initialize()\n   Tells the LMS to initiate the communication session.\n\n   Parameters:  None\n   Returns:     Boolean\n---------------------------------------------------------------------------- */\n\npipwerks.SCORM.connection.initialize = function(){\n\n    var success = false,\n        scorm = pipwerks.SCORM,\n        completionStatus = scorm.data.completionStatus,\n        trace = pipwerks.UTILS.trace,\n        makeBoolean = pipwerks.UTILS.StringToBoolean,\n        debug = scorm.debug,\n        traceMsgPrefix = \"SCORM.connection.initialize \";\n\n    trace(\"connection.initialize called.\");\n\n    if(!scorm.connection.isActive){\n\n        var API = scorm.API.getHandle(),\n            errorCode = 0;\n\n        if(API){\n\n            switch(scorm.version){\n                case \"1.2\" : success = makeBoolean(API.LMSInitialize(\"\")); break;\n                case \"2004\": success = makeBoolean(API.Initialize(\"\")); break;\n            }\n\n            if(success){\n\n                //Double-check that connection is active and working before returning 'true' boolean\n                errorCode = debug.getCode();\n\n                if(errorCode !== null && errorCode === 0){\n\n                    scorm.connection.isActive = true;\n\n                    if(scorm.handleCompletionStatus){\n\n                        //Automatically set new launches to incomplete\n                        completionStatus = scorm.status(\"get\");\n\n                        if(completionStatus){\n\n                            switch(completionStatus){\n\n                                //Both SCORM 1.2 and 2004\n                                case \"not attempted\": scorm.status(\"set\", \"incomplete\"); break;\n\n                                //SCORM 2004 only\n                                case \"unknown\" : scorm.status(\"set\", \"incomplete\"); break;\n\n                                //Additional options, presented here in case you'd like to use them\n                                //case \"completed\"  : break;\n                                //case \"incomplete\" : break;\n                                //case \"passed\"     : break;    //SCORM 1.2 only\n                                //case \"failed\"     : break;    //SCORM 1.2 only\n                                //case \"browsed\"    : break;    //SCORM 1.2 only\n\n                            }\n\n                            //Commit changes\n                            scorm.save();\n\n                        }\n\n                    }\n\n                } else {\n\n                    success = false;\n                    trace(traceMsgPrefix +\"failed. \\nError code: \" +errorCode +\" \\nError info: \" +debug.getInfo(errorCode));\n\n                }\n\n            } else {\n\n                errorCode = debug.getCode();\n\n                if(errorCode !== null && errorCode !== 0){\n\n                    trace(traceMsgPrefix +\"failed. \\nError code: \" +errorCode +\" \\nError info: \" +debug.getInfo(errorCode));\n\n                } else {\n\n                    trace(traceMsgPrefix +\"failed: No response from server.\");\n\n                }\n            }\n\n        } else {\n\n            trace(traceMsgPrefix +\"failed: API is null.\");\n\n        }\n\n    } else {\n\n          trace(traceMsgPrefix +\"aborted: Connection already active.\");\n\n     }\n\n     return success;\n\n};\n\n\n/* -------------------------------------------------------------------------\n   pipwerks.SCORM.connection.terminate()\n   Tells the LMS to terminate the communication session\n\n   Parameters:  None\n   Returns:     Boolean\n---------------------------------------------------------------------------- */\n\npipwerks.SCORM.connection.terminate = function(){\n\n    var success = false,\n        scorm = pipwerks.SCORM,\n        exitStatus = scorm.data.exitStatus,\n        completionStatus = scorm.data.completionStatus,\n        trace = pipwerks.UTILS.trace,\n        makeBoolean = pipwerks.UTILS.StringToBoolean,\n        debug = scorm.debug,\n        traceMsgPrefix = \"SCORM.connection.terminate \";\n\n\n    if(scorm.connection.isActive){\n\n        var API = scorm.API.getHandle(),\n            errorCode = 0;\n\n        if(API){\n\n             if(scorm.handleExitMode && !exitStatus){\n\n                if(completionStatus !== \"completed\" && completionStatus !== \"passed\"){\n\n                    switch(scorm.version){\n                        case \"1.2\" : success = scorm.set(\"cmi.core.exit\", \"suspend\"); break;\n                        case \"2004\": success = scorm.set(\"cmi.exit\", \"suspend\"); break;\n                    }\n\n                } else {\n\n                    switch(scorm.version){\n                        case \"1.2\" : success = scorm.set(\"cmi.core.exit\", \"logout\"); break;\n                        case \"2004\": success = scorm.set(\"cmi.exit\", \"normal\"); break;\n                    }\n\n                }\n\n            }\n\n            //Ensure we persist the data\n            success = scorm.save();\n\n            if(success){\n\n                switch(scorm.version){\n                    case \"1.2\" : success = makeBoolean(API.LMSFinish(\"\")); break;\n                    case \"2004\": success = makeBoolean(API.Terminate(\"\")); break;\n                }\n\n                if(success){\n\n                    scorm.connection.isActive = false;\n\n                } else {\n\n                    errorCode = debug.getCode();\n                    trace(traceMsgPrefix +\"failed. \\nError code: \" +errorCode +\" \\nError info: \" +debug.getInfo(errorCode));\n\n                }\n\n            }\n\n        } else {\n\n            trace(traceMsgPrefix +\"failed: API is null.\");\n\n        }\n\n    } else {\n\n        trace(traceMsgPrefix +\"aborted: Connection already terminated.\");\n\n    }\n\n    return success;\n\n};\n\n\n\n// ------------------------------------------------------------------------- //\n// --- pipwerks.SCORM.data functions --------------------------------------- //\n// ------------------------------------------------------------------------- //\n\n\n/* -------------------------------------------------------------------------\n   pipwerks.SCORM.data.get(parameter)\n   Requests information from the LMS.\n\n   Parameter: parameter (string, name of the SCORM data model element)\n   Returns:   string (the value of the specified data model element)\n---------------------------------------------------------------------------- */\n\npipwerks.SCORM.data.get = function(parameter){\n\n    var value = null,\n        scorm = pipwerks.SCORM,\n        trace = pipwerks.UTILS.trace,\n        debug = scorm.debug,\n        traceMsgPrefix = \"SCORM.data.get('\" +parameter +\"') \";\n\n    if(scorm.connection.isActive){\n\n        var API = scorm.API.getHandle(),\n            errorCode = 0;\n\n          if(API){\n\n            switch(scorm.version){\n                case \"1.2\" : value = API.LMSGetValue(parameter); break;\n                case \"2004\": value = API.GetValue(parameter); break;\n            }\n\n            errorCode = debug.getCode();\n\n            //GetValue returns an empty string on errors\n            //If value is an empty string, check errorCode to make sure there are no errors\n            if(value !== \"\" || errorCode === 0){\n\n                //GetValue is successful.\n                //If parameter is lesson_status/completion_status or exit status, let's\n                //grab the value and cache it so we can check it during connection.terminate()\n                switch(parameter){\n\n                    case \"cmi.core.lesson_status\":\n                    case \"cmi.completion_status\" : scorm.data.completionStatus = value; break;\n\n                    case \"cmi.core.exit\":\n                    case \"cmi.exit\"     : scorm.data.exitStatus = value; break;\n\n                }\n\n            } else {\n\n                trace(traceMsgPrefix +\"failed. \\nError code: \" +errorCode +\"\\nError info: \" +debug.getInfo(errorCode));\n\n            }\n\n        } else {\n\n            trace(traceMsgPrefix +\"failed: API is null.\");\n\n        }\n\n    } else {\n\n        trace(traceMsgPrefix +\"failed: API connection is inactive.\");\n\n    }\n\n    trace(traceMsgPrefix +\" value: \" +value);\n\n    return String(value);\n\n};\n\n\n/* -------------------------------------------------------------------------\n   pipwerks.SCORM.data.set()\n   Tells the LMS to assign the value to the named data model element.\n   Also stores the SCO's completion status in a variable named\n   pipwerks.SCORM.data.completionStatus. This variable is checked whenever\n   pipwerks.SCORM.connection.terminate() is invoked.\n\n   Parameters: parameter (string). The data model element\n               value (string). The value for the data model element\n   Returns:    Boolean\n---------------------------------------------------------------------------- */\n\npipwerks.SCORM.data.set = function(parameter, value){\n\n    var success = false,\n        scorm = pipwerks.SCORM,\n        trace = pipwerks.UTILS.trace,\n        makeBoolean = pipwerks.UTILS.StringToBoolean,\n        debug = scorm.debug,\n        traceMsgPrefix = \"SCORM.data.set('\" +parameter +\"') \";\n\n\n    if(scorm.connection.isActive){\n\n        var API = scorm.API.getHandle(),\n            errorCode = 0;\n\n        if(API){\n\n            switch(scorm.version){\n                case \"1.2\" : success = makeBoolean(API.LMSSetValue(parameter, value)); break;\n                case \"2004\": success = makeBoolean(API.SetValue(parameter, value)); break;\n            }\n\n            if(success){\n\n                if(parameter === \"cmi.core.lesson_status\" || parameter === \"cmi.completion_status\"){\n\n                    scorm.data.completionStatus = value;\n\n                }\n\n            } else {\n\n                errorCode = debug.getCode();\n\n                trace(traceMsgPrefix +\"failed. \\nError code: \" +errorCode +\". \\nError info: \" +debug.getInfo(errorCode));\n\n            }\n\n        } else {\n\n            trace(traceMsgPrefix +\"failed: API is null.\");\n\n        }\n\n    } else {\n\n        trace(traceMsgPrefix +\"failed: API connection is inactive.\");\n\n    }\n\n\ttrace(traceMsgPrefix +\" value: \" +value);\n\n    return success;\n\n};\n\n\n/* -------------------------------------------------------------------------\n   pipwerks.SCORM.data.save()\n   Instructs the LMS to persist all data to this point in the session\n\n   Parameters: None\n   Returns:    Boolean\n---------------------------------------------------------------------------- */\n\npipwerks.SCORM.data.save = function(){\n\n    var success = false,\n        scorm = pipwerks.SCORM,\n        trace = pipwerks.UTILS.trace,\n        makeBoolean = pipwerks.UTILS.StringToBoolean,\n        traceMsgPrefix = \"SCORM.data.save failed\";\n\n\n    if(scorm.connection.isActive){\n\n        var API = scorm.API.getHandle();\n\n        if(API){\n\n            switch(scorm.version){\n                case \"1.2\" : success = makeBoolean(API.LMSCommit(\"\")); break;\n                case \"2004\": success = makeBoolean(API.Commit(\"\")); break;\n            }\n\n        } else {\n\n            trace(traceMsgPrefix +\": API is null.\");\n\n        }\n\n    } else {\n\n        trace(traceMsgPrefix +\": API connection is inactive.\");\n\n    }\n\n    return success;\n\n};\n\n\npipwerks.SCORM.status = function (action, status){\n\n    var success = false,\n        scorm = pipwerks.SCORM,\n        trace = pipwerks.UTILS.trace,\n        traceMsgPrefix = \"SCORM.getStatus failed\",\n        cmi = \"\";\n\n    if(action !== null){\n\n        switch(scorm.version){\n            case \"1.2\" : cmi = \"cmi.core.lesson_status\"; break;\n            case \"2004\": cmi = \"cmi.completion_status\"; break;\n        }\n\n        switch(action){\n\n            case \"get\": success = scorm.data.get(cmi); break;\n\n            case \"set\": if(status !== null){\n\n                            success = scorm.data.set(cmi, status);\n\n                        } else {\n\n                            success = false;\n                            trace(traceMsgPrefix +\": status was not specified.\");\n\n                        }\n\n                        break;\n\n            default      : success = false;\n                        trace(traceMsgPrefix +\": no valid action was specified.\");\n\n        }\n\n    } else {\n\n        trace(traceMsgPrefix +\": action was not specified.\");\n\n    }\n\n    return success;\n\n};\n\n\n// ------------------------------------------------------------------------- //\n// --- pipwerks.SCORM.debug functions -------------------------------------- //\n// ------------------------------------------------------------------------- //\n\n\n/* -------------------------------------------------------------------------\n   pipwerks.SCORM.debug.getCode\n   Requests the error code for the current error state from the LMS\n\n   Parameters: None\n   Returns:    Integer (the last error code).\n---------------------------------------------------------------------------- */\n\npipwerks.SCORM.debug.getCode = function(){\n\n    var scorm = pipwerks.SCORM,\n        API = scorm.API.getHandle(),\n        trace = pipwerks.UTILS.trace,\n        code = 0;\n\n    if(API){\n\n        switch(scorm.version){\n            case \"1.2\" : code = parseInt(API.LMSGetLastError(), 10); break;\n            case \"2004\": code = parseInt(API.GetLastError(), 10); break;\n        }\n\n    } else {\n\n        trace(\"SCORM.debug.getCode failed: API is null.\");\n\n    }\n\n    return code;\n\n};\n\n\n/* -------------------------------------------------------------------------\n   pipwerks.SCORM.debug.getInfo()\n   \"Used by a SCO to request the textual description for the error code\n   specified by the value of [errorCode].\"\n\n   Parameters: errorCode (integer).\n   Returns:    String.\n----------------------------------------------------------------------------- */\n\npipwerks.SCORM.debug.getInfo = function(errorCode){\n\n    var scorm = pipwerks.SCORM,\n        API = scorm.API.getHandle(),\n        trace = pipwerks.UTILS.trace,\n        result = \"\";\n\n\n    if(API){\n\n        switch(scorm.version){\n            case \"1.2\" : result = API.LMSGetErrorString(errorCode.toString()); break;\n            case \"2004\": result = API.GetErrorString(errorCode.toString()); break;\n        }\n\n    } else {\n\n        trace(\"SCORM.debug.getInfo failed: API is null.\");\n\n    }\n\n    return String(result);\n\n};\n\n\n/* -------------------------------------------------------------------------\n   pipwerks.SCORM.debug.getDiagnosticInfo\n   \"Exists for LMS specific use. It allows the LMS to define additional\n   diagnostic information through the API Instance.\"\n\n   Parameters: errorCode (integer).\n   Returns:    String (Additional diagnostic information about the given error code).\n---------------------------------------------------------------------------- */\n\npipwerks.SCORM.debug.getDiagnosticInfo = function(errorCode){\n\n    var scorm = pipwerks.SCORM,\n        API = scorm.API.getHandle(),\n        trace = pipwerks.UTILS.trace,\n        result = \"\";\n\n    if(API){\n\n        switch(scorm.version){\n            case \"1.2\" : result = API.LMSGetDiagnostic(errorCode); break;\n            case \"2004\": result = API.GetDiagnostic(errorCode); break;\n        }\n\n    } else {\n\n        trace(\"SCORM.debug.getDiagnosticInfo failed: API is null.\");\n\n    }\n\n    return String(result);\n\n};\n\n\n// ------------------------------------------------------------------------- //\n// --- Shortcuts! ---------------------------------------------------------- //\n// ------------------------------------------------------------------------- //\n\n// Because nobody likes typing verbose code.\n\npipwerks.SCORM.init = pipwerks.SCORM.connection.initialize;\npipwerks.SCORM.get  = pipwerks.SCORM.data.get;\npipwerks.SCORM.set  = pipwerks.SCORM.data.set;\npipwerks.SCORM.save = pipwerks.SCORM.data.save;\npipwerks.SCORM.quit = pipwerks.SCORM.connection.terminate;\n\n\n\n// ------------------------------------------------------------------------- //\n// --- pipwerks.UTILS functions -------------------------------------------- //\n// ------------------------------------------------------------------------- //\n\n\n/* -------------------------------------------------------------------------\n   pipwerks.UTILS.StringToBoolean()\n   Converts 'boolean strings' into actual valid booleans.\n\n   (Most values returned from the API are the strings \"true\" and \"false\".)\n\n   Parameters: String\n   Returns:    Boolean\n---------------------------------------------------------------------------- */\n\npipwerks.UTILS.StringToBoolean = function(value){\n    var t = typeof value;\n    switch(t){\n       //typeof new String(\"true\") === \"object\", so handle objects as string via fall-through.\n       //See https://github.com/pipwerks/scorm-api-wrapper/issues/3\n       case \"object\":\n       case \"string\": return (/(true|1)/i).test(value);\n       case \"number\": return !!value;\n       case \"boolean\": return value;\n       case \"undefined\": return null;\n       default: return false;\n    }\n};\n\n\n\n/* -------------------------------------------------------------------------\n   pipwerks.UTILS.trace()\n   Displays error messages when in debug mode.\n\n   Parameters: msg (string)\n   Return:     None\n---------------------------------------------------------------------------- */\n\npipwerks.UTILS.trace = function(msg){\n\n     if(pipwerks.debug.isActive){\n\n        if(window.console && window.console.log){\n            window.console.log(msg);\n        } else {\n            //alert(msg);\n        }\n\n     }\n};\n\ndefine(\"extensions/adapt-contrib-spoor/js/scorm/API\", function(){});\n\n","define ('extensions/adapt-contrib-spoor/js/scorm/wrapper',['require'],function(require) {\n\n\t/*\n\t\tIMPORTANT: This wrapper uses the Pipwerks SCORM wrapper and should therefore support both SCORM 1.2 and 2004. Ensure any changes support both versions.\n\t*/\n\n\tvar ScormWrapper = function() {\n\t\t/* configuration */\n\t\tthis.setCompletedWhenFailed = true;// this only applies to SCORM 2004\n\t\t/**\n\t\t * whether to commit each time there's a change to lesson_status or not\n\t\t */\n\t\tthis.commitOnStatusChange = true;\n\t\t/**\n\t\t * how frequently (in minutes) to commit automatically. set to 0 to disable.\n\t\t */\n\t\tthis.timedCommitFrequency = 10;\n\t\t/**\n\t\t * how many times to retry if a commit fails\n\t\t */\n\t\tthis.maxCommitRetries = 5;\n\t\t/**\n\t\t * time (in milliseconds) to wait between retries\n\t\t */\n\t\tthis.commitRetryDelay = 1000;\n\t\t\n\t\t/**\n\t\t * prevents commit from being called if there's already a 'commit retry' pending.\n\t\t */\n\t\tthis.commitRetryPending = false;\n\t\t/**\n\t\t * how many times we've done a 'commit retry'\n\t\t */\n\t\tthis.commitRetries = 0;\n\t\t/**\n\t\t * not currently used - but you could include in an error message to show when data was last saved\n\t\t */\n\t\tthis.lastCommitSuccessTime = null;\n\t\t\n\t\tthis.timedCommitIntervalID = null;\n\t\tthis.retryCommitTimeoutID = null;\n\t\tthis.logOutputWin = null;\n\t\tthis.startTime = null;\n\t\tthis.endTime = null;\n\t\t\n\t\tthis.lmsConnected = false;\n\t\tthis.finishCalled = false;\n\t\t\n\t\tthis.logger = Logger.getInstance();\n\t\tthis.scorm = pipwerks.SCORM;\n\n\t\tthis.suppressErrors = false;\n        \n\t\tif (window.__debug)\n\t\t\tthis.showDebugWindow();\n\n\t\tif ((window.API && window.API.__offlineAPIWrapper) || (window.API_1484_11 && window.API_1484_11.__offlineAPIWrapper))\n\t\t\tthis.logger.error(\"Offline SCORM API is being used. No data will be reported to the LMS!\");\n\t};\n\n\t// static\n\tScormWrapper.instance = null;\n\n\t/******************************* public methods *******************************/\n\n\t// static\n\tScormWrapper.getInstance = function() {\n\t\tif (ScormWrapper.instance === null)\n\t\t\tScormWrapper.instance = new ScormWrapper();\n\t\t\n\t\treturn ScormWrapper.instance;\n\t};\n\n\tScormWrapper.prototype.getVersion = function() {\n\t\treturn this.scorm.version;\n\t};\n\n\tScormWrapper.prototype.setVersion = function(value) {\n\t\tthis.logger.debug(\"ScormWrapper::setVersion: \" + value);\n\t\tthis.scorm.version = value;\n\t\t/**\n\t\t * stop the pipwerks code from setting cmi.core.exit to suspend/logout when targeting SCORM 1.2.\n\t\t * there doesn't seem to be any tangible benefit to doing this in 1.2 and it can actually cause problems with some LMSes\n\t\t * (e.g. setting it to 'logout' apparently causes Plateau to log the user completely out of the LMS!)\n\t\t * It needs to be on for SCORM 2004 though, otherwise the LMS might not restore the suspend_data\n\t\t */\n\t\tthis.scorm.handleExitMode = this.isSCORM2004();\n\t};\n\n\tScormWrapper.prototype.initialize = function() {\n\t\tthis.logger.debug(\"ScormWrapper::initialize\");\n\t\tthis.lmsConnected = this.scorm.init();\n\n\t\tif (this.lmsConnected) {\n\t\t\tthis.startTime = new Date();\n\t\t\t\n\t\t\tthis.initTimedCommit();\n\t\t}\n\t\telse {\n\t\t\tthis.handleError(\"Course could not connect to the LMS\");\n\t\t}\n\t\t\n\t\treturn this.lmsConnected;\n\t};\n\n\t/**\n\t* allows you to check if this is the user's first ever 'session' of a SCO, even after the lesson_status has been set to 'incomplete'\n\t*/\n\tScormWrapper.prototype.isFirstSession = function() {\n\t\treturn (this.getValue(this.isSCORM2004() ? \"cmi.entry\" :\"cmi.core.entry\") === \"ab-initio\");\n\t};\n\n\tScormWrapper.prototype.setIncomplete = function() {\n\t\tthis.setValue(this.isSCORM2004() ? \"cmi.completion_status\" : \"cmi.core.lesson_status\", \"incomplete\");\n\n\t\tif(this.commitOnStatusChange) this.commit();\n\t};\n\n\tScormWrapper.prototype.setCompleted = function() {\n\t\tthis.setValue(this.isSCORM2004() ? \"cmi.completion_status\" : \"cmi.core.lesson_status\", \"completed\");\n\t\t\n\t\tif(this.commitOnStatusChange) this.commit();\n\t};\n\n\tScormWrapper.prototype.setPassed = function() {\n\t\tif (this.isSCORM2004()) {\n\t\t\tthis.setValue(\"cmi.completion_status\", \"completed\");\n\t\t\tthis.setValue(\"cmi.success_status\", \"passed\");\n\t\t}\n\t\telse {\n\t\t\tthis.setValue(\"cmi.core.lesson_status\", \"passed\");\n\t\t}\n\n\t\tif(this.commitOnStatusChange) this.commit();\n\t};\n\n\tScormWrapper.prototype.setFailed = function() {\n\t\tif (this.isSCORM2004()) {\n\t\t\tthis.setValue(\"cmi.success_status\", \"failed\");\n\t\t\t\n\t\t\tif(this.setCompletedWhenFailed) {\n\t\t\t\tthis.setValue(\"cmi.completion_status\", \"completed\");\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis.setValue(\"cmi.core.lesson_status\", \"failed\");\n\t\t}\n\n\t\tif(this.commitOnStatusChange) this.commit();\n\t};\n\n\tScormWrapper.prototype.getStatus = function() {\n\t\tvar status = this.getValue(this.isSCORM2004() ? \"cmi.completion_status\" : \"cmi.core.lesson_status\");\n\n\t\tswitch(status.toLowerCase()) {// workaround for some LMSes (e.g. Arena) not adhering to the all-lowercase rule\n\t\t\tcase \"passed\":\n\t\t\tcase \"completed\":\n\t\t\tcase \"incomplete\":\n\t\t\tcase \"failed\":\n\t\t\tcase \"browsed\":\n\t\t\tcase \"not attempted\":\n\t\t\tcase \"not_attempted\":// mentioned in SCORM 2004 docs but not sure it ever gets used\n\t\t\tcase \"unknown\": //the SCORM 2004 version of not attempted\n\t\t\t\treturn status;\n\t\t\tdefault:\n\t\t\t\tthis.handleError(\"ScormWrapper::getStatus: invalid lesson status '\" + status + \"' received from LMS\");\n\t\t\t\treturn null;\n\t\t}\n\t};\n\n\tScormWrapper.prototype.setStatus = function(status) {\n\t\tswitch (status.toLowerCase()){\n\t\t\tcase \"incomplete\":\n\t\t\t\tthis.setIncomplete();\n\t\t\tbreak;\n\t\t\tcase \"completed\":\n\t\t\t\tthis.setCompleted();\n\t\t\tbreak;\n\t\t\tcase \"passed\":\n\t\t\t\tthis.setPassed();\n\t\t\tbreak;\n\t\t\tcase \"failed\":\n\t\t\t\tthis.setFailed();\n\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthis.handleError(\"ScormWrapper::setStatus: the status '\" + status + \"' is not supported.\");\n\t\t}\n\t};\n\n\tScormWrapper.prototype.getScore = function() {\n\t\treturn this.getValue(this.isSCORM2004() ? \"cmi.score.raw\" : \"cmi.core.score.raw\");\n\t};\n\n\tScormWrapper.prototype.setScore = function(_score, _minScore, _maxScore) {\n\t\tif (this.isSCORM2004()) {\n\t\t\tthis.setValue(\"cmi.score.raw\", _score);\n\t\t\tthis.setValue(\"cmi.score.min\", _minScore);\n\t\t\tthis.setValue(\"cmi.score.max\", _maxScore);\n\t\t\tthis.setValue(\"cmi.score.scaled\", _score / 100);\n\t\t}\n\t\telse {\n\t\t\tthis.setValue(\"cmi.core.score.raw\", _score);\n\n\t\t\tif(this.isSupported(\"cmi.core.score.min\")) this.setValue(\"cmi.core.score.min\", _minScore);\n\n\t\t\tif(this.isSupported(\"cmi.core.score.max\")) this.setValue(\"cmi.core.score.max\", _maxScore);\n\t\t}\n\t};\n\n\tScormWrapper.prototype.getLessonLocation = function() {\n\t\treturn this.getValue(this.isSCORM2004() ? \"cmi.location\" : \"cmi.core.lesson_location\");\n\t};\n\n\tScormWrapper.prototype.setLessonLocation = function(_location) {\n\t\tthis.setValue(this.isSCORM2004() ? \"cmi.location\" : \"cmi.core.lesson_location\", _location);\n\t};\n\n\tScormWrapper.prototype.getSuspendData = function() {\n\t\treturn this.getValue(\"cmi.suspend_data\");\n\t};\n\n\tScormWrapper.prototype.setSuspendData = function(_data) {\n\t\tthis.setValue(\"cmi.suspend_data\", _data);\n\t};\n\n\tScormWrapper.prototype.getStudentName = function() {\n\t\treturn this.getValue(this.isSCORM2004() ? \"cmi.learner_name\" : \"cmi.core.student_name\");\n\t};\n\n\tScormWrapper.prototype.getStudentId = function(){\n\t\treturn this.getValue(this.isSCORM2004() ? \"cmi.learner_id\":\"cmi.core.student_id\");\n\t};\n\n\tScormWrapper.prototype.commit = function() {\n\t\tthis.logger.debug(\"ScormWrapper::commit\");\n\t\t\n\t\tif (this.lmsConnected) {\n\t\t\tif (this.commitRetryPending) {\n\t\t\t\tthis.logger.debug(\"ScormWrapper::commit: skipping this commit call as one is already pending.\");\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (this.scorm.save()) {\n\t\t\t\t\tthis.commitRetries = 0;\n\t\t\t\t\tthis.lastCommitSuccessTime = new Date();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (this.commitRetries < this.maxCommitRetries && !this.finishCalled) {\n\t\t\t\t\t\tthis.commitRetries++;\n\t\t\t\t\t\tthis.initRetryCommit();\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tvar _errorCode = this.scorm.debug.getCode();\n\n\t\t\t\t\t\tvar _errorMsg = \"Course could not commit data to the LMS\";\n\t\t\t\t\t\t_errorMsg += \"\\nError \" + _errorCode + \": \" + this.scorm.debug.getInfo(_errorCode);\n\t\t\t\t\t\t_errorMsg += \"\\nLMS Error Info: \" + this.scorm.debug.getDiagnosticInfo(_errorCode);\n\n\t\t\t\t\t\tthis.handleError(_errorMsg);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis.handleError(\"Course is not connected to the LMS\");\n\t\t}\n\t};\n\n\tScormWrapper.prototype.finish = function() {\n\t\tthis.logger.debug(\"ScormWrapper::finish\");\n\t\t\n\t\tif (this.lmsConnected && !this.finishCalled) {\n\t\t\tthis.finishCalled = true;\n\t\t\t\n\t\t\tif(this.timedCommitIntervalID !== null) {\n\t\t\t\twindow.clearInterval(this.timedCommitIntervalID);\n\t\t\t}\n\t\t\t\n\t\t\tif(this.commitRetryPending) {\n\t\t\t\twindow.clearTimeout(this.retryCommitTimeoutID);\n\t\t\t\tthis.commitRetryPending = false;\n\t\t\t}\n\t\t\t\n\t\t\tif (this.logOutputWin && !this.logOutputWin.closed) {\n\t\t\t\tthis.logOutputWin.close();\n\t\t\t}\n\t\t\t\n\t\t\tthis.endTime = new Date();\n\t\t\t\n\t\t\tif (this.isSCORM2004()) {\n\t\t\t\tthis.scorm.set(\"cmi.session_time\", this.convertToSCORM2004Time(this.endTime.getTime() - this.startTime.getTime()));\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.scorm.set(\"cmi.core.session_time\", this.convertToSCORM12Time(this.endTime.getTime() - this.startTime.getTime()));\n\t\t\t\tthis.scorm.set(\"cmi.core.exit\", \"\");\n\t\t\t}\n\t\t\t\n\t\t\t// api no longer available from this point\n\t\t\tthis.lmsConnected = false;\n\t\t\t\n\t\t\tif (!this.scorm.quit()) {\n\t\t\t\tthis.handleError(\"Course could not finish\");\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis.handleError(\"Course is not connected to the LMS\");\n\t\t}\n\t};\n\n\tScormWrapper.prototype.recordInteraction = function(id, response, correct, latency, type) {\n\t\tif(this.isSupported(\"cmi.interactions._count\")) {\n\t\t\tswitch(type) {\n\t\t\t\tcase \"choice\":\n\t\t\t\t\tthis.recordInteractionMultipleChoice.apply(this, arguments);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"matching\":\n\t\t\t\t\tthis.recordInteractionMatching.apply(this, arguments);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"numeric\":\n\t\t\t\t\tthis.isSCORM2004() ? this.recordInteractionScorm2004.apply(this, arguments) : this.recordInteractionScorm12.apply(this, arguments);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"fill-in\":\n\t\t\t\t\tthis.recordInteractionFillIn.apply(this, arguments);\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.error(\"ScormWrapper.recordInteraction: unknown interaction type of '\" + type + \"' encountered...\");\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis.logger.info(\"ScormWrapper::recordInteraction: cmi.interactions are not supported by this LMS...\");\n\t\t}\n\t};\n\n\t/****************************** private methods ******************************/\n\tScormWrapper.prototype.getValue = function(_property) {\n\t\tthis.logger.debug(\"ScormWrapper::getValue: _property=\" + _property);\n\n\t\tif(this.finishCalled) {\n\t\t\tthis.logger.debug(\"ScormWrapper::getValue: ignoring request as 'finish' has been called\");\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tif (this.lmsConnected) {\n\t\t\tvar _value = this.scorm.get(_property);\n\t\t\tvar _errorCode = this.scorm.debug.getCode();\n\t\t\tvar _errorMsg = \"\";\n\t\t\t\n\t\t\tif (_errorCode !== 0) {\n\t\t\t\tif (_errorCode === 403) {\n\t\t\t\t\tthis.logger.warn(\"ScormWrapper::getValue: data model element not initialized\");\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t_errorMsg += \"Course could not get \" + _property;\n\t\t\t\t\t_errorMsg += \"\\nError Info: \" + this.scorm.debug.getInfo(_errorCode);\n\t\t\t\t\t_errorMsg += \"\\nLMS Error Info: \" + this.scorm.debug.getDiagnosticInfo(_errorCode);\n\t\t\t\t\t\n\t\t\t\t\tthis.handleError(_errorMsg);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.logger.debug(\"ScormWrapper::getValue: returning \" + _value);\n\t\t\treturn _value + \"\";\n\t\t}\n\t\telse {\n\t\t\tthis.handleError(\"Course is not connected to the LMS\");\n\t\t}\n\t};\n\n\tScormWrapper.prototype.setValue = function(_property, _value) {\n\t\tthis.logger.debug(\"ScormWrapper::setValue: _property=\" + _property + \" _value=\" + _value);\n\n\t\tif(this.finishCalled) {\n\t\t\tthis.logger.debug(\"ScormWrapper::setValue: ignoring request as 'finish' has been called\");\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tif (this.lmsConnected) {\n\t\t\tvar _success = this.scorm.set(_property, _value);\n\t\t\tvar _errorCode = this.scorm.debug.getCode();\n\t\t\tvar _errorMsg = \"\";\n\t\t\t\n\t\t\tif (!_success) {\n\t\t\t\t/*\n\t\t\t\t* Some LMSes have an annoying tendency to return false from a set call even when it actually worked fine.\n\t\t\t\t* So, we should throw an error _only_ if there was a valid error code...\n\t\t\t\t*/\n\t\t\t\tif(_errorCode !== 0) {\n\t\t\t\t\t_errorMsg += \"Course could not set \" + _property + \" to \" + _value;\n\t\t\t\t\t_errorMsg += \"\\nError Info: \" + this.scorm.debug.getInfo(_errorCode);\n\t\t\t\t\t_errorMsg += \"\\nLMS Error Info: \" + this.scorm.debug.getDiagnosticInfo(_errorCode);\n\t\t\t\t\t\n\t\t\t\t\tthis.handleError(_errorMsg);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.logger.warn(\"ScormWrapper::setValue: LMS reported that the 'set' call failed but then said there was no error!\");\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn _success;\n\t\t}\n\t\telse {\n\t\t\tthis.handleError(\"Course is not connected to the LMS\");\n\t\t}\n\t};\n\n\t/**\n\t* used for checking any data field that is not 'LMS Mandatory' to see whether the LMS we're running on supports it or not.\n\t* Note that the way this check is being performed means it wouldn't work for any element that is\n\t* 'write only', but so far we've not had a requirement to check for any optional elements that are.\n\t*/\n\tScormWrapper.prototype.isSupported = function(_property) {\n\t\tthis.logger.debug(\"ScormWrapper::isSupported: _property=\" + _property);\n\n\t\tif(this.finishCalled) {\n\t\t\tthis.logger.debug(\"ScormWrapper::isSupported: ignoring request as 'finish' has been called\");\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tif (this.lmsConnected) {\n\t\t\tvar _value = this.scorm.get(_property);\n\t\t\tvar _errorCode = this.scorm.debug.getCode();\n\t\t\t\n\t\t\treturn (_errorCode === 401 ? false : true);\n\t\t}\n\t\telse {\n\t\t\tthis.handleError(\"Course is not connected to the LMS\");\n\t\t\treturn false;\n\t\t}\n\t};\n\n\tScormWrapper.prototype.initTimedCommit = function() {\n\t\tthis.logger.debug(\"ScormWrapper::initTimedCommit\");\n\t\t\n\t\tif(this.timedCommitFrequency > 0) {\n\t\t\tvar delay = this.timedCommitFrequency * (60 * 1000);\n\t\t\tthis.timedCommitIntervalID = window.setInterval(_.bind(this.commit, this), delay);\n\t\t}\n\t};\n\n\tScormWrapper.prototype.initRetryCommit = function() {\n\t\tthis.logger.debug(\"ScormWrapper::initRetryCommit \" + this.commitRetries + \" out of \" + this.maxCommitRetries);\n\t\t\n\t\tthis.commitRetryPending = true;// stop anything else from calling commit until this is done\n\t\t\n\t\tthis.retryCommitTimeoutID = window.setTimeout(_.bind(this.doRetryCommit, this), this.commitRetryDelay);\n\t};\n\n\tScormWrapper.prototype.doRetryCommit = function() {\n\t\tthis.logger.debug(\"ScormWrapper::doRetryCommit\");\n\n\t\tthis.commitRetryPending = false;\n\n\t\tthis.commit();\n\t};\n\n\tScormWrapper.prototype.handleError = function(_msg) {\n\t\tthis.logger.error(_msg);\n\t\t\n\t\tif (!this.suppressErrors && (!this.logOutputWin || this.logOutputWin.closed) && confirm(\"An error has occured:\\n\\n\" + _msg + \"\\n\\nPress 'OK' to view debug information to send to technical support.\"))\n\t\t\tthis.showDebugWindow();\n\t};\n\n\tScormWrapper.prototype.getInteractionCount = function(){\n\t\tvar count = this.getValue(\"cmi.interactions._count\");\n\t\treturn count === \"\" ? 0 : count;\n\t};\n\t\n\tScormWrapper.prototype.recordInteractionScorm12 = function(id, response, correct, latency, type) {\n\t\t\n\t\tid = this.trim(id);\n\n\t\tvar cmiPrefix = \"cmi.interactions.\" + this.getInteractionCount();\n\t\t\n\t\tthis.setValue(cmiPrefix + \".id\", id);\n\t\tthis.setValue(cmiPrefix + \".type\", type);\n\t\tthis.setValue(cmiPrefix + \".student_response\", response);\n\t\tthis.setValue(cmiPrefix + \".result\", correct ? \"correct\" : \"wrong\");\n\t\tif (latency !== null && latency !== undefined) this.setValue(cmiPrefix + \".latency\", this.convertToSCORM12Time(latency));\n\t\tthis.setValue(cmiPrefix + \".time\", this.getCMITime());\n\t};\n\n\n\tScormWrapper.prototype.recordInteractionScorm2004 = function(id, response, correct, latency, type) {\n\n\t\tid = this.trim(id);\n\n\t\tvar cmiPrefix = \"cmi.interactions.\" + this.getInteractionCount();\n\t\t\n\t\tthis.setValue(cmiPrefix + \".id\", id);\n\t\tthis.setValue(cmiPrefix + \".type\", type);\n\t\tthis.setValue(cmiPrefix + \".learner_response\", response);\n\t\tthis.setValue(cmiPrefix + \".result\", correct ? \"correct\" : \"incorrect\");\n\t\tif (latency !== null && latency !== undefined) this.setValue(cmiPrefix + \".latency\", this.convertToSCORM2004Time(latency));\n\t\tthis.setValue(cmiPrefix + \".timestamp\", this.getISO8601Timestamp());\n\t};\n\n\n\tScormWrapper.prototype.recordInteractionMultipleChoice = function(id, response, correct, latency, type) {\n\t\t\n\t\tif(this.isSCORM2004()) {\n\t\t\tresponse = response.replace(/,|#/g, \"[,]\");\n\t\t} else {\n\t\t\tresponse = response.replace(/#/g, \",\");\n\t\t}\n\t\t\n\t\tvar scormRecordInteraction = this.isSCORM2004() ? this.recordInteractionScorm2004 : this.recordInteractionScorm12;\n\n\t\tscormRecordInteraction.call(this, id, response, correct, latency, type);\n\t};\n\n\t\n\tScormWrapper.prototype.recordInteractionMatching = function(id, response, correct, latency, type) {\n\n\t\tresponse = response.replace(/#/g, \",\");\n\n\t\tif(this.isSCORM2004()) {\n\t\t\tresponse = response.replace(/,/g, \"[,]\");\n\t\t\tresponse = response.replace(/\\./g, \"[.]\");\n\t\t}\n\t\t\n\t\tvar scormRecordInteraction = this.isSCORM2004() ? this.recordInteractionScorm2004 : this.recordInteractionScorm12;\n\n\t\tscormRecordInteraction.call(this, id, response, correct, latency, type);\n\t};\n\n\n\tScormWrapper.prototype.recordInteractionFillIn = function(id, response, correct, latency, type) {\n\t\t\n\t\tvar maxLength = this.isSCORM2004() ? 250 : 255;\n\n\t\tif(response.length > maxLength) {\n\t\t\tresponse = response.substr(0, maxLength);\n\n\t\t\tthis.logger.warn(\"ScormWrapper::recordInteractionFillIn: response data for \" + id + \" is longer than the maximum allowed length of \" + maxLength + \" characters; data will be truncated to avoid an error.\");\n\t\t}\n\n\t\tvar scormRecordInteraction = this.isSCORM2004() ? this.recordInteractionScorm2004 : this.recordInteractionScorm12;\n\n\t\tscormRecordInteraction.call(this, id, response, correct, latency, type);\n\t};\n\n\tScormWrapper.prototype.showDebugWindow = function() {\n\t\t\n\t\tif (this.logOutputWin && !this.logOutputWin.closed) {\n\t\t\tthis.logOutputWin.close();\n\t\t}\n\t\t\n\t\tthis.logOutputWin = window.open(\"log_output.html\", \"Log\", \"width=600,height=300,status=no,scrollbars=yes,resizable=yes,menubar=yes,toolbar=yes,location=yes,top=0,left=0\");\n\t\t\n\t\tif (this.logOutputWin)\n\t\t\tthis.logOutputWin.focus();\n\t\t\n\t\treturn;\n\t};\n\n\tScormWrapper.prototype.convertToSCORM12Time = function(msConvert) {\n\t\t\n\t\tvar msPerSec = 1000;\n\t\tvar msPerMin = msPerSec * 60;\n\t\tvar msPerHour = msPerMin * 60;\n\n\t\tvar ms = msConvert % msPerSec;\n\t\tmsConvert = msConvert - ms;\n\n\t\tvar secs = msConvert % msPerMin;\n\t\tmsConvert = msConvert - secs;\n\t\tsecs = secs / msPerSec;\n\n\t\tvar mins = msConvert % msPerHour;\n\t\tmsConvert = msConvert - mins;\n\t\tmins = mins / msPerMin;\n\n\t\tvar hrs = msConvert / msPerHour;\n\n\t\tif(hrs > 9999) {\n\t\t\treturn \"9999:99:99.99\";\n\t\t}\n\t\telse {\n\t\t\tvar str = [this.padWithZeroes(hrs,4), this.padWithZeroes(mins, 2), this.padWithZeroes(secs, 2)].join(\":\");\n\t\t\treturn (str + '.' + Math.floor(ms/10));\n\t\t}\n\t};\n\n\t/**\n\t* Converts milliseconds into the SCORM 2004 data type 'timeinterval (second, 10,2)'\n\t* this will output something like 'P1DT3H5M0S' which indicates a period of time of 1 day, 3 hours and 5 minutes\n\t* or 'PT2M10.1S' which indicates a period of time of 2 minutes and 10.1 seconds\n\t*/\n\tScormWrapper.prototype.convertToSCORM2004Time = function(msConvert) {\n\t\tvar csConvert = Math.floor(msConvert / 10);\n\t\tvar csPerSec = 100;\n\t\tvar csPerMin = csPerSec * 60;\n\t\tvar csPerHour = csPerMin * 60;\n\t\tvar csPerDay = csPerHour * 24;\n\n\t\tvar days = Math.floor(csConvert/ csPerDay);\n\t\tcsConvert -= days * csPerDay;\n\t\tdays = days ? days + \"D\" : \"\";\n\n\t\tvar hours = Math.floor(csConvert/ csPerHour);\n\t\tcsConvert -= hours * csPerHour;\n\t\thours = hours ? hours + \"H\" : \"\";\n\n\t\tvar mins = Math.floor(csConvert/ csPerMin);\n\t\tcsConvert -= mins * csPerMin;\n\t\tmins = mins ? mins + \"M\" : \"\";\n\n\t\tvar secs = Math.floor(csConvert/ csPerSec);\n\t\tcsConvert -= secs * csPerSec;\n\t\tsecs = secs ? secs : \"0\";\n\n\t\tvar cs = csConvert;\n\t\tcs = cs ? \".\" + cs : \"\";\n\t\t\n\t\tvar seconds = secs + cs + \"S\";\n\t\t\n\t\tvar hms = [hours,mins,seconds].join(\"\");\n\t\t\n\t\treturn \"P\" + days + \"T\" + hms;\n\t};\n\n\tScormWrapper.prototype.getCMITime = function() {\n\t\t\n\t\tvar date = new Date();\n\n\t\tvar hours = this.padWithZeroes(date.getHours(),2);\n\t\tvar min = this.padWithZeroes(date.getMinutes(),2);\n\t\tvar sec = this.padWithZeroes(date.getSeconds(),2);\n\n\t\treturn [hours, min, sec].join(\":\");\n\t};\n\n\tScormWrapper.prototype.getISO8601Timestamp = function() {\n\t\n\t\tvar date = new Date();\n\t\t\n\t\tvar ymd = [\n\t\t\tdate.getFullYear(),\n\t\t\tthis.padWithZeroes(date.getMonth()+1,2),\n\t\t\tthis.padWithZeroes(date.getDate(),2)\n\t\t].join(\"-\");\n\n\t\tvar hms = [\n\t\t\tthis.padWithZeroes(date.getHours(),2),\n\t\t\tthis.padWithZeroes(date.getMinutes(),2),\n\t\t\tthis.padWithZeroes(date.getSeconds(),2)\n\t\t].join(\":\");\n\n\t\treturn ymd + \"T\" + hms;\n\t};\n\n\tScormWrapper.prototype.padWithZeroes = function(numToPad, padBy) {\n\n\t\tvar len = padBy;\n\n\t\twhile(--len){ numToPad = \"0\" + numToPad; }\n\n\t\treturn numToPad.slice(-padBy);\n\t};\n\n\tScormWrapper.prototype.trim = function(str) {\n\t\treturn str.replace(/^\\s*|\\s*$/g, \"\");\n\t};\n\n\tScormWrapper.prototype.isSCORM2004 = function() {\n\t\treturn this.scorm.version === \"2004\";\n\t};\n\n\treturn ScormWrapper;\n});\n\n","Logger = function() {\n\tthis.logArr = new Array();\n\tthis.registeredViews = new Array();\n};\n\nif (!Date.now) {\n    Date.now = function() { return new Date().getTime(); }\n}\n\n// static\nLogger.instance = null;\nLogger.LOG_TYPE_INFO = 0;\nLogger.LOG_TYPE_WARN = 1;\nLogger.LOG_TYPE_ERROR = 2;\nLogger.LOG_TYPE_DEBUG = 3;\n\nLogger.getInstance = function() {\n\tif (Logger.instance == null)\n\t\tLogger.instance = new Logger();\n\treturn Logger.instance;\n};\n\nLogger.prototype.getEntries = function() {\n\treturn this.logArr;\n};\n\nLogger.prototype.getLastEntry = function() {\n\treturn this.logArr[this.logArr.length - 1];\n};\n\nLogger.prototype.info = function(str) {\n\tthis.logArr[this.logArr.length] = {str:str, type:Logger.LOG_TYPE_INFO, time:Date.now()};\n\tthis.updateViews();\n};\n\nLogger.prototype.warn = function(str) {\n\tthis.logArr[this.logArr.length] = {str:str, type:Logger.LOG_TYPE_WARN, time:Date.now()};\n\tthis.updateViews();\n};\n\nLogger.prototype.error = function(str) {\n\tthis.logArr[this.logArr.length] = {str:str, type:Logger.LOG_TYPE_ERROR, time:Date.now()};\n\tthis.updateViews();\n};\n\nLogger.prototype.debug = function(str) {\n\tthis.logArr[this.logArr.length] = {str:str, type:Logger.LOG_TYPE_DEBUG, time:Date.now()};\n\tthis.updateViews();\n};\n\n//register a view\nLogger.prototype.registerView = function(_view) {\n\tthis.registeredViews[this.registeredViews.length] = _view;\n};\n\n//unregister a view\nLogger.prototype.unregisterView = function(_view) {\n\tfor (var i = 0; i < this.registeredViews.length; i++)\n\t\tif (this.registeredViews[i] == _view) {\n\t\t\tthis.registeredViews.splice(i, 1);\n\t\t\ti--;\n\t\t}\n};\n\n// update all views\nLogger.prototype.updateViews = function() {\n\tfor (var i = 0; i < this.registeredViews.length; i++) {\n\t\tif (this.registeredViews[i])\n\t\t\tthis.registeredViews[i].update(this);\n\t}\n};\ndefine(\"extensions/adapt-contrib-spoor/js/scorm/logger\", function(){});\n\n","define('extensions/adapt-contrib-spoor/js/scorm',[\n\t'./scorm/API',\n \t'./scorm/wrapper',\n\t'./scorm/logger'\n], function(API, wrapper, logger) {\n\n\t//Load and prepare SCORM API\n\n\treturn wrapper.getInstance();\n\n});\n","define('extensions/adapt-contrib-spoor/js/serializers/default',[\n    'core/js/adapt'\n], function (Adapt) {\n\n    //Captures the completion status of the blocks\n    //Returns and parses a '1010101' style string\n\n    var serializer = {\n        serialize: function () {\n            return this.serializeSaveState('_isComplete');\n        },\n\n        serializeSaveState: function(attribute) {\n            if (Adapt.course.get('_latestTrackingId') === undefined) {\n                var message = \"This course is missing a latestTrackingID.\\n\\nPlease run the grunt process prior to deploying this module on LMS.\\n\\nScorm tracking will not work correctly until this is done.\";\n                console.error(message);\n            }\n\n            var excludeAssessments = Adapt.config.get('_spoor') && Adapt.config.get('_spoor')._tracking && Adapt.config.get('_spoor')._tracking._excludeAssessments;\n\n            // create the array to be serialised, pre-populated with dashes that represent unused tracking ids - because we'll never re-use a tracking id in the same course\n            var data = [];\n            var length = Adapt.course.get('_latestTrackingId') + 1;\n            for (var i = 0; i < length; i++) {\n                data[i] = \"-\";\n            }\n\n            // now go through all the blocks, replacing the appropriate dashes with 0 (incomplete) or 1 (completed) for each of the blocks\n            _.each(Adapt.blocks.models, function(model, index) {\n                var _trackingId = model.get('_trackingId'),\n                    isPartOfAssessment = model.getParent().get('_assessment'),\n                    state = model.get(attribute) ? 1: 0;\n\n                if(excludeAssessments && isPartOfAssessment) {\n                    state = 0;\n                }\n\n                if (_trackingId === undefined) {\n                    var message = \"Block '\" + model.get('_id') + \"' doesn't have a tracking ID assigned.\\n\\nPlease run the grunt process prior to deploying this module on LMS.\\n\\nScorm tracking will not work correctly until this is done.\";\n                    console.error(message);\n                } else {\n                    data[_trackingId] = state;\n                }\n            }, this);\n\n            return data.join(\"\");\n        },\n\n        deserialize: function (completion) {\n\n            _.each(this.deserializeSaveState(completion), function(state, blockTrackingId) {\n                if (state === 1) {\n                    this.markBlockAsComplete(Adapt.blocks.findWhere({_trackingId: blockTrackingId}));\n                }\n            }, this);\n\n        },    \n\n        deserializeSaveState: function (string) {\n            var completionArray = string.split(\"\");\n\n            for (var i = 0; i < completionArray.length; i++) {\n                if (completionArray[i] === \"-\") {\n                    completionArray[i] = -1;\n                } else {\n                    completionArray[i] = parseInt(completionArray[i], 10);\n                }\n            }\n\n            return completionArray;\n        },\n\n        markBlockAsComplete: function(block) {\n            if (!block) {\n                return;\n            }\n        \n            block.getChildren().each(function(child) {\n                child.set('_isComplete', true);\n            }, this);\n        }\n\n    };\n\n    return serializer;\n});\n\n","//https://raw.githubusercontent.com/oliverfoster/SCORMSuspendDataSerializer 2015-06-27\n(function(_) {\n\n\tfunction toPrecision(number, precision) {\n\t\tif (precision === undefined) precision = 2\n\t\tvar multiplier = 1 * Math.pow(10, precision);\n\t\treturn Math.round(number * multiplier) / multiplier;\n\t}\n\n\tfunction BinaryToNumber(bin, length) {\n\t\treturn parseInt(bin.substr(0, length), 2);\n\t}\n\n\tfunction NumberToBinary(number, length) {\n\t\treturn Padding.fillLeft( number.toString(2), length );\n\t}\n\n\tvar Padding = {\n\t\taddLeft: function PaddingAddLeft(str, x , char) {\n\t\t\tchar = char || \"0\";\n\t\t\treturn (new Array( x + 1)).join(char) + str;\n\t\t},\n\t\taddRight: function PaddingAddRight(str, x, char) {\n\t\t\tchar = char || \"0\";\n\t\t\treturn  str + (new Array( x + 1)).join(char);\n\t\t},\n\t\tfillLeft: function PaddingFillLeft(str, x, char) {\n\t\t\tif (str.length < x) {\n\t        \tvar paddingLength = x - str.length;\n\t        \treturn Padding.addLeft(str, paddingLength, char)\n\t        }\n\t        return str;\n\t\t},\n\t\tfillRight: function PaddingFillLeft(str, x, char) {\n\t\t\tif (str.length < x) {\n\t        \tvar paddingLength = x - str.length;\n\t        \treturn Padding.addRight(str, paddingLength, char)\n\t        }\n\t        return str;\n\t\t},\n\t\tfillBlockLeft: function PaddingFillBlockRight(str, x, char) {\n\t\t\tif (str.length % x) {\n\t        \tvar paddingLength = x - (str.length % x);\n\t        \treturn Padding.addLeft(str, paddingLength, char)\n\t        }\n\t        return str;\n\t\t},\n\t\tfillBlockRight: function PaddingFillBlockRight(str, x, char) {\n\t\t\tif (str.length % x) {\n\t        \tvar paddingLength = x - (str.length % x);\n\t        \treturn Padding.addRight(str, paddingLength, char)\n\t        }\n\t        return str;\n\t\t}\n\t};\n\n\tfunction Base64() {\n\t\tswitch (arguments.length) {\n\t\tcase 1:\n\t\t\tvar firstArgumentType = typeof arguments[0];\n\t\t\tswitch (firstArgumentType) {\n\t\t\tcase \"number\":\n\t\t\t\treturn Base64._indexes[arguments[0]];\n\t\t\tcase \"string\":\n\t\t\t\treturn Base64._chars[arguments[0]];\n\t\t\tdefault:\n\t\t\t\tthrow \"Invalid arguments type\";\n\t\t\t}\n\t\tcase 2:\n\t\t\tvar char = arguments[0];\n\t\t\tvar index = arguments[1];\n\t\t\tBase64._chars[char] = index;\n\t\t\tBase64._indexes[index] = char;\n\t\t\treturn;\n\t\tdefault:\n\t\t\tthrow \"Invalid number of arguments\";\n\t\t}\n\t}\n\tBase64._chars = {};\n\tBase64._indexes = {};\n\t(function() {\n\t\tvar alphabet = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n\t\tfor (var i = 0, l = alphabet.length; i<l; i++) {\n\t\t\tBase64(alphabet[i], i);\n\t\t}\n\t})();\n\n\n\tfunction DataType() {\n\t\tswitch (arguments.length) {\n\t\tcase 1:\n\t\t\tswitch (typeof  arguments[0]) {\n\t\t\tcase \"object\":\n\t\t\t\tvar item = arguments[0]\n\t\t\t\tif (DataType._types[item.type] === undefined) DataType._types[item.type] = [];\n\t\t\t\tDataType._types[item.type].push(item);\n\t\t\t\titem.index = DataType._indexes.length\n\t\t\t\tDataType._indexes.push(item);\n\t\t\t\tDataType[item.name] = item;\n\t\t\t\treturn;\n\t\t\tcase \"string\":\n\t\t\t\treturn DataType.getName(arguments[0]);\n\t\t\tcase \"number\":\n\t\t\t\treturn DataType.getIndex(arguments[0]);\n\t\t\tdefault:\n\t\t\t\tthrow \"Argument type not allowed\";\n\t\t\t}\n\t\tdefault:\n\t\t\tthrow \"Too many arguments\";\n\t\t}\n\t\t\n\t}\n\tDataType.VARIABLELENGTHDESCRIPTORSIZE = 8;\n\tDataType._types = {};\n\tDataType._indexes = [];\n\tDataType.getName = function DataTypeGetName(name) {\n\t\tif (DataType[name])\n\t\t\treturn DataType[name];\n\t\tthrow \"Type name not found '\"+name+\"'\";\n\t};\n\tDataType.getIndex = function DataTypeGetIndex(index) {\n\t\tif (DataType._indexes[index])\n\t\t\treturn DataType._indexes[index];\n\t\tthrow \"Type index not found '\"+index+\"'\";\n\t};\n\tDataType.getTypes = function DataTypeGetTypes(type) {\n\t\tif (DataType._types[type])\n\t\t\treturn DataType._types[type];\n\t\tthrow \"Type not found '\"+type+\"'\";\n\t};\n\tDataType.checkBounds = function DataTypeCheckBounds(name, number) {\n\t\tvar typeDef = DataType(name);\n\t\tif (number > typeDef.max) throw name + \" value is larger than \"+typeDef.max;\n\t\tif (number < typeDef.min) throw name + \" value is smaller than \"+typeDef.min;\n\t};\n\tDataType.getNumberType = function DataTypeGetNumberType(number) {\n\t\tvar isDecimal = (number - Math.floor(number)) !== 0;\n\t\tvar numberDataTypes = DataType.getTypes(\"number\");\n\t\tfor (var t = 0, type; type = numberDataTypes[t++];) {\n\t\t\tif (number <= type.max && number >= type.min && (!isDecimal || isDecimal == type.decimal) ) {\n\t\t\t\treturn type;\n\t\t\t}\n\t\t}\n\t};\n\tDataType.getVariableType = function DataTypeGetVariableType(variable) {\n\t\tvar variableNativeType = variable instanceof Array ? \"array\" : typeof variable;\n\t\tvar variableDataType;\n\n\t\tswitch(variableNativeType) {\n\t\tcase \"number\":\n\t\t\tvariableDataType = DataType.getNumberType(variable);\n\t\t\tbreak;\n\t\tcase \"string\":\n\t\t\tvariableDataType = DataType.getName(\"string\");\n\t\t\tbreak;\n\t\tdefault: \n\t\t\tvar supportedItemDataTypes = DataType.getTypes(variableNativeType);\n\t\t\tswitch (supportedItemDataTypes.length) {\n\t\t\tcase 1:\n\t\t\t\tvariableDataType = supportedItemDataTypes[0];\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow \"Type not found '\"+variableNativeType+\"'\";\n\t\t\t}\n\t\t}\n\t\n\t\tif (!variableDataType) throw \"Cannot assess type '\"+variableNativeType+\"'\";\n\n\t\treturn variableDataType;\n\t};\n\tDataType.getArrayType = function getArrayType(arr) {\n\t\tvar foundItemTypes = [];\n\n\t\tfor (var i = 0, l = arr.length; i < l; i++) {\n\t\t\tvar item = arr[i];\n\t\t\tvar itemDataType = DataType.getVariableType(item);\n\n\t\t\tif (_.findWhere(foundItemTypes, { name: itemDataType.name })) continue;\n\t\n\t\t\tfoundItemTypes.push(itemDataType);\n\t\t}\n\n\t\tswitch (foundItemTypes.length) {\n\t\tcase 0:\n\t\t\tthrow \"Cannot determine array data types\";\n\t\tcase 1:\n\t\t\t//single value type\n\t\t \treturn foundItemTypes[0];\n\t\tdefault: \n\t\t\t//many value types\n\t\t\tvar nativeTypeNames = _.pluck(foundItemTypes, 'type');\n\t\t\tvar uniqueNativeTypeNames = _.uniq(nativeTypeNames);\n\t\t\tvar hasManyNativeTypes = (uniqueNativeTypeNames.length > 1);\n\n\t\t\tif (hasManyNativeTypes) return DataType(\"variable\"); //multiple types in array\n\n\t\t\t//single native type in array, multiple datatype lengths\n\t\t\tswitch (uniqueNativeTypeNames[0]) {\n\t\t\tcase \"number\":\n\t\t\t\tvar foundDecimal = _.findWhere(foundItemTypes, { decimal: true});\n\t\t\t\tif (foundDecimal) return foundDecimal;\n\t\t\t\treturn _.max(foundItemTypes, function(type) {\n\t\t\t\t\treturn type.max;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthrow \"Unsupported data types\";\n\t\t}\n\t\t\n\t};\n\t(function() {\n\t\tvar types = [\n\t\t\t{\n\t\t\t\t\"size\": \"fixed\",\n\t\t\t\t\"length\": 1,\n\t\t\t\t\"name\": \"boolean\",\n\t\t\t\t\"type\": \"boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"max\": 15,\n\t\t\t\t\"min\": 0,\n\t\t\t\t\"decimal\": false,\n\t\t\t\t\"size\": \"fixed\",\n\t\t\t\t\"length\": 4,\n\t\t\t\t\"name\": \"half\",\n\t\t\t\t\"type\": \"number\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"max\": 255,\n\t\t\t\t\"min\": 0,\n\t\t\t\t\"decimal\": false,\n\t\t\t\t\"size\": \"fixed\",\n\t\t\t\t\"length\": 8,\n\t\t\t\t\"name\": \"byte\",\n\t\t\t\t\"type\": \"number\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"max\": 65535,\n\t\t\t\t\"min\": 0,\n\t\t\t\t\"decimal\": false,\n\t\t\t\t\"size\": \"fixed\",\n\t\t\t\t\"length\": 16,\n\t\t\t\t\"name\": \"short\",\n\t\t\t\t\"type\": \"number\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"max\": 4294967295,\n\t\t\t\t\"min\": 0,\n\t\t\t\t\"decimal\": false,\n\t\t\t\t\"size\": \"fixed\",\n\t\t\t\t\"length\": 32,\n\t\t\t\t\"name\": \"long\",\n\t\t\t\t\"type\": \"number\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"max\": 4294967295,\n\t\t\t\t\"min\": -4294967295,\n\t\t\t\t\"decimal\": true,\n\t\t\t\t\"precision\": 2,\n\t\t\t\t\"size\": \"variable\",\n\t\t\t\t\"name\": \"double\",\n\t\t\t\t\"type\": \"number\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"base16\",\n\t\t\t\t\"size\": \"variable\",\n\t\t\t\t\"type\": \"string\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"base64\",\n\t\t\t\t\"size\": \"variable\",\n\t\t\t\t\"type\": \"string\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"array\",\n\t\t\t\t\"size\": \"variable\",\n\t\t\t\t\"type\": \"array\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"variable\",\n\t\t\t\t\"size\": \"variable\",\n\t\t\t\t\"type\": \"variable\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"string\",\n\t\t\t\t\"size\": \"variable\",\n\t\t\t\t\"type\": \"string\"\n\t\t\t}\n\t\t];\n\t\tfor (var i = 0, type; type = types[i++];) {\n\t\t\tDataType(type);\n\t\t}\n\t})();\n\n\t\n\n\tfunction Converter(fromType, toType) {\n\t\tfromType = Converter.translateTypeAlias(fromType);\n\t\ttoType = Converter.translateTypeAlias(toType);\n\n\t\tvar args = [].slice.call(arguments, 2);\n\n\t\tif (fromType != \"binary\" && toType != \"binary\") {\n\t\t\tif (!Converter._converters[fromType]) throw \"Type not found '\" + fromType + \"'\";\n\t\t\tif (!Converter._converters[fromType]['binary']) throw \"Type not found 'binary'\";\n\t\t\t\n\t\t\tvar bin = Converter._converters[fromType]['binary'].call(this, args[0], Converter.WRAPOUTPUT);\n\n\t\t\tif (!Converter._converters['binary'][toType]) throw \"Type not found '\"+toType+\"'\";\n\n\t\t\treturn Converter._converters['binary'][toType].call(this, bin, Converter.WRAPOUTPUT);\n\t\t}\n\n\t\tif (!Converter._converters[fromType]) throw \"Type not found '\" + fromType + \"'\";\n\t\tif (!Converter._converters[fromType][toType]) throw \"Type not found '\" + toType + \"'\";\n\n\t\treturn Converter._converters[fromType][toType].call(this, args[0], Converter.WRAPOUTPUT);\n\t}\n\tConverter.WRAPOUTPUT = false;\n\tConverter.translateTypeAlias = function ConverterTranslateTypeAlias(type) {\n\t\ttype = type.toLowerCase();\n\t\tfor (var Type in Converter._typeAliases) {\n\t\t\tif (Type == type || (\" \"+Converter._typeAliases[Type].join(\" \")+\" \").indexOf(\" \"+type+\" \") >= 0 ) return Type;\n\t\t}\n\t\tthrow \"Type not found '\" + type + \"'\";\n\t};\n\tConverter._typeAliases = {\n\t\t\"base64\": [ \"b64\" ],\n\t\t\"base16\" : [ \"hex\", \"b16\" ],\n\t\t\"double\": [ \"dbl\", \"decimal\", \"d\" ],\n\t\t\"long\": [ \"lng\", \"l\" ],\n\t\t\"short\": [ \"s\" ],\n\t\t\"byte\" : [ \"b\" ],\n\t\t\"half\": [ \"h\" ],\n\t\t\"number\": [ \"num\", \"n\" ],\n\t\t\"binary\": [ \"bin\" ],\n\t\t\"boolean\": [ \"bool\" ],\n\t\t\"array\": [ \"arr\" ]\n\t};\n\tConverter._variableWrapLength = function ConverterVariableWrapLength(bin) {\n\t\tvar variableLength = bin.length;\n\t\tvar binLength = NumberToBinary(variableLength, DataType.VARIABLELENGTHDESCRIPTORSIZE)\n\n\t\treturn binLength + bin;\n\t};\n\tConverter._variableLength = function ConverterVariableLength(bin) {\n\t\tvar VLDS =  DataType.VARIABLELENGTHDESCRIPTORSIZE;\n\t\tvar variableLength = BinaryToNumber(bin, VLDS );\n\t\treturn variableLength;\n\t};\n\tConverter._variableUnwrapLength = function ConverterVariableUnwrapLength(bin) {\n\t\tvar VLDS =  DataType.VARIABLELENGTHDESCRIPTORSIZE;\n\t\tvar variableLength = BinaryToNumber(bin, VLDS );\n\n\t\treturn bin.substr( VLDS, variableLength);\n\t};\n\tConverter._converters = {\n\t\t\"base64\": {\n\t\t\t\"binary\": function ConverterBase64ToBinary(base64) { //TODO PADDING... ?\n\t\t\t\tvar firstByte = Base64(base64.substr(0,1));\n\t\t\t\tvar binFirstByte = NumberToBinary(firstByte, 6);\n\t\t\t\tvar paddingLength = BinaryToNumber(binFirstByte, 6);\n\n\t\t\t    var bin = \"\";\n\t\t\t    for (var i = 0, ch; ch = base64[i++];) {\n\t\t\t        var block = Base64(ch).toString(2);\n\t\t\t        block = Padding.fillLeft(block, 6);\n\t\t\t        bin += block;\n\t\t\t    }\n\t\t\t    bin =  bin.substr(6+paddingLength);\n\t\t\t    return bin;\n\t\t\t}\n\t\t},\n\t\t\"base16\": {\n\t\t\t\"binary\": function ConverterBase16ToBinary(hex) {\n\t\t\t\tvar firstByte = Base64(base64.substr(0,1));\n\t\t\t\tvar binFirstByte = NumberToBinary(firstByte, 4);\n\t\t\t\tvar paddingLength = BinaryToNumber(binFirstByte, 4);\n\n\t\t\t    var bin = \"\";\n\t\t\t    for (var i = 0, ch; ch = hex[i++];) {\n\t\t\t        var block = parseInt(ch, 16).toString(2);\n\t\t\t        block = Padding.fillLeft(block, 4);\n\t\t\t        bin += block;\n\t\t\t    }\n\n\t\t\t     bin =  bin.substr(6+paddingLength);\n\t\t\t    return bin;\n\t\t\t}\n\t\t},\n\t\t\"double\": {\n\t\t\t\"binary\": function ConverterDoubleToBinary(dbl, wrap) {\n\t\t\t\tvar typeDef = DataType(\"double\");\n\t\t\t\tDataType.checkBounds(\"double\", dbl);\n\n\t\t\t\tdbl = toPrecision(dbl, typeDef.precision);\n\n\t\t\t\tvar dblStr = dbl.toString(10);\n\n\t\t\t\tvar isMinus = dbl < 0;\n\t\t\t\n\t\t\t\tvar baseStr, exponentStr, highStr, lowStr, decimalPosition, hasDecimal;\n\n\t\t\t\t\n\t\t\t\tvar exponentPos = dblStr.indexOf(\"e\");\n\t\t\t\tif (exponentPos > -1) {\n\t\t\t\t\t//exponential float representation \"nE-x\"\n\t\t\t\t\tbaseStr = dblStr.substr(0, exponentPos);\n\t\t\t\t\texponentStr = Math.abs(dblStr.substr(exponentPos+1));\n\n\t\t\t\t\tif (isMinus) baseStr = baseStr.substr(1);\n\n\t\t\t\t\tdecimalPosition = baseStr.indexOf(\".\");\n\t\t\t\t\thasDecimal = (decimalPosition > -1);\n\n\t\t\t\t\tif (hasDecimal) {\n\t\t\t\t\t\thighStr = baseStr.substr(0, decimalPosition);\n\t\t\t\t\t\tlowStr = baseStr.substr(decimalPosition+1);\n\n\t\t\t\t\t\texponentStr = (Math.abs(exponentStr) + lowStr.length);\n\n\t\t\t\t\t\tbaseStr = highStr + lowStr;\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\t//normal long float representation \"0.00000000\"\n\t\t\t\t\tbaseStr = dblStr;\n\t\t\t\t\texponentStr = \"0\";\n\n\t\t\t\t\tif (isMinus) dblStr = dblStr.substr(1);\n\n\t\t\t\t\tdecimalPosition = dblStr.indexOf(\".\");\n\t\t\t\t\thasDecimal = (decimalPosition > -1);\n\t\t\t\t\tif (hasDecimal) {\n\t\t\t\t\t\thighStr = dblStr.substr(0, decimalPosition);\n\t\t\t\t\t\tlowStr = dblStr.substr(decimalPosition+1);\n\n\t\t\t\t\t\texponentStr = (lowStr.length);\n\t\t\t\t\t\tif (highStr == \"0\") {\n\t\t\t\t\t\t\tbaseStr = parseInt(lowStr, 10).toString(10);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbaseStr = highStr + lowStr;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbaseStr = dblStr;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tvar bin = [];\n\n\t\t\t\tvar binLong = Padding.fillBlockLeft (parseInt(baseStr, 10).toString(2), 4);\n\t\t\t\tvar binMinus = isMinus ? \"1\" : \"0\";\n\t\t\t\tvar binExponent = Padding.fillLeft( parseInt(exponentStr, 10).toString(2), 7);\n\t\t\t\t\n\t\t\t\tbin.push( binMinus );\n\t\t\t\tbin.push( binExponent );\n\t\t\t\tbin.push( binLong );\n\n\t\t\t\tif (wrap === false) {\n\t\t\t\t\treturn bin.join(\"\");\n\t\t\t\t} else {\n\t\t\t\t\treturn Converter._variableWrapLength(bin.join(\"\"));\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t\"long\": {\n\t\t\t\"binary\": function ConverterLongToBinary(value) {\n\t\t\t\tvar typeDef = DataType(\"long\");\n\t\t\t\tDataType.checkBounds(\"long\", value);\n\t\t\t\tvalue = toPrecision(value, 0);\n\t\t\t\treturn Padding.fillLeft(value.toString(2), typeDef.length);\n\t\t\t}\n\t\t},\n\t\t\"short\": {\n\t\t\t\"binary\": function ConverterShortToBinary(value) {\n\t\t\t\tvar typeDef = DataType(\"short\");\n\t\t\t\tDataType.checkBounds(\"short\", value);\n\t\t\t\tvalue = toPrecision(value, 0);\n\t\t\t\treturn Padding.fillLeft(value.toString(2), typeDef.length);\n\t\t\t}\n\t\t},\n\t\t\"byte\": {\n\t\t\t\"binary\": function ConverterByteToBinary(value) {\n\t\t\t\tvar typeDef = DataType(\"byte\");\n\t\t\t\tDataType.checkBounds(\"byte\", value);\n\t\t\t\tvalue = toPrecision(value, 0);\n\t\t\t\treturn Padding.fillLeft(value.toString(2), typeDef.length);\n\t\t\t}\n\t\t},\n\t\t\"half\": {\n\t\t\t\"binary\": function ConverterHalfToBinary(value) {\n\t\t\t\tvar typeDef = DataType(\"half\");\n\t\t\t\tDataType.checkBounds(\"half\", value);\n\t\t\t\tvalue = toPrecision(value, 0);\n\t\t\t\treturn Padding.fillLeft(value.toString(2), typeDef.length);\n\t\t\t}\n\t\t},\n\t\t\"boolean\": {\n\t\t\t\"binary\": function ConverterBooleanToBinary(bool) {\n\t\t\t\treturn bool ? \"1\" : \"0\";\n\t\t\t},\n\t\t},\n\t\t\"array\": {\n\t\t\t\"binary\": function ConverterArrayToBinary(arr, wrap) { //TODO PADDING NOT GOOD\n\t\t\t\tvar typeDef = DataType(\"array\");\n\t\t\t\tvar arrayItemType = DataType.getArrayType(arr);\n\t\t\t\tvar isVariableArray = arrayItemType.name == \"vairable\";\n\n\t\t\t\tif (isVariableArray) {\n\t\t\t\t\tvar bin = half2bin(15);\n\t\t\t\t\t//variable array\n\t\t\t\t\treturn bin;\n\t\t\t\t} else {\n\t\t\t\t\tvar binArrayIdentifier = Converter._converters['half']['binary'](arrayItemType.index);\n\n\t\t\t\t\tvar binItemsArray = [];\n\t\t\t\t\tfor (var i = 0, l = arr.length; i < l; i++) {\n\t\t\t\t\t\tvar item = arr[i];\n\t\t\t\t\t\tvar binItem = Converter._converters[arrayItemType.name]['binary'](item);\n\t\t\t\t\t\t//console.log(\"binItem\", binItem);\n\t\t\t\t\t\tbinItemsArray.push( binItem );\n\t\t\t\t\t}\n\n\t\t\t\t\tvar binItems = binItemsArray.join(\"\");\n\n\t\t\t\t\tvar paddingLength = 0;\n\t\t\t\t\tif (binItems.length % 4) paddingLength = 4 - (binItems.length % 4);\n\t\t\t\t\tvar binPaddingLen = NumberToBinary(paddingLength, 2);\n\n\t\t\t\t\tvar binPadding = (new Array(paddingLength+1)).join(\"0\");\n\n\t\t\t\t\tvar bin = [];\n\t\t\t\t\tbin.push(binArrayIdentifier);\n\t\t\t\t\tbin.push(binPaddingLen);\n\t\t\t\t\tbin.push(binPadding);\n\t\t\t\t\tbin.push(binItems);\n\n\t\t\t\t\tvar finished = bin.join(\"\");\n\t\t\t\t\t//console.log(\"unwrapped\", finished);\n\n\t\t\t\t\tif (wrap === false) return finished;\n\n\t\t\t\t\tvar wrapped = Converter._variableWrapLength( finished);\n\t\t\t\t\t//console.log(\"wrapped\", wrapped);\n\n\t\t\t\t\treturn wrapped;\n\t\t\t\t}\n\n\t\t\t}\n\t\t},\n\t\t\"binary\": {\n\t\t\t\"array\": function ConverterBinaryToArray(bin, wrap) { //TODO PADDING NOT GOOD\n\t\t\t\tvar typeDef = DataType(\"array\");\n\n\t\t\t\t//console.log(\"wrapped\", bin);\n\t\t\t\tif (wrap !== false)\n\t\t\t\t\tbin = Converter._variableUnwrapLength( bin);\n\t\t\t\t//console.log(\"unwrapped\", bin);\n\n\t\t\t\tvar binArrayIdentifier = bin.substr(0, 4);\n\t\t\t\tvar binPaddingLen = bin.substr(4 , 2);\n\n\t\t\t\tvar arrayIdentifier = Converter._converters['binary'][ 'half' ]( binArrayIdentifier );\n\t\t\t\tvar paddingLength = BinaryToNumber( binPaddingLen, 2 );\n\n\t\t\t\tvar dataStart = 4 + 2 + paddingLength;\n\t\t\t\tvar dataLength = bin.length - dataStart;\n\n\t\t\t\tvar binItems = bin.substr(dataStart, dataLength );\n\n\t\t\t\tvar arrayItemType = DataType(arrayIdentifier);\n\t\t\t\tvar isVariableArray = arrayItemType.name == \"variable\";\n\n\t\t\t\tvar rtn = [];\n\t\t\t\tif (isVariableArray) {\n\n\t\t\t\t} else {\n\t\t\t\t\tvar hasVariableLengthChildren = arrayItemType.size == \"variable\";\n\t\t\t\t\tif (hasVariableLengthChildren) {\n\t\t\t\t\t\tvar VLDS = DataType.VARIABLELENGTHDESCRIPTORSIZE;\n\t\t\t\t\t\twhile ( binItems != \"\" ) {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar variableLength = Converter._variableLength( binItems );\n\t\t\t\t\t\t\tvar binItem = binItems.substr(0, VLDS + variableLength);\n\t\t\t\t\t\t\tbinItems = binItems.substr(VLDS+variableLength);\n\t\t\t\t\t\t\t//console.log(\"binItem\", binItem, BinaryToNumber(binItem, 16));\n\n\t\t\t\t\t\t\trtn.push( Converter._converters['binary'][ arrayItemType.name ]( binItem) );\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\twhile ( binItems != \"\" ) {\n\t\t\t\t\t\t\tvar binItem = binItems.substr(0, arrayItemType.length);\n\t\t\t\t\t\t\tbinItems = binItems.substr(arrayItemType.length);\n\n\t\t\t\t\t\t\trtn.push( Converter._converters['binary'][ arrayItemType.name ](binItem) );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\n\t\t\t\treturn rtn;\n\n\t\t\t},\n\t\t\t\"base64\": function ConverterBinaryToBase64(bin) { //TODO PADDING NOT GOOD\n\t\t\t\tvar paddingLength = 0;\n\t\t\t\tif (bin.length % 6) paddingLength = 6 - (bin.length % 6);\n\t\t\t\tbinPaddingLen = NumberToBinary(paddingLength, 6);\n\t\t\t\tbinPadding = Padding.addLeft(\"\", paddingLength);\n\t\t\t\tbin = binPaddingLen + binPadding + bin;\n\n\t\t\t\tvar binLength = bin.length;\n\t\t\t    var base64 = \"\";\n\t\t\t    for (var b = 0; b < 10000; b++) {\n\t\t\t        if (b*6 >= binLength) break;\n\t\t\t     \n\t\t\t        var block = bin.substr(b*6,6);\n\t\t\t        base64 += Base64(parseInt(block, 2));\n\t\t\t    }\n\n\t\t\t    return base64;\n\t\t\t},\n\t\t\t\"base16\": function ConverterBinaryToBase16(bin) {\n\t\t\t\tvar paddingLength = 0;\n\t\t\t\tif (bin.length % 4) paddingLength = 4 - (bin.length % 4);\n\t\t\t\tbinPaddingLen = NumberToBinary(paddingLength, 4);\n\t\t\t\tbinPadding = Padding.addLeft(\"\", paddingLength);\n\t\t\t\tbin = binPaddingLen + binPadding + bin;\n\n\t\t\t    var binLength = bin.length;\n\t\t\t    var hex = \"\";\n\t\t\t    for (var b = 0; b < 10000; b++) {\n\t\t\t        if (b*4 >= binLength) break;\n\t\t\t     \n\t\t\t        var block = bin.substr(b*4,4);\n\t\t\t        hex += parseInt(block, 2).toString(16);\n\t\t\t    }\n\t\t\t    return hex;\n\t\t\t},\n\t\t\t\"double\": function ConverterBinaryToDouble(bin, wrap) {\n\t\t\t\tvar typeDef = DataType(\"double\");\n\t\t\t\t\n\t\t\t\tif (wrap !== false)\n\t\t\t\t\tbin = Converter._variableUnwrapLength(bin);\n\n\t\t\t\tvar isMinus = bin.substr(0 ,1) == 1;\n\n\t\t\t\tvar exponentByte = parseInt(\"0\" + bin.substr(1, 7), 2);\n\t\t\t\tvar baseLong = parseInt( bin.substr(8, bin.length), 2);\n\n\t\t\t\tvar dbl = parseFloat(baseLong+\"E-\"+exponentByte, 10);\n\t\t\t\tif (isMinus) dbl = dbl * -1;\n\n\t\t\t\treturn dbl;\n\t\t\t},\n\t\t\t\"long\": function ConverterBinaryToLong(bin) {\n\t\t\t\treturn parseInt(bin.substr(0, 32), 2);\n\t\t\t},\n\t\t\t\"short\": function ConverterBinaryToShort(bin) {\n\t\t\t\treturn parseInt(bin.substr(0, 16), 2);\n\t\t\t},\n\t\t\t\"byte\": function ConverterBinaryToByte(bin) {\n\t\t\t\treturn parseInt(bin.substr(0, 8), 2);\n\t\t\t},\n\t\t\t\"half\": function ConverterBinaryToHalf(bin) {\n\t\t\t\treturn parseInt(bin.substr(0, 4), 2);\n\t\t\t},\n\t\t\t\"boolean\": function ConverterBinaryToBoolean(bin) {\n\t\t\t\treturn bin.substr(0,1) == \"1\" ? true: false;\n\t\t\t},\n\t\t\t\"number\": function ConverterBinaryToNumber(bin) {\n\t\t\t\treturn parseInt(bin, 2);\n\t\t\t}\n\t\t}\n\t};\n\t\n\twindow.SCORMSuspendData = {\n\t\tserialize: function SCORMSuspendDataSerialize(arr) {\n\t\t\treturn Converter (\"array\", \"base64\", arr);\n\t\t},\n\t\tdeserialize: function SCORMSuspendDataDeserialize(base64) {\n\t\t\treturn Converter(\"base64\", \"array\", base64);\n\t\t},\n\t\tBase64: Base64,\n\t\tConverter: Converter,\n\t\tDataType: DataType\n\t};\n\n\n})(_);\n\ndefine(\"extensions/adapt-contrib-spoor/js/serializers/scormSuspendDataSerializer\", function(){});\n\n","define('extensions/adapt-contrib-spoor/js/serializers/questions',[\n    'core/js/adapt',\n    './scormSuspendDataSerializer'\n], function (Adapt) {\n\n    //Captures the completion status and user selections of the question components\n    //Returns and parses a base64 style string\n    var includes = {\n        \"_isQuestionType\": true,\n        \"_isResetOnRevisit\": false\n    };\n\n    var serializer = {\n        serialize: function () {\n            return this.serializeSaveState();\n        },\n\n        serializeSaveState: function() {\n            if (Adapt.course.get('_latestTrackingId') === undefined) {\n                var message = \"This course is missing a latestTrackingID.\\n\\nPlease run the grunt process prior to deploying this module on LMS.\\n\\nScorm tracking will not work correctly until this is done.\";\n                console.error(message);\n                return \"\";\n            }\n\n            var rtn = \"\";\n            try {\n                var data = this.captureData();\n                if (data.length === 0) return \"\";\n                rtn = SCORMSuspendData.serialize(data);\n            } catch(e) {\n                console.error(e);\n            }\n\n            return rtn;\n        },\n\n        captureData: function() {\n            var data = [];\n            \n            var trackingIds = Adapt.blocks.pluck(\"_trackingId\");\n            var blocks = {};\n            var countInBlock = {};\n\n            for (var i = 0, l = trackingIds.length; i < l; i++) {\n\n                var trackingId = trackingIds[i];\n                var blockModel = Adapt.blocks.findWhere({_trackingId: trackingId });\n                var componentModels = blockModel.getChildren().where(includes);\n\n                for (var c = 0, cl = componentModels.length; c < cl; c++) {\n\n                    var component = componentModels[c].toJSON();\n                    var blockId = component._parentId;\n\n                    if (!blocks[blockId]) {\n                        blocks[blockId] = blockModel.toJSON();\n                    }\n\n                    var block = blocks[blockId];\n                    if (countInBlock[blockId] === undefined) countInBlock[blockId] = -1;\n                    countInBlock[blockId]++;\n\n                    var blockLocation = countInBlock[blockId];\n\n                    if (component['_isInteractionComplete'] === false || component['_isComplete'] === false) {\n                        //if component is not currently complete skip it\n                        continue;\n                    }\n\n                    var hasUserAnswer = (component['_userAnswer'] !== undefined);\n                    var isUserAnswerArray = (component['_userAnswer'] instanceof Array);\n\n\n                    var numericParameters = [\n                            blockLocation,\n                            block['_trackingId'],\n                            component['_score'] || 0,\n                            component['_attemptsLeft'] || 0\n                        ];\n\n                    var booleanParameters = [\n                            hasUserAnswer,\n                            isUserAnswerArray,\n                            component['_isInteractionComplete'],\n                            component['_isSubmitted'],\n                            component['_isCorrect'] || false\n                        ];\n\n                    var dataItem = [\n                        numericParameters,\n                        booleanParameters\n                    ];\n\n\n                    if (hasUserAnswer) {\n                        var userAnswer = isUserAnswerArray ? component['_userAnswer'] : [component['_userAnswer']];\n\n                        var arrayType = SCORMSuspendData.DataType.getArrayType(userAnswer);\n\n                        switch(arrayType.name) {\n                        case \"string\": case \"variable\":\n                            console.log(\"Cannot store _userAnswers from component \" + component._id + \" as array is of variable or string type.\");\n                            continue;\n                        }\n\n                        dataItem.push(userAnswer);\n                    }\n\n                    data.push(dataItem);\n\n                }\n\n            }\n\n            return data;\n\n        },\n\n        deserialize: function (str) {\n\n            try {\n                var data = SCORMSuspendData.deserialize(str);\n                this.releaseData( data );\n            } catch(e) {\n                console.error(e);\n            }\n            \n        },    \n\n        releaseData: function (arr) {\n            \n            for (var i = 0, l = arr.length; i < l; i++) {\n                var dataItem = arr[i];\n\n                var numericParameters = dataItem[0];\n                var booleanParameters = dataItem[1];\n\n                var blockLocation = numericParameters[0];\n                var trackingId = numericParameters[1];\n                var score = numericParameters[2];\n                var attemptsLeft = numericParameters[3] || 0;\n\n                var hasUserAnswer = booleanParameters[0];\n                var isUserAnswerArray = booleanParameters[1];\n                var isInteractionComplete = booleanParameters[2];\n                var isSubmitted = booleanParameters[3];\n                var isCorrect = booleanParameters[4];\n\n                var block = Adapt.blocks.findWhere({_trackingId: trackingId});\n                var components = block.getChildren();\n                components = components.where(includes);\n                var component = components[blockLocation];\n\n                component.set(\"_isComplete\", true);\n                component.set(\"_isInteractionComplete\", isInteractionComplete);\n                component.set(\"_isSubmitted\", isSubmitted);\n                component.set(\"_score\", score);\n                component.set(\"_isCorrect\", isCorrect);\n                component.set(\"_attemptsLeft\", attemptsLeft);\n\n                if (hasUserAnswer) {\n                    var userAnswer = dataItem[2];\n                    if (!isUserAnswerArray) userAnswer = userAnswer[0];\n\n                    component.set(\"_userAnswer\", userAnswer);\n                }\n\n\n            }\n        }\n    };\n\n    return serializer;\n});\n\n","define('extensions/adapt-contrib-spoor/js/adapt-stateful-session',[\n\t'core/js/adapt',\n\t'./serializers/default',\n\t'./serializers/questions'\n], function(Adapt, serializer, questions) {\n\n\t//Implements Adapt session statefulness\n\t\n\tvar AdaptStatefulSession = _.extend({\n\n\t\t_config: null,\n\t\t_shouldStoreResponses: false,\n\t\t_shouldRecordInteractions: true,\n\n\t//Session Begin\n\t\tinitialize: function() {\n\t\t\tthis._onWindowUnload = _.bind(this.onWindowUnload, this);\n\t\t\tthis.getConfig();\n\t\t\tthis.restoreSessionState();\n\t\t\t/*\n\t\t\tdeferring this prevents restoring the completion state of the blocks from triggering a setSuspendData call for each block that gets its completion state restored\n\t\t\twe should be able to remove this if/when we implement the feature that allows plugins like spoor to pause course initialisation\n\t\t\t*/\n\t\t\t_.defer(_.bind(this.setupEventListeners, this));\n\t\t},\n\n\t\tgetConfig: function() {\n\t\t\tthis._config = Adapt.config.has('_spoor') ? Adapt.config.get('_spoor') : false;\n\t\t\t\n\t\t\tthis._shouldStoreResponses = (this._config && this._config._tracking && this._config._tracking._shouldStoreResponses);\n\t\t\t\n\t\t\t// default should be to record interactions, so only avoid doing that if _shouldRecordInteractions is set to false\n\t\t\tif (this._config && this._config._tracking && this._config._tracking._shouldRecordInteractions === false) {\n\t\t\t\tthis._shouldRecordInteractions = false;\n\t\t\t}\n\t\t},\n\n\t\tsaveSessionState: function() {\n\t\t\tvar sessionPairs = this.getSessionState();\n\t\t\tAdapt.offlineStorage.set(sessionPairs);\n\t\t},\n\n\t\trestoreSessionState: function() {\n\t\t\tvar sessionPairs = Adapt.offlineStorage.get();\n\t\t\tvar hasNoPairs = _.keys(sessionPairs).length === 0;\n\n\t\t\tif (hasNoPairs) return;\n\n\t\t\tif (sessionPairs.completion) serializer.deserialize(sessionPairs.completion);\n\t\t\tif (sessionPairs.questions && this._shouldStoreResponses) questions.deserialize(sessionPairs.questions);\n\t\t\tif (sessionPairs._isCourseComplete) Adapt.course.set('_isComplete', sessionPairs._isCourseComplete);\n\t\t\tif (sessionPairs._isAssessmentPassed) Adapt.course.set('_isAssessmentPassed', sessionPairs._isAssessmentPassed);\n\t\t},\n\n\t\tgetSessionState: function() {\n\t\t\tvar sessionPairs = {\n\t\t\t\t\"completion\": serializer.serialize(),\n\t\t\t\t\"questions\": (this._shouldStoreResponses === true ? questions.serialize() : \"\"),\n\t\t\t\t\"_isCourseComplete\": Adapt.course.get(\"_isComplete\") || false,\n\t\t\t\t\"_isAssessmentPassed\": Adapt.course.get('_isAssessmentPassed') || false\n\t\t\t};\n\t\t\treturn sessionPairs;\n\t\t},\n\n\t//Session In Progress\n\t\tsetupEventListeners: function() {\n\t\t\t$(window).on('beforeunload unload', this._onWindowUnload);\n\n\t\t\tif (this._shouldStoreResponses) {\n\t\t\t\tthis.listenTo(Adapt.components, 'change:_isInteractionComplete', this.onQuestionComponentComplete);\n\t\t\t}\n\n\t\t\tif(this._shouldRecordInteractions) {\n\t\t\t\tthis.listenTo(Adapt, 'questionView:recordInteraction', this.onQuestionRecordInteraction);\n\t\t\t}\n\n\t\t\tthis.listenTo(Adapt.blocks, 'change:_isComplete', this.onBlockComplete);\n\t\t\tthis.listenTo(Adapt.course, 'change:_isComplete', this.onCompletion);\n\t\t\tthis.listenTo(Adapt, 'assessment:complete', this.onAssessmentComplete);\n\t\t\tthis.listenTo(Adapt, 'app:languageChanged', this.onLanguageChanged);\n\t\t},\n\n\t\tremoveEventListeners: function () {\n\t\t\t$(window).off('beforeunload unload', this._onWindowUnload);\n\t\t\tthis.stopListening();\n\t\t},\n\n\t\treattachEventListeners: function() {\n\t\t\tthis.removeEventListeners();\n\t\t\tthis.setupEventListeners();\n\t\t},\n\n\t\tonBlockComplete: function(block) {\n\t\t\tthis.saveSessionState();\n\t\t},\n\n\t\tonQuestionComponentComplete: function(component) {\n\t\t\tif (!component.get(\"_isQuestionType\")) return;\n\n\t\t\tthis.saveSessionState();\n\t\t},\n\n\t\tonCompletion: function() {\n\t\t\tif (!this.checkTrackingCriteriaMet()) return;\n\n\t\t\tthis.saveSessionState();\n\t\t\t\n\t\t\tAdapt.offlineStorage.set(\"status\", this._config._reporting._onTrackingCriteriaMet);\n\t\t},\n\n\t\tonAssessmentComplete: function(stateModel) {\n\t\t\tAdapt.course.set('_isAssessmentPassed', stateModel.isPass);\n\t\t\t\n\t\t\tthis.saveSessionState();\n\n\t\t\tthis.submitScore(stateModel);\n\n\t\t\tif (stateModel.isPass) {\n\t\t\t\tthis.onCompletion();\n\t\t\t} else if (this._config && this._config._tracking._requireAssessmentPassed) {\n\t\t\t\tthis.submitAssessmentFailed();\n\t\t\t}\n\t\t},\n\n\t\tonQuestionRecordInteraction:function(questionView) {\n\t\t\tvar responseType = questionView.getResponseType();\n\n\t\t\t// if responseType doesn't contain any data, assume that the question component hasn't been set up for cmi.interaction tracking\n\t\t\tif(_.isEmpty(responseType)) return;\n\n\t\t\tvar id = questionView.model.get('_id');\n\t\t\tvar response = questionView.getResponse();\n\t\t\tvar result = questionView.isCorrect();\n\t\t\tvar latency = questionView.getLatency();\n\t\t\t\n\t\t\tAdapt.offlineStorage.set(\"interaction\", id, response, result, latency, responseType);\n\t\t},\n\n\t\t/**\n\t\t * when the user switches language, we need to:\n\t\t * - reattach the event listeners as the language change triggers a reload of the json, which will create brand new collections\n\t\t * - get and save a fresh copy of the session state. as the json has been reloaded, the blocks completion data will be reset (the user is warned that this will happen by the language picker extension)\n\t\t * - check to see if the config requires that the lesson_status be reset to 'incomplete'\n\t\t */\n\t\tonLanguageChanged: function () {\n\t\t\tthis.reattachEventListeners();\n\n\t\t\tthis.saveSessionState();\n\t\t\t\n\t\t\tif (this._config._reporting && this._config._reporting._resetStatusOnLanguageChange === true) {\n\t\t\t\tAdapt.offlineStorage.set(\"status\", \"incomplete\");\n\t\t\t}\n\t\t},\n\n\t\tsubmitScore: function(stateModel) {\n\t\t\tif (this._config && !this._config._tracking._shouldSubmitScore) return;\n\n\t\t\tif (stateModel.isPercentageBased) {\n\t\t\t\tAdapt.offlineStorage.set(\"score\", stateModel.scoreAsPercent, 0, 100);\n\t\t\t} else {\n\t\t\t\tAdapt.offlineStorage.set(\"score\", stateModel.score, 0, stateModel.maxScore);\n\t\t\t}\n\t\t},\n\n\t\tsubmitAssessmentFailed: function() {\n\t\t\tif (this._config && this._config._reporting.hasOwnProperty(\"_onAssessmentFailure\")) {\n\t\t\t\tvar onAssessmentFailure = this._config._reporting._onAssessmentFailure;\n\t\t\t\tif (onAssessmentFailure === \"\") return;\n\t\t\t\t\t\n\t\t\t\tAdapt.offlineStorage.set(\"status\", onAssessmentFailure);\n\t\t\t}\n\t\t},\n\t\t\n\t\tcheckTrackingCriteriaMet: function() {\n\t\t\tvar criteriaMet = false;\n\n\t\t\tif (!this._config) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (this._config._tracking._requireCourseCompleted && this._config._tracking._requireAssessmentPassed) { // user must complete all blocks AND pass the assessment\n\t\t\t\tcriteriaMet = (Adapt.course.get('_isComplete') && Adapt.course.get('_isAssessmentPassed'));\n\t\t\t} else if (this._config._tracking._requireCourseCompleted) { //user only needs to complete all blocks\n\t\t\t\tcriteriaMet = Adapt.course.get('_isComplete');\n\t\t\t} else if (this._config._tracking._requireAssessmentPassed) { // user only needs to pass the assessment\n\t\t\t\tcriteriaMet = Adapt.course.get('_isAssessmentPassed');\n\t\t\t}\n\n\t\t\treturn criteriaMet;\n\t\t},\n\n\t//Session End\n\t\tonWindowUnload: function() {\n\t\t\tthis.removeEventListeners();\n\t\t}\n\t\t\n\t}, Backbone.Events);\n\n\treturn AdaptStatefulSession;\n\n});\n","define('extensions/adapt-contrib-spoor/js/adapt-offlineStorage-scorm',[\n\t'core/js/adapt',\n\t'./scorm',\n\t'core/js/offlineStorage'\n], function(Adapt, scorm) {\n\n\t//SCORM handler for Adapt.offlineStorage interface.\n\n\t//Stores to help handle posting and offline uniformity\n\tvar temporaryStore = {};\n\tvar suspendDataStore = {};\n\tvar suspendDataRestored = false;\n\n\tAdapt.offlineStorage.initialize({\n\n\t\tget: function(name) {\n\t\t\tif (name === undefined) {\n\t\t\t\t//If not connected return just temporary store.\n\t\t\t\tif (this.useTemporaryStore()) return temporaryStore;\n\n\t\t\t\t//Get all values as a combined object\n\t\t\t\tsuspendDataStore = this.getCustomStates();\n\n\t\t\t\tvar data = _.extend(_.clone(suspendDataStore), {\n\t\t\t\t\tlocation: scorm.getLessonLocation(),\n\t\t\t\t\tscore: scorm.getScore(),\n\t\t\t\t\tstatus: scorm.getStatus(),\n\t\t\t\t\tstudent: scorm.getStudentName(),\n\t\t\t\t\tlearnerInfo: this.getLearnerInfo()\n\t\t\t\t});\n\n\t\t\t\tsuspendDataRestored = true;\n\t\t\t\t\n\t\t\t\treturn data;\n\t\t\t}\n\n\t\t\t//If not connected return just temporary store value.\n\t\t\tif (this.useTemporaryStore()) return temporaryStore[name];\n\n\t\t\t//Get by name\n\t\t\tswitch (name.toLowerCase()) {\n\t\t\t\tcase \"location\":\n\t\t\t\t\treturn scorm.getLessonLocation();\n\t\t\t\tcase \"score\":\n\t\t\t\t\treturn scorm.getScore();\n\t\t\t\tcase \"status\":\n\t\t\t\t\treturn scorm.getStatus();\n\t\t\t\tcase \"student\":// for backwards-compatibility. learnerInfo is preferred now and will give you more information\n\t\t\t\t\treturn scorm.getStudentName();\n\t\t\t\tcase \"learnerinfo\":\n\t\t\t\t\treturn this.getLearnerInfo();\n\t\t\t\tdefault:\n\t\t\t\t\treturn this.getCustomState(name);\n\t\t\t}\n\t\t},\n\n\t\tset: function(name, value) {\n\t\t\t//Convert arguments to array and drop the 'name' parameter\n\t\t\tvar args = [].slice.call(arguments, 1);\n\t\t\tvar isObject = typeof name == \"object\";\n\n\t\t\tif (isObject) {\n\t\t\t\tvalue = name;\n\t\t\t\tname = \"suspendData\";\n\t\t\t}\n\n\t\t\tif (this.useTemporaryStore()) {\n\t\t\t\tif (isObject) {\n\t\t\t\t\ttemporaryStore = _.extend(temporaryStore, value);\n\t\t\t\t} else {\n\t\t\t\t\ttemporaryStore[name] = value;\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tswitch (name.toLowerCase()) {\n\t\t\t\tcase \"interaction\":\n\t\t\t\t\treturn scorm.recordInteraction.apply(scorm, args);\n\t\t\t\tcase \"location\":\n\t\t\t\t\treturn scorm.setLessonLocation.apply(scorm, args);\n\t\t\t\tcase \"score\":\n\t\t\t\t\treturn scorm.setScore.apply(scorm, args);\n\t\t\t\tcase \"status\":\n\t\t\t\t\treturn scorm.setStatus.apply(scorm, args);\n\t\t\t\tcase \"student\":\n\t\t\t\tcase \"learnerinfo\":\n\t\t\t\t\treturn false;// these properties are read-only\n\t\t\t\tcase \"suspenddata\":\n\t\t\t\tdefault:\n\t\t\t\t\tif (isObject) {\n\t\t\t\t\t\tsuspendDataStore = _.extend(suspendDataStore, value);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsuspendDataStore[name] = value;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar dataAsString = JSON.stringify(suspendDataStore);\n\t\t\t\t\treturn (suspendDataRestored) ? scorm.setSuspendData(dataAsString) : false;\n\t\t\t}\n\t\t},\n\n\t\tgetCustomStates: function() {\n\t\t\tvar isSuspendDataStoreEmpty = _.isEmpty(suspendDataStore);\n\t\t\tif (!isSuspendDataStoreEmpty && suspendDataRestored) return _.clone(suspendDataStore);\n\n\t\t\tvar dataAsString = scorm.getSuspendData();\n\t\t\tif (dataAsString === \"\" || dataAsString === \" \" || dataAsString === undefined) return {};\n\n\t\t\tvar dataAsJSON = JSON.parse(dataAsString);\n\t\t\tif (!isSuspendDataStoreEmpty && !suspendDataRestored) dataAsJSON = _.extend(dataAsJSON, suspendDataStore);\n\t\t\treturn dataAsJSON;\n\t\t},\n\n\t\tgetCustomState: function(name) {\n\t\t\tvar dataAsJSON = this.getCustomStates();\n\t\t\treturn dataAsJSON[name];\n\t\t},\n\t\t\n\t\tuseTemporaryStore: function() {\n\t\t\tvar cfg = Adapt.config.get('_spoor');\n\t\t\t\n\t\t\tif (!scorm.lmsConnected || (cfg && cfg._isEnabled === false)) return true;\n\t\t\treturn false;\n\t\t},\n\n\t\t/**\n\t\t * Returns an object with the properties:\n\t\t * - id (cmi.core.student_id)\n\t\t * - name (cmi.core.student_name - which is usually in the format \"Lastname, Firstname\" - but sometimes doesn't have the space after the comma)\n\t\t * - firstname\n\t\t * - lastname\n\t\t */\n\t\tgetLearnerInfo: function() {\n\t\t\tvar name = scorm.getStudentName();\n\t\t\tvar firstname = \"\", lastname = \"\";\n\t\t\tif (name && name !== 'undefined' && name.indexOf(\",\") > -1) {\n\t\t\t\t//last name first, comma separated\n\t\t\t\tvar nameSplit = name.split(\",\");\n\t\t\t\tlastname = $.trim(nameSplit[0]);\n\t\t\t\tfirstname = $.trim(nameSplit[1]);\n\t\t\t\tname = firstname + \" \" + lastname;\n\t\t\t} else {\n\t\t\t\tconsole.log(\"SPOOR: LMS learner_name not in 'lastname, firstname' format\");\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tname: name,\n\t\t\t\tlastname: lastname,\n\t\t\t\tfirstname: firstname,\n\t\t\t\tid: scorm.getStudentId()\n\t\t\t};\n\t\t}\n\t\t\n\t});\n\n});\n","define('extensions/adapt-contrib-spoor/js/adapt-contrib-spoor',[\n    'core/js/adapt',\n    './scorm',\n    './adapt-stateful-session',\n    './adapt-offlineStorage-scorm'\n], function(Adapt, scorm, adaptStatefulSession) {\n\n    //SCORM session manager\n\n    var Spoor = _.extend({\n\n        _config: null,\n\n    //Session Begin\n\n        initialize: function() {\n            this.listenToOnce(Adapt, \"configModel:dataLoaded\", this.onConfigLoaded);\n            this.listenToOnce(Adapt, \"app:dataReady\", this.onDataReady);\n        },\n\n        onConfigLoaded: function() {\n            if (!this.checkConfig()) {\n                if (Adapt.offlineStorage.setReadyStatus) {// backwards-compatibility check - setReadyStatus was only introduced in framework v2.0.14\n                    Adapt.offlineStorage.setReadyStatus();\n                }\n                return;\n            }\n\n            this.configureAdvancedSettings();\n\n            scorm.initialize();\n\n            /*\n            force offlineStorage-scorm to initialise suspendDataStore - this allows us to do things like store the user's \n            chosen language before the rest of the course data loads \n            */\n            Adapt.offlineStorage.get();\n\n            if (Adapt.offlineStorage.setReadyStatus) {\n                Adapt.offlineStorage.setReadyStatus();\n            }\n\n            this.setupEventListeners();\n        },\n\n        onDataReady: function() {\n            adaptStatefulSession.initialize();\n        },\n\n        checkConfig: function() {\n            this._config = Adapt.config.get('_spoor') || false;\n\n            if (this._config && this._config._isEnabled !== false) return true;\n            \n            return false;\n        },\n\n        configureAdvancedSettings: function() {\n            if(this._config._advancedSettings) {\n                var settings = this._config._advancedSettings;\n\n                if(settings._showDebugWindow) scorm.showDebugWindow();\n\n                scorm.setVersion(settings._scormVersion || \"1.2\");\n\n                if(settings.hasOwnProperty(\"_suppressErrors\")) {\n                    scorm.suppressErrors = settings._suppressErrors;\n                }\n\n                if(settings.hasOwnProperty(\"_commitOnStatusChange\")) {\n                    scorm.commitOnStatusChange = settings._commitOnStatusChange;\n                }\n\n                if(settings.hasOwnProperty(\"_timedCommitFrequency\")) {\n                    scorm.timedCommitFrequency = settings._timedCommitFrequency;\n                }\n\n                if(settings.hasOwnProperty(\"_maxCommitRetries\")) {\n                    scorm.maxCommitRetries = settings._maxCommitRetries;\n                }\n\n                if(settings.hasOwnProperty(\"_commitRetryDelay\")) {\n                    scorm.commitRetryDelay = settings._commitRetryDelay;\n                }\n            } else {\n                /**\n                * force use of SCORM 1.2 by default - some LMSes (SABA/Kallidus for instance) present both APIs to the SCO and, if given the choice,\n                * the pipwerks code will automatically select the SCORM 2004 API - which can lead to unexpected behaviour.\n                */\n                scorm.setVersion(\"1.2\");\n            }\n\n            /**\n            * suppress SCORM errors if 'nolmserrors' is found in the querystring\n            */\n            if(window.location.search.indexOf('nolmserrors') != -1) scorm.suppressErrors = true;\n        },\n\n        setupEventListeners: function() {\n            var advancedSettings = this._config._advancedSettings;\n            var shouldCommitOnVisibilityChange = (!advancedSettings ||\n                advancedSettings._commitOnVisibilityChangeHidden !== false) &&\n                document.addEventListener;\n\n            this._onWindowUnload = _.bind(this.onWindowUnload, this);\n            $(window).on('beforeunload unload', this._onWindowUnload);\n\n            if (shouldCommitOnVisibilityChange) {\n                document.addEventListener(\"visibilitychange\", this.onVisibilityChange);\n            }\n\n            require(['libraries/jquery.keycombo'], function() {\n                // listen for user holding 'd', 'e', 'v' keys together\n                $.onKeyCombo([68, 69, 86], function() {\n                    scorm.showDebugWindow();\n                });\n            });\n        },\n\n        onVisibilityChange: function() {\n            if (document.visibilityState === \"hidden\") scorm.commit();\n        },\n\n    //Session End\n\n        onWindowUnload: function() {\n            $(window).off('beforeunload unload', this._onWindowUnload);\n\n            scorm.finish();\n        }\n        \n    }, Backbone.Events);\n\n    Spoor.initialize();\n\n});\n\n","define('extensions/adapt-contrib-trickle/js/trickleView',[\n    'coreJS/adapt'\n], function(Adapt) {\n\n    var TrickleView = Backbone.View.extend({\n\n        isSteplocked: false,\n\n        initialize: function(options) {\n            this.setupEventListeners();\n        },\n\n        setupEventListeners: function() {\n            var AdaptEvents = {\n                \"trickle:kill\": this.onKill,\n                \"remove\": this.onRemove\n            };\n            \n            this.onPreRender(this);\n\n            AdaptEvents[this.model.get(\"_type\") + \"View:postRender\"] = this.onPostRender;\n            this.listenTo(Adapt, AdaptEvents);\n\n            this.on(\"steplock\", this.onStepLock);\n            this.on(\"stepunlock\", this.onStepUnlock);\n        },\n\n        onPreRender: function(view) {\n            if (!this.isElementEnabled()) return;\n\n            Adapt.trigger(\"trickle:preRender\", this);\n        },\n\n        onPostRender: function(view) {\n            if (view.model.get(\"_id\") !== this.model.get(\"_id\")) return;\n            if (!this.isElementEnabled()) return;\n\n            Adapt.trigger(\"trickle:postRender\", this);\n        },\n\n        isElementEnabled: function() {\n            var trickle = Adapt.trickle.getModelConfig(this.model);\n            if (!trickle) return false;\n\n            var isArticleWithOnChildren = (this.model.get(\"_type\") === \"article\" && trickle._onChildren);\n            if (isArticleWithOnChildren) {\n                return false;\n            }\n\n            if (trickle._isEnabled === true) return true;\n            return false;\n        },\n\n        onStepLock: function() {\n            if (!this.isElementEnabled()) {\n                this.continueToNext();\n                return;\n            }\n\n            var trickle = Adapt.trickle.getModelConfig(this.model);\n            var isSteplocking = (trickle._stepLocking && trickle._stepLocking._isEnabled);\n            if (!isSteplocking) {\n                this.continueToNext();\n                return;\n            }\n\n            Adapt.trigger(\"trickle:steplock\", this);\n            //console.log(\"trickle steplock at\", this.model.get(\"_id\"))\n\n            this.isSteplocked = true;\n        },\n\n        continueToNext: function() {\n            _.defer(_.bind(function() {\n                Adapt.trigger(\"trickle:continue\", this);\n            }, this));\n        },\n\n\n        onStepUnlock: function() {\n            if (!this.isSteplocked) return;\n            this.isSteplocked = false;\n            Adapt.trigger(\"trickle:stepunlock\", this);\n        },\n\n        onKill: function() {\n            this.detachFromElement()\n        },\n\n        onRemove: function() {\n            this.detachFromElement();\n        },\n\n        detachFromElement: function() {\n            this.undelegateEvents();\n            this.stopListening();\n            this.model = null;\n            this.articleModel = null;\n            this.$el = null;\n            this.el = null;\n        }\n                \n    });\n\n    return TrickleView;\n\n})\n;\n","define('extensions/adapt-contrib-trickle/js/pageView',[\n    'coreJS/adapt',\n    './trickleView'\n], function(Adapt, TrickleView) {\n\n    var PageView = Backbone.View.extend({\n\n        currentDescendantIndex: 0,\n        currentLocksOnDescendant: 0,\n        currentDescendant: null,\n\n        initialize: function(options) {\n            if (!this.isPageEnabled()) {\n                return this.detachFromPage();\n            }\n            this.setupDescendants();\n            if (!this.haveDescendantsGotTrickle()) {\n                return this.detachFromPage();   \n            }\n            this.addClassToHtml();\n            this.setupEventListeners();\n        },\n\n        isPageEnabled: function() {\n            var trickleConfig = Adapt.trickle.getModelConfig(this.model);\n            if (trickleConfig && trickleConfig._isEnabled === false) return false;\n            return true;\n        },\n\n        setupDescendants: function() {\n            this.currentDescendant = null;\n            this.descendantViews = {};\n            this.getDescendants();\n            Adapt.trigger(\"trickle:descendants\", this);\n        },\n\n        descendantsChildFirst: null,\n        descendantsParentFirst: null,\n        descendantViews: null,\n\n        getDescendants: function() {\n            this.descendantsChildFirst = this.model.getDescendants();\n            this.descendantsParentFirst = this.model.getDescendants(true);\n\n            //if some descendants flip between _isAvailable true/false they must have their defaults set before the filter is applied\n            this.setDescendantsTrickleDefaults();\n\n            this.descendantsChildFirst = this.filterComponents(this.descendantsChildFirst);\n            this.descendantsParentFirst = this.filterComponents(this.descendantsParentFirst);\n\n        },\n\n        filterComponents: function(descendants) {\n            return new Backbone.Collection(descendants.filter(function(descendant) {\n                if (descendant.get(\"_type\") === \"component\") return false;\n                if (!descendant.get(\"_isAvailable\")) return false;\n                return true;\n            }));\n        },\n\n        setDescendantsTrickleDefaults: function() {\n            //use parent first as likely to get to article \n            //\n            this.descendantsParentFirst.each(_.bind(function(descendant) {\n\n                var trickle = Adapt.trickle.getModelConfig(descendant);\n                var noTrickleConfig = (!trickle);\n\n                //check if descendant has trickle settings\n                if (noTrickleConfig) return;\n\n                //check if trickle is configures on descendant\n                //NOTE: Removed for banked assessments\n                //var isTrickleConfigured = descendant.get(\"_isTrickleConfigured\");\n                //if (isTrickleConfigured) return;\n\n                //setup steplocking defaults\n                trickle._stepLocking = _.extend({\n                    \"_isEnabled\": true, //(default=true)\n                    \"_isCompletionRequired\": true, //(default=true)\n                    \"_isLockedOnRevisit\": false //(default=false)\n                }, trickle._stepLocking);\n\n                //setup main trickle defaults\n                trickle = _.extend({\n                    \"_isEnabled\": true, //(default=true)\n                    \"_autoScroll\": true, //(default=true)\n                    \"_scrollDuration\": 500, //(default=500)\n                    \"_onChildren\": true, //(default=true)\n                    \"_scrollTo\": \"@block +1\", //(default=\"@block +1\")\n                }, trickle);\n\n                Adapt.trickle.setModelConfig(descendant, trickle);\n\n                //check article \"onChildren\" rule\n                if (trickle._onChildren \n                    && descendant.get(\"_type\") === \"article\") {\n                    this.setupArticleOnChildren(descendant, trickle);\n                }\n\n                //set descendant trickle as configured\n                descendant.set(\"_isTrickleConfigured\", true);\n\n            }, this));\n        },\n\n        setupArticleOnChildren: function(articleModel, articleTrickleConfig) {\n            //set trickle on all blocks, using article config with block overrides\n            var articleBlocks = articleModel.getChildren();\n\n            articleBlocks.each(function(blockModel, index) {\n                var blockTrickleConfig = Adapt.trickle.getModelConfig(blockModel);\n\n                //overlay block trickle on article trickle\n                //this allows values to carry through from the article to the block \n                //retains any value overriden in the block\n                for (var k in blockTrickleConfig) {\n                    //handle nested objects to one level\n                    if (typeof blockTrickleConfig[k] === \"object\") {\n                        blockTrickleConfig[k] = _.extend({}, articleTrickleConfig[k], blockTrickleConfig[k]);\n                    }\n                }\n\n                blockTrickleConfig = _.extend({}, articleTrickleConfig, blockTrickleConfig);\n\n\n                //setup start/final config\n                if (articleBlocks.length === index+1) {\n                    blockTrickleConfig._isFinal = true;\n                }\n                if (index === 0) {\n                    blockTrickleConfig._isStart = true;\n                }\n\n                Adapt.trickle.setModelConfig(blockModel, blockTrickleConfig);\n            });\n\n        },\n\n        haveDescendantsGotTrickle: function() {\n            return this.descendantsChildFirst.some(function(descendant) {\n                var trickle = Adapt.trickle.getModelConfig(descendant);\n                if (!trickle) return false;\n                if (trickle._isEnabled === true) {\n                    return true;\n                }\n                return false;\n            });\n        },\n\n        addClassToHtml: function() {\n            $(\"html\").addClass(\"trickle\");\n        },\n\n        setupEventListeners: function() {\n            this.listenTo(Adapt, {\n                \"remove\": this.onRemove,\n                \n                \"articleView:preRender\": this.onDescendantPreRender,\n                \"blockView:preRender\": this.onDescendantPreRender,\n\n                \"trickle:unwait\": this.onUnwait,\n                \"trickle:wait\": this.onWait,\n                \"trickle:continue\": this.onContinue,\n                \"trickle:skip\": this.onSkip,\n\n                \"trickle:kill\": this.onKill\n            });\n            this.listenToOnce(this.model, \"change:_isReady\", this.onPageReady)\n        },\n\n        onDescendantPreRender: function(view) {\n            //ignore components\n            if (view.model.get(\"_type\") === \"component\") return;\n\n            var descendantView = new TrickleView({\n                model: view.model,\n                el: view.el\n            });\n            this.descendantViews[view.model.get(\"_id\")] = descendantView;\n        },\n\n        //trickle lifecycle\n\n        onPageReady: function(model, value) {\n            if (!value) return;\n\n            this.currentDescendant = null;\n\n            Adapt.trigger(\"trickle:started\");\n            this.gotoNextDescendant();\n        },\n\n        gotoNextDescendant: function() {\n            this.getDescendants();\n\n            if (this.currentDescendant) {\n                this.currentDescendant.trigger(\"stepunlock\");\n                this.currentDescendant = null;\n            }\n\n            for (var index = this.currentDescendantIndex || 0, l = this.descendantsChildFirst.models.length; index < l; index++) {\n                var descendant = this.descendantsChildFirst.models[index];\n                switch ( descendant.get(\"_type\") ) {\n                case \"block\": case \"article\":\n                    this.currentLocksOnDescendant = 0;\n                    this.currentDescendantIndex = index;\n                    var currentId = descendant.get(\"_id\");\n                    this.currentDescendant = this.descendantViews[currentId];\n                    this.currentDescendant.trigger(\"steplock\");\n                    return;\n                }\n            }\n            this.finished();\n        },\n\n        onContinue: function(view) {\n            if (!this.currentDescendant) return;\n            if (view.model.get(\"_id\") !== this.currentDescendant.model.get(\"_id\")) return;\n\n            this.onSkip();\n        },\n\n        onWait: function() {\n            this.currentLocksOnDescendant++;\n        },\n\n        onUnwait: function() {\n            this.currentLocksOnDescendant--;\n            if (this.currentLocksOnDescendant > 0) return;\n            \n            var lastDescendant = this.currentDescendant.model;\n            \n            this.currentDescendantIndex++;\n            this.gotoNextDescendant();\n\n            Adapt.trickle.scroll(lastDescendant);\n            \n        },\n\n        onSkip: function() {\n            //wait for all handlers to accept skip\n            _.defer(_.bind(function() {\n                this.currentDescendantIndex++;\n                this.gotoNextDescendant();\n            }, this));\n        },\n\n        onKill: function() {\n            this.finished();\n            this.detachFromPage();\n        },\n\n        finished: function() {\n            Adapt.trigger(\"trickle:finished\");\n            this.detachFromPage();\n        },\n\n        //end of trickle lifecycle\n\n        onRemove: function() {\n            this.finished();\n        },\n\n        detachFromPage: function() {\n            this.removeClassFromHtml();\n            this.undelegateEvents();\n            this.stopListening();\n            this.model = null;\n            this.$el = null;\n            this.el = null;\n            this.currentDescendant = null;\n            this.descendantViews = null;\n            this.descendantsChildFirst = null;\n            this.descendantsParentFirst = null;\n            Adapt.trickle.pageView = null;\n        },\n\n        removeClassFromHtml: function() {\n            $(\"html\").removeClass(\"trickle\");\n        }\n                \n    });\n\n    return PageView;\n\n})\n;\n","define('extensions/adapt-contrib-trickle/js/lib/adaptModelExtension',[\n    'coreJS/adapt',\n    'coreModels/adaptModel'\n], function(Adapt, AdaptModel) {\n\n    _.extend(AdaptModel.prototype, {\n        \n        /*\n        * Fetchs the sub structure of an id as a flattened array\n        *\n        *   Such that the tree:\n        *       { a1: { b1: [ c1, c2 ], b2: [ c3, c4 ] }, a2: { b3: [ c5, c6 ] } }\n        *\n        *   will become the array (parent first = false):\n        *       [ c1, c2, b1, c3, c4, b2, a1, c5, c6, b3, a2 ]\n        *\n        *   or (parent first = true):\n        *       [ a1, b1, c1, c2, b2, c3, c4, a2, b3, c5, c6 ]\n        *\n        * This is useful when sequential operations are performed on the page/article/block/component hierarchy.\n        */\n        getDescendants: function(parentFirst) {\n            var descendants = [];\n\n            if (this.get(\"_type\") === \"component\") {\n                descendants.push(this);\n                return new Backbone.Collection(descendants);\n            }\n\n            var children = this.getChildren();\n\n            for (var i = 0, l = children.models.length; i < l; i++) {\n\n                var child = children.models[i];\n                if (child.get(\"_type\") === \"component\") {\n\n                    descendants.push(child);\n\n                } else {\n\n                    var subDescendants = child.getDescendants(parentFirst);\n                    if (parentFirst == true) descendants.push(child);\n                    descendants = descendants.concat(subDescendants.models);\n                    if (parentFirst != true) descendants.push(child);\n\n                }\n\n            }\n\n            return new Backbone.Collection(descendants);\n        },\n\n        /*\n        * Returns a relative structural item from the Adapt hierarchy\n        *   \n        *   Such that in the tree:\n        *       { a1: { b1: [ c1, c2 ], b2: [ c3, c4 ] }, a2: { b3: [ c5, c6 ] } }\n        *\n        *       findRelative(modelC1, \"@block +1\") = modelB2;\n        *       findRelative(modelC1, \"@component +4\") = modelC5;\n        *\n        */\n        findRelative: function(relativeString, options) {\n            var types = [ \"menu\", \"page\", \"article\", \"block\", \"component\" ];\n\n            options = options || {};\n\n            var modelId = this.get(\"_id\");\n            var modelType = this.get(\"_type\");\n\n            //return a model relative to the specified one if opinionated\n            var rootModel = Adapt.course;\n            if (options.limitParentId) {\n                rootModel = Adapt.findById(options.limitParentId);\n            }\n\n            var relativeDescriptor = parseRelativeString(relativeString);\n\n            var findAncestorType = (_.indexOf(types, modelType) > _.indexOf(types, relativeDescriptor.type));\n            var findSameType = (modelType === relativeDescriptor.type);\n\n            var searchBackwards = false;\n            var movementCount = 0;\n\n            // children first [c,c,b,a,c,c,b,a,p,c,c,b,a,c,c,b,a,p]\n            var pageDescendants = rootModel.getDescendants().toJSON();\n\n            //choose search style\n            if (findSameType || findAncestorType) {\n                //examples a<>a or c<>b,a,p\n                //assume next is 0 index\n                //assume last is -1 index\n                searchBackwards = (relativeDescriptor.offset <= 0);\n            } else {\n                //finding descendant\n                //examples a<>c or a<>b\n                if (relativeDescriptor.offset < 1) {\n                    //assume last descendant is 0 index\n                    searchBackwards = true;\n                } else {\n                    //assume next descendant is +1 index\n                    movementCount = 1;\n                    searchBackwards = false;\n                }\n            }\n\n            //exclude not available and not visible if opinionated\n            if (options.filterNotVisible) {\n                pageDescendants = _.filter(pageDescendants, function(descendant) {\n                    return descendant._isVisible;\n                });\n            } \n            if (options.filterNotAvailable) {\n                pageDescendants = _.filter(pageDescendants, function(descendant) {\n                    return descendant._isAvailable;\n                });\n            } \n\n            //find current index in array\n            var modelIndex = _.findIndex(pageDescendants, function(pageDescendant) {\n                if (pageDescendant._id === modelId) {\n                    return true;\n                }\n                return false;\n            });\n\n            //search in appropriate order\n            if (searchBackwards) {\n                for (var i = modelIndex, l = -1; i > l; i--) {\n                    var descendant = pageDescendants[i];\n                    if (descendant._type === relativeDescriptor.type) {\n                        if (-movementCount === relativeDescriptor.offset) {\n                            return Adapt.findById(descendant._id);\n                        }\n                        movementCount++;\n                    }\n                }\n            } else {\n                for (var i = modelIndex, l = pageDescendants.length; i < l; i++) {\n                    var descendant = pageDescendants[i];\n                    if (descendant._type === relativeDescriptor.type) {\n                        if (movementCount === relativeDescriptor.offset) {\n                            return Adapt.findById(descendant._id);\n                        }\n                        movementCount++;\n                    }\n                }\n            }\n\n            return undefined;\n        }\n    });\n\n\n    function parseRelativeString(relativeString) {\n        var type = relativeString.substr(0, _.indexOf(relativeString, \" \"));\n        var offset = parseInt(relativeString.substr(type.length));\n        type = type.substr(1);\n\n        /*RETURN THE TYPE AND OFFSET OF THE SCROLLTO\n        * \"@component +1\"  : \n        * {\n        *       type: \"component\",\n        *       offset: 1\n        * }\n        */\n        return { \n            type: type,\n            offset: offset\n        };\n    }\n\n});\n\n","define('extensions/adapt-contrib-trickle/js/handlers/buttonView',[\n    'coreJS/adapt',\n    'coreViews/componentView'\n], function(Adapt, ComponentView) {\n\n    var completionAttribute = \"_isInteractionComplete\";\n\n    var TrickleButtonView = Backbone.View.extend({\n\n        isStepLocking: false,\n        hasStepLocked: false,\n        isStepLocked: false,\n        isStepLockFinished: false,\n        hasStepPreCompleted: false,\n        isWaitingForClick: false,\n        allowVisible: false,\n        allowEnabled: true,\n        overlayShownCount: 0,\n\n        el: function() {\n\n            this.setupPreRender();\n\n            return Handlebars.templates['trickle-button'](this.model.toJSON());\n        },\n\n        setupPreRender: function() {\n            \n            this.setupButtonVisible();\n            this.setupButtonEnabled();\n        },\n\n        setupButtonVisible: function() {\n            var trickle = Adapt.trickle.getModelConfig(this.model);\n            this.allowVisible = false;\n            trickle._button._isVisible = false;\n\n            if (trickle._button._styleBeforeCompletion === \"visible\") {\n                this.allowVisible = true;\n                if (trickle._button._autoHide && trickle._button._isFullWidth) {\n                    trickle._button._isVisible = false;    \n                } else {\n                    trickle._button._isVisible = true;\n                }\n            }\n        },\n\n        setupButtonEnabled: function() {\n            var trickle = Adapt.trickle.getModelConfig(this.model);\n            \n            if (trickle._stepLocking._isCompletionRequired === false) {\n                this.allowEnabled = true;\n                trickle._button._isDisabled = false;   \n            } else if (trickle._button._styleBeforeCompletion === \"visible\") {\n                this.allowEnabled = false;\n                trickle._button._isDisabled = true;\n            } else {\n                trickle._button._isDisabled = false;\n                this.allowEnabled = true;\n            }\n\n        },\n        \n        events: {\n            \"click button\": \"onButtonClick\"\n        },\n\n        initialize: function(options) {\n            this.getCompletionAttribute();\n            this.debounceCheckAutoHide();\n            this.setupStepLocking();\n            this.setupEventListeners();\n        },\n\n        getCompletionAttribute: function() {\n            var trickle = Adapt.trickle.getModelConfig(Adapt.config);\n            if (!trickle) return;\n            if (trickle._completionAttribute) {\n                completionAttribute = trickle._completionAttribute\n            }\n        },\n\n        setupStepLocking: function() {\n            var trickle = Adapt.trickle.getModelConfig(this.model);\n            if (trickle._stepLocking._isEnabled) {\n                this.isStepLocked = true;\n            } else {\n                this.isStepLocked = false;\n            }\n        },\n\n        setupEventListeners: function() {\n            this.listenTo(Adapt, {\n                \"trickle:overlay\": this.onOverlay,\n                \"trickle:unoverlay\": this.onUnoverlay,\n                \"trickle:steplock\": this.onStepLock,\n                \"trickle:stepunlock\": this.onStepUnlock,\n                \"trickle:skip\": this.onSkip,\n                \"trickle:kill\": this.onKill,\n                \"trickle:update\": this.onUpdate,\n                \"remove\": this.onRemove \n            });\n\n            this.listenTo(this.model, \"change:\"+completionAttribute, this.onCompletion);\n        },\n\n        debounceCheckAutoHide: function() {\n            this.checkButtonAutoHideSync = this.checkButtonAutoHide;\n            this.checkButtonAutoHide = _.debounce(_.bind(this.checkButtonAutoHide, this), 100);\n        },\n\n        checkButtonAutoHide: function() {\n            if (!this.allowVisible) {\n                this.setButtonVisible(false);\n                return;\n            }\n\n            var trickle = Adapt.trickle.getModelConfig(this.model);\n            if (!trickle._button._autoHide) {\n                this.setButtonVisible(true);\n                return;\n            } else if (this.overlayShownCount > 0) {\n                this.setButtonVisible(false);\n                return;\n            }\n\n            var measurements = this.$el.onscreen();\n\n            //this is to fix ios7 iphone4 miscalculation\n            var isJustOffscreen = (measurements.bottom > -100);\n\n\n            //add show/hide animation here if needed\n            if (measurements.onscreen || isJustOffscreen) {\n                this.setButtonVisible(true);\n            } else {\n                this.setButtonVisible(false);\n            }\n        },\n\n        setButtonVisible: function(bool) {\n            var trickle = Adapt.trickle.getModelConfig(this.model);\n            if (!bool) {\n                this.$(\".component-inner\").addClass(\"display-none\");\n                trickle._button._isVisible = false;\n                //console.log(\"trickle hiding button\", this.model.get(\"_id\"));\n            } else {\n                this.$(\".component-inner\").removeClass(\"display-none\");\n                trickle._button._isVisible = true;\n                //console.log(\"trickle showing button\", this.model.get(\"_id\"));\n            }\n        },\n\n        checkButtonEnabled: function(bool) {\n            if (!this.allowEnabled) {\n                this.setButtonEnabled(false);\n            } else {\n                this.setButtonEnabled(true);\n            }\n        },\n\n        setButtonEnabled: function(bool) {\n            var trickle = Adapt.trickle.getModelConfig(this.model);\n            if (bool) {\n                this.$(\"button\").removeClass(\"disabled\").removeAttr(\"disabled\");\n                trickle._button._isDisabled = true;\n            } else {\n                this.$(\"button\").addClass(\"disabled\").attr(\"disabled\", \"disabled\");\n                trickle._button._isDisabled = false;\n            }\n        },\n\n        onStepLock: function(view) {\n            if (!this.isViewMatch(view)) return;\n\n            this.hasStepLocked = true;\n            this.isStepLocking = true;\n            this.overlayShownCount = 0;\n\n            var trickle = Adapt.trickle.getModelConfig(this.model);\n\n            if (this.isButtonEnabled()) {\n                var isCompleteAndShouldRelock = (trickle._stepLocking._isLockedOnRevisit && this.model.get(completionAttribute));\n\n                if (isCompleteAndShouldRelock) {\n                    this.isStepLocked = true;\n                    this.model.set(\"_isTrickleAutoScrollComplete\", false);\n                    Adapt.trigger(\"trickle:wait\");\n                    this.allowVisible = true;\n                    this.checkButtonAutoHide();\n                } else if (this.hasStepPreCompleted) {\n                    //force the button to show if section completed before it was steplocked\n                    this.isStepLocked = true;\n                    this.model.set(\"_isTrickleAutoScrollComplete\", false);\n                    this.allowVisible = true;\n                    this.stepCompleted();\n                }\n                this.setupOnScreenListener();\n            }\n        },\n\n        onOverlay: function() {\n            this.overlayShownCount++;\n        },\n\n        onUnoverlay: function() {\n            this.overlayShownCount--;\n            this.checkButtonAutoHide();\n        },\n\n        setupOnScreenListener: function() {\n            var trickle = Adapt.trickle.getModelConfig(this.model);\n\n            if (trickle._button._autoHide) {\n                this.$el.on(\"onscreen\", this.checkButtonAutoHide);\n            }\n        },\n\n        isViewMatch: function(view) {\n            return view.model.get(\"_id\") === this.model.get(\"_id\");\n        },\n\n        isButtonEnabled: function() {\n            var trickle = Adapt.trickle.getModelConfig(this.model);\n\n            if (!trickle._isEnabled || !trickle._button._isEnabled) return false;\n            return true;\n        },\n\n        onCompletion: function(model, value) {\n            if (value === false) return;\n\n            this.hasStepPreCompleted = true;\n\n            if (!this.hasStepLocked) return;\n\n            _.defer(_.bind(function() {\n                this.stepCompleted();\n            }, this));\n        },\n\n        stepCompleted: function() {\n\n            if (this.isStepLockFinished) return;\n\n            this.isStepLocked = false;\n            this.allowVisible = false;\n            this.allowEnabled = false;\n\n            if (this.isButtonEnabled()) {\n                if (this.isStepLocking) {\n\n                    this.isStepLocked = true;\n                    this.isWaitingForClick = true;\n                    Adapt.trigger(\"trickle:wait\");\n\n                } else {\n\n                    this.isStepLockFinished = true;\n                }\n\n                this.allowVisible = true;\n                this.allowEnabled = true;\n            }\n\n            this.model.set(\"_isTrickleAutoScrollComplete\", false);\n            this.checkButtonAutoHide();\n            this.checkButtonEnabled();\n\n        },\n\n        onButtonClick: function() {\n            if (this.isStepLocked) {\n                Adapt.trigger(\"trickle:unwait\");\n                this.isStepLocked = false;\n                this.isStepLockFinished = true;\n\n            } else {\n                this.model.set(\"_isTrickleAutoScrollComplete\", false);\n                _.defer(_.bind(function() {\n                    Adapt.trickle.scroll(this.model);\n                }, this));\n            }\n\n            var trickle = this.model.get(\"_trickle\");\n            switch (trickle._button._styleAfterClick) {\n            case \"hidden\":\n                this.allowVisible = false;\n                this.checkButtonAutoHideSync();\n                break;\n            case \"disabled\":\n                this.allowEnabled = false;\n                this.checkButtonAutoHideSync();\n            }\n        },\n\n        onUpdate: function() {\n            var trickle = Adapt.trickle.getModelConfig(this.model);\n\n            if (trickle._button._autoHide && this.isStepLocking) {\n                this.$el.off(\"onscreen\", this.checkButtonAutoHide);\n            }\n            \n            var $original = this.$el;\n            var $newEl = $(Handlebars.templates['trickle-button'](this.model.toJSON()));\n            $original.replaceWith($newEl);\n\n            this.setElement($newEl);\n\n            if (trickle._button._autoHide && this.isStepLocking) {\n                this.$el.on(\"onscreen\", this.checkButtonAutoHide);\n            }\n        },\n\n        onStepUnlock: function(view) {\n            if (!this.isViewMatch(view)) return;\n            this.$el.off(\"onscreen\", this.checkButtonAutoHide);\n            this.isStepLocking = false;\n            this.overlayShownCount = 0;\n        },\n\n        onSkip: function() {\n            if (!this.isStepLocking) return;\n\n            this.onKill();\n        },\n\n        onKill: function() {\n            this.$el.off(\"onscreen\", this.checkButtonAutoHide);\n            if (this.isWaitingForClick) {\n                this.model.set(\"_isTrickleAutoScrollComplete\", true);\n            }\n            this.isWaitingForClick = false;\n            this.isStepLocked = false;\n            this.isStepLocking = false;\n            this.allowVisible = false;\n            this.allowEnabled = false;\n            this.isStepLockFinished = true;\n            this.model.set(\"_isTrickleAutoScrollComplete\", false);\n            this.checkButtonAutoHide();\n            this.checkButtonEnabled();\n        },\n\n        onRemove: function() {\n            if (this.isWaitingForClick) {\n                this.model.set(\"_isTrickleAutoScrollComplete\", true);\n            }\n            this.isWaitingForClick = false;\n            this.$el.off(\"onscreen\", this.checkButtonAutoHide);\n            this.isStepLocking = true;\n            this.remove();\n        }\n\n    });\n\n    return TrickleButtonView;\n});\n\n","define('extensions/adapt-contrib-trickle/js/handlers/button',[\n    'coreJS/adapt',\n    './buttonView'\n], function(Adapt, ButtonView) {\n\n    var TrickleButtonHandler = _.extend({\n\n        buttonViews: null,\n\n        initialize: function() {\n            this.listenToOnce(Adapt, {\n                \"app:dataReady\": this.onAppDataReady,\n                \"remove\": this.onRemove\n            });\n        },\n\n        onAppDataReady: function() {\n            this.buttonViews = {};\n            this.setupEventListeners();\n        },\n\n        setupEventListeners: function() {\n            this.listenTo(Adapt, {\n                \"trickle:preRender\": this.onPreRender,\n                \"trickle:postRender\": this.onPostRender,\n            });\n        },\n\n        onPreRender: function(view) {\n            //setup button on prerender to allow it to control the steplocking process\n            if (!this.isTrickleEnabled(view.model)) return;\n\n            this.setupConfigDefaults(view.model);\n\n            this.buttonViews[view.model.get(\"_id\")] = new ButtonView({\n                model: view.model\n            });\n        },\n\n        onPostRender: function(view) {\n            //inject the button at post render\n            if (!this.isTrickleEnabled(view.model)) return;\n\n            view.$el.append(this.buttonViews[view.model.get(\"_id\")].$el);\n        },\n\n        isTrickleEnabled: function(model) {\n            var trickle = Adapt.trickle.getModelConfig(model);\n            if (!trickle || !trickle._isEnabled) return false;\n\n            if (trickle._onChildren && model.get(\"_type\") === \"article\") return false;\n\n            return true;\n        },\n\n        setupConfigDefaults: function(model) {\n            if (model.get(\"_isTrickleButtonConfigured\")) return;\n\n            var trickle = Adapt.trickle.getModelConfig(model);\n            trickle._button = _.extend({\n                \"_isEnabled\": true, //(default=true)\n                \"_styleBeforeCompletion\": \"hidden\", //(default=hidden)\n                \"_styleAfterClick\": \"hidden\", //(default=hidden)\n                \"_isFullWidth\": true, //(default=true)\n                \"_autoHide\": true, //(default=true)\n                \"_className\": \"\", //(default=\"\")\n                \"text\": \"Continue\", //(default=\"Continue\")\n                \"startText\": \"Begin\", //(default=\"Begin\")\n                \"finalText\": \"Finish\", //(default=\"Finish\")\n                \"_component\": \"trickle-button\", //(default=\"trickle-button\")\n                \"_isLocking\": true,\n                \"_isVisible\": false,\n                \"_isDisabled\": false\n            }, trickle._button);\n\n\n            if (trickle._button._isFullWidth) {\n                trickle._stepLocking._isEnabled = true;\n                trickle._button._styleAfterClick = \"hidden\";\n            } else {\n                trickle._button._autoHide = false;\n            }\n\n            Adapt.trickle.setModelConfig(model, trickle);\n            model.set(\"_isTrickleButtonConfigured\", true);\n\n        },\n\n        onRemove: function() {\n            this.buttonViews = {};\n        }\n\n    }, Backbone.Events);\n\n    TrickleButtonHandler.initialize();\n\n    return TrickleButtonHandler;\n});\n\n","define('extensions/adapt-contrib-trickle/js/handlers/completion',[\n    'coreJS/adapt', \n], function(Adapt) {\n\n    var completionAttribute = \"_isInteractionComplete\";\n\n    var TrickleCompletionHandler = _.extend({\n\n        isStepLocking: false,\n        isCompleted: false,\n        \n        stepModel: null,\n        \n        initialize: function() {\n            this.listenToOnce(Adapt, \"app:dataReady\", this.onAppDataReady);\n        },\n\n        onAppDataReady: function() {\n            this.getCompletionAttribute();\n            this.setupEventListeners();\n        },\n\n        getCompletionAttribute: function() {\n            var trickle = Adapt.trickle.getModelConfig(Adapt.config);\n            if (!trickle) return;\n            if (trickle._completionAttribute) {\n                completionAttribute = trickle._completionAttribute\n            }\n        },\n\n        setupEventListeners: function() {\n            this.listenTo(Adapt, {\n                \"trickle:descendants\": this.onDescendants,\n                \"trickle:steplock\": this.onStepLock,\n                \"trickle:stepunlock\": this.onStepUnlock,\n                \"trickle:kill\": this.onKill,\n                \"remove\": this.onRemove\n            });\n        },\n\n        onDescendants: function(view) {\n            //save the original completion state of the component before steplocking\n            view.descendantsParentFirst.each(_.bind(function(descendant) {\n                var trickle = Adapt.trickle.getModelConfig(descendant);\n                if (!trickle) return;\n                trickle._wasCompletedPreRender = descendant.get(completionAttribute);\n            }, this));\n        },\n\n        onStepLock: function(view) {\n            var isModelComplete = view.model.get(completionAttribute);\n\n            var trickle = Adapt.trickle.getModelConfig(view.model);\n            if (!trickle._stepLocking._isCompletionRequired\n                && !trickle._stepLocking._isLockedOnRevisit) {\n                if (isModelComplete) {\n                    //skip any components that do not require completion but that are already complete\n                    //this is needed for a second visit to a page with 'inview' components that aren't reset and don't require completion and are not relocked on revisit\n                    Adapt.trigger(\"trickle:continue\", view);\n                }\n                return;\n            }\n\n            if (trickle._stepLocking._isCompletionRequired\n                && isModelComplete\n                && trickle._wasCompletedPreRender) {\n                //skip any components that are complete, have require completion and we completed before the page rendered\n                Adapt.trigger(\"trickle:continue\", view);\n                return;\n            }\n\n            Adapt.trigger(\"trickle:wait\");\n\n            if (isModelComplete) {\n                _.defer(function() {\n                    Adapt.trigger(\"trickle:unwait\")\n                });\n                return;\n            }\n\n            view.model.set(\"_isTrickleAutoScrollComplete\", false);\n            this.isCompleted = false;\n            this.isStepLocking = true;\n            this.stepModel = view.model;\n\n            this.listenTo(this.stepModel, \"change:\"+completionAttribute, this.onCompletion);\n        },\n\n        onCompletion: function(model, value) {\n            if (value === false) return;\n\n            _.defer(_.bind(function() {\n                this.stepCompleted();\n            }, this));\n\n        },\n\n        stepCompleted: function() {\n\n            if (!this.isStepLocking) return;\n\n            if (this.isCompleted) return;\n            this.isCompleted = true;\n\n            this.stopListening(this.stepModel, \"change:\"+completionAttribute, this.onCompletion);\n            \n            _.defer(function(){\n                Adapt.trigger(\"trickle:unwait\");\n            });\n        },\n\n        onKill: function() {\n            this.onStepUnlock();\n        },\n\n        onRemove: function() {\n            this.onStepUnlock();\n        },\n\n        onStepUnlock: function() {\n            this.stopListening(this.stepModel, \"change:\"+completionAttribute, this.onCompletion);\n            this.isStepLocking = false;\n            this.stepModel = null;\n            this.isCompleted = false;\n        }        \n\n    }, Backbone.Events);\n\n    TrickleCompletionHandler.initialize();\n\n    return TrickleCompletionHandler;\n\n});\n\n","define('extensions/adapt-contrib-trickle/js/handlers/notify',[\n    'coreJS/adapt', \n], function(Adapt) {\n\n    var TrickleNotifyHandler = _.extend({\n\n        isStepLocking: false,\n        isNotifyOpen: false,\n\n        initialize: function() {\n            this.listenToOnce(Adapt, \"app:dataReady\", this.onAppDataReady);\n        },\n\n        onAppDataReady: function() {\n            this.setupEventListeners();\n        },\n\n        setupEventListeners: function() {\n            this.listenTo(Adapt, {\n                \"trickle:steplock\": this.onStepLock,\n                \"notify:opened\": this.onNotifyOpened,\n                \"notify:closed\": this.onNotifyClosed,\n                \"trickle:stepunlock\": this.onStepUnlock,\n                \"remove\": this.onRemove\n            });\n        },\n\n        onStepLock: function(view) {\n            this.isStepLocking = true;\n        },\n\n        onNotifyOpened: function() {\n            if (!this.isStepLocking) return;\n\n            this.isNotifyOpen = true;\n            Adapt.trigger(\"trickle:overlay\");\n            Adapt.trigger(\"trickle:wait\");\n        },\n\n        onNotifyClosed: function() {\n            if (!this.isStepLocking) return;\n            if (!this.isNotifyOpen) return;\n\n            this.isNotifyOpen = false;\n            Adapt.trigger(\"trickle:unoverlay\");\n            Adapt.trigger(\"trickle:unwait\");\n        },\n\n        onStepUnlock: function() {\n            this.isStepLocking = false;\n        },\n\n        onRemove: function() {\n            this.onStepUnlock();\n        }\n\n    }, Backbone.Events);\n\n    TrickleNotifyHandler.initialize();\n\n    return TrickleNotifyHandler;\n\n});\n\n","define('extensions/adapt-contrib-trickle/js/handlers/resize',[\n    'coreJS/adapt', \n], function(Adapt) {\n\n    var TrickleBodyResizeHandler = _.extend({\n\n        isStepLocking: false,\n\n        stepView: null,\n\n        initialize: function() {\n            this.listenToOnce(Adapt, \"app:dataReady\", this.onAppDataReady);\n        },\n\n        onAppDataReady: function() {\n            this.debounceOnResize();\n            this.setupEventListeners();\n        },\n\n        debounceOnResize: function() {\n            this.onResize = _.debounce(_.bind(this.onResize, this), 10);\n        },\n\n        setupEventListeners: function() {\n            this.listenTo(Adapt, {\n                \"trickle:steplock\": this.onStepLock,\n                \"trickle:resize\": this.onTrickleResize,\n                \"trickle:stepunlock\": this.onStepUnlock,\n                \"trickle:kill\": this.onKill,\n                \"trickle:finished\": this.onFinished,\n                \"remove\": this.onRemove\n            });\n        },\n\n        onStepLock: function(view) {\n            this.isStepLocking = true;\n            this.stepView = view;\n            $(window).on(\"resize\", this.onResize);\n            $(\".page\").on(\"resize\", this.onResize);\n\n            //wait for height / visibility to adjust\n            _.defer(function() {\n                Adapt.trigger(\"trickle:resize\");\n            });\n        },\n\n        onResize: function() {\n            if (!this.isStepLocking) return;\n            Adapt.trigger(\"trickle:resize\");\n        },\n\n        onTrickleResize: function() {\n            if (!this.isStepLocking) return;\n            var offset = this.stepView.$el.offset();\n            var height = this.stepView.$el.height();\n\n            var topPadding = parseInt($(\"#wrapper\").css(\"padding-top\") || \"0\");\n\n            var bottom = (offset['top'] - topPadding) + height;\n\n            $(\"#wrapper\").css(\"height\", bottom );\n        },\n\n        onStepUnlock: function(view) {\n            this.isStepLocking = false;\n            this.stepView = null;\n            $(window).off(\"resize\", this.onResize);\n            $(\".page\").off(\"resize\", this.onResize);\n        },\n\n        onKill: function() {\n            this.onFinished();\n            this.onStepUnlock();\n        },\n\n        onFinished: function() {\n             $(\"#wrapper\").css(\"height\", \"\" );\n        },\n\n        onRemove: function() {\n            this.onStepUnlock();\n            this.stepView = null;\n        }\n\n    }, Backbone.Events);\n\n    TrickleBodyResizeHandler.initialize();\n\n    return TrickleBodyResizeHandler;\n\n});\n\n","define('extensions/adapt-contrib-trickle/js/handlers/tutor',[\n    'coreJS/adapt', \n], function(Adapt) {\n\n    var TrickleTutorHandler = _.extend({\n\n        stepLockedId: null,\n        isStepLocking: false,\n        isTutorOpen: false,\n\n        initialize: function() {\n            this.listenToOnce(Adapt, \"app:dataReady\", this.onAppDataReady);\n        },\n\n        onAppDataReady: function() {\n            this.setupEventListeners();\n        },\n\n        setupEventListeners: function() {\n            this.listenTo(Adapt, {\n                \"trickle:steplock\": this.onStepLock,\n                \"tutor:opened\": this.onTutorOpened,\n                \"tutor:closed\": this.onTutorClosed,\n                \"trickle:stepunlock\": this.onStepUnlock,\n                \"remove\": this.onRemove\n            });\n        },\n\n        onStepLock: function(view) {\n            if (view) {\n                this.stepLockedId = view.model.get(\"_id\");\n            }\n            this.isStepLocking = true;\n        },\n\n        onTutorOpened: function(view, alertObject) {\n            if (!this.isStepLocking) return;\n            if (!this.isOriginStepLocked(view)) return;\n\n            this.isTutorOpen = true;\n            Adapt.trigger(\"trickle:overlay\");\n            Adapt.trigger(\"trickle:wait\");\n        },\n\n        isOriginStepLocked: function(view) {\n            if (!view || !this.stepLockedId) return true;\n\n            var parents = view.model.getParents();\n            var hasStepLockedParent = parents.findWhere({_id:this.stepLockedId});\n            if (!hasStepLockedParent) return false;\n            return true;\n        },\n\n        onTutorClosed: function(view, alertObject) {\n            if (!this.isStepLocking) return;\n            if (!this.isTutorOpen) return;\n            if (!this.isOriginStepLocked(view)) return;\n\n            this.isTutorOpen = false;\n            Adapt.trigger(\"trickle:unoverlay\");\n            Adapt.trigger(\"trickle:unwait\");\n        },\n\n        onStepUnlock: function() {\n            this.isStepLocking = false;\n            this.stepLockedId = null;\n        },\n\n        onRemove: function() {\n            this.onStepUnlock();\n        }\n\n    }, Backbone.Events);\n\n    TrickleTutorHandler.initialize();\n\n    return TrickleTutorHandler;\n\n});\n\n","define('extensions/adapt-contrib-trickle/js/handlers/visibility',[\n    'coreJS/adapt', \n], function(Adapt) {\n\n    var TrickleVisibilityHandler = _.extend({\n\n        isStepLocking: false,\n\n        trickleModel: null,\n\n        initialize: function() {\n            this.listenToOnce(Adapt, \"app:dataReady\", this.onAppDataReady);\n        },\n\n        onAppDataReady: function() {\n            this.setupEventListeners();\n        },\n\n        setupEventListeners: function() {\n            this.listenTo(Adapt, {\n                \"trickle:steplock\": this.onStepLock,\n                \"trickle:visibility\": this.onVisibility,\n                \"trickle:stepunlock\": this.onStepUnlock,\n                \"trickle:kill\": this.onKill,\n                \"trickle:finished\": this.onFinished,\n                \"remove\": this.onRemove\n            });\n\n        },\n\n        onStepLock: function(view) {\n            this.isStepLocking = true;\n            this.trickleModel = view.model;\n            Adapt.trigger(\"trickle:visibility\");\n        },\n\n        onVisibility: function() {\n            if (!this.isStepLocking) return;\n\n            if (!Adapt.trickle.pageView) return;\n\n            var descendantsParentFirst = Adapt.trickle.pageView.descendantsParentFirst;\n\n            var trickleModelId = this.trickleModel.get(\"_id\");\n            var trickleType = this.trickleModel.get(\"_type\");\n\n            var atIndex = _.findIndex(descendantsParentFirst.models, function(descendant) {\n                if (descendant.get(\"_id\") === trickleModelId) return true;\n            });\n\n            descendantsParentFirst.each(function(descendant, index) {\n                if (index <= atIndex) {\n                    descendant.set(\"_isVisible\", true, {pluginName:\"trickle\"});\n                    var components = descendant.findDescendants(\"components\");\n                    components.each(function(componentModel) {\n                        componentModel.set(\"_isVisible\", true, {pluginName:\"trickle\"});\n                    });\n                } else {\n\n                    if (trickleType === \"article\" && descendant.get(\"_type\") === \"block\") {\n                        //make sure article blocks are shown\n                        if (descendant.get(\"_parentId\") === trickleModelId) {\n                            descendant.set(\"_isVisible\", true, {pluginName:\"trickle\"});\n                            var components = descendant.findDescendants(\"components\");\n                            components.each(function(componentModel) {\n                                componentModel.set(\"_isVisible\", true, {pluginName:\"trickle\"});\n                            });\n                            return;\n                        }\n                    }\n\n                    descendant.set(\"_isVisible\", false, {pluginName:\"trickle\"});\n                    var components = descendant.findDescendants(\"components\");\n                    components.each(function(componentModel) {\n                        componentModel.set(\"_isVisible\", false, {pluginName:\"trickle\"});\n                    });\n                }\n            });\n\n        },\n\n        onStepUnlock: function(view) {\n            this.isStepLocking = false;\n            this.trickleModel = null;\n        },\n\n        onKill: function() {\n            this.onFinished();\n            this.onStepUnlock();\n        },\n\n        onFinished: function() {\n\n            var descendantsParentFirst = Adapt.trickle.pageView.descendantsParentFirst;\n\n            descendantsParentFirst.each(function(descendant) {\n                descendant.set(\"_isVisible\", true, {pluginName:\"trickle\"});\n                var components = descendant.findDescendants(\"components\");\n                components.each(function(componentModel) {\n                    componentModel.set(\"_isVisible\", true, {pluginName:\"trickle\"});\n                });\n            });\n\n        },\n\n        onRemove: function() {\n            this.onStepUnlock();\n        }\n\n    }, Backbone.Events);\n\n    TrickleVisibilityHandler.initialize();\n\n    return TrickleVisibilityHandler;\n\n});\n\n","define('extensions/adapt-contrib-trickle/js/handlers/done',[\n    'coreJS/adapt', \n], function(Adapt) {\n\n    var TrickleDone = _.extend({\n\n        initialize: function() {\n            this.listenToOnce(Adapt, \"app:dataReady\", this.onAppDataReady);\n        },\n\n        onAppDataReady: function() {\n            this.setupEventListeners();\n        },\n\n        setupEventListeners: function() {\n            this.onDone = _.debounce(_.bind(this.onDone), 50);\n            this.listenTo(Adapt, {\n                \"trickle:steplock\": this.onDone,\n                \"trickle:stepunlock\": this.onDone,\n                \"trickle:continue\": this.onDone,\n                \"trickle:finished\": this.onDone\n            });\n        },\n\n        onDone: function() {\n            Adapt.trigger(\"trickle:done\");\n        }\n\n    }, Backbone.Events);\n\n    TrickleDone.initialize();\n\n    return TrickleDone;\n\n});\n\n","define('extensions/adapt-contrib-trickle/js/adapt-contrib-trickle',[\n    'coreJS/adapt',\n    './pageView',\n    'libraries/jquery.resize',\n    './lib/adaptModelExtension',\n    './handlers/button',\n    './handlers/completion',\n    './handlers/notify',\n    './handlers/resize',\n    './handlers/tutor',\n    './handlers/visibility',\n    './handlers/done'\n], function(Adapt, PageView) {\n\n    Adapt.trickle = _.extend({\n\n        model: null,\n        pageView: null,\n\n        initialize: function() {\n            this.listenToOnce(Adapt, {\n                \"app:dataReady\": this.onAppDataReady\n            });\n        },\n\n        onAppDataReady: function() {\n            this.getCourseModel();\n            if (!this.isCourseEnabled()) return;\n            this.setupListeners();\n        },\n\n        getCourseModel: function() {\n            this.model = Adapt.course;\n        },\n\n        isCourseEnabled: function() {\n            var trickleConfig = this.getModelConfig(this.model);\n            if (trickleConfig && trickleConfig._isEnabled === false) return false;\n            return true;\n        },\n\n        getModelConfig: function(model) {\n            return model.get(\"_trickle\");\n        },\n\n        setModelConfig: function(model, config) {\n            return model.set(\"_trickle\", config);\n        },\n\n        setupListeners: function() {\n            this.listenTo(Adapt, {\n                \"pageView:preRender\": this.onPagePreRender,\n                \"remove\": this.onRemove\n            });\n        },\n\n        onPagePreRender: function(view) {\n            this.pageView = new PageView({\n                model: view.model, \n                el: view.el\n            });\n        },\n\n        scroll: function(fromModel) {\n            //wait for model visibility to handle\n            _.delay(_.bind(function() {\n\n                if (!this.shouldScrollPage(fromModel)) return;\n\n                var trickle = Adapt.trickle.getModelConfig(fromModel);\n                var scrollTo = trickle._scrollTo;\n                if (scrollTo === undefined) scrollTo = \"@block +1\";\n\n                fromModel.set(\"_isTrickleAutoScrollComplete\", true);\n\n                var scrollToId = \"\";\n                switch (scrollTo.substr(0,1)) {\n                case \"@\":\n                    //NAVIGATE BY RELATIVE TYPE\n                    \n                    //Allows trickle to scroll to a sibling / cousin component relative to the current trickle item\n                    var relativeModel = fromModel.findRelative(scrollTo, {\n                        filterNotAvailable: true\n                    });\n                    \n                    if (relativeModel === undefined) return;\n                    scrollToId = relativeModel.get(\"_id\");\n\n                    //console.log(\"trickle scrolling to\", scrollToId, \"from\", fromModel.get(\"_id\"));\n\n                    break;\n                case \".\":\n                    //NAVIGATE BY CLASS\n                    scrollToId = scrollTo.substr(1, scrollTo.length-1);\n                    break;\n                default: \n                    scrollToId = scrollTo;\n                }\n\n                if (scrollToId == \"\") return;\n                \n                var duration = fromModel.get(\"_trickle\")._scrollDuration || 500;\n                Adapt.scrollTo(\".\" + scrollToId, { duration: duration });\n\n            }, this), 250);\n        },\n\n        shouldScrollPage: function(fromModel) {\n            var trickle = Adapt.trickle.getModelConfig(fromModel);\n            if (!trickle || !trickle._isEnabled) return false;\n\n            var hasScrolled = fromModel.get(\"_isTrickleAutoScrollComplete\");\n            if (hasScrolled) return false;\n\n            var isAutoScrollOff = (!trickle._autoScroll);\n            if (isAutoScrollOff) return false;\n\n            var isArticleWithOnChildren = (fromModel.get(\"_type\") === \"article\" && trickle._onChildren);\n            if (isArticleWithOnChildren) return false;\n\n            return true;\n        },\n\n        onRemove: function() {\n            \n        }\n                \n    }, Backbone.Events);\n\n    Adapt.trickle.initialize();\n\n    return Adapt.trickle;\n\n});\n\n","define('extensions/adapt-contrib-tutor/js/adapt-contrib-tutor',[\n    'coreJS/adapt'\n],function(Adapt) {\n\n    Adapt.on('questionView:showFeedback', function(view) {\n\n        var alertObject = {\n            title: view.model.get(\"feedbackTitle\"),\n            body: view.model.get(\"feedbackMessage\")\n        };\n\n        if (view.model.has('_isCorrect')) {\n            // Attach specific classes so that feedback can be styled.\n            if (view.model.get('_isCorrect')) {\n                alertObject._classes = 'correct';\n            } else {\n                if (view.model.has('_isAtLeastOneCorrectSelection')) {\n                    // Partially correct feedback is an option.\n                    alertObject._classes = view.model.get('_isAtLeastOneCorrectSelection')\n                        ? 'partially-correct'\n                        : 'incorrect';\n                } else {\n                    alertObject._classes = 'incorrect';\n                }\n            }\n        }\n\n        Adapt.once(\"notify:closed\", function() {\n            Adapt.trigger(\"tutor:closed\", view, alertObject);\n        });\n\n        Adapt.trigger('notify:popup', alertObject);\n\n        Adapt.trigger('tutor:opened', view, alertObject);\n    });\n\n});\n\n","define('extensions/adapt-devtools/js/devtools-model',['require','coreJS/adapt'],function(require) {\n\n\tvar Adapt = require('coreJS/adapt');\n\n\tvar DevtoolsModel = Backbone.Model.extend({\n\n\t\tinitialize:function() {\n\t\t\tvar config = Adapt.config.has('_devtools') ? Adapt.config.get('_devtools') : this.getDefaultConfig();\n\t\t\tthis.set(_.extend({\n\t\t\t\t'_trickleEnabled':false,\n\t\t\t\t'_hintingAvailable':true,\n\t\t\t\t'_hintingEnabled':false,\n\t\t\t\t'_toggleFeedbackAvailable':true,\n\t\t\t\t'_feedbackEnabled':true,\n\t\t\t\t'_autoCorrectAvailable':true,\n\t\t\t\t'_autoCorrectEnabled':false,\n\t\t\t\t'_altTextAvailable':true,\n\t\t\t\t'_altTextEnabled':false,\n\t\t\t\t'_tutorListener':null,\n\t\t\t\t'_unlockAvailable':true,\n\t\t\t\t'_unlocked':false,\n\t\t\t\t'_toggleBankingAvailable':true\n\t\t\t}, config));\n\t\t},\n\n\t\tgetDefaultConfig:function() {\n\t\t\treturn {\n\t\t\t\t'_isEnabled':false,\n\t\t\t\t'_theme':'theme-dark'\n\t\t\t};\n\t\t},\n\n\t\ttoggleFeedback:function() {\n\t\t\tthis.set('_feedbackEnabled', !this.get('_feedbackEnabled'));\n\t\t},\n\n\t\ttoggleHinting:function() {\n\t\t\tthis.set('_hintingEnabled', !this.get('_hintingEnabled'));\n\t\t},\n\n\t\ttoggleAutoCorrect:function() {\n\t\t\tthis.set('_autoCorrectEnabled', !this.get('_autoCorrectEnabled'));\n\t\t},\n\n\t\ttoggleAltText:function() {\n\t\t\tthis.set('_altTextEnabled', !this.get('_altTextEnabled'));\n\t\t}\n\t});\n\n\treturn DevtoolsModel;\n});\n\n","define('extensions/adapt-devtools/js/hinting',['require','coreJS/adapt'],function(require) {\n\n\tvar Adapt = require('coreJS/adapt');\n\n\tvar Hinting = _.extend({\n\n\t\tinitialize:function() {\n\t\t\tthis.listenTo(Adapt.devtools, 'change:_hintingEnabled', this.toggleHints);\n\t\t},\n\n\t\ttoggleHints:function() {\n\t\t\tvar contentObject = Adapt.findById(Adapt.location._currentId);\n\t\t\tvar components = contentObject.findDescendants('components');\n\t\t\tvar renderedQuestions = components.where({'_isQuestionType':true, '_isReady':true});\n\n\t\t\t_.each(renderedQuestions, function(model) {\n\t\t\t\tthis.setHinting($('.'+model.get('_id')), model, Adapt.devtools.get('_hintingEnabled'));\n\t\t\t}, this);\n\n\t\t\tif (Adapt.devtools.get('_hintingEnabled')) this.listenTo(Adapt, 'componentView:postRender', this.onComponentRendered);\n\t\t\telse this.stopListening(Adapt, 'componentView:postRender');\n\t\t},\n\n\t\tonComponentRendered:function(view, hintingEnabled) {\n\t\t\tif (view.model.get('_isQuestionType')) this.setHinting(view.$el, view.model);\n\t\t},\n\n\t\tsetHinting:function($el, model, hintingEnabled) {\n\t\t\tswitch (model.get('_component')) {\n\t\t\t\tcase 'mcq':this.setMcqHinting($el, model, hintingEnabled !== false); break;\n\t\t\t\tcase 'gmcq':this.setGmcqHinting($el, model, hintingEnabled !== false); break;\n\t\t\t\tcase 'matching':this.setMatchingHinting($el, model, hintingEnabled !== false); break;\n\t\t\t\tcase 'slider':this.setSliderHinting($el, model, hintingEnabled !== false); break;\n\t\t\t\tcase 'textinput':this.setTextInputHinting($el, model, hintingEnabled !== false); break;\n\t\t\t\tcase 'questionStrip':this.setQuestionStripHinting($el, model, hintingEnabled !== false); break;\n\t\t\t}\n\t\t},\n\n\t\tsetMcqHinting:function($el, model, hintingEnabled) {\n\t\t\tif (hintingEnabled) {\n\t\t\t\t_.each(model.get('_items'), function(item, index) {\n\t\t\t\t\t$el.find('.mcq-item').eq(index).addClass(item._shouldBeSelected ? 'hintCorrect' : 'hintIncorrect');\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$el.find('.mcq-item').removeClass('hintCorrect hintIncorrect');\n\t\t\t}\n\t\t},\n\n\t\tsetGmcqHinting:function($el, model, hintingEnabled) {\n\t\t\tif (hintingEnabled) {\n\t\t\t\t_.each(model.get('_items'), function(item, index) {\n\t\t\t\t\t$el.find('.gmcq-item').eq(index).addClass(item._shouldBeSelected ? 'hintCorrect' : 'hintIncorrect');\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$el.find('.gmcq-item').removeClass('hintCorrect hintIncorrect');\n\t\t\t}\n\t\t},\n\n\t\tsetMatchingHinting:function($el, model, hintingEnabled) {\n\t\t\tif (hintingEnabled) {\n\t\t\t\t_.each(model.get('_items'), function(item, itemIndex) {\n\t\t\t\t\tvar $select = $el.find('select').eq(itemIndex);\n\t\t\t\t\tvar $options = $select.find('option');\n\t\t\t\t\t_.each(item._options, function(option, optionIndex) {\n\t\t\t\t\t\t/*if (Modernizr.touch) {*/\n\t\t\t\t\t\t\tif (option._isCorrect) $options.eq(optionIndex+1).append('<span class=\"hint\"> (correct)</span>');\n\t\t\t\t\t\t/*}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t$options.eq(optionIndex+1).addClass(option._isCorrect ? 'hintCorrect' : 'hintIncorrect');\n\t\t\t\t\t\t}*/\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\t/*if (Modernizr.touch) */$el.find('option .hint').remove();\n\t\t\t\t/*else $el.find('option').removeClass('hintCorrect hintIncorrect');*/\n\t\t\t}\n\t\t},\n\n\t\tsetSliderHinting:function($el, model, hintingEnabled) {\n\t\t\tif (hintingEnabled) {\n\t\t\t\tvar correctAnswer = model.get('_correctAnswer');\n\t\t\t\tif (correctAnswer) {\n\t\t\t\t\t$el.find('.slider-scale-number').addClass('hintIncorrect');\n\t\t\t\t\t$el.find('.slider-scale-number[data-id=\"'+correctAnswer+'\"]').removeClass('hintIncorrect').addClass('hintCorrect');\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t$el.find('.slider-scale-number').addClass('hintIncorrect');\n\t\t\t\t\tvar bottom = model.get('_correctRange')._bottom;\n\t        \t\tvar top = model.get('_correctRange')._top;\n\t        \t\tfor (var i = bottom; i <= top; i++)\n\t        \t\t\t$el.find('.slider-scale-number[data-id=\"'+i+'\"]').removeClass('hintIncorrect').addClass('hintCorrect');\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$el.find('.slider-scale-number').removeClass('hintCorrect hintIncorrect');\n\t\t\t}\n\t\t},\n\n\t\tsetTextInputHinting:function($el, model, hintingEnabled) {\n\t\t\tif (hintingEnabled) {\n\t\t\t\t_.each(model.get('_items'), function(item, index) {\n\t\t\t\t\tif (model.get('_answers')) {\n\t\t\t\t\t\t// generic answers\n\t\t\t\t\t\t$el.find('.textinput-item').eq(index).find('input').attr('placeholder', model.get('_answers')[index][0]);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// specific answers\n\t\t\t\t\t\t$el.find('.textinput-item').eq(index).find('input').attr('placeholder', item._answers[0]);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\t_.each(model.get('_items'), function(item, index) {\n\t\t\t\t\tif (model.get('_answers')) {\n\t\t\t\t\t\t$el.find('.textinput-item').eq(index).find('input').attr('placeholder', item.placeholder);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\tsetQuestionStripHinting:function($el, model, hintingEnabled) {\n\t\t\tif (hintingEnabled) {\n\t\t\t\t_.each(model.get('_items'), function(item, itemIndex) {\n\t\t\t\t\tvar $item = $el.find('.component-item').eq(itemIndex);\n\t\t\t\t\tvar $subItems = $item.find('.qs-strapline-header-inner:not(.qs-noop) .qs-strapline-title-inner');\n\t\t\t\t\t_.each(item._subItems, function(subItem, subItemIndex) {\n\t\t\t\t\t\tif (subItem._isCorrect) $subItems.eq(subItemIndex).append('<span class=\"hint\"> (correct)</span>');\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$el.find('.qs-strapline-title-inner .hint').remove();\n\t\t\t}\n\t\t}\n\t}, Backbone.Events);\n\n\tAdapt.once('adapt:initialize devtools:enable', function() {\n\t\tif (!Adapt.devtools.get('_isEnabled')) return;\n\n\t\tHinting.initialize();\n\t});\n\n\treturn Hinting;\n});\n\n","define('extensions/adapt-devtools/js/is-question-supported',['require'],function(require) {\n\tfunction isQuestionSupported(model) {\n\t\tswitch (model.get('_component')) {\n\t\t\tcase 'mcq':\n\t\t\tcase 'gmcq':\n\t\t\tcase 'matching':\n\t\t\tcase 'slider':\n\t\t\tcase 'textinput':\n\t\t\tcase 'questionStrip':return true;\n\t\t\tdefault: return false;\n\t\t}\n\t}\n\n\treturn isQuestionSupported;\n});\n","define('extensions/adapt-devtools/js/auto-answer',['require','coreJS/adapt','./hinting','./is-question-supported'],function(require) {\n\n\tvar Adapt = require('coreJS/adapt');\n\tvar Hinting = require('./hinting');\n\tvar isQuestionSupported = require('./is-question-supported');\n\n\tvar AutoAnswer = _.extend({\n\n\t\tinitialize:function() {\n\t\t\tthis.listenTo(Adapt, 'componentView:postRender', this.componentRendered);\n\t\t},\n\n\t\tcomponentRendered:function(view) {\n\t\t\tif (isQuestionSupported(view.model)) {\n\t\t\t\tif (view.buttonsView) {\n\t\t\t\t\tview.$('.buttons-action').on('mousedown', _.bind(this.onSubmitClicked, this, view));\n\t\t\t\t}\n\t\t\t\telse if (Adapt.devtools.get('_debug')) {\n\t\t\t\t\tconsole.warn('adapt-devtools: could not find submit button on '+view.model.get('_id'));\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tonSubmitClicked:function(view, e) {\n\t\t\t// remove hinting if enabled\n\t\t\tif (Adapt.devtools.get('_hintingEnabled')) Hinting.setHinting(view.$el, view.model, false);\n\n\t\t\tif ((e.ctrlKey && !e.shiftKey) || Adapt.devtools.get('_autoCorrectEnabled')) {\n\t\t\t\tthis.answer(view);\n\t\t\t}\n\t\t\telse if (e.ctrlKey && e.shiftKey) {\n\t\t\t\tthis.answer(view, true);\n\t\t\t}\n\t\t},\n\n\t\tanswer:function(view, incorrectly) {\n\t\t\tif (view.model.get('_isSubmitted')) return;\n\n\t\t\tif (Adapt.devtools.get('_debug')) {\n\t\t\t\tconsole.log('adapt-devtools: answer '+view.model.get('_id')+(incorrectly === true ? ' incorrectly' : ''));\n\t\t\t}\n\n\t\t\tif (incorrectly === true) {\n\t\t\t\tswitch (view.model.get('_component')) {\n\t\t\t\t\tcase 'mcq':this.answerMultipleChoiceIncorrectly(view); break;\n\t\t\t\t\tcase 'gmcq':this.answerMultipleChoiceIncorrectly(view, true); break;\n\t\t\t\t\tcase 'matching':this.answerMatchingIncorrectly(view); break;\n\t\t\t\t\tcase 'slider':this.answerSliderIncorrectly(view); break;\n\t\t\t\t\tcase 'textinput':this.answerTextInputIncorrectly(view); break;\n\t\t\t\t\tcase 'questionStrip':this.answerQuestionStripIncorrectly(view); break;\n\t\t\t\t\tdefault:this.answerUnsupportedIncorrectly(view);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tswitch (view.model.get('_component')) {\n\t\t\t\t\tcase 'mcq':this.answerMultipleChoice(view); break;\n\t\t\t\t\tcase 'gmcq':this.answerMultipleChoice(view, true); break;\n\t\t\t\t\tcase 'matching':this.answerMatching(view); break;\n\t\t\t\t\tcase 'slider':this.answerSlider(view); break;\n\t\t\t\t\tcase 'textinput':this.answerTextInput(view); break;\n\t\t\t\t\tcase 'questionStrip':this.answerQuestionStrip(view); break;\n\t\t\t\t\tdefault:this.answerUnsupported(view);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tanswerMultipleChoice:function(view, isGraphical) {\n\t\t\t_.each(view.model.get('_items'), function(item, index) {\n\t\t\t\tif (item._shouldBeSelected && !item._isSelected || !item._shouldBeSelected && item._isSelected) {\n\t\t\t\t\tview.$(isGraphical ? '.gmcq-item input' : '.mcq-item input').eq(index).trigger('change');\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\tanswerMultipleChoiceIncorrectly:function(view, isGraphical) {\n\t\t\tvar model = view.model, items = model.get('_items'), itemCount = items.length;\n\t\t\tvar selectionStates = _.times(itemCount, function() {return false;});\n\t\t\t// number of items that should be selected\n\t\t\tvar nShould = _.where(items, {_shouldBeSelected:true}).length;\n\t\t\t// and number that should not\n\t\t\tvar nShouldNot = itemCount - nShould;\n\t\t\t// decide how many items to select\n\t\t\tvar nSelect = model.get('_selectable');\n\t\t\t// decide how many of these should be incorrect\n\t\t\tvar nIncorrect = nShouldNot == 0 ? 0 : _.random(nShould == 1 ? 1 : 0, Math.min(nShouldNot, nSelect));\n\t\t\t// and how many should be correct\n\t\t\tvar nCorrect = nIncorrect == 0 ? _.random(1, Math.min(nShould - 1, nSelect)) : _.random(0, Math.min(nShould, nSelect - nIncorrect));\n\n\t\t\tif (itemCount == 1 || nSelect == 0) {\n\t\t\t\tconsole.warn('adapt-devtools: not possible to answer '+model.get('_id')+' incorrectly');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfor (var j = 0; j < nIncorrect; j++) {\n\t\t\t\t// start at a random position in items to avoid bias (err is contingency for bad data)\n\t\t\t\tfor (var k=_.random(itemCount), err=itemCount, found=false; !found && err>=0; k++, err--) {\n\t\t\t\t\tvar index = k%itemCount;\n\t\t\t\t\tif (selectionStates[index] === false) {\n\t\t\t\t\t\tif (!items[index]._shouldBeSelected) selectionStates[index] = found = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (var j = 0; j < nCorrect; j++) {\n\t\t\t\t// start at a random position in items to avoid bias (err is contingency for bad data)\n\t\t\t\tfor (var k=_.random(itemCount), err=itemCount, found=false; !found && err>=0; k++, err--) {\n\t\t\t\t\tvar index = k%itemCount;\n\t\t\t\t\tif (selectionStates[index] === false) {\n\t\t\t\t\t\tif (items[index]._shouldBeSelected) selectionStates[index] = found = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t_.each(items, function(item, index) {\n\t\t\t\tif (selectionStates[index] && !item._isSelected || !selectionStates[index] && item._isSelected) {\n\t\t\t\t\tview.$(isGraphical ? '.gmcq-item input' : '.mcq-item input').eq(index).trigger('change');\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\tanswerMatching:function(view) {\n\t\t\t_.each(view.model.get('_items'), function(item, itemIndex) {\n\t\t\t\tvar $select = view.$('select').eq(itemIndex);\n\t\t\t\tvar $options = $select.find('option');\n\t\t\t\t_.each(item._options, function(option, optionIndex) {\n\t\t\t\t\tif (option._isCorrect) $options.eq(optionIndex+1).prop('selected', true);\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\tanswerMatchingIncorrectly:function(view) {\n\t\t\tvar items = view.model.get('_items'), itemCount = items.length, nIncorrect = _.random(1, itemCount);\n\t\t\t// decide which items to answer incorrectly (minimum one)\n\t\t\tvar selectionStates = _.shuffle(_.times(itemCount, function(i) {return i<nIncorrect;}));\n\n\t\t\t_.each(items, function(item, itemIndex) {\n\t\t\t\tvar $select = view.$('select').eq(itemIndex);\n\t\t\t\tvar $options = $select.find('option');\n\t\t\t\t// check if this item is to be answered incorrectly\n\t\t\t\tif (selectionStates[itemIndex]) {\n\t\t\t\t\t// start at a random position in options to avoid bias (err is contingency for bad data)\n\t\t\t\t\tfor (var count=item._options.length, i=_.random(count), err=count; err>=0; i++, err--)\n\t\t\t\t\t\tif (!item._options[i%count]._isCorrect) {\n\t\t\t\t\t\t\t$options.eq((i%count)+1).prop('selected', true);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t_.each(item._options, function(option, optionIndex) {\n\t\t\t\t\t\tif (option._isCorrect) $options.eq(optionIndex+1).prop('selected', true);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\tanswerSlider:function(view) {\n\t\t\tvar correctAnswer = view.model.get('_correctAnswer');\n\t\t\tif (correctAnswer) {\n\t\t\t\tview.$('.slider-scale-number[data-id=\"'+correctAnswer+'\"]').trigger('click');\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar bottom = view.model.get('_correctRange')._bottom;\n        \t\tvar top = view.model.get('_correctRange')._top;\n        \t\tvar d = top - bottom;\n        \t\t// select from range at random\n        \t\tview.$('.slider-scale-number[data-id=\"'+(bottom+Math.floor(Math.random()*(d+1)))+'\"]').trigger('click');\n\t\t\t}\n\t\t},\n\n\t\tanswerSliderIncorrectly:function(view) {\n\t\t\tvar correctAnswer = view.model.get('_correctAnswer');\n\t\t\tvar start = view.model.get('_scaleStart'), end = view.model.get('_scaleEnd');\n\t\t\tvar incorrect = _.times(end-start+1, function(i) {return start+i;});\n\t\t\tif (correctAnswer) {\n\t\t\t\tincorrect.splice(correctAnswer-start, 1);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar bottom = view.model.get('_correctRange')._bottom;\n        \t\tvar top = view.model.get('_correctRange')._top;\n        \t\tincorrect.splice(bottom-start, top-bottom+1);\n\t\t\t}\n\t\t\tview.$('.slider-scale-number[data-id=\"'+_.shuffle(incorrect)[0]+'\"]').trigger('click');\n\t\t},\n\n\t\tanswerTextInput:function(view) {\n\t\t\tvar answers = view.model.get('_answers');\n\t\t\t_.each(view.model.get('_items'), function(item, index) {\n\t\t\t\tif (answers) view.$('.textinput-item input').eq(index).val(answers[index][0]); // generic answers\n\t\t\t\telse view.$('.textinput-item input').eq(index).val(item._answers[0]); // specific answers\n\t\t\t});\n\t\t},\n\n\t\tanswerTextInputIncorrectly:function(view) {\n\t\t\tvar items = view.model.get('_items'), itemCount = items.length, nIncorrect = _.random(1, itemCount);\n\t\t\t// decide which items to answer incorrectly (minimum one)\n\t\t\tvar selectionStates = _.shuffle(_.times(itemCount, function(i) {return i<nIncorrect;}));\n\t\t\tvar answers = view.model.get('_answers');\n\t\t\t_.each(items, function(item, index) {\n\t\t\t\tif (selectionStates[index]) {\n\t\t\t\t\tview.$('.textinput-item input').eq(index).val('***4n 1nc0rr3ct 4nsw3r***'); // probably\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (answers) view.$('.textinput-item input').eq(index).val(answers[index][0]);\n\t\t\t\t\telse view.$('.textinput-item input').eq(index).val(item._answers[0]);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\tanswerQuestionStrip:function(view) {\n\t\t\t_.each(view.model.get('_items'), function(item, itemIndex) {\n\t\t\t\t_.each(item._subItems, function(subItem, subItemIndex) {\n\t\t\t\t\tif (subItem._isCorrect) view.setStage(itemIndex, subItemIndex, true);\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\tanswerQuestionStripIncorrectly:function(view) {\n\t\t\tvar items = view.model.get('_items'), itemCount = items.length, nIncorrect = _.random(1, itemCount);\n\t\t\t// decide which items to answer incorrectly (minimum one)\n\t\t\tvar selectionStates = _.shuffle(_.times(itemCount, function(i) {return i<nIncorrect;}));\n\n\t\t\t_.each(items, function(item, itemIndex) {\n\t\t\t\t// check if this item is to be answered incorrectly\n\t\t\t\tif (selectionStates[itemIndex]) {\n\t\t\t\t\t// start at a random position in subitems to avoid bias (err is contingency for bad data)\n\t\t\t\t\tfor (var count=item._subItems.length, i=_.random(count), err=count; err>=0; i++, err--)\n\t\t\t\t\t\tif (!item._subItems[i%count]._isCorrect) {\n\t\t\t\t\t\t\tview.setStage(itemIndex, i%count, true);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t_.each(item._subItems, function(subItem, subItemIndex) {\n\t\t\t\t\t\tif (subItem._isCorrect) view.setStage(itemIndex, subItemIndex, true);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\tanswerUnsupported:function(view) {\n\t\t\tvar model = view.model;\n\n\t\t\tmodel.set({\"_isComplete\":true, \"_isInteractionComplete\":true, \"_isCorrect\":true, \"_isSubmitted\":true, \"_score\":1});\n\t\t\tmodel.set(\"_attemptsLeft\", Math.max(0, model.get(\"_attempts\") - 1));\n\t\t},\n\n\t\tanswerUnsupportedIncorrectly:function(view) {\n\t\t\tvar model = view.model;\n\t\t\t\n\t\t\tmodel.set({\"_isComplete\":true, \"_isInteractionComplete\":true, \"_isCorrect\":false, \"_isSubmitted\":true, \"_score\":0});\n\t\t\tmodel.set(\"_attemptsLeft\", Math.max(0, model.get(\"_attempts\") - 1));\n\t\t}\n\t}, Backbone.Events);\n\t\n\tAdapt.on('app:dataReady devtools:enable', function() {\n\t\tif (!Adapt.devtools.get('_isEnabled')) return;\n\n\t\tAutoAnswer.initialize();\n\t});\n\n\treturn AutoAnswer;\n});\n\n","define('extensions/adapt-devtools/js/pass-half-fail',['require','coreJS/adapt','./auto-answer'],function(require) {\n\n\tvar Adapt = require('coreJS/adapt');\n\tvar AutoAnswer = require('./auto-answer');\n\n\tvar PassHalfFail = _.extend({\n\t\tinitialize:function() {\n\t\t\tthis._questionViews = [];\n\t\t\tthis._currentPageId = null;\n\t\t\tthis.listenTo(Adapt, 'pageView:preRender', this.onPagePreRender);\n\t\t\tthis.listenTo(Adapt, 'remove', this.onRemove);\n\t\t},\n\n\t\t_completeNonQuestions:function() {\n\t\t\tvar currentModel = Adapt.findById(Adapt.location._currentId);\n\t\t\tvar nonQuestions = currentModel.findDescendants(\"components\").filter(function(m) {return m.get('_isQuestionType') !== true;});\n\n\t\t\t_.each(nonQuestions, function(item) {\n\t\t\t\titem.set(\"_isComplete\", true);\n\t\t\t\titem.set(\"_isInteractionComplete\", true);\n\t\t\t});\n\t\t},\n\n\t\tpass:function(callback) {\n\t\t\tvar i = 0, qs = this._questionViews, len = qs.length;\n\n\t\t\t//this._completeNonQuestions();\n\n\t\t\t// async to avoid locking up the interface\n\t\t\tfunction step() {\n\t\t\t\tfor (var j=0, count=Math.min(2, len-i); j < count; i++, j++) {\n\t\t\t\t\tAutoAnswer.answer(qs[i]);\n\t\t\t\t\tif (!qs[i].model.get('_isSubmitted')) qs[i].$('.buttons-action').trigger('click');\n\t\t\t\t}\n\t\t\t\ti == len ? callback() : setTimeout(step);\n\t\t\t}\n\n\t\t\tstep();\n\t\t},\n\n\t\thalf:function(callback) {\n\t\t\tvar notSubmitted = function(view) {return !view.model.get('_isSubmitted')};\n\t\t\tvar qs = _.shuffle(_.filter(this._questionViews, notSubmitted));\n\t\t\tvar i = 0, len = qs.length;\n\n\t\t\t//this._completeNonQuestions();\n\n\t\t\t// async to avoid locking up the interface\n\t\t\tfunction step() {\n\t\t\t\tfor (var j=0, count=Math.min(2, len-i); j < count; i++, j++) {\n\t\t\t\t\tAutoAnswer.answer(qs[i], i % 2 == 0);\n\t\t\t\t\tif (!qs[i].model.get('_isSubmitted')) qs[i].$('.buttons-action').trigger('click');\n\t\t\t\t}\n\t\t\t\ti == len ? callback() : setTimeout(step);\n\t\t\t}\n\n\t\t\tstep();\n\t\t},\n\n\t\tfail:function(callback) {\n\t\t\tvar i = 0, qs = this._questionViews, len = qs.length;\n\n\t\t\t//this._completeNonQuestions();\n\n\t\t\t// async to avoid locking up the interface\n\t\t\tfunction step() {\n\t\t\t\tfor (var j=0, count=Math.min(2, len-i); j < count; i++, j++) {\n\t\t\t\t\tAutoAnswer.answer(qs[i], true);\n\t\t\t\t\tif (!qs[i].model.get('_isSubmitted')) qs[i].$('.buttons-action').trigger('click');\n\t\t\t\t}\n\t\t\t\ti == len ? callback() : setTimeout(step);\n\t\t\t}\n\n\t\t\tstep();\n\t\t},\n\n\t\tonPagePreRender:function(view) {\n\t\t\tthis._currentPageId = view.model.get('_id');\n\t\t\tthis.listenTo(Adapt, 'componentView:postRender', this.onComponentRendered);\n\t\t},\n\n\t\tonRemove:function() {\n\t\t\tthis.stopListening(Adapt, 'componentView:postRender', this.onComponentRendered);\n\t\t\tthis._questionViews = [];\n\t\t},\n\n\t\tonComponentRendered:function(view) {\n\t\t\t// check component is part of current page\n\t\t\tif (view.model.has('_parentId') && view.model.findAncestor('contentObjects').get('_id') == this._currentPageId) {\n\t\t\t\tif (view.model.get('_isQuestionType')) {\n\t\t\t\t\tthis._questionViews.push(view);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}, Backbone.Events);\n\n\tAdapt.on('app:dataReady devtools:enable', function() {\n\t\tif (!Adapt.devtools.get('_isEnabled')) return;\n\n\t\tPassHalfFail.initialize();\n\t});\n\n\treturn PassHalfFail;\n});\n\n","define('extensions/adapt-devtools/js/toggle-banking',['require','coreJS/adapt','coreJS/router'],function(require) {\n\n\tvar Adapt = require('coreJS/adapt');\n\tvar Router = require('coreJS/router');\n\n\tvar ToggleBanking = {\n\n\t\tinitialize:function() {\n\t\t\tAdapt.articles.each(function(m) {\n\t\t\t\tvar config = this.getConfig(m);\n\t\t\t\tif (m.has('_assessment') && m.get('_assessment')._banks && !m.get('_assessment')._banks._isEnabled) {\n\t\t\t\t\tconfig._assessmentBankDisabled = true;\n\t\t\t\t}\n\t\t\t}, this);\n\t\t},\n\n\t\tgetConfig:function(articleModel) {\n\t\t\tif (!articleModel.has('_devtools')) articleModel.set('_devtools', {});\n\t\t\treturn articleModel.get('_devtools');\n\t\t},\n\n\t\tgetBankedAssessmentsInCurrentPage:function() {\n\t\t\tvar pageModel = Adapt.findById(Adapt.location._currentId);\n\t\t\tvar f = function(m) {\n\t\t\t\tconfig = this.getConfig(m);\n\t\t\t\tif (!config._assessmentBankDisabled &&\n\t\t\t\t\tm.has('_assessment') &&\n\t\t\t\t\tm.get('_assessment')._isEnabled &&\n\t\t\t\t\tm.get('_assessment')._banks._split.length > 1) return true;\n\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\treturn Adapt.location._contentType == 'menu' ? [] : pageModel.findDescendants('articles').filter(f, this);\n\t\t},\n\n\t\ttoggle:function() {\n\t\t\tvar bankedAssessments = this.getBankedAssessmentsInCurrentPage();\n\t\t\tvar isBankingEnabled = function(m) {return m.get('_assessment')._banks._isEnabled;};\n\t\t\tvar enable = !bankedAssessments.some(isBankingEnabled);\n\n\t\t\t_.each(bankedAssessments, function(articleModel) {\n\t\t\t\tarticleModel.get('_assessment')._banks._isEnabled = enable;\n\t\t\t\t// set properties to trigger setup of assessment data\n\t\t\t\tarticleModel.set({'_attemptInProgress':false, '_isPass':false});\n\t\t\t});\n\n\t\t\t// reload page\n\t\t\tRouter.handleId(Adapt.location._currentId);\n\t\t}\n\t};\n\n\tAdapt.once('adapt:initialize devtools:enable', function() {\n\t\tif (!Adapt.devtools.get('_isEnabled')) return;\n\n\t\tToggleBanking.initialize();\n\t});\n\n\treturn ToggleBanking;\n});\n\n","define('extensions/adapt-devtools/js/map',['require','coreJS/adapt','coreJS/router'],function(require) {\n\n\tvar Adapt = require('coreJS/adapt');\n\tvar Router = require('coreJS/router');\n\n\tvar MapView = Backbone.View.extend({\n\t\tevents: {\n\t\t\t'click a':'onLinkClicked'\n\t\t},\n\n\t\tinitialize: function() {\n\t\t\tthis.$('html').addClass('devtools-map');\n\t\t\tthis._renderIntervalId = setInterval(_.bind(this._checkRenderInterval, this), 500);\n\t\t\tthis.listenTo(Adapt.components, 'change:_isComplete', this.onModelCompletionChanged);\n\t\t\tthis.listenTo(Adapt.blocks, 'change:_isComplete', this.onModelCompletionChanged);\n\t\t\tthis.listenTo(Adapt.articles, 'change:_isComplete', this.onModelCompletionChanged);\n\t\t\tthis.listenTo(Adapt.contentObjects, 'change:_isComplete', this.onModelCompletionChanged);\n\t\t\tthis.render();\n\t\t},\n\n\t\trender: function() {\n\t\t\tvar config = Adapt.devtools;\n            var data = this.model;\n            var startTime = new Date().getTime();\n\n            var template = Handlebars.templates['devtoolsMap'];\n            this.$('body').addClass(config.has('_theme') ? config.get('_theme') : 'theme-light');\n            this.$('body').html(template(data));\n\n            //console.log('adapt-devtools: map rendered in ' + ((new Date().getTime())-startTime) + ' ms');\n\t\t},\n\n\t\tremove: function() {\n\t\t\tclearInterval(this._renderIntervalId);\n            this.$('body').html('Course closed!');\n            this.stopListening();\n            return this;\n        },\n\n\t\t_checkRenderInterval:function() {\n\t\t\tif (this._invalid) {\n\t\t\t\tthis._invalid = false;\n\t\t\t\tthis.render();\n\t\t\t}\n\t\t},\n\n\t\t_getConfig:function(pageModel) {\n\t\t\tif (!pageModel.has('_devtools')) pageModel.set('_devtools', {});\n\t\t\treturn pageModel.get('_devtools');\n\t\t},\n\n\t\t_disablePageIncompletePrompt:function(pageModel) {\n\t\t\tvar config = this._getConfig(pageModel);\n\n\t\t\tif (pageModel.has('_pageIncompletePrompt')) {\n\t\t\t\tconfig._pageIncompletePromptExists = true;\n\t\t\t\tif (pageModel.get('_pageIncompletePrompt').hasOwnProperty('_isEnabled')) {\n\t\t\t\t\tconfig._pageIncompletePromptEnabled = pageModel.get('_pageIncompletePrompt')._isEnabled;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tconfig._pageIncompletePromptExists = false;\n\t\t\t\tpageModel.set('_pageIncompletePrompt', {});\n\t\t\t}\n\n\t\t\tpageModel.get('_pageIncompletePrompt')._isEnabled = false;\n\t\t},\n\n\t\t_restorePageIncompletePrompt:function(pageModel) {\n\t\t\tvar config = this._getConfig(pageModel);\n\n\t\t\tif (config._pageIncompletePromptExists) {\n\t\t\t\tif (config.hasOwnProperty('_pageIncompletePromptEnabled')) pageModel.get('_pageIncompletePrompt')._isEnabled = config._pageIncompletePromptEnabled;\n\t\t\t\telse delete pageModel.get('_pageIncompletePrompt')._isEnabled;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tpageModel.unset('_pageIncompletePrompt');\n\t\t\t}\n\t\t\tdelete config._pageIncompletePromptExists;\n\t\t\tdelete config._pageIncompletePromptEnabled;\n\t\t},\n\n\t\tonModelCompletionChanged:function() {\n\t\t\tthis.invalidate();\n\t\t},\n\n\t\tonLinkClicked:function(e) {\n\t\t\tvar $target = $(e.currentTarget);\n\t\t\tvar id = $target.attr(\"href\").slice(1);\n\t\t\tvar model = Adapt.findById(id);\n\n\t\t\te.preventDefault();\n\t\t\t\n\t\t\tif (e.ctrlKey && this.el.defaultView) {\n\t\t\t\tid = id.replace(/-/g, '');\n\t\t\t\tthis.el.defaultView[id] = model;\n\t\t\t\tthis.el.defaultView.console.log('devtools: add property window.'+id+':');\n\t\t\t\tthis.el.defaultView.console.log(model);\n\t\t\t}\n\t\t\telse if (e.shiftKey) {\n\t\t\t\tthis.navigateAndDisableTrickle(id);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.navigateAndDisableTrickleUpTo(id);\n\t\t\t}\n\t\t},\n\n\t\tinvalidate:function() {\n\t\t\tthis._invalid = true;\n\t\t},\n\n\t\t/**\n\t\t* Navigate to the element with the given id (or as closely to it as possible). Disable trickle up to the given id.\n\t\t* N.B. because trickle cannot be reliably manipulated in situ we must reload the page. Trickle remains disabled on\n\t\t* affected article(s)|block(s).\n\t\t*/\n\t\tnavigateAndDisableTrickleUpTo:function(id) {\n\t\t\tvar model = Adapt.findById(id);\n\t\t\tvar pageModel = Adapt.findById(Adapt.location._currentId);\n\n\t\t\t// first ensure page incomplete prompt won't activate\n\t\t\tthis._disablePageIncompletePrompt(pageModel);\n\n\t\t\t// now navigate\n\n\t\t\tif (model._siblings == 'contentObjects') {\n\t\t\t\tBackbone.history.navigate(\"#/id/\"+id, {trigger:true});\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar level = model.get('_type') == 'component' ? model.getParent() : model;\n\t\t\t\tvar siblings = level.getParent().getChildren(), sibling = null;\n\t\t\t\t// disable trickle on all preceeding article(s)|block(s)\n\t\t\t\tfor (var i=0, count=siblings.indexOf(level); i < count; i++) {\n\t\t\t\t\tsibling = siblings.at(i);\n\t\t\t\t\tconsole.log('disabling trickle on '+sibling.get('_id'));\n\t\t\t\t\tif (sibling.has('_trickle')) {\n\t\t\t\t\t\tsibling.get('_trickle')._isEnabled = false;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tsibling.set('_trickle', {_isEnabled:false});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// check if already on page\n\t\t\t\tif (Adapt.location._currentId == model.findAncestor('contentObjects').get('_id')) {\n\t\t\t\t\tthis.listenToOnce(Adapt, 'pageView:ready', function(view) {\n\t\t\t\t\t\t_.defer(_.bind(function() {\n\t\t\t\t\t\t\tAdapt.scrollTo($('.'+id));\n\t\t\t\t\t\t\tthis.checkVisibility(id);\n\t\t\t\t\t\t}, this));\n\t\t\t\t\t});\n\t\t\t\t\tif (Adapt.location._currentId == Adapt.course.get('_id')) Router.handleRoute ? Router.handleRoute() : Router.handleCourse();\n\t\t\t\t\telse Router.handleId(Adapt.location._currentId);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.listenToOnce(Adapt, 'pageView:ready', function() {\n\t\t\t\t\t\t_.defer(_.bind(function() {\n\t\t\t\t\t\t\tthis.checkVisibility(id);\n\t\t\t\t\t\t}, this));\n\t\t\t\t\t});\n\t\t\t\t\tBackbone.history.navigate(\"#/id/\"+id, {trigger:true});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// restore pageIncompletePrompt config\n\t\t\tthis._restorePageIncompletePrompt(pageModel);\n\n\t\t\tthis.invalidate();\n\t\t},\n\n\t\t/**\n\t\t* Navigate to the element with the given id (or as closely to it as possible). Disable trickle on containing\n\t\t* page temporarily.\n\t\t*/\n\t\tnavigateAndDisableTrickle:function(id) {\n\t\t\tvar model = Adapt.findById(id);\n\t\t\tvar pageModel = Adapt.findById(Adapt.location._currentId);\n\n\t\t\t// first ensure page incomplete prompt won't activate\n\t\t\tthis._disablePageIncompletePrompt(pageModel);\n\n\t\t\tif (model._siblings == 'contentObjects') {\n\t\t\t\tBackbone.history.navigate(\"#/id/\"+id, {trigger:true});\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// if already on page ensure trickle is disabled\n\t\t\t\tif (Adapt.location._currentId == model.findAncestor('contentObjects').get('_id')) {\n\t\t\t\t\tAdapt.devtools.set('_trickleEnabled', false);\n\t\t\t\t\tAdapt.scrollTo($('.'+id));\n\t\t\t\t\tthis.checkVisibility(id);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// pick target model to determine trickle config according to trickle version (2.1 or 2.0.x)\n\t\t\t\t\tvar targetModel = Adapt.trickle ? model.findAncestor('contentObjects') : Adapt.course;\n\t\t\t\t\t\n\t\t\t\t\t// if necessary disable trickle (until page is ready)\n\t\t\t\t\tif (!targetModel.has('_trickle')) {\n\t\t\t\t\t\ttargetModel.set('_trickle', {_isEnabled:false});\n\t\t\t\t\t\tthis.listenToOnce(Adapt, 'pageView:ready', function() {\n\t\t\t\t\t\t\t_.defer(_.bind(function() {\n\t\t\t\t\t\t\t\ttargetModel.get('_trickle')._isEnabled = true;\n\t\t\t\t\t\t\t\tthis.checkVisibility(id);\n\t\t\t\t\t\t\t}, this));\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse if (targetModel.get('_trickle')._isEnabled) {\n\t\t\t\t\t\ttargetModel.get('_trickle')._isEnabled = false;\n\t\t\t\t\t\tthis.listenToOnce(Adapt, 'pageView:ready', function() {\n\t\t\t\t\t\t\t_.defer(_.bind(function() {\n\t\t\t\t\t\t\t\ttargetModel.get('_trickle')._isEnabled = true;\n\t\t\t\t\t\t\t\tthis.checkVisibility(id);\n\t\t\t\t\t\t\t}, this));\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tBackbone.history.navigate(\"#/id/\"+id, {trigger:true});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// restore pageIncompletePrompt config\n\t\t\tthis._restorePageIncompletePrompt(pageModel);\n\n\t\t\tthis.invalidate();\n\t\t},\n\n\t\tcheckVisibility:function(id) {\n\t\t\tvar model = Adapt.findById(id);\n\t\t\tif ($('.'+id).is(':visible') || model == Adapt.course) return;\n\n\t\t\twhile (!$('.'+id).is(':visible') && model != Adapt.course) {\n\t\t\t\tmodel = model.getParent();\n\t\t\t\tid = model.get('_id');\n\t\t\t}\n\t\t\tconsole.log('adapt-devtools::checkVisibility scrolling to ancestor '+id);\n\t\t\tAdapt.scrollTo($('.'+id));\n\t\t}\n\t});\n\n\tvar Map = _.extend({\n\t\tinitialize: function() {\n\t\t\tthis.listenTo(Adapt, 'devtools:mapLoaded', this.onMapLoaded);\n\t\t\t$(window).on('unload', _.bind(this.onCourseClosed, this));\n\n\t\t\tfunction isMenu(options) {\n\t\t\t\tif (this.get('_type') !== 'page') {\n                    return options.fn(this);\n                } else {\n                    return options.inverse(this);\n                }\n\t\t\t}\n\n\t\t\tfunction eachChild(options) {\n\t\t\t    var ret = \"\";\n\t\t\t    var children = this.get('_children').models;\n\t\t\t    \n\t\t\t    for (var i = 0, j = children.length; i < j; i++) {\n\t\t\t        ret = ret + options.fn(children[i], {data:{index:i,first:i==0,last:i===j-1}});\n\t\t\t    }\n\n\t\t\t    return ret;\n\t\t\t}\n\n\t\t\tfunction getProp(prop, options) {\n\t\t\t\treturn this.get(prop);\n\t\t\t}\n\n\t\t\tfunction isStringEmpty(str) {\n\t\t\t\treturn !str || (str.trim && str.trim().length == 0) || ($.trim(str).length == 0)\n\t\t\t}\n\n\t\t\tfunction getTitle(options) {\n\t\t\t\tvar t = this.get('displayTitle');\n\t\t\t\tif (isStringEmpty(t)) t = this.get('title');\n\t\t\t\tif (isStringEmpty(t)) t = this.get('_id');\n\t\t\t\treturn t;\n\t\t\t}\n\n\t\t\tfunction when(prop, options) {\n\t\t\t\tif (this.get(prop)) {\n                    return options.fn(this);\n                } else {\n                    return options.inverse(this);\n                }\n\t\t\t}\n\n\t\t\tfunction isTrickled(options) {\n\t\t\t\tvar trickleConfig = this.get('_trickle');\n\t\t\t\tvar trickled = false;\n\t\t\t\tvar isBlock = this.get('_type') == 'block';\n\n\t\t\t\tif (trickleConfig) trickled = (isBlock || trickleConfig._onChildren !== true) && trickleConfig._isEnabled;\n\t\t\t\telse if (isBlock) {\n\t\t\t\t\ttrickleConfig = this.getParent().get('_trickle');\n\t\t\t\t\tif (trickleConfig) trickled = trickleConfig._onChildren && trickleConfig._isEnabled;\n\t\t\t\t}\n\n\t\t\t\tif (trickled) {\n                    return options.fn(this);\n                } else {\n                    return options.inverse(this);\n                }\n\t\t\t}\n\n\t\t\tHandlebars.registerHelper('isMenu', isMenu);\n\t\t\tHandlebars.registerHelper('eachChild', eachChild);\n\t\t\tHandlebars.registerHelper('getProp', getProp);\n\t\t\tHandlebars.registerHelper('getTitle', getTitle);\n\t\t\tHandlebars.registerHelper('when', when);\n\t\t\tHandlebars.registerHelper('isTrickled', isTrickled);\n\t\t},\n\n\t\topen:function() {\n\t\t\tif (!this.mapWindow) {\n\t\t\t\tthis.mapWindow = window.open('assets/map.html', 'Map');\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.mapWindow.focus();\n\t\t\t}\n\t\t},\n\n\t\tonMapClosed: function() {\n\t\t\tconsole.log('onMapClosed');\n\t\t\tthis.mapWindow = null;\n\t\t},\n\n\t\tonMapLoaded: function(mapWindow) {\n\t\t\tconsole.log('onMapLoaded');\n\t\t\tthis.mapWindow = mapWindow;\n\t\t\tthis.mapWindow.focus();\n\t\t\t$('html', this.mapWindow.document).addClass($('html', window.document).attr('class'));\n\t\t\tthis.mapView = new MapView({model:Adapt, el:this.mapWindow.document});\n\t\t\t$(this.mapWindow).on('unload', _.bind(this.onMapClosed, this));\n        },\n\n        onCourseClosed:function() {\n        \tif (this.mapView) {\n        \t\tthis.mapView.remove();\n        \t\t//this.mapWindow.close();\n        \t}\n        }\n\t}, Backbone.Events);\n\n\tAdapt.once('adapt:initialize devtools:enable', function() {\n\t\tif (!Adapt.devtools.get('_isEnabled')) return;\n\n\t\tMap.initialize();\n\t});\n\n\treturn Map;\n});\n\n","define('extensions/adapt-devtools/js/utils',['require','coreJS/adapt','coreModels/adaptModel','coreViews/questionView'],function(require) {\n\n\tvar Adapt = require('coreJS/adapt');\n\tvar AdaptModel = require('coreModels/adaptModel');\n\tvar QuestionView = require('coreViews/questionView');\n\t\n\t// control-click to access Adapt model\n\tfunction onDocumentClicked(e) {\n\t\tif (e.ctrlKey) {\n\t\t\tvar $target = $(e.target);\n\n\t\t\tfunction getModel($el, t) {\n\t\t\t\tif ($el.length == 0) return false; \n\t\t\t\tvar re = new RegExp('[\\\\s]+('+t+'\\\\-[^\\\\s]+)');\n\t\t\t\tvar id = re.exec($el.attr('class'))[1];\n\t\t\t\tvar model = id.slice(t.length+1) == Adapt.course.get('_id') ? Adapt.course : Adapt.findById(id);\n\t\t\t\tif (model) {\n\t\t\t\t\tid = model.get('_id').replace(/-/g, '');\n\t\t\t\t\twindow[id] = model;\n\t\t\t\t\tconsole.log('devtools: add property window.'+id+':');\n\t\t\t\t\tconsole.log(model);\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\t\n\t\t\tif (getModel($target.parents('.component'), 'c')) return;\n\t\t\tif (getModel($target.parents('.block'), 'b')) return;\n\t\t\tif (getModel($target.parents('.article'), 'a')) return;\n\t\t\tif (getModel($target.parents('.page'), 'co')) return;\n\t\t\tif (getModel($target.parents('.menu'), 'menu')) return;\n\t\t}\n\t}\n\n\tfunction getAdaptCoreVersion() {\n\t\ttry {\n\t\t\tif (typeof AdaptModel.prototype.setCompletionStatus == 'function') return \">=v2.0.10\";\n\t\t\tif (typeof AdaptModel.prototype.checkLocking == 'function') return \"v2.0.9\";\n\t\t\tif (typeof Adapt.checkingCompletion == 'function') return \"v2.0.8\";\n\t\t\tif (typeof AdaptModel.prototype.getParents == 'function') return \"v2.0.7\";\n\t\t\tif ($.a11y && $.a11y.options.hasOwnProperty('isIOSFixesEnabled')) return \"v2.0.5-v2.0.6\";\n\t\t\tif (Adapt instanceof Backbone.Model) return \"v2.0.4\";\n\t\t\tif (typeof QuestionView.prototype.recordInteraction == 'function') return \"v2.0.2-v2.0.3\";\n\t\t\tif (typeof Adapt.findById == 'function') return \"v2.0.0-v2.0.1\";\n\t\t\treturn \"v1.x\";\n\t\t}\n\t\tcatch (e) {\n\t\t\treturn 'unknown version';\n\t\t}\n\t}\n\n\tAdapt.once('adapt:initialize', function() {\n\t\tvar str = 'Version of Adapt core detected: '+getAdaptCoreVersion();\n\t\tvar horz = getHorzLine();\n\n\t\tconsole.log(horz+'\\nVersion of Adapt core detected: '+getAdaptCoreVersion()+'\\n'+horz);\n\n\t\tfunction getHorzLine() {\n\t\t\tfor (var s='', i=0, c=str.length; i<c; i++) s+='*';\n\t\t\treturn s;\n\t\t}\n\t});\n\n\tAdapt.once('adapt:initialize devtools:enable', function() {\n\t\tif (!Adapt.devtools.get('_isEnabled')) return;\n\n\t\t$(document).on('click', onDocumentClicked);\n\n\t\t// useful for command-line debugging\n\t\tif (!window.a) window.a = Adapt;\n\t});\n});\n\n","define('extensions/adapt-devtools/js/end-trickle',['require','coreJS/adapt'],function(require) {\n\n\tvar Adapt = require('coreJS/adapt');\n\n\tfunction onTrickleBegun() {\n\t\tif (!Adapt.devtools.get('_trickleEnabled')) {\n\t\t\tconsole.log('Trickle started');\n\t\t\tAdapt.devtools.set('_trickleEnabled', true);\n\t\t\t// listen for user request to end trickle\n\t\t\tAdapt.devtools.once('change:_trickleEnabled', onTrickleChange);\n\t\t}\n\t}\n\n\tfunction onTrickleEnded() {\n\t\tconsole.log('Trickle ended');\n\t\tAdapt.devtools.off('change:_trickleEnabled', onTrickleChange);\n\t\tAdapt.devtools.set('_trickleEnabled', false);\n\t}\n\n\tfunction onTrickleChange() {\n\t\tif (!Adapt.devtools.get('_trickleEnabled')) {\n\t\t\t// user triggered\n\t\t\tAdapt.trigger('trickle:kill');\n\t\t}\n\t}\n\n\tfunction remove() {\n\t\tif (Adapt.devtools.get('_trickleEnabled')) {\n\t\t\tonTrickleEnded();\n\t\t}\n\t}\n\n\tAdapt.once('adapt:initialize devtools:enable', function() {\n\t\tif (!Adapt.devtools.get('_isEnabled')) return;\n\n\t\tAdapt.on('trickle:interactionInitialize trickle:started', onTrickleBegun);\n\t\tAdapt.on('trickle:kill trickle:finished', onTrickleEnded);\n\t\tAdapt.on('remove', remove);\n\t});\n});\n\n","define('extensions/adapt-devtools/js/toggle-feedback',['require','coreJS/adapt'],function(require) {\n\n\tvar Adapt = require('coreJS/adapt');\n\n\tfunction onShowFeedback() {\n\t\t// trickle waits for tutor to close so pretend that this happens\n\t\t//Adapt.trigger('tutor:opened'); trickle-tutorPlugin doesn't actually listen to this(!)\n\t\tAdapt.trigger('tutor:closed');\n\t}\n\n\tfunction hushTutor() {\n\t\tAdapt.devtools.set('_tutorListener', Adapt._events['questionView:showFeedback'].pop());\n\t\tAdapt.on('questionView:showFeedback', onShowFeedback);\n\t}\n\n\tfunction reinstateTutor() {\n\t\tAdapt.off('questionView:showFeedback', onShowFeedback);\n\n\t\tif (!Adapt._events.hasOwnProperty('questionView:showFeedback')) {\n\t\t\tAdapt._events['questionView:showFeedback'] = [];\n\t\t}\n\n\t\tAdapt._events['questionView:showFeedback'].push(Adapt.devtools.get('_tutorListener'));\n\t}\n\n\tfunction onFeedbackToggled() {\n\t\tif (Adapt.devtools.get('_feedbackEnabled')) {\n\t\t\treinstateTutor();\n\t\t\t$(document).off('mouseup', '.buttons-feedback');\n\t\t}\n\t\telse {\n\t\t\thushTutor();\n\t\t\t$(document).on('mouseup', '.buttons-feedback', onFeedbackButtonClicked);\n\t\t}\n\t}\n\n\tfunction onFeedbackButtonClicked(e) {\n\t\tvar classes = $(e.currentTarget).parents('.component').attr('class');\n\t\tvar componentId = /[\\s]+(c\\-[^\\s]+)/.exec(classes)[1];\n\t\t\n\t\tif (componentId) {\n\t\t\t// bring tutor back temporarily\n\t\t\treinstateTutor();\n\t\t\t// tutor expects a view, but it's not actually needed\n\t\t\tAdapt.trigger('questionView:showFeedback', {model:Adapt.findById(componentId)});\n\t\t\t// and hush it again\n\t\t\thushTutor();\n\t\t}\n\t\telse console.error('devtools:onFeedbackButtonClicked: malformed component class name');\n\t}\n\t\n\tAdapt.once('adapt:initialize devtools:enable', function() {\n\t\tif (!Adapt.devtools.get('_isEnabled')) return;\n\n\t\tif (Adapt.devtools.get('_toggleFeedbackAvailable')) {\n\t\t\t// assume single registrant is adapt-contrib-tutor\n\t\t\tif (Adapt._events.hasOwnProperty('questionView:showFeedback') && Adapt._events['questionView:showFeedback'].length == 1) {\n\t\t\t\tAdapt.devtools.on('change:_feedbackEnabled', onFeedbackToggled);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tconsole.warn('devtools: no tutor or multiple registrants of questionView:showFeedback so disabling ability to toggle feedback.');\n\t\t\t\tAdapt.devtools.set('_toggleFeedbackAvailable', false);\n\t\t\t}\n\t\t}\n\t});\n});\n\n","define('extensions/adapt-devtools/js/toggle-alt-text',['require','coreJS/adapt'],function(require) {\n\n\tvar Adapt = require('coreJS/adapt');\n\n\tvar AltText = _.extend({\n\n\t\tinitialize:function() {\n\t\t\tthis.listenTo(Adapt.devtools, 'change:_altTextEnabled', this.toggleAltText);\n\n\t\t\t// if available we can use to avoid unnecessary checks\n\t\t\tif (typeof MutationObserver == 'function') {\n\t\t\t\tthis.observer = new MutationObserver(_.bind(this.onDomMutation, this));\n\t\t\t}\n\t\t},\n\n\t\taddTimer:function(fireNow) {\n\t\t\tthis.timerId = setInterval(_.bind(this.onTimer, this), 1000);\n\t\t\tif (fireNow) this.onTimer();\n\t\t},\n\n\t\tremoveTimer:function() {\n\t\t\tclearInterval(this.timerId);\n\t\t},\n\n\t\tconnectObserver:function() {\n\t\t\tif (this.observer) this.observer.observe(document.getElementById('wrapper'), {\n\t\t\t\tchildList: true,\n\t\t\t\tsubtree:true,\n\t\t\t\tattributes:true,\n\t\t\t\tattributeFilter:['class', 'style']\n\t\t\t});\n\t\t},\n\n\t\tdisconnectObserver:function() {\n\t\t\tif (this.observer) this.observer.disconnect();\n\t\t},\n\n\t\ttoggleAltText:function() {\n\t\t\tif (Adapt.devtools.get('_altTextEnabled')) {\n\t\t\t\tthis.addTimer(true);\n\t\t\t\tthis.connectObserver();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.removeTimer();\n\t\t\t\tthis.removeAllAnnotations();\n\t\t\t\tthis.disconnectObserver();\n\t\t\t}\n\t\t},\n\n\t\taddAnnotation:function($img, $annotation) {\n\t\t\tvar template = Handlebars.templates['devtoolsAnnotation'];\n\t\t\tvar text = $img.attr('alt');\n\n\t\t\tif (!text) text = $img.attr('aria-label');\n\t\t\t\n\t\t\tvar $annotation = $(template({text:text}));\n\n\t\t\tif (!text) $annotation.addClass('devtools-annotation-warning');\n\n\t\t\t$img.after($annotation);\n\t\t\t$img.data('annotation', $annotation);\n\n\t\t\tthis.updateAnnotation($img, $annotation);\n\t\t},\n\n\t\tremoveAnnotation:function($img, $annotation) {\n\t\t\t$annotation.remove();\n\t\t\t$img.removeData('annotation');\n\t\t},\n\n\t\tremoveAllAnnotations:function() {\n\t\t\t$('img').each(_.bind(function(index, element) {\n\t\t\t\tvar $img = $(element);\n\t\t\t\tvar $annotation = $img.data('annotation');\n\n\t\t\t\tif ($annotation) this.removeAnnotation($img, $annotation);\n\t\t\t}, this));\n\t\t},\n\n\t\tupdateAnnotation:function($img, $annotation) {\n\t\t\tvar position = $img.position();\n\t\t\tposition.left += parseInt($img.css('marginLeft'), 10) + parseInt($img.css('paddingLeft'), 10);\n\t\t\tposition.top += parseInt($img.css('marginTop'), 10) + parseInt($img.css('paddingTop'), 10);\n\t\t\t$annotation.css(position);\n\t\t},\n\n\t\tonDomMutation:function(mutations) {\n\t\t\tthis.mutated = true;\n\t\t},\n\n\t\tonTimer:function() {\n\t\t\tif (this.mutated === false) return;\n\t\t\tif (this.observer) this.mutated = false;\n\n\t\t\t//console.log('devtools::toggle-alt-text:run check');\n\n\t\t\tthis.disconnectObserver();\n\n\t\t\t$('img').each(_.bind(function(index, element) {\n\t\t\t\tvar $img = $(element);\n\t\t\t\tvar $annotation = $img.data('annotation');\n\t\t\t\tvar isVisible = $img.is(':visible');\n\n\t\t\t\tif (isVisible) {\n\t\t\t\t\tif (!$annotation) this.addAnnotation($img, $annotation);\n\t\t\t\t\telse this.updateAnnotation($img, $annotation);\n\t\t\t\t}\n\t\t\t\telse if ($annotation) {\n\t\t\t\t\tthis.removeAnnotation($img, $annotation);\n\t\t\t\t}\n\t\t\t}, this));\n\n\t\t\tthis.connectObserver();\n\t\t}\n\t}, Backbone.Events);\n\n\tAdapt.once('adapt:initialize devtools:enable', function() {\n\t\tif (!Adapt.devtools.get('_isEnabled')) return;\n\n\t\tAltText.initialize();\n\t});\n\n\treturn AltText;\n});\n","define('extensions/adapt-devtools/js/unlock',['require','coreJS/adapt','coreJS/router'],function(require) {\n\n\tvar Adapt = require('coreJS/adapt');\n\tvar Router = require('coreJS/router');\n\n\tfunction breakCoreLocking() {\n\t\tAdapt.course.unset('_lockType');\n\n\t\tbreakLocks(Adapt.contentObjects);\n\t\tbreakLocks(Adapt.articles);\n\t\tbreakLocks(Adapt.blocks);\n\n\t\tfunction breakLocks(collection) {\n\t\t\tcollection.each(function(model) {\n\t\t\t\tmodel.unset('_lockType');\n\t\t\t\tmodel.unset('_isLocked');\n\t\t\t});\n\t\t}\n\t}\n\n\tfunction onUnlocked() {\n\t\tif (Adapt.devtools.get('_unlocked')) {\n\t\t\tbreakCoreLocking();\n\t\t\t// reload the page/menu\n\t\t\tif (Adapt.location._currentId == Adapt.course.get('_id')) Router.handleRoute ? Router.handleRoute() : Router.handleCourse();\n\t\t\telse Router.handleId(Adapt.location._currentId);\n\t\t}\n\t}\n\n\t// menu unlock legacy (for courses authored prior to v2.0.9 or which otherwise do not use core locking)\n\tfunction onMenuPreRender(view) {\n\t\tif (Adapt.devtools.get('_unlocked')) {\n\t\t\tif (Adapt.location._currentId == view.model.get('_id')) {\n\t\t\t\tview.model.once('change:_isReady', _.bind(onMenuReady, view));\n\t\t\t\tview.model.getChildren().each(function(item) {\n\t\t\t\t\t// first pass: attempt to manipulate commonly employed locking mechanisms\n\t\t\t\t\tif (item.has('_lock')) item.set('_lock', item.get('_lock').length > -1 ? [] : false);\n\t\t\t\t\tif (item._lock) item._lock = item._lock.length > -1 ? [] : false;\n\t\t\t\t\tif (item._locked === true) item._locked = false;\n\t\t\t\t\tif (item._isLocked === true) item._isLocked = false;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\t// menu unlock legacy (for courses authored prior to v2.0.9 or which otherwise do not use core locking)\n\tfunction onMenuReady() {\n\t\tif (Adapt.devtools.get('_unlocked')) {\n\t\t\t// second pass: attempt to enable clickable elements\n\t\t\tthis.$('a, button').prop('disabled', false).css('pointer-events', 'auto');\n\t\t}\n\t}\n\n\tAdapt.once('adapt:initialize devtools:enable', function() {\n\t\tif (!Adapt.devtools.get('_isEnabled')) return;\n\n\t\tif (Adapt.devtools.get('_unlockAvailable')) {\n\t\t\tAdapt.devtools.on('change:_unlocked', onUnlocked);\n\t\t\tAdapt.on('menuView:preRender', onMenuPreRender);\n\t\t}\n\t});\n});\n\n","define('extensions/adapt-devtools/js/enable',['require','coreJS/adapt','coreJS/router'],function(require) {\n\n\tvar Adapt = require('coreJS/adapt');\n\tvar Router = require('coreJS/router');\n\n\tvar buffer = '';\n\tvar isMouseDown = false;\n\n\tfunction onKeypress(e) {\n\t\tvar c = String.fromCharCode(e.which).toLowerCase();\n\t\tbuffer += c;\n\t\tif (isMouseDown && c == '5' && !Adapt.devtools.get('_isEnabled')) enable();\n\t\telse processBuffer();\n\t}\n\n\tfunction onMouseDown() {\n\t\tisMouseDown = true;\n\t}\n\n\tfunction onMouseUp() {\n\t\tisMouseDown = false;\n\t}\n\t\n\tfunction processBuffer() {\n\t\tvar blen = buffer.length;\n\t\tif (blen > 100) buffer = buffer.substr(1,100);\n\t\tblen = buffer.length;\n\n\t\tif (buffer.substr( blen - (\"kcheat\").length, (\"kcheat\").length  ) == \"kcheat\") {\n\t\t\tif (!Adapt.devtools.get('_isEnabled')) enable();\n\t\t}\n\t}\n\n\tfunction enable() {\n\t\tremoveHooks();\n\t\tAdapt.devtools.set('_isEnabled', true);\n\t\tAdapt.trigger('devtools:enable');\n\n\t\t// reload the menu/page\n\t\tif (Adapt.location._currentId == Adapt.course.get('_id')) Router.handleRoute ? Router.handleRoute() : Router.handleCourse();\n\t\telse Router.handleId(Adapt.location._currentId);\n\t}\n\n\tfunction addHooks() {\n\t\t$(window).on(\"keypress\", onKeypress);\n\t\t$(window).on(\"mousedown\", onMouseDown);\n\t\t$(window).on(\"mouseup\", onMouseUp);\n\n\t\twindow.kcheat = function() {\n\t\t\tbuffer = \"kcheat\";\n\t\t\tprocessBuffer();\n\t\t};\n\n\t\tRouter.route('kcheat', 'kcheat', function() {\n\t\t\tif (window.kcheat) window.kcheat();\n\t\t});\n\t}\n\n\tfunction removeHooks() {\n\t\t$(window).off(\"keypress\", onKeypress);\n\t\t$(window).off(\"mousedown\", onMouseDown);\n\t\t$(window).off(\"mouseup\", onMouseUp);\n\t\twindow.kcheat = undefined;\n\t}\n\n\tAdapt.once('adapt:initialize', function() {\n\t\tif (Adapt.devtools.get('_isEnabled')) return;\n\n\t\t// some plugins (e.g. bookmarking) will manipulate the router so defer the call\n\t\t_.defer(function () {addHooks();});\n\t});\n});\n\n","/*\n* adapt-devtools\n* License - http://github.com/adaptlearning/adapt_framework/LICENSE\n* Maintainers - Chris Steele <chris.steele@kineo.com>, Oliver Foster <oliver.foster@kineo.com>\n*/\n\ndefine('extensions/adapt-devtools/js/adapt-devtools',[\n\t'coreJS/adapt',\n\t'coreModels/adaptModel',\n\t'./devtools-model',\n\t'./pass-half-fail',\n\t'./toggle-banking',\n\t'./map',\n\t'./auto-answer',\n\t'./utils',\n\t'./end-trickle',\n\t'./hinting',\n\t'./toggle-feedback',\n\t'./toggle-alt-text',\n\t'./unlock',\n\t'./enable'\n], function(Adapt, AdaptModel, DevtoolsModel, PassHalfFail, ToggleBanking, Map) {\n\n\tvar DevtoolsView = Backbone.View.extend({\n\n\t\tclassName:'devtools',\n\n\t\tevents:{\n\t\t\t'click .end-trickle':'onEndTrickle',\n\t\t\t'change .hinting input':'onToggleHinting',\n\t\t\t'change .banking input':'onToggleBanking',\n\t\t\t'change .feedback input':'onToggleFeedback',\n\t\t\t'change .auto-correct input':'onToggleAutoCorrect',\n\t\t\t'change .alt-text input':'onToggleAltText',\n\t\t\t'click .unlock':'onUnlock',\n\t\t\t'click .open-map':'onOpenMap',\n\t\t\t'click .complete-page':'onCompletePage',\n\t\t\t'click .pass':'onPassHalfFail',\n\t\t\t'click .half':'onPassHalfFail',\n\t\t\t'click .fail':'onPassHalfFail'\n\t\t},\n\n\t\tinitialize:function() {\n\t\t\tthis.render();\n\n\t\t\tthis._checkUnlockVisibility();\n\t\t\tthis._checkTrickleEndVisibility();\n\t\t\tthis._checkBankingVisibility();\n\t\t\tthis._checkFeedbackVisibility();\n\t\t\tthis._checkHintingVisibility();\n\t\t\tthis._checkAutoCorrectVisibility();\n\t\t\tthis._checkAltTextVisibility();\n\t\t\tthis._checkPassHalfFailVisibility();\n\t\t\tthis._checkCompletePageVisibility();\n\t\t},\n\n\t\trender:function() {\n\t\t\tvar data = Adapt.devtools.toJSON();\n\t\t\tvar template = Handlebars.templates['devtools'];\n            this.$el.html(template(data));\n\t\t\treturn this;\n\t\t},\n\n\t\t/*************************************************/\n\t\t/********************* UNLOCK ********************/\n\t\t/*************************************************/\n\n\t\t_checkUnlockVisibility:function() {\n\t\t\t// check if function available and not already activated\n\t\t\tif (!Adapt.devtools.get('_unlockAvailable') || Adapt.devtools.get('_unlocked')) this.$('.unlock').addClass('display-none');\n\t\t\telse this.$('.unlock').toggleClass('display-none', !this._checkForLocks());\n\t\t},\n\n\t\t_checkForLocks:function() {\n\t\t\tif (typeof AdaptModel.prototype.checkLocking != 'function') return Adapt.location._contentType == 'menu';\n\n\t\t\tvar hasLock = function(model) {return model.has('_lockType');};\n\n\t\t\tif (hasLock(Adapt.course)) return true;\n\t\t\tif (Adapt.contentObjects.some(hasLock)) return true;\n\t\t\tif (Adapt.articles.some(hasLock)) return true;\n\t\t\tif (Adapt.blocks.some(hasLock)) return true;\n\n\t\t\treturn false;\n\t\t},\n\n\t\tonUnlock:function() {\n\t\t\tAdapt.devtools.set('_unlocked', true);\n\t\t\tthis._checkUnlockVisibility();\n\t\t},\n\n\t\t/*************************************************/\n\t\t/********************** MAP **********************/\n\t\t/*************************************************/\n\n\t\tonOpenMap:function() {\n\t\t\tMap.open();\n\t\t\tAdapt.trigger('drawer:closeDrawer');\n\t\t},\n\n\t\t/*************************************************/\n\t\t/******************** TRICKLE ********************/\n\t\t/*************************************************/\n\n\t\t_checkTrickleEndVisibility:function() {\n\t\t\tthis.$('.end-trickle').toggleClass('display-none', !Adapt.devtools.get('_trickleEnabled'));\n\t\t},\n\n\t\tonEndTrickle:function() {\n\t\t\tAdapt.devtools.set('_trickleEnabled', false);\n\t\t\tthis._checkTrickleEndVisibility();\n\t\t},\n\n\t\t/*************************************************/\n\t\t/*************** QUESTION BANKING ****************/\n\t\t/*************************************************/\n\n\t\t_checkBankingVisibility:function() {\n\t\t\tif (!Adapt.devtools.get('_toggleFeedbackAvailable')) {\n\t\t\t\tthis.$('.banking').addClass('display-none');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar bankedAssessments = ToggleBanking.getBankedAssessmentsInCurrentPage();\n\t\t\tvar isBankingEnabled = function(m) {return m.get('_assessment')._banks._isEnabled;};\n\n\t\t\tif (bankedAssessments.length > 0) {\n\t\t\t\tthis.$('.banking').removeClass('display-none');\n\t\t\t\tthis.$('.banking label').toggleClass('selected', bankedAssessments.some(isBankingEnabled));\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.$('.banking').addClass('display-none');\n\t\t\t}\n\t\t},\n\n\t\tonToggleBanking:function() {\n\t\t\tToggleBanking.toggle();\n\t\t\tthis._checkBankingVisibility();\n\t\t},\n\n\t\t/*************************************************/\n\t\t/*********** QUESTION FEEDBACK (TUTOR) ***********/\n\t\t/*************************************************/\n\n\t\t_checkFeedbackVisibility:function() {\n\t\t\tif (Adapt.devtools.get('_toggleFeedbackAvailable')) {\n\t\t\t\tthis.$('.feedback').removeClass('display-none');\n\t\t\t\tthis.$('.feedback label').toggleClass('selected', Adapt.devtools.get('_feedbackEnabled'));\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.$('.feedback').addClass('display-none');\n\t\t\t}\n\t\t},\n\n\t\tonToggleFeedback:function() {\n\t\t\tAdapt.devtools.toggleFeedback();\n\t\t\tthis._checkFeedbackVisibility();\n\t\t},\n\n\t\t/*************************************************/\n\t\t/*************** QUESTION HINTING ****************/\n\t\t/*************************************************/\n\n\t\t_checkHintingVisibility:function() {\n\t\t\tif (Adapt.devtools.get('_hintingAvailable')) {\n\t\t\t\tthis.$('.hinting').removeClass('display-none');\n\t\t\t\tthis.$('.hinting label').toggleClass('selected', Adapt.devtools.get('_hintingEnabled'));\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.$('.hinting').addClass('display-none');\n\t\t\t}\n\t\t},\n\n\t\tonToggleHinting:function() {\n\t\t\tAdapt.devtools.toggleHinting();\n\t\t\tthis._checkHintingVisibility();\n\t\t},\n\n\t\t/*************************************************/\n\t\t/***************** AUTO CORRECT ******************/\n\t\t/*************************************************/\n\n\t\t_checkAutoCorrectVisibility:function() {\n\t\t\tif (Adapt.devtools.get('_autoCorrectAvailable')) {\n\t\t\t\tthis.$('.toggle.auto-correct').removeClass('display-none');\n\t\t\t\tthis.$('.toggle.auto-correct label').toggleClass('selected', Adapt.devtools.get('_autoCorrectEnabled'));\n\t\t\t\tthis.$('.tip.auto-correct').toggleClass('display-none', Adapt.devtools.get('_autoCorrectEnabled'));\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.$('.auto-correct').addClass('display-none');\n\t\t\t}\n\t\t},\n\n\t\tonToggleAutoCorrect:function() {\n\t\t\tAdapt.devtools.toggleAutoCorrect();\n\t\t\tthis._checkAutoCorrectVisibility();\n\t\t},\n\n\t\t/*************************************************/\n\t\t/******************* ALT TEXT ********************/\n\t\t/*************************************************/\n\n\t\t_checkAltTextVisibility:function() {\n\t\t\tif (Adapt.devtools.get('_altTextAvailable')) {\n\t\t\t\tthis.$('.toggle.alt-text').removeClass('display-none');\n\t\t\t\tthis.$('.toggle.alt-text label').toggleClass('selected', Adapt.devtools.get('_altTextEnabled'));\n\t\t\t\tthis.$('.tip.alt-text').toggleClass('display-none', Adapt.devtools.get('_altTextEnabled'));\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.$('.alt-text').addClass('display-none');\n\t\t\t}\n\t\t},\n\n\t\tonToggleAltText:function() {\n\t\t\tAdapt.devtools.toggleAltText();\n\t\t\tthis._checkAltTextVisibility();\n\t\t},\n\n\t\t/*************************************************/\n\t\t/***************** COMPLETE PAGE *****************/\n\t\t/*************************************************/\n\n\t\t_checkCompletePageVisibility:function() {\n\t\t\tvar currentModel = Adapt.findById(Adapt.location._currentId);\n\n\t\t\tif (currentModel.get('_type') != 'page') {\n\t\t\t\tthis.$('.complete-page').addClass('display-none');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar cond = currentModel.has('_isInteractionsComplete') ? {'_isInteractionsComplete':false} : {'_isInteractionComplete':false};\n\t\t\tvar incomplete = currentModel.findDescendants('components').where(cond);\n\n\t\t\tthis.$('.complete-page').toggleClass('display-none', incomplete.length == 0);\n\n\t\t},\n\n\t\tonCompletePage:function(e) {\n\t\t\tvar currentModel = Adapt.findById(Adapt.location._currentId);\n\n\t\t\tif (Adapt.devtools.get('_trickleEnabled')) Adapt.trigger(\"trickle:kill\");\n\n\t\t\tvar cond = currentModel.has('_isInteractionsComplete') ? {'_isInteractionsComplete':false} : {'_isInteractionComplete':false};\n\t\t\tvar incomplete = currentModel.findDescendants('components').where(cond);\n\n\t\t\t_.each(incomplete, function(component) {\n\t\t\t\tif (component.get('_isQuestionType')) {\n\t\t\t\t\tcomponent.set(\"_isCorrect\", true);\n\t\t\t\t\tcomponent.set(\"_isSubmitted\", true);\n\t\t\t\t\tcomponent.set(\"_score\", 1);\n\t\t\t\t\tcomponent.set(\"_attemptsLeft\", Math.max(0, component.set(\"_attempts\") - 1));\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tcomponent.set(\"_isComplete\", true);\n\t\t\t\tcomponent.set(currentModel.has('_isInteractionsComplete') ? '_isInteractionsComplete' : '_isInteractionComplete', true);\n\t\t\t});\n\n\t\t\tAdapt.trigger('drawer:closeDrawer');\n\t\t},\n\n\t\t/************************************************************/\n\t\t/******* Similar to original adapt-cheat functionality ******/\n\t\t/************************************************************/\n\n\t\t_checkPassHalfFailVisibility:function() {\n\t\t\tvar currentModel = Adapt.findById(Adapt.location._currentId);\n\n\t\t\tif (currentModel.get('_type') != 'page') {\n\t\t\t\tthis.$('.pass, .half, .fail').addClass('display-none');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar unanswered = currentModel.findDescendants('components').where({'_isQuestionType':true, '_isSubmitted':false});\n\t\t\t\n\t\t\tif (unanswered.length == 0)\tthis.$('.tip.pass-half-fail').html('');\n\t\t\telse this.$('.tip.pass-half-fail').html('With the '+unanswered.length+' unanswered question(s) in this page do the following:');\n\n\t\t\tthis.$('.pass, .half, .fail').toggleClass('display-none', unanswered.length == 0);\n\n\t\t},\n\n\t\tonPassHalfFail:function(e) {\n\t\t\tif (Adapt.devtools.get('_trickleEnabled')) Adapt.trigger(\"trickle:kill\");\n\n\t\t\t// potentially large operation so show some feedback\n\t\t\t$('.loading').show();\n\n\t\t\tvar tutorEnabled = Adapt.devtools.get('_feedbackEnabled');\n\n\t\t\tif (tutorEnabled) Adapt.devtools.set('_feedbackEnabled', false);\n\n\t\t\tif ($(e.currentTarget).hasClass('pass')) PassHalfFail.pass(_.bind(this.onPassHalfFailComplete, this, tutorEnabled));\n\t\t\telse if ($(e.currentTarget).hasClass('half')) PassHalfFail.half(_.bind(this.onPassHalfFailComplete, this, tutorEnabled));\n\t\t\telse PassHalfFail.fail(_.bind(this.onPassHalfFailComplete, this, tutorEnabled));\n\n\t\t\tAdapt.trigger('drawer:closeDrawer');\n\t\t},\n\n\t\tonPassHalfFailComplete:function(tutorEnabled) {\n\t\t\tconsole.log('onPassHalfFailComplete');\n\n\t\t\tif (tutorEnabled) Adapt.devtools.set('_feedbackEnabled', true);\n\n\t\t\t$('.loading').hide();\n\t\t}\n\t});\n\n\tvar DevtoolsNavigationView = Backbone.View.extend({\n\n\t\tinitialize:function() {\n\t\t\tvar template = Handlebars.templates.devtoolsNavigation;\n\n\t\t\tthis.$el = $(template());\n\n\t\t\t$('html').addClass('devtools-enabled');\n\n\t\t\tif (this.$el.is('a') || this.$el.is('button')) this.$el.on('click', _.bind(this.onDevtoolsClicked, this));\n\t\t\telse this.$el.find('a, button').on('click', _.bind(this.onDevtoolsClicked, this));\n\n\t\t\t// keep drawer item to left of PLP, resources, close button etc\n\t\t\tthis.listenTo(Adapt, 'pageView:postRender menuView:postRender', this.onContentRendered);\n\t\t},\n\n\t\trender:function() {\n\t        $('.navigation-inner').append(this.$el);\n\t\t\treturn this;\n\t\t},\n\n\t\tdeferredRender:function() {\n\t\t\t_.defer(_.bind(this.render, this));\n\t\t},\n\n\t\tonContentRendered:function(view) {\n\t\t\tif (view.model.get('_id') == Adapt.location._currentId) {\n\t\t\t\tthis.stopListening(view.model, 'change:_isReady', this.deferredRender);\n\t\t\t\tthis.listenToOnce(view.model, 'change:_isReady', this.deferredRender);\n\t\t\t}\n\t\t},\n\n\t\tonDevtoolsClicked:function(event) {\n\t\t\tif(event && event.preventDefault) event.preventDefault();\n            Adapt.drawer.triggerCustomView(new DevtoolsView().$el, false);\n\t\t}\n\t});\n\n\tAdapt.once('courseModel:dataLoaded', function() {\n\t\tAdapt.devtools = new DevtoolsModel();\n\t});\n\n\tAdapt.once('adapt:initialize devtools:enable', function() {\n\t\tif (!Adapt.devtools.get('_isEnabled')) return;\n\t\t\n\t\tnew DevtoolsNavigationView();\n\t});\n});\n\n",";define('extensions/adapt-editorial/js/lib/Backbone.Inherit',['backbone'],function(Backbone){\r\n\r\n\tvar Inherit = {};\r\n\r\n\tInherit.prototype = {\r\n\r\n\t\t//calls overridden inherited functions on Backbone.Model, Backbone.Router or Backbone.View \r\n\t\t//allows behaviour to be encapsulated in a single extend layer and brought forward to extended layers\r\n\r\n\t\tascend: function(name, callback, defer) {\r\n\r\n\t\t\tvar binder = function() {\r\n\r\n\t\t\t\t//fetch all the inherited parents and store them on the object\r\n\t\t\t\tif (!this.hasOwnProperty('_inheritParents')) {\r\n\t\t\t\t\tthis._inheritParents = Inherit.prototype.getInheritParents.call(this);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar returnValue;\r\n\t\t\t\tvar deferedParents = [];\r\n\r\n\t\t\t\t//itereate through the inherited parents\r\n\t\t\t\tfor (var i = 0, l = this._inheritParents.length; i < l; i++) {\r\n\t\t\t\t\tvar parent = this._inheritParents[i];\r\n\t\t\t\t\tvar parentReturnValue;\r\n\r\n\t\t\t\t\t//check if the parent has the function requested\r\n\t\t\t\t\tif (!parent.hasOwnProperty(binder._callbackName)) continue;\r\n\r\n\t\t\t\t\tvar callbackFunctionAtParent = parent[binder._callbackName];\r\n\t\t\t\t\tif (!callbackFunctionAtParent) continue;\r\n\r\n\t\t\t\t\t//check if the parent function is already ascend/descend bound\r\n\t\t\t\t\tif (callbackFunctionAtParent._performsInherited) {\r\n\t\t\t\t\t\t//if the parent function should be defered, add it to the defer list\r\n\t\t\t\t\t\tif (callbackFunctionAtParent._defer) {\r\n\t\t\t\t\t\t\tdeferedParents.push(parent);\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t//call the parent function without triggering the cascade backwards\r\n\t\t\t\t\t\tparentReturnValue = callbackFunctionAtParent._callback.apply(this, arguments);\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t//the parent function is not bound by ascend/descend so it can be called directly\r\n\t\t\t\t\t\tparentReturnValue = callbackFunctionAtParent.apply(this, arguments);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//merge the return value from the parent function into any existing return value\r\n\t\t\t\t\treturnValue = mergeReturnValues(parentReturnValue, returnValue);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//perform the same routine on the defered parent functions\r\n\t\t\t\tfor (var i = 0, l = deferedParents.length; i < l; i++) {\r\n\t\t\t\t\tvar parent = deferedParents[i];\r\n\t\t\t\t\tvar parentReturnValue;\r\n\t\t\t\t\tif (!parent.hasOwnProperty(binder._callbackName)) continue;\r\n\t\t\t\t\tvar callbackFunctionAtParent = parent[binder._callbackName];\r\n\t\t\t\t\tif (!callbackFunctionAtParent) continue;\r\n\t\t\t\t\tif (callbackFunctionAtParent._performsInherited) {\r\n\t\t\t\t\t\tparentReturnValue = callbackFunctionAtParent._callback.apply(this, arguments);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tparentReturnValue = callbackFunctionAtParent.apply(this, arguments);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturnValue = mergeReturnValues(parentReturnValue, returnValue);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn returnValue;\r\n\t\t\t};\r\n\t\t\t//setup the binder function with the appropriate variables\r\n\t\t\tbinder._performsInherited = true;\r\n\t\t\tbinder._callback = callback;\r\n\t\t\tbinder._callbackName = name;\r\n\t\t\tbinder._defer = defer;\r\n\r\n\t\t\treturn binder;\r\n\r\n\t\t},\r\n\r\n\t\tdescend: function(name, callback, defer) {\r\n\r\n\t\t\tvar binder = function() {\r\n\r\n\t\t\t\t//fetch all the inherited parents and store them on the object\r\n\t\t\t\tif (!this.hasOwnProperty('_inheritParents')) {\r\n\t\t\t\t\tthis._inheritParents = Inherit.prototype.getInheritParents.call(this);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar returnValue;\r\n\t\t\t\tvar deferedParents = [];\r\n\r\n\t\t\t\t//itereate through the inherited parents\r\n\t\t\t\tfor (var i = this._inheritParents.length-1, l = -1; i > l; i--) {\r\n\t\t\t\t\tvar parent = this._inheritParents[i];\r\n\t\t\t\t\tvar parentReturnValue;\r\n\r\n\t\t\t\t\t//check if the parent has the function requested\r\n\t\t\t\t\tif (!parent.hasOwnProperty(binder._callbackName)) continue;\r\n\r\n\t\t\t\t\tvar callbackFunctionAtParent = parent[binder._callbackName];\r\n\t\t\t\t\tif (!callbackFunctionAtParent) continue;\r\n\r\n\t\t\t\t\t//check if the parent function is already ascend/descend bound\r\n\t\t\t\t\tif (callbackFunctionAtParent._performsInherited) {\r\n\t\t\t\t\t\t//if the parent function should be defered, add it to the defer list\r\n\t\t\t\t\t\tif (callbackFunctionAtParent._defer) {\r\n\t\t\t\t\t\t\tdeferedParents.push(parent);\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t//call the parent function without triggering the cascade backwards\r\n\t\t\t\t\t\tparentReturnValue = callbackFunctionAtParent._callback.apply(this, arguments);\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t//the parent function is not bound by ascend/descend so it can be called directly\r\n\t\t\t\t\t\tparentReturnValue = callbackFunctionAtParent.apply(this, arguments);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//merge the return value from the parent function into any existing return value\r\n\t\t\t\t\treturnValue = mergeReturnValues(parentReturnValue, returnValue);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//perform the same routine on the defered parent functions\r\n\t\t\t\tfor (var i = 0, l = deferedParents.length; i < l; i++) {\r\n\t\t\t\t\tvar parent = deferedParents[i];\r\n\t\t\t\t\tvar parentReturnValue;\r\n\t\t\t\t\tif (!parent.hasOwnProperty(binder._callbackName)) continue;\r\n\t\t\t\t\tvar callbackFunctionAtParent = parent[binder._callbackName];\r\n\t\t\t\t\tif (!callbackFunctionAtParent) continue;\r\n\t\t\t\t\tif (callbackFunctionAtParent._performsInherited) {\r\n\t\t\t\t\t\tparentReturnValue = callbackFunctionAtParent._callback.apply(this, arguments);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tparentReturnValue = callbackFunctionAtParent.apply(this, arguments);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturnValue = mergeReturnValues(parentReturnValue, returnValue);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn returnValue;\r\n\t\t\t};\r\n\t\t\t//setup the binder function with the appropriate variables\r\n\t\t\tbinder._performsInherited = true;\r\n\t\t\tbinder._callback = callback;\r\n\t\t\tbinder._callbackName = name;\r\n\t\t\tbinder._defer = defer;\r\n\r\n\t\t\treturn binder;\r\n\r\n\t\t\t\r\n\t\t},\r\n\r\n\t\t//fetches all of the inherited prototypes from the Backbone.Model, Backbone.Router or Backbone.View\r\n\t\tgetInheritParents: function() {\r\n\r\n\t\t\t//step back through the inheritance chain and collect all of the inherited parents\r\n\t\t\tvar parents = [ this.constructor.prototype ];\r\n\t\t\tvar parent = this.constructor.__super__;\r\n\t\t\tparents.unshift(parent)\r\n\t\t\twhile (parent.constructor && parent.constructor.__super__) {\r\n\t\t\t\tvar parent = parent.constructor.__super__;\r\n\t\t\t\tparents.unshift(parent);\r\n\t\t\t}\r\n\t\t\treturn parents;\r\n\r\n\t\t}\r\n\t\t\r\n\t};\r\n\r\n\tInherit.extend = function(to) {\r\n\t\treturn _.extend({}, Inherit.prototype, to);\r\n\t};\r\n\r\n\t//extend Backbone with the three functions ascend, descend and getInheritParents\r\n\t_.extend(Backbone, Inherit.prototype);\r\n\r\n\t/* result\r\n\t* Backbone.ascend(\"functionName\", function(sharedArgument) {\r\n\t*\r\n\t* });\r\n\t* Backbone.descend(\"functionName\", function(sharedArgument) {\r\n\t*\r\n\t* });\r\n\t* Backbone.getInheritedParents.call(backboneObject);\r\n\t*/\r\n\r\n\t//merge return values together\r\n\tfunction mergeReturnValues(into, using) {\r\n\r\n\t\tvar typeofInto = typeof into;\r\n\t\tvar typeofUsing = typeof using;\r\n\r\n\t\tif (!into || !using) {\r\n\t\t\t//if one return value is undefined, use the one which is defined or return undefined\r\n\t\t\treturn into || using;\r\n\t\t}\r\n\t\tif (typeofInto == typeofUsing) {\r\n\t\t\t//if the return values types are equal\r\n\t\t\tswitch (typeofInto) {\r\n\t\t\tcase \"object\":\r\n\t\t\t\tvar isArrayInto = into instanceof Array;\r\n\t\t\t\tvar isArrayUsing = using instanceof Array;\r\n\t\t\t\tif (isArrayInto == isArrayUsing && isArrayInto) {\r\n\t\t\t\t\t//if both are arrays, concatinate the results\r\n\t\t\t\t\treturn into.concat(using);\r\n\t\t\t\t}\r\n\t\t\t\t//if both are objects, (shallow) merge them together\r\n\t\t\t\treturn _.extend(into, using);\r\n\t\t\tcase \"string\": case \"number\": \r\n\t\t\t\t//if both a number or string, add the results to each other\r\n\t\t\t\treturn into + using;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t//if the values have different types and both are defined, throw an error\r\n\t\t\tthrow \"Cannot merge different types\";\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\r\n\treturn Inherit;\r\n\r\n});\n","// http://paulirish.com/2011/requestanimationframe-for-smart-animating/\r\n// http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating\r\n\r\n// requestAnimationFrame polyfill by Erik Möller. fixes from Paul Irish and Tino Zijdel\r\n\r\n// MIT license\r\n\r\n(function() {\r\n    var lastTime = 0;\r\n    var vendors = ['ms', 'moz', 'webkit', 'o'];\r\n    for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\r\n        window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];\r\n        window.cancelAnimationFrame = window[vendors[x]+'CancelAnimationFrame'] \r\n                                   || window[vendors[x]+'CancelRequestAnimationFrame'];\r\n    }\r\n \r\n    if (!window.requestAnimationFrame)\r\n        window.requestAnimationFrame = function(callback, element) {\r\n            var currTime = new Date().getTime();\r\n            var timeToCall = Math.max(0, 16 - (currTime - lastTime));\r\n            var id = window.setTimeout(function() { callback(currTime + timeToCall); }, \r\n              timeToCall);\r\n            lastTime = currTime + timeToCall;\r\n            return id;\r\n        };\r\n \r\n    if (!window.cancelAnimationFrame)\r\n        window.cancelAnimationFrame = function(id) {\r\n            clearTimeout(id);\r\n        };\r\n}());\ndefine(\"extensions/adapt-editorial/js/lib/raf\", function(){});\n\n","define('extensions/adapt-editorial/js/tiles/tile',[\r\n    'coreJS/adapt',\r\n    '../lib/Backbone.Inherit',\r\n    '../lib/raf'\r\n], function(Adapt) {\r\n\r\n    //function for dividing up json settings and trimming white text\r\n    var attributeSplitRegEx = /([\\,]{1})|([^,]*\\'.*\\'[^,]*)|([^,]*\\\".*\\\"[^,]*)|([^,]*\\(.*\\)[^,]*)|([^,]*)/g;\r\n    var trimRegEx = /^\\s+|\\s+$/g;\r\n    function splitAttribute(attr) {\r\n        var matches = attr.match(attributeSplitRegEx);\r\n        var ret = [];\r\n        var currentValue = \"\";\r\n        for (var i = 0, l = matches.length; i < l; i++) {\r\n            var match = matches[i];\r\n            switch (match) {\r\n            case \",\":case \"\":\r\n                ret.push(currentValue);\r\n                currentValue = \"\";\r\n                break;\r\n            default:\r\n                currentValue = match.replace(trimRegEx, '');\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n\r\n\r\n    //tile unit\r\n    var Tile = {\r\n\r\n        //base tile view\r\n        View: Backbone.View.extend({\r\n\r\n            _isIE8: false,\r\n            _isRemoved: false,\r\n            _editorialArticleView: null,\r\n            _hasReCheckedSize: true,\r\n\r\n            classes: function() {\r\n                return [\r\n                    \"tile\",\r\n                    \"clearfix\", \r\n                    this.model.get('_type'),\r\n                    this.model.get('_id'),\r\n                    this.model.get('_classes')\r\n                ];\r\n            },\r\n\r\n            initialize: function(options) {\r\n                this.$el.attr(\"class\", _.uniq(this.classes()).join(\" \"));\r\n                this.$el.attr(\"name\", this.model.get(\"_id\"));\r\n                \r\n                this._editorialArticleView = options.editorialArticleView;\r\n                if (this.model.get(\"_editorialModel\").get(\"_forceIE8\")) this._isIE8 = true;\r\n                this._parentView = options.parentView;\r\n\r\n                this.setupEventListeners();\r\n\r\n                this.setupHasText();\r\n                \r\n                this.onInitialize();\r\n                \r\n                this.preRender();\r\n                this.render();\r\n\r\n            },\r\n\r\n            setupEventListeners: function() {\r\n\r\n                this.listenTo(this._editorialArticleView, \"resize\", this.preResize);\r\n                this.listenTo(this._parentView, \"resize\", this.preResize);\r\n                this.listenToOnce(this._editorialArticleView, 'remove', this.onRemove);\r\n                this.listenTo(this, \"resize\", this.preResize);\r\n\r\n            },\r\n\r\n            setupHasText: function() {\r\n                var hasText = false;\r\n                var model = this.model.toJSON();\r\n                for (var k in model) {\r\n                    if (k == \"defaults\") continue;\r\n                    switch (k.slice(0,1)) {\r\n                    case \"_\": case \"@\": case \"#\":\r\n                        break;\r\n                    default:\r\n                        if (model[k]) hasText = true;\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                this.model.set(\"_hasText\", hasText);\r\n            },\r\n\r\n            onInitialize: function() {},\r\n\r\n            preRender: function() {},\r\n\r\n            render: function() {\r\n\r\n                var data = this.model.toJSON();\r\n                _.extend(data, { _globals: Adapt.course.get(\"_globals\") });\r\n                var template = Handlebars.templates[this.constructor.template];\r\n                this.$el.html(template(data));\r\n\r\n                _.defer(_.bind(function() {\r\n                    // don't call postRender after remove\r\n                    if(this._isRemoved) return;\r\n\r\n                    this.postRender();\r\n\r\n                }, this));\r\n\r\n                return this;\r\n            },\r\n\r\n            postRender: function() {\r\n                Adapt.trigger(\"tileView:postRender\", this);\r\n                this.checkReadyStatus();\r\n            },\r\n\r\n            checkReadyStatus: function() {\r\n                this.setReadyStatus();\r\n            },\r\n\r\n            setReadyStatus: function() {\r\n                this._editorialArticleView.trigger(\"tileView:ready\");\r\n            },\r\n\r\n            preResize: function() {\r\n                this.setupGridVariables();\r\n                _.defer(_.bind(this.onResize, this));\r\n            },\r\n\r\n            onResize: function() {\r\n\r\n                this.styleClear();\r\n\r\n                var styleObject = this.getCalculatedStyleObject();\r\n                this.renderStyle(styleObject);\r\n\r\n            },\r\n\r\n            setupGridVariables: function() {\r\n\r\n                this.setupGridFixedVariables();\r\n                this.setupGridRelativeVariables();\r\n\r\n            },\r\n\r\n            setupGridFixedVariables: function() {\r\n                var config = this.model.toJSON();\r\n\r\n                var rootKeys = _.filter(_.keys(config), function(key) {\r\n                    if (key.slice(0,1) == \"#\") return true;\r\n                });\r\n\r\n                for (var vk = 0, vkl = rootKeys.length; vk < vkl; vk++) {\r\n                    var key = rootKeys[vk];\r\n                    var oKey = key;\r\n\r\n                    if (key.slice(0,4) == \"#ie8\") continue;\r\n                    if (this._isIE8) {\r\n                        var ie8Key = \"#ie8\" + key.slice(1,2).toUpperCase() + key.slice(2);\r\n                        if (config[ie8Key]) {\r\n                            key = ie8Key;\r\n                        }\r\n                    }\r\n\r\n                    var values = splitAttribute(config[key]);\r\n                    var defaultValue;\r\n                    if (config.defaults[oKey]) {\r\n                        var defaultValues = splitAttribute(config.defaults[oKey]);\r\n                        defaultValue = defaultValues[ config._editorialModel.get(\"_spanColumns\") -1 ];\r\n                    }\r\n\r\n                    var value = values[ config._editorialModel.get(\"_spanColumns\") -1 ];\r\n\r\n                    if (value === undefined || value == \"\") {\r\n                        value = defaultValue;\r\n                    }\r\n                    \r\n                    this.$el.attr(oKey.slice(1), value);\r\n                    var childContainer = this.$(\".tile-container\");\r\n                    if (childContainer.length > 0) {\r\n                        childContainer.attr(oKey.slice(1), value);\r\n                    }\r\n                    switch(value) {\r\n                    case \"no\": case \"false\":\r\n                        value = false;\r\n                        break;\r\n                    case \"yes\": case \"true\":\r\n                        value = true;\r\n                        break\r\n                    }\r\n                    \r\n                    this.model.set(\"_\"+oKey.slice(1), value);\r\n                }\r\n            },\r\n\r\n            setupGridRelativeVariables: function() {\r\n                var config = this.model.toJSON();\r\n\r\n                var relativeKeys = _.filter(_.keys(config), function(key) {\r\n                    if (key.slice(0,1) == \"@\") return true;\r\n                });\r\n\r\n                for (var vk = 0, vkl = relativeKeys.length; vk < vkl; vk++) {\r\n                    var key = relativeKeys[vk];\r\n                    var oKey = key;\r\n                    \r\n                    if (key.slice(0,4) == \"@ie8\") continue;\r\n                    if (this._isIE8) {\r\n                        var ie8Key = \"@ie8\" + key.slice(1,2).toUpperCase() + key.slice(2);\r\n                        if (config[ie8Key]) {\r\n                            key = ie8Key;\r\n                        }\r\n                    }\r\n\r\n                    var values = splitAttribute(config[key]);\r\n                    var defaultValue;\r\n                    if (config.defaults[oKey]) {\r\n                        var defaultValues = splitAttribute(config.defaults[oKey]);\r\n                        defaultValue = defaultValues[ config._editorialModel.get(\"_spanColumns\") -1 ];\r\n                    }\r\n\r\n                    var value = values[ config._parentModel.get(\"_spanColumns\") - 1 ];\r\n                    \r\n                    if (value === undefined || value == \"\") {\r\n                        value = defaultValue;\r\n                    }\r\n\r\n                    this.$el.attr(oKey.slice(1), value);\r\n                    var $childContainer = this.$el.find(\"> .tile-container\");\r\n                    if ($childContainer.length > 0) {\r\n                        $childContainer.attr(oKey.slice(1), value);\r\n                    }\r\n                    switch(value) {\r\n                    case \"no\": case \"false\":\r\n                        value = false;\r\n                        break;\r\n                    case \"yes\": case \"true\":\r\n                        value = true;\r\n                        break\r\n                    }\r\n                    this.model.set(\"_\"+oKey.slice(1), value);\r\n                    \r\n                }\r\n            },\r\n\r\n            styleClear: function() {\r\n                this.renderStyle({});\r\n            },\r\n\r\n            getCalculatedStyleObject: function() {\r\n                var styleObject = this.model.toJSON();\r\n\r\n                var $childContainer = this.$el.find(\"> .tile-container\");\r\n\r\n                //tile height/width ratio\r\n                if (!this._internalResize) {\r\n                    this.$el.css(\"height\", \"\");\r\n                    this.$el.css(\"min-height\", \"\");\r\n                    if ($childContainer.length > 0) {\r\n                        $childContainer.css(\"height\",\"\");\r\n                        $childContainer.css(\"min-height\",\"\");\r\n                    }\r\n                    if (styleObject['_ratio']) {\r\n                    \r\n                        styleObject._tileHeight = this.$el.width() * styleObject['_ratio'];\r\n                        \r\n                    } else if (styleObject['_fillHeight']) {\r\n                        _.defer(_.bind(function() {\r\n                            var $parent = this.$el.parent();\r\n                            var parentHeight = $parent.height();\r\n                            if (this.$el.height() < parentHeight) {\r\n                                styleObject._tileHeight = parentHeight;\r\n                                this.$el.css(\"height\", parentHeight);\r\n                                this.$el.css(\"min-height\", parentHeight);\r\n                                if ($childContainer.length > 0) {\r\n                                    $childContainer.css(\"height\",parentHeight);\r\n                                    $childContainer.css(\"min-height\",parentHeight);\r\n                                }\r\n                                this._internalResize = true;\r\n                                this.trigger(\"resize\");\r\n                            }\r\n                        }, this));\r\n\r\n                    }\r\n                } else this._internalResize = false;\r\n\r\n                if (styleObject['_spanColumns'] == styleObject._parentModel.get(\"_spanColumns\") ) {\r\n                    styleObject._fullWidth = true;\r\n                } else {\r\n                    styleObject._fullWidth = false;\r\n                }\r\n\r\n                return styleObject;\r\n                \r\n            },\r\n\r\n            renderStyle: function(styleObject) {\r\n\r\n                var tileHeight = styleObject._tileHeight ? styleObject._tileHeight : \"\";\r\n                var tileVerticalAlign = styleObject._verticalAlign || \"\"\r\n                var tileBackground = styleObject._background || \"\"\r\n                this.$el.css({\r\n                    \"height\": tileHeight, \r\n                    \"vertical-align\": tileVerticalAlign,\r\n                    \"background\": tileBackground\r\n                });\r\n\r\n                if (styleObject._fullWidth) {\r\n                    this.$el.attr(\"fullWidth\", true);\r\n                } else {\r\n                    this.$el.removeAttr(\"fullWidth\");\r\n                }\r\n                \r\n            },\r\n\r\n            onRemove: function() {\r\n                 this.resetViewState();\r\n                 this.remove();\r\n            },\r\n\r\n            resetViewState: function() {\r\n                this._isRemoved = true;\r\n                this._editorialArticleView = null;\r\n            }\r\n\r\n        }),\r\n\r\n        //base tile model\r\n        Model: Backbone.Model.extend({\r\n\r\n            defaults: function() {\r\n                return {\r\n                    \"@spanColumns\": \"1,2,3,4\",\r\n                    \"#ratio\": \",,,\",\r\n                    \"#fillHeight\": \"false,false,false,false\"\r\n                };\r\n            },\r\n\r\n            initialize: function() {\r\n\r\n                this.set(\"_globals\", Adapt.course.get(\"_globals\"));\r\n\r\n                var config = this.toJSON();\r\n                this.set(\"defaults\", this.defaults());\r\n\r\n                var fixedKeys = _.filter(_.keys(config), function(key) {\r\n                    if (key.slice(0,1) == \"_\") return true;\r\n                });\r\n\r\n                for (var vk = 0, vkl = fixedKeys.length; vk < vkl; vk++) {\r\n                    var key = fixedKeys[vk];\r\n\r\n                    if (key.slice(0,4) == \"_ie8\") continue;\r\n                    if (this._isIE8) {\r\n                        var ie8Key = \"_ie8\" + key.slice(1,2).toUpperCase() + key.slice(2);\r\n                        if (config[ie8Key]) {\r\n                            this.set(key, config[ie8Key]);\r\n                        }\r\n                    }\r\n\r\n                    \r\n                }\r\n\r\n            }\r\n\r\n        }),\r\n\r\n\r\n        //tile registry\r\n\r\n        _tileStore: {},\r\n    \r\n        register: function(name, object) {\r\n            if (Tile._tileStore[name])\r\n                throw Error('This component already exists in your project');\r\n            if (!object.View) object.View =  Tile.View.extend({});\r\n            if (!object.Model) object.Model =  Tile.Model.extend({});\r\n            object.View.template = \"e-\"+name;\r\n            Tile._tileStore[name] = object;\r\n        },\r\n    \r\n        get: function(name) {\r\n            return Tile._tileStore[name];\r\n        },\r\n\r\n        //unit extention function\r\n\r\n        extend: function(to) {\r\n            return _.extend({}, Tile, to);\r\n        }\r\n\r\n    };\r\n\r\n    return Tile;\r\n\r\n});\r\n\n","define('extensions/adapt-editorial/js/adapt-editorialArticleView',[\r\n    'coreJS/adapt',\r\n    'coreViews/articleView',\r\n    './tiles/tile',\r\n], function(Adapt, ArticleView, Tile) {\r\n\r\n    var EditorialView = {\r\n\r\n        _tilesReady: 0,\r\n        _primaryTilePixelWidth: 0,\r\n        _editorialModel: null,\r\n        \r\n        render: function() {\r\n            ArticleView.prototype.render.call(this);\r\n            if (this.model.isEditorialEnabled && this.model.isEditorialEnabled()) {\r\n                this._editorialModel = this.model.get(\"_editorialModel\");\r\n                if (this._editorialModel.get(\"_forceIE8\")) this.$el.addClass(\"ie8\");\r\n                this.$el.addClass(this._editorialModel.get(\"_classes\"));\r\n                this.$(\".block-container\").removeClass(\"block-container\");\r\n                this.$el.append( $(Handlebars.templates['adapt-editorialArticleView'](this.model.toJSON())) );\r\n\r\n            }\r\n        },\r\n\r\n        postRender: function() {\r\n            ArticleView.prototype.postRender.call(this);\r\n            if (this.model.isEditorialEnabled()) {\r\n                this.setupEditorialEventListeners();\r\n                this.addEditorialChildren();\r\n            }\r\n        },\r\n\r\n        setupEditorialEventListeners: function() {\r\n            this.listenToOnce(Adapt, \"remove\", this.onRemoveEditorial);\r\n            this.listenTo(Adapt, \"device:resize\", this.onResizeEditorial);\r\n            this.listenTo(Adapt, \"device:change\", this.onResizeEditorial);\r\n            this.on(\"tileView:ready\", this.onEditorialTileReady);\r\n        },\r\n\r\n        addEditorialChildren: function() {\r\n            var editorialModel = this.model.get(\"_editorialModel\");\r\n\r\n            var $tilesById = {};\r\n            var $tileContainersById = {};\r\n            var groupViews = {};\r\n\r\n            //create group tiles in cascade order\r\n            //this is so that the resize event triggers the resize of groups in cascade order\r\n\r\n            var groupModels = editorialModel.get(\"_groupModels\");\r\n            var GroupInstantiator = Tile.get(\"group\");\r\n            for (var groupModel, i = 0; groupModel = groupModels.models[i++];) {\r\n                var groupId = groupModel.get(\"_id\");\r\n                var groupParentId = groupModel.get(\"_parentId\");\r\n                var groupView = new GroupInstantiator.View({ model: groupModel, editorialArticleView: this });\r\n\r\n                groupViews[groupId] = groupView;\r\n                $tilesById[groupId] =  groupView.$el;\r\n                $tileContainersById[groupId] = groupView.$(\".tile-container\");\r\n\r\n            }\r\n\r\n            //create non-group tiles\r\n            var contentModels = editorialModel.get(\"_contentModels\");\r\n            for (var tileModel, i = 0; tileModel = contentModels.models[i++];) {\r\n                var tileId = tileModel.get(\"_id\");\r\n                var tileType = tileModel.get(\"_type\");\r\n                var TileInstantiator = Tile.get(tileType);\r\n                var tileParentId = tileModel.get(\"_parentId\");\r\n                var tileView;\r\n                if (tileParentId) {\r\n                    tileView = new TileInstantiator.View({ model: tileModel, editorialArticleView: this, parentView:  groupViews[tileParentId]});\r\n                } else {\r\n                    tileView = new TileInstantiator.View({ model: tileModel, editorialArticleView: this, parentView: undefined });\r\n                }\r\n\r\n                $tilesById[tileId] =  tileView.$el;\r\n            }\r\n\r\n            //add new elements to dom in tile order\r\n            var $primaryTile = this.$('.tile-container.primary');\r\n            var tileModels = editorialModel.get(\"_tileModels\");\r\n            for (var tileModel, i = 0; tileModel = tileModels.models[i++];) {\r\n                var tileId = tileModel.get(\"_id\");\r\n                var tileParentId = tileModel.get(\"_parentId\");\r\n                var $element = $tilesById[tileId];\r\n\r\n                if (tileParentId) {\r\n                    $tileContainersById[tileParentId].append( $element  );\r\n                } else {\r\n                    $primaryTile.append( $element );\r\n                }\r\n            }\r\n\r\n        },\r\n\r\n        onEditorialTileReady: function() {\r\n            var tilesModels = this._editorialModel.get(\"_tileModels\");\r\n\r\n            this._tilesReady++;\r\n\r\n            var hasFinishedLoading = this._tilesReady >= tilesModels.models.length;\r\n\r\n            if (hasFinishedLoading) this.onEditorialArticleReady();\r\n        },\r\n\r\n        onEditorialArticleReady: function() {\r\n            this.off(\"tileView:ready\", this.onEditorialTileReady);\r\n            this.model.set(\"_isEditorialReady\", true);\r\n            this.model.checkReadyStatus();\r\n            this.onResizeEditorial();\r\n        },\r\n\r\n        onResizeEditorial: function() {\r\n            if (!this.model.get(\"_isEditorialReady\")) return;\r\n            \r\n            window.requestAnimationFrame(_.bind(function() {\r\n\r\n                if (!this.setupEditorialPrimaryTileColumnWidth()) return;\r\n\r\n\r\n                var style = this.$(\"style\").remove(); //ios fix - remove and readd the styling\r\n                this.$el.append(style); //ios fix\r\n\r\n                this.trigger(\"resize\");\r\n\r\n                _.defer(_.bind(function() {\r\n                    this.$(\".editorial-container\").css({\r\n                        \"visibility\": \"\"\r\n                    }); //ie8 hide until finished fix\r\n                }, this));\r\n\r\n            }, this));\r\n        },\r\n\r\n        setupEditorialPrimaryTileColumnWidth: function() {\r\n\r\n            var screenSize = Adapt.config.get(\"screenSize\");\r\n            var maxColumns = this._editorialModel.get(\"_maxColumns\");\r\n            var maxColumnWidth = this._editorialModel.get(\"_maxColumnWidth\");\r\n\r\n\r\n            var columnMaxPixelWidth = maxColumnWidth ? maxColumnWidth : Math.floor(screenSize.large / maxColumns);\r\n\r\n            var $primaryTile = this.$('.tile-container.primary');\r\n            var primaryTilePixelWidth = $primaryTile.outerWidth();\r\n\r\n            if (this._primaryTilePixelWidth == primaryTilePixelWidth) return false;\r\n            this._primaryTilePixelWidth = primaryTilePixelWidth;\r\n\r\n            //calculate primary tile grid column size\r\n            var primaryTileColumnWidth = Math.floor(primaryTilePixelWidth / columnMaxPixelWidth) || 1;\r\n            \r\n            if (primaryTileColumnWidth > maxColumns) primaryTileColumnWidth = maxColumns; \r\n\r\n\r\n            $primaryTile.attr(\"spanColumns\", primaryTileColumnWidth);\r\n            this._editorialModel.set(\"_spanColumns\", primaryTileColumnWidth);\r\n\r\n            return true;\r\n        },\r\n\r\n\r\n        onRemoveEditorial: function() {\r\n            this.removeEditorialEventListeners();\r\n            this.model.set(\"_isEditorialReady\", false);\r\n            this.trigger(\"remove\");\r\n        },\r\n\r\n        removeEditorialEventListeners: function() {\r\n            this.stopListening(Adapt, \"device:resize\", this.onResizeEditorial);\r\n            this.off(\"tileView:ready\", this.onEditorialTileReady);\r\n        }\r\n\r\n    };\r\n\r\n    return EditorialView;\r\n\r\n});\n","define('extensions/adapt-editorial/js/adapt-editorialArticleModel',[\r\n    'coreModels/articleModel',\r\n    './tiles/tile'\r\n], function(ArticleModel, Tile) {\r\n\r\n    var EditorialModel = {\r\n\r\n        postInitialize: function() {\r\n            if (!this.isEditorialEnabled()) return;\r\n            this.set(\"_isEditorialReady\", false);\r\n            this.setupEditorial();\r\n            this.setupEditorialGridRules();\r\n            this.setupEditorialChildren();\r\n        },\r\n\r\n        isEditorialEnabled: function() {\r\n            var config = this.getEditorialConfig();\r\n            return config && config._isEnabled;\r\n        },\r\n\r\n        setupEditorial: function() {\r\n            var config = this.getEditorialConfig();\r\n            _.extend(config, { _id: this.get(\"_id\") });\r\n            this.set(\"_editorialModel\", new Backbone.Model(config));\r\n\r\n        },\r\n\r\n        setupEditorialGridRules: function() {\r\n            var editorialModel = this.get(\"_editorialModel\");\r\n            var maxColumns = editorialModel.get(\"_maxColumns\");\r\n\r\n            var rules = [];\r\n            for (var i = 0, l = maxColumns; i < l; i++) {\r\n                for (var r = 0, rl = i + 2; r < rl; r++) {\r\n                    var columnWidth = i + 1;\r\n                    rules.push({\r\n                        \"_columnWidth\": columnWidth,\r\n                        \"_spanColumns\": r,\r\n                        \"_displayNone\": r == 0 ? true : false,\r\n                        \"_width\": Math.floor((r / columnWidth) * 10000) / 100\r\n                    });\r\n                }\r\n            }\r\n\r\n            editorialModel.set(\"_columnStyleRules\", rules);\r\n        },\r\n\r\n        setupEditorialChildren: function() {\r\n            var articleId = this.get(\"_id\");\r\n            var editorialModel = this.get(\"_editorialModel\");\r\n\r\n            var tiles = editorialModel.get(\"_tiles\");\r\n\r\n            var indexedTiles = _.indexBy(tiles, \"_id\");\r\n\r\n            var groups = this.getEditorialGroupCascadeOrder();\r\n            var groupModelsIndexed = {};\r\n            var tileModelsIndexed = {};\r\n\r\n            var GroupInstantiator = Tile.get(\"group\");\r\n            for (var group, i = 0; group = groups[i++];) {\r\n\r\n                group._editorialId = articleId;\r\n                group._editorialModel = editorialModel;\r\n\r\n                if (group._parentId) {\r\n                    group._parentModel = groupModelsIndexed[group._parentId];\r\n                } else {\r\n                    group._parentModel = editorialModel;\r\n                }\r\n\r\n                var groupModel = new GroupInstantiator.Model(group);\r\n                groupModelsIndexed[group._id] = groupModel;\r\n            }\r\n\r\n            editorialModel.set(\"_groupModels\", new Backbone.Collection(_.values(groupModelsIndexed)));\r\n            \r\n            var contentTiles = _.filter(tiles, function(tile) { return tile._type != \"group\" });\r\n            var contentTilesIndexed = {};\r\n            for (var tile, i = 0; tile = contentTiles[i++];) {\r\n                tile._editorialId = articleId;\r\n                tile._editorialModel = editorialModel;\r\n\r\n                var TileInstantiator = Tile.get(tile._type);\r\n\r\n                if (tile._parentId) {\r\n                    tile._parentModel = groupModelsIndexed[tile._parentId];\r\n                } else {\r\n                    tile._parentModel = editorialModel;\r\n                }\r\n\r\n                var tileModel = new TileInstantiator.Model(tile);\r\n\r\n                contentTilesIndexed[tile._id] = tileModel;\r\n            }\r\n\r\n            for (var tile, i = 0; tile = tiles[i++];) {\r\n                tileModelsIndexed[tile._id] = groupModelsIndexed[tile._id] || contentTilesIndexed[tile._id];\r\n            }\r\n\r\n\r\n            editorialModel.set(\"_contentModels\", new Backbone.Collection(_.values(contentTilesIndexed)));\r\n            editorialModel.set(\"_tileModels\", new Backbone.Collection(_.values(tileModelsIndexed)));\r\n        },\r\n\r\n        getEditorialConfig: function() {\r\n            return this.get(\"_editorial\");\r\n        },\r\n\r\n        checkReadyStatus: function(model, val) {\r\n            if (!this.isEditorialEnabled()) ArticleModel.prototype.checkReadyStatus.call(this);\r\n            if (!this.get(\"_isEditorialReady\")) return;\r\n\r\n            var availableChildren = new Backbone.Collection(this.findDescendants('components').where({_isAvailable: true, _isOptional:false}));\r\n            var notReadyChildren = availableChildren.where({_isReady: false});\r\n            var hasNotReadyChildren = notReadyChildren.length > 0;\r\n\r\n            var notReadyIds = [];\r\n            _.each(notReadyChildren, function(item){\r\n                notReadyIds.push(item.get(\"_id\"));\r\n            });\r\n            //console.log(notReadyIds.join(\",\"))\r\n\r\n            if (hasNotReadyChildren) return;\r\n\r\n            this.set(\"_isReady\", true);\r\n        },\r\n\r\n        getEditorialGroupCascadeOrder: function() {\r\n            //sort groups by descendent levels\r\n\r\n            var groupCascadeOrder = [];\r\n\r\n            var editorialModel = this.get(\"_editorialModel\");\r\n            var tiles = editorialModel.get(\"_tiles\");\r\n\r\n            var groups = _.where(tiles, { _type: \"group\" });\r\n            var groupIndex = _.indexBy(groups, \"_id\");\r\n            var rootGroups = _.filter(groups, function(group) {\r\n                return !group._parentId;\r\n            });\r\n\r\n            var resolve = rootGroups;\r\n            removeResolveFromGroups();\r\n\r\n            var tick = 0;\r\n            //stop if no more in groups array and not move in resolve array or stack overrun.\r\n            while ((groups.length > 0 || resolve.length > 0) && tick < 100) {\r\n\r\n                //add all resolve elements to cascade order\r\n                for (var r = 0, rl = resolve.length; r < rl; r++) {\r\n                    var resItem = resolve[r];\r\n                    groupCascadeOrder.push(resItem);\r\n                }\r\n\r\n                //get resolve elements children and put in resolve\r\n                resolveNextChildren();\r\n\r\n                //remove resolve elements from groups array\r\n                removeResolveFromGroups();\r\n\r\n                tick++;\r\n            }\r\n\r\n            return groupCascadeOrder;\r\n\r\n            function removeResolveFromGroups() {\r\n                groups = _.filter(groups, function(group) {\r\n                    //if the resolve item found in groups list, remove it from groups list\r\n                    return _.findWhere(resolve, {_id: group._id}) === undefined;\r\n                });\r\n            }\r\n\r\n            function resolveNextChildren() {\r\n                resolve = _.filter(groups, function(group) {\r\n                    //if the group is child of a resolve item, add it to next resolve list\r\n                    return _.findWhere(resolve, { _id: group._parentId}) !== undefined; \r\n                });\r\n            }\r\n        }\r\n        \r\n    };\r\n\r\n    return EditorialModel;\r\n});\r\n\n","define('extensions/adapt-editorial/js/tiles/e-group',[\r\n    './tile'\r\n], function(Tile) {\r\n\r\n    var GroupTile = {};\r\n\r\n    Tile.register('group', GroupTile);\r\n\r\n    return GroupTile;\r\n\r\n});\r\n\n","//https://github.com/cgkineo/jquery.resize 2015-08-13\r\n\r\n(function() {\r\n\r\n  if ($.fn.off.elementResizeOriginalOff) return;\r\n\r\n\r\n  var orig = $.fn.on;\r\n  $.fn.on = function () {\r\n    if (arguments[0] !== \"resize\") return $.fn.on.elementResizeOriginalOn.apply(this, _.toArray(arguments));\r\n    if (this[0] === window) return $.fn.on.elementResizeOriginalOn.apply(this, _.toArray(arguments));\r\n\r\n    addResizeListener.call(this, (new Date()).getTime());\r\n\r\n    return $.fn.on.elementResizeOriginalOn.apply(this, _.toArray(arguments));\r\n  };\r\n  $.fn.on.elementResizeOriginalOn = orig;\r\n  var orig = $.fn.off;\r\n  $.fn.off = function () {\r\n    if (arguments[0] !== \"resize\") return $.fn.off.elementResizeOriginalOff.apply(this, _.toArray(arguments));\r\n    if (this[0] === window) return $.fn.off.elementResizeOriginalOff.apply(this, _.toArray(arguments));\r\n\r\n    removeResizeListener.call(this, (new Date()).getTime());\r\n\r\n    return $.fn.off.elementResizeOriginalOff.apply(this, _.toArray(arguments));\r\n  };\r\n  $.fn.off.elementResizeOriginalOff = orig;\r\n\r\n  var expando = $.expando;\r\n\r\n  //element + event handler storage\r\n  var resizeObjs = {};\r\n\r\n  //jQuery element + event handler attachment / removal\r\n  var addResizeListener = function(data) {\r\n      resizeObjs[data.guid + \"-\" + this[expando]] = { \r\n        data: data, \r\n        $element: $(this) \r\n      };\r\n  };\r\n\r\n  var removeResizeListener = function(data) {\r\n    try { \r\n      delete resizeObjs[data.guid + \"-\" + this[expando]]; \r\n    } catch(e) {\r\n\r\n    }\r\n  };\r\n\r\n  function checkLoopExpired() {\r\n    if ((new Date()).getTime() - loopData.lastEvent > 500) {\r\n      stopLoop()\r\n      return true;\r\n    }\r\n  }\r\n\r\n  function resizeLoop () {\r\n    if (checkLoopExpired()) return;\r\n\r\n    var resizeHandlers = getEventHandlers(\"resize\");\r\n\r\n    if (resizeHandlers.length === 0) {\r\n      //nothing to resize\r\n      stopLoop();\r\n      resizeIntervalDuration = 500;\r\n      repeatLoop();\r\n    } else {\r\n      //something to resize\r\n      stopLoop();\r\n      resizeIntervalDuration = 250;\r\n      repeatLoop();\r\n    }\r\n\r\n    if  (resizeHandlers.length > 0) {\r\n      var items = resizeHandlers;\r\n      for (var i = 0; i < items.length; i++) {\r\n        var item = items[i];\r\n        triggerResize(item);\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  function getEventHandlers(eventName) {\r\n    var items = [];\r\n    \r\n    switch (eventName) {\r\n    case \"resize\":\r\n      for (var k in resizeObjs) {\r\n        items.push(resizeObjs[k]);\r\n      }\r\n      break;\r\n    }\r\n\r\n    return items;\r\n  }\r\n\r\n  function getDimensions($element) {\r\n      var height = $element.outerHeight();\r\n      var width = $element.outerWidth();\r\n\r\n      return {\r\n        uniqueMeasurementId: height+\",\"+width\r\n      };\r\n  }\r\n\r\n  function triggerResize(item) {\r\n    var measure = getDimensions(item.$element);\r\n    //check if measure has the same values as last\r\n    if (item._resizeData !== undefined && item._resizeData === measure.uniqueMeasurementId) return;\r\n    item._resizeData = measure.uniqueMeasurementId;\r\n    \r\n    //make sure to keep listening until no more resize changes are found\r\n    loopData.lastEvent = (new Date()).getTime();\r\n    \r\n    item.$element.trigger('resize');\r\n  }\r\n\r\n\r\n  //checking loop interval duration\r\n  var resizeIntervalDuration = 250;\r\n\r\n  var loopData = {\r\n    lastEvent: 0,\r\n    interval: null\r\n  };\r\n\r\n  //checking loop start and end\r\n  function startLoop() {\r\n    loopData.lastEvent = (new Date()).getTime();\r\n    if (loopData.interval !== null) {\r\n      stopLoop();\r\n    }\r\n    loopData.interval = setTimeout(resizeLoop, resizeIntervalDuration);\r\n  }\r\n\r\n  function repeatLoop() {\r\n    if (loopData.interval !== null) {\r\n      stopLoop();\r\n    }\r\n    loopData.interval = setTimeout(resizeLoop, resizeIntervalDuration);\r\n  }\r\n\r\n  function stopLoop() {\r\n    clearInterval(loopData.interval);\r\n    loopData.interval = null;\r\n  }\r\n\r\n  $('body').on(\"mousedown mouseup keyup keydown\", startLoop);\r\n  $(window).on(\"resize\", startLoop);\r\n\r\n\r\n})();\r\n\ndefine(\"extensions/adapt-editorial/js/lib/jquery.resize\", function(){});\n\n","//https://github.com/cgkineo/jquery.backgroundImage 2015-08-18\r\n\r\n;(function( $ ) {\r\n\r\n    if ($.fn.backgroundImage) return;\r\n\r\n    $.fn.backgroundImage = function(options) {\r\n\r\n        options = options || {};\r\n        if (options.dynamicRatio === undefined) options.dynamicRatio = false;\r\n        if (options.expandContainerHeight === undefined) options.expandContainerHeight = true;\r\n        if (options.expandHeight === undefined) options.expandHeight = undefined;\r\n        if (options.selector === undefined) options.selector = \"img\";\r\n        if (options.restrict === undefined) options.restrict = \"auto auto\";\r\n\r\n        var $images = this.find(options.selector).add( this.filter(options.selector) );\r\n\r\n        if ($images.length === 0) return;\r\n\r\n        $images.each(function() {\r\n            process($(this), options);\r\n        });\r\n\r\n    };\r\n\r\n    function process($image, options) {\r\n        var $offset = $image.parent();\r\n        var $container = $offset.parent();\r\n        var $containerParent = $container.parent();\r\n        \r\n        //reset image and offset\r\n        $offset.css({\r\n            \"height\": \"\",\r\n            \"width\": \"\",\r\n            \"overflow\": \"hidden\",\r\n            \"max-width\": \"100%\",\r\n            \"max-height\": \"100%\"\r\n        });\r\n        $image.css({\r\n            \"top\": \"\",\r\n            \"left\": \"\",\r\n            \"bottom\": \"\",\r\n            \"right\": \"\",\r\n            \"width\": \"\",\r\n            \"height\": \"\",\r\n            \"max-width\": \"100%\",\r\n            \"max-height\": \"100%\"\r\n        });\r\n\r\n        var imageDim = $image.getDimensions(options.dynamicRatio);\r\n\r\n        //set/unset container height if required\r\n        if (options.expandContainerHeight === true) {\r\n            $container.css({\r\n                \"height\": \"100%\"\r\n            });\r\n            if ($containerParent.height() > 0) {\r\n                $container.css({\r\n                    \"height\": $containerParent.height() + \"px\"\r\n                });\r\n            }\r\n        } else if (options.expandContainerHeight === false) {\r\n            $container.css({\r\n                \"height\": \"\"\r\n            });\r\n        }\r\n\r\n        var containerDim = $container.getDimensions(true);\r\n\r\n\r\n        // set offset container to fill the width\r\n        var offsetDimensions = {\r\n            \"width\": \"100%\"\r\n        };        \r\n        \r\n        /* only fill the height if asked in the settings or if the container height is larger than the offset height, \r\n        *  otherwise where content height is generated from the conent image, \r\n        *  100% height is meaningless before the image is in\r\n        */\r\n        if (containerDim.height > $offset.height() && offsetDimensions.height === undefined && options.expandHeight === undefined) {\r\n            options.expandHeight = true;\r\n            offsetDimensions.height = containerDim.height + \"px\";\r\n        }\r\n        //set offset style\r\n        $offset.css(offsetDimensions);\r\n\r\n        //capture body and container fontsize for rem and em calculations\r\n        containerDim['fontSize'] = $container.css(\"font-size\");\r\n        var documentFontSize = $(\"body\").css(\"font-size\");\r\n        \r\n        //setup image for styling\r\n        var imageDimensions = {\r\n            \"max-width\": \"none\",\r\n            \"max-height\": \"none\"\r\n        };\r\n\r\n\r\n        /* check the position variable to set the top left position of the image \r\n        *  inside it's overall container\r\n        */\r\n        var positionsDim;\r\n        if (options.position !== undefined) {\r\n\r\n            //setup image position styles for filling\r\n            $.extend(imageDimensions, {\r\n                \"top\": \"\",\r\n                \"left\": \"\",\r\n                \"bottom\": \"\",\r\n                \"right\": \"\"\r\n            });\r\n\r\n            var positions = (options.position || \"top left\").split(\" \");\r\n\r\n            positionsDim = convertPositions(containerDim, imageDim, {\r\n                \"left\": positions[0], \r\n                \"top\": positions[1], \r\n                \"documentFontSize\": documentFontSize\r\n            });\r\n            imageDimensions.top = positionsDim.top;\r\n            imageDimensions.left = positionsDim.left;\r\n\r\n        }\r\n\r\n        //setup image size styles for filling\r\n        if (options.size !== undefined) {\r\n            $.extend(imageDimensions, {\r\n                \"width\": \"\",\r\n                \"height\": \"\"\r\n            });\r\n        }\r\n\r\n        //setup image size (height / width);\r\n        switch (options.size) {\r\n        case undefined:\r\n        case \"contain\":\r\n            //default to contain if size is undefined, auto auto, or contain\r\n            if (containerDim.ratio < imageDim.ratio) {\r\n                var width = containerDim.width;\r\n                imageDimensions.width = width + \"px\";\r\n                imageDimensions.height = width / imageDim.ratio + \"px\"\r\n            } else {\r\n                var height = containerDim.height;\r\n                imageDimensions.height = height + \"px\";\r\n                imageDimensions.width = height * imageDim.ratio + \"px\"\r\n            }\r\n            break;\r\n\r\n        case \"cover\":\r\n\r\n            if (containerDim.ratio > imageDim.ratio) {\r\n                var width = containerDim.width;\r\n                imageDimensions.width = width + \"px\";\r\n                imageDimensions.height = width / imageDim.ratio + \"px\"\r\n            } else {\r\n                var height = containerDim.height;\r\n                imageDimensions.height = height + \"px\";\r\n                imageDimensions.width = height * imageDim.ratio + \"px\"\r\n            }\r\n            break;\r\n\r\n        default:\r\n            //setup image value styles\r\n            var sizes = (options.size || \"100% auto\").split(\" \");\r\n            var widthSize = sizes[0];\r\n            var heightSize = sizes[1];\r\n\r\n            var dims = convertDimensions(containerDim, imageDim, {\r\n                \"width\": widthSize, \r\n                \"height\": heightSize,\r\n                \"documentFontSize\": documentFontSize\r\n            });\r\n\r\n            imageDimensions.height = dims.height;\r\n            imageDimensions.width = dims.width;\r\n\r\n        }\r\n\r\n        //correct any leftover styles with the image height/width if required\r\n        if (imageDimensions.height === \"auto\") {\r\n            imageDimensions.height = imageDim.height;\r\n        }\r\n\r\n        if (imageDimensions.width === \"auto\") {\r\n            imageDimensions.width = imageDim.width;\r\n        }\r\n\r\n        //restrict the offset container (height/width) if required\r\n        if (options.restrict !== undefined) {\r\n            var restricts = options.restrict.split(\" \");\r\n            \r\n            imageDimensions.ratio = imageDim.ratio;\r\n\r\n            var dims = convertRestricts(containerDim, imageDimensions, {\r\n                \"width\": restricts[0], \r\n                \"height\": restricts[1], \r\n                \"documentFontSize\": documentFontSize\r\n            });\r\n\r\n            offsetDimensions.width = dims.width;\r\n            offsetDimensions.height = dims.height;\r\n\r\n            $offset.css(offsetDimensions);\r\n        }\r\n        \r\n\r\n        var offsetDim = $offset.getDimensions(true);\r\n\r\n        //center, bottom or right align the image inside the offset container\r\n        if (imageDimensions.top === \"center\") {\r\n            var height = imageDimensions.height === undefined ? imageDim.height : parseInt(imageDimensions.height);\r\n            imageDimensions.top = ((offsetDim.height / 2) - (parseFloat(height) / 2)) + \"px\";\r\n        } else if (imageDimensions.top === \"bottom\") {\r\n            var height = imageDimensions.height === undefined ? imageDim.height : parseInt(imageDimensions.height);\r\n            imageDimensions.top = ((offsetDim.height) - (parseFloat(height))) + \"px\";\r\n        }\r\n        if (imageDimensions.left === \"center\") {\r\n            var width = imageDimensions.width === undefined ? imageDim.width : parseFloat(imageDimensions.width);\r\n            imageDimensions.left = ((offsetDim.width / 2) - (parseFloat(width) / 2)) + \"px\";\r\n        } else if (imageDimensions.left === \"right\") {\r\n            var width = imageDimensions.width === undefined ? imageDim.width : parseFloat(imageDimensions.width);\r\n            imageDimensions.left = ((offsetDim.width) - (parseFloat(width))) + \"px\";\r\n        }\r\n\r\n        //apply the style\r\n        $image.css(imageDimensions);\r\n    }\r\n\r\n    function arrayIndexOf(arr, value) {\r\n        if (arr.indexOf) return arr.indexOf(value);\r\n        for (var i = 0, l = arr.length; i < l; i++) {\r\n            if (arr[i] == value) return i;\r\n        }\r\n        return -1;\r\n    }\r\n\r\n    function convertDimensions(container, image, settings) {\r\n        var dim = {\r\n            \"width\": 0,\r\n            \"height\": 0\r\n        };\r\n        if (settings.width === undefined) settings.width = \"auto\";\r\n        if (settings.height === undefined) settings.height = \"auto\";\r\n\r\n        dim.width = convertDimension(container.width, settings.width, container.fontSize, settings.documentFontSize);\r\n        dim.height = convertDimension(container.height, settings.height, container.fontSize, settings.documentFontSize);\r\n\r\n        var autos = {\r\n            \"width\": isAuto(dim.width),\r\n            \"height\": isAuto(dim.height)\r\n        };\r\n\r\n        if (autos.width && autos.height) {\r\n            if (container.ratio < image.ratio) {\r\n                dim.width = container.width + \"px\";\r\n                dim.height = (container.width / image.ratio) + \"px\"\r\n            } else {\r\n                dim.height = container.height + \"px\";\r\n                dim.width = (container.height * image.ratio) + \"px\";\r\n            }\r\n        } else if (autos.width) {\r\n            dim.width = (parseFloat(dim.height) * image.ratio) + \"px\";\r\n        } else if (autos.height) {\r\n            dim.height = (parseFloat(dim.width) / image.ratio) + \"px\";\r\n        }\r\n\r\n        return dim;\r\n\r\n    }\r\n\r\n    function convertDimension(containerValue, settingsValue, containerFontSize, documentFontSize) {\r\n        if (isAuto(settingsValue)) {\r\n            return \"auto\";\r\n        } else if (isPercent(settingsValue)) {\r\n            var val = parseFloat(settingsValue);\r\n            return ((containerValue / 100) * val) + \"px\";\r\n        } else if (isPixel(settingsValue)) {\r\n            return parseFloat(settingsValue) + \"px\";\r\n        } else if (isREM(settingsValue)) {\r\n            return (documentFontSize * parseFloat(settingsValue)) + \"px\";\r\n        } else if (isEM(settingsValue)) {\r\n            return (containerFontSize * parseFloat(settingsValue)) + \"px\";\r\n        }\r\n        return \"auto\";\r\n    }\r\n\r\n    function convertPositions(container, image, settings) {\r\n        var dim = {\r\n            \"left\": 0,\r\n            \"top\": 0\r\n        };\r\n        if (settings.left === undefined) settings.left = \"left\";\r\n        if (settings.top === undefined) settings.top = \"top\";\r\n\r\n        var swapped = false;\r\n        switch (settings.left) {\r\n        case \"top\": case \"bottom\":\r\n            var a = settings.top;\r\n            settings.top = settings.left;\r\n            settings.left = a;\r\n            swapped = true;\r\n        }\r\n\r\n        switch (settings.top) {\r\n        case \"left\": case \"right\":\r\n            if (!swapped) {\r\n                var a = settings.top;\r\n                settings.top = settings.left;\r\n                settings.left = a;\r\n                swapped = true;\r\n            } else {\r\n                settings.top = \"top\";\r\n            }\r\n        }\r\n\r\n        dim.left = convertPosition(container.width, settings.left, container.fontSize, settings.documentFontSize);\r\n        dim.top = convertPosition(container.height, settings.top, container.fontSize, settings.documentFontSize);\r\n\r\n        if (dim.left === \"auto\") dim.left = \"0px\";\r\n        if (dim.top === \"auto\") dim.top = \"0px\";\r\n\r\n        return dim;\r\n    }\r\n\r\n    function convertPosition(containerValue, settingsValue, containerFontSize, documentFontSize) {\r\n        if (isAuto(settingsValue)) {\r\n            return \"auto\";\r\n        } else if (isPercent(settingsValue)) {\r\n            var val = parseFloat(settingsValue);\r\n            return ((containerValue / 100) * val) + \"px\";\r\n        } else if (isPixel(settingsValue)) {\r\n            return parseFloat(settingsValue) + \"px\";\r\n        } else if (isREM(settingsValue)) {\r\n            return (documentFontSize * parseFloat(settingsValue)) + \"px\";\r\n        } else if (isEM(settingsValue)) {\r\n            return (containerFontSize * parseFloat(settingsValue)) + \"px\";\r\n        }\r\n        switch(settingsValue) {\r\n        case \"center\":\r\n            return \"center\";\r\n        case \"top\":\r\n            return \"0px\"\r\n        case \"left\":\r\n            return \"0px\"\r\n        case \"bottom\":\r\n            return \"bottom\";\r\n        case \"right\":\r\n            return \"right\";\r\n        }\r\n        return \"auto\";\r\n    }\r\n\r\n    function convertRestricts(container, image, settings) {\r\n        var dim = {\r\n            \"width\": 0,\r\n            \"height\": 0\r\n        };\r\n        if (settings.width === undefined) settings.width = \"auto\";\r\n        if (settings.height === undefined) settings.height = \"auto\";\r\n\r\n        dim.width = convertDimension(container.width, settings.width, container.fontSize, settings.documentFontSize);\r\n        dim.height = convertDimension(container.height, settings.height, container.fontSize, settings.documentFontSize);\r\n\r\n        var autos = {\r\n            \"width\": isAuto(dim.width),\r\n            \"height\": isAuto(dim.height)\r\n        };\r\n\r\n        if (autos.width && autos.height) {\r\n            dim.height = parseFloat(image.height) + \"px\";\r\n            dim.width =  parseFloat(image.width) + \"px\";\r\n        } else if (autos.width) {\r\n            dim.width = parseFloat(image.width) + \"px\";\r\n        } else if (autos.height) {\r\n            dim.height = parseFloat(image.height) + \"px\";\r\n        }\r\n\r\n        return dim;\r\n\r\n    }\r\n\r\n    function isAuto(value) {\r\n        return (/(auto){1}/gi).test(value);\r\n    }\r\n\r\n    function isRelative(value) {\r\n        return (/^(\\+|\\-){1}/g).text(value);\r\n    }\r\n\r\n    function isPercent(value) {\r\n        return (/\\%{1}/g).test(value);\r\n    }\r\n\r\n    function isPixel(value) {\r\n        return (/(px){1}/gi).test(value);\r\n    }\r\n\r\n    function isREM(value) {\r\n        return (/(rem){1}/gi).test(value);\r\n    }\r\n\r\n    function isEM(value) {\r\n        return (/(em){1}/gi).test(value);\r\n    }\r\n  \r\n\r\n})( jQuery );\r\n\ndefine(\"extensions/adapt-editorial/js/lib/jquery.backgroundimage\", function(){});\n\n","define('extensions/adapt-editorial/js/tiles/lightbox',[\r\n    'coreJS/adapt',\r\n    '../tiles/tile',\r\n    '../lib/jquery.resize',\r\n    '../lib/jquery.backgroundimage'\r\n], function(Adapt, Tile) {\r\n\r\n    var LightboxTile = Tile.extend({\r\n        View: Tile.View.extend({\r\n\r\n            _disableAnimations: false,\r\n            _lightboxOpen: false,\r\n            _lightboxId: \"\",\r\n            _lightboxBackground: false,\r\n            _lightboxFullsize: false,\r\n            _lightboxHasSized: false,\r\n            _lightboxCurrentOffsetTop: 0,\r\n            _lightboxCurrentAvailableHeight: 0,\r\n            _animationDuration: 400,\r\n            _windowDimensions: null,\r\n            _forceResize: true,\r\n            _iOS: /iPad|iPhone|iPod/.test(navigator.platform),\r\n\r\n            onInitialize: Backbone.ascend(\"onInitialize\", function() {\r\n                var linkId = this.model.get(\"_linkId\");\r\n                if (!linkId) return;\r\n\r\n                if (this._isIE8 || $('html').is(\".ie8\") || $('html').is(\".iPhone.version-7\\\\.0\")) {\r\n                    this._disableAnimations = true;\r\n                }\r\n\r\n                if (linkId.indexOf(\"/\") === -1) {\r\n                    this.$el.addClass(linkId);\r\n                } else {\r\n                    this.$el.addClass(\"incomplete\");\r\n                }\r\n                this.$el.attr(\"data-link\", linkId);\r\n            }),\r\n\r\n            postRender: Backbone.ascend(\"postRender\", function() {\r\n                var linkId = this.model.get(\"_linkId\");\r\n                if (!linkId) return;\r\n\r\n                this.onLinkClick = _.bind(this.onLinkClick, this);\r\n                this.onCloseClick = _.bind(this.onCloseClick, this);\r\n\r\n                this.$(\"button[data-link]\").on(\"click\", this.onLinkClick);\r\n                \r\n                switch (this.model.get(\"_type\")) {\r\n                case \"video\":\r\n                    this.$(\".text\").on(\"click\", this.onLinkClick);\r\n                    break;\r\n                case \"text\":\r\n                case \"image\":\r\n                    this.$el.on(\"click\", this.onLinkClick);\r\n                    break;\r\n                }\r\n\r\n                this.listenTo(Adapt, \"lightbox:did-hide\", this.onCloseClick);\r\n\r\n                this.updateProgressBars();\r\n\r\n            }),\r\n\r\n            onLinkClick: function(event) {\r\n                event.preventDefault();\r\n                if (this._lightboxOpen) return;\r\n\r\n                var linkId = this.model.get(\"_linkId\");\r\n\r\n                if (linkId.indexOf(\"/\") > -1) {\r\n                    window.open(linkId, \"lightbox_resource\");\r\n                    this.$el.addClass(\"complete\").removeClass(\"incomplete\");\r\n                    return;\r\n                }\r\n\r\n                $('video,audio').trigger('pause');\r\n\r\n                this._lightboxOpen = true;\r\n\r\n                Adapt.trigger(\"lightbox:show\", linkId);\r\n\r\n                var visitedLink = this.model.get('_linkTextVisited');\r\n                this.$('.lightbox-link-progress').html(visitedLink).attr('aria-label', visitedLink);\r\n            },\r\n\r\n            onCloseClick: function(event) {\r\n                if (!this._lightboxOpen) return;\r\n\r\n                this.updateProgressBars();\r\n\r\n                $('video,audio').trigger('pause');\r\n                \r\n                this._lightboxOpen = false;\r\n                \r\n\r\n            },\r\n\r\n            updateProgressBars: function() {\r\n                var linkId = this.model.get(\"_linkId\");\r\n                if (!linkId) return;\r\n\r\n                if (linkId.indexOf(\"/\") > -1) return;\r\n\r\n\r\n                var linkModel = Adapt.findById(linkId);\r\n                var componentModels = linkModel.findDescendants(\"components\");\r\n                componentModels = new Backbone.Collection(componentModels.where({\r\n                    \"_isAvailable\": true\r\n                }));\r\n\r\n                var completeComponents = new Backbone.Collection(componentModels.where({\r\n                    _isComplete: true\r\n                }));\r\n\r\n                var percentageComplete = 100;\r\n                if (componentModels.length > 0) {\r\n                    percentageComplete = (completeComponents.length / componentModels.length ) * 100;\r\n                }\r\n\r\n                if (percentageComplete == 0) {\r\n                    this._editorialArticleView.$(\"[data-link='\"+linkId+\"']\").removeClass(\"complete\").addClass('incomplete');\r\n                } else if (percentageComplete > 0 && percentageComplete < 100) {\r\n                    this.$('.lightbox-link-progress').html(visitedLink).attr('aria-label', visitedLink);\r\n                } else if (percentageComplete == 100) {\r\n                    this._editorialArticleView.$(\"[data-link='\"+linkId+\"']\").removeClass(\"incomplete partially-complete\").addClass('complete visited');\r\n                    var completedLink = this.model.get('_linkTextComplete');\r\n                    this.$('.lightbox-link-progress').html(completedLink).attr('aria-label', completedLink);\r\n                }\r\n\r\n\r\n                this._editorialArticleView.$(\"[data-link='\"+linkId+\"']\").addClass()\r\n\r\n                this._editorialArticleView.$(\"[data-link='\"+linkId+\"'] .lightbox-link-progress-bar\").css({\r\n                    \"width\": percentageComplete +\"%\"\r\n                });\r\n\r\n                if (Adapt.course.get(\"_globals\") && Adapt.course.get(\"_globals\")._extensions && Adapt.course.get(\"_globals\")._extensions._editorial) {\r\n                    var ariaLabel = Adapt.course.get(\"_globals\")._extensions._editorial.progressIndicatorBar;\r\n                    var ariaLabelInstructions = Adapt.course.get(\"_globals\")._extensions._editorial.progressIndicatorBarIncompleteInstructions;\r\n                    var $ariaLabel = this._editorialArticleView.$(\"[data-link='\"+linkId+\"'] .lightbox-link-progress-bar .aria-label\");\r\n                    $ariaLabel.html(ariaLabel + \" \" + percentageComplete + \"%. \" + (percentageComplete == 100 ? \"\" : ariaLabelInstructions));\r\n                }\r\n            },\r\n\r\n            getCalculatedStyleObject: Backbone.ascend(\"getCalculatedStyleObject\", function(styleObject) {\r\n                var styleObject = this.model.toJSON();\r\n                \r\n                var linkId = this.model.get(\"_linkId\");\r\n                if (!linkId) return;\r\n                \r\n                switch (styleObject._linkStyle) {\r\n                case \"title\":\r\n                    this.$(\".lightbox-link-title\").removeClass(\"display-none\")\r\n                    this.$(\".lightbox-link-center\").addClass(\"display-none\");\r\n                    break;\r\n                case \"center\":\r\n                    this.$(\".lightbox-link-title\").addClass(\"display-none\")\r\n                    this.$(\".lightbox-link-center\").removeClass(\"display-none\");\r\n                    break;\r\n                }\r\n            }),\r\n\r\n            onRemove: Backbone.descend(\"onRemove\", function() {\r\n                var linkId = this.model.get(\"_linkId\");\r\n                if (!linkId) return;\r\n                \r\n                this.stopListening(Adapt, \"lightbox:close\", this.onCloseClick);\r\n\r\n                this.$(\"button[data-link]\").off(\"click\", this.onLinkClick);\r\n                this.$(\".text\").off(\"click\", this.onLinkClick);\r\n                delete this.onLinkClick;\r\n            })\r\n\r\n        }),\r\n\r\n        Model: Tile.Model.extend({\r\n\r\n            defaults: Backbone.ascend(\"defaults\", function() {\r\n                return {\r\n                    \"_linkId\": null,\r\n                    \"_linkText\": null,\r\n                    \"_linkInstruction\": null,\r\n                    \"_linkStyle\": null,\r\n                    \r\n                };\r\n            })\r\n\r\n        })\r\n\r\n    });\r\n\r\n    return LightboxTile;\r\n\r\n});\r\n\r\n\n","define('extensions/adapt-editorial/js/tiles/e-text',[\r\n    './tile',\r\n    './lightbox'\r\n], function(Tile, LightboxTile) {\r\n\r\n    var TextTile = Tile.extend({\r\n\r\n    \tView: LightboxTile.View.extend({\r\n\r\n            classes: Backbone.ascend(\"classes\", function() {\r\n                return [\r\n                    \"content\"\r\n                ];\r\n            }),\r\n\r\n            renderStyle: Backbone.descend(\"renderStyle\", function(styleObject) {\r\n\r\n                var textRoundedCorderColor = styleObject._textRoundedCornerColor || \"\";\r\n                 this.$(\".text\").css({ \r\n                    \"background-color\": textRoundedCorderColor\r\n                });\r\n\r\n                var textBackgroundColor = styleObject._textBackgroundColor || \"\";\r\n                this.$(\".text .background\").css({ \r\n                    \"background-color\": textBackgroundColor\r\n                });\r\n\r\n                var textTitleColor = styleObject._textTitleColor || \"\";\r\n                this.$(\".text .title\").css({ \r\n                    \"color\": textTitleColor\r\n                });\r\n\r\n                var textTitleFontSize = styleObject._textTitleFontSize || \"\";\r\n                this.$(\".text .title\").css({ \r\n                    \"font-size\": textTitleFontSize\r\n                });\r\n\r\n                var textBodyColor = styleObject._textBodyColor || \"\";\r\n                this.$(\".text .body\").css({ \r\n                    \"color\": textBodyColor\r\n                });\r\n\r\n                var textInstructionColor = styleObject._textInstructionColor || \"\";\r\n                this.$(\".text .instruction\").css({ \r\n                    \"color\": textInstructionColor\r\n                });\r\n\r\n                var textHeight = \"\";\r\n                if (!textHeight && styleObject._fillHeight) {\r\n                    var contentPadding = parseInt(this.$(\".content\").css(\"padding-bottom\")) + parseInt(this.$(\".content\").css(\"padding-top\"));\r\n                    var tileInnerSpace = this.$el.innerHeight();\r\n                    var textFillHeight = (tileInnerSpace - contentPadding);\r\n                    textHeight = ( textFillHeight ) + \"px\";\r\n                }\r\n                this.$(\".text\").css({ \r\n                    height: textHeight\r\n                });\r\n\r\n            })\r\n\r\n        }),\r\n\r\n        Model: LightboxTile.Model.extend({\r\n\r\n            defaults: Backbone.ascend(\"defaults\", function() {\r\n                return {\r\n                    \"#showText\": \"true,true,true,true\"\r\n                };\r\n            })\r\n            \r\n        })\r\n\r\n    });\r\n\r\n    Tile.register('text', TextTile);\r\n\r\n    return TextTile;\r\n\r\n});\r\n\n",";(function( $) {\r\n\r\n\tif ($.fn.haveDimensionsChanged) return;\r\n\r\n\t$.fn.haveDimensionsChanged = function(oldDimensions) {\r\n\t\tif (this.length === 0) return false;\r\n\t\treturn haveDimensionsChanged(this, oldDimensions);\r\n\t};\r\n\r\n\tfunction haveDimensionsChanged($ele, oldDimensions) {\r\n        oldDimensions = oldDimensions || $ele.data(\"dimensions\");\r\n\r\n        var height = $ele.height();\r\n        var width = $ele.width();\r\n        var ratio = width / height;\r\n        var dimensions = {\r\n            \"width\": width,\r\n            \"height\": height,\r\n            \"ratio\": ratio\r\n        };\r\n\r\n        var hasChanged = false;\r\n\r\n        if (oldDimensions) {\r\n            if (oldDimensions.ratio != dimensions.ratio) hasChanged = true;\r\n            else if (oldDimensions.height != dimensions.height) hasChanged = true;\r\n        }\r\n\r\n        if (!hasChanged) return false;\r\n           \r\n        $ele.data(\"dimensions\", dimensions);\r\n\r\n        return true;\r\n\r\n    }\r\n\r\n    $.fn.getDimensions = function(dynamicRatio) {\r\n\t\tif (this.length === 0) return false;\r\n\t\treturn getDimensions(this, dynamicRatio);\r\n\t};\r\n\r\n    function getDimensions($ele, dynamicRatio) {\r\n        var dimensions;\r\n        if (dynamicRatio === undefined) dynamicRatio = false;\r\n        if (!dynamicRatio) {\r\n            dimensions = $ele.data(\"dimensions\");\r\n            if (dimensions) return dimensions;\r\n        }\r\n        var height;\r\n        var width;\r\n        if ($ele.is(\"img\")) {\r\n            height = $ele[0].naturalHeight || $ele[0].height;\r\n            width = $ele[0].naturalWidth || $ele[0].width;\r\n        } else {\r\n            height = $ele.height();\r\n            width = $ele.width();\r\n        }\r\n        var ratio = width / height;\r\n        var dimensions = {\r\n            \"width\": width,\r\n            \"height\": height,\r\n            \"ratio\": ratio\r\n        };\r\n        if (!dynamicRatio) {\r\n            $ele.data(\"dimensions\", dimensions);\r\n        }\r\n        return dimensions;\r\n    }\r\n\r\n})( jQuery );\ndefine(\"extensions/adapt-editorial/js/lib/jquery.dimensions\", function(){});\n\n","define('extensions/adapt-editorial/js/tiles/media',[\r\n    'coreJS/adapt',\r\n    './tile',\r\n    './lightbox',\r\n    '../lib/jquery.resize',\r\n    '../lib/jquery.dimensions',\r\n    '../lib/jquery.backgroundimage'\r\n], function(Adapt, Tile, LightboxTile) {\r\n\r\n    var MediaTile = Tile.extend({\r\n\r\n        View: LightboxTile.View.extend({\r\n\r\n            mediaSelector: \".media-item\",\r\n\r\n            classes: Backbone.ascend(\"classes\", function() {\r\n                return [\r\n                    \"media\",\r\n                    \"content\",\r\n                    this.model.get(\"_linkId\")\r\n                ];\r\n            }),\r\n\r\n            getCalculatedStyleObject: Backbone.ascend(\"getCalculatedStyleObject\", function() {\r\n                var styleObject = this.model.toJSON();\r\n\r\n                //set the ratio of text to media\r\n                if (styleObject['_textPortion'] && (styleObject._textPosition == \"left\" || styleObject._textPosition == \"right\")) {\r\n                \r\n                    styleObject._textPortion = parseInt(styleObject._textPortion);\r\n                    styleObject._mediaPortion = (100 - styleObject._textPortion) + \"%\";\r\n                    styleObject._textPortion+=\"%\";\r\n\r\n\r\n                } else {\r\n                    styleObject._mediaPortion = \"\";\r\n                    styleObject._textPortion = \"\";\r\n                }\r\n\r\n                //space between text and media\r\n                if (styleObject['_spaceBetween']) {\r\n            \r\n                    styleObject._textMargin = parseInt(styleObject._spaceBetween) + \"px\"\r\n                   \r\n                }\r\n\r\n                return styleObject;\r\n            }),\r\n\r\n            renderStyle: Backbone.descend(\"renderStyle\", function(styleObject) {\r\n\r\n                var contentHeight = styleObject._contentHeight ? styleObject._contentHeight+\"px\" : \"\";\r\n                this.$(\".content\").css({ \r\n                    height: contentHeight\r\n                });\r\n\r\n                var size = (styleObject['_mediaSize'] || \"auto auto\");\r\n                var position = (styleObject['_mediaPosition'] || \"top left\");\r\n                var restrict = (styleObject['_mediaRestrict'] || \"auto auto\");\r\n                var dynamicRatio = (styleObject['_mediaDynamicRatio'] === undefined ? true : styleObject['_mediaDynamicRatio']);\r\n\r\n                this.$el.backgroundImage({\r\n                    \"size\": size,\r\n                    \"position\": position,\r\n                    \"restrict\": restrict,\r\n                    \"selector\": this.mediaSelector,\r\n                    \"dynamicRatio\": dynamicRatio,\r\n                    \"expandContainerHeight\": this.model.get(\"_textBigger\")\r\n                });\r\n\r\n                var textWidth = \"\";\r\n                var textHeight = \"\";\r\n                var textRoundedCorderColor = styleObject._textRoundedCornerColor || \"\";\r\n                var textMarginTop = \"\";\r\n                var textMarginLeft = \"\";\r\n                var textMarginBottom = \"\";\r\n                var textMarginRight = \"\";\r\n                if (styleObject._textPosition==\"left\"||styleObject._textPosition==\"right\") {\r\n                    textWidth = styleObject._textPortion || \"\";\r\n                }\r\n                if (styleObject._textPosition==\"top\"||styleObject._textPosition==\"bottom\") {\r\n                    textHeight = \"\";\r\n                    if (styleObject._fillHeight) {\r\n                        var contentPadding = parseInt(this.$(\".content\").css(\"padding-bottom\")) + parseInt(this.$(\".content\").css(\"padding-top\"));\r\n                        var tileInnerSpace = this.$el.innerHeight();\r\n                        var mediaOuterHeight = this.$(\".media\").outerHeight();\r\n                        var textFillHeight = (tileInnerSpace - contentPadding)- mediaOuterHeight;\r\n                        textHeight = ( textFillHeight ) + \"px\";\r\n                    }\r\n                }\r\n                if (styleObject._textMargin) {\r\n                    switch (styleObject._textPosition) {\r\n                    case \"top\":\r\n                        textMargin = \"0 0 \" + styleObject._textMargin + \"px 0\";\r\n                        textMarginBottom = styleObject._textMargin;\r\n                        break;\r\n                    case \"left\":\r\n                        textMargin = \"0 \" + styleObject._textMargin + \"px 0 0\";\r\n                        textMarginRight = styleObject._textMargin;\r\n                        break;\r\n                    case \"bottom\":\r\n                        textMargin = styleObject._textMargin + \"px 0 0 0\";\r\n                        textMarginTop = styleObject._textMargin;\r\n                        break;\r\n                    case \"right\":\r\n                        textMargin = \"0 0 0 \" + styleObject._textMargin + \"px\";\r\n                        textMarginLeft = styleObject._textMargin;\r\n                        break;\r\n                    }\r\n                }\r\n                this.$(\".text\").css({ \r\n                    position: styleObject._offsetTop ? \"absolute\" : \"\",\r\n                    bottom: styleObject._offsetTop ? \"0px\" : \"\",\r\n                    width: textWidth,\r\n                    height: textHeight,\r\n                    \"margin-top\": textMarginTop,\r\n                    \"margin-left\": textMarginLeft,\r\n                    \"margin-bottom\": textMarginBottom,\r\n                    \"margin-right\": textMarginRight,\r\n                    \"background-color\": textRoundedCorderColor\r\n                });\r\n\r\n                var mediaPortion = styleObject._hasText ? styleObject._mediaPortion || \"\" : \"\";\r\n                this.$(\".media\").css({\r\n                    \"width\": mediaPortion\r\n                });\r\n\r\n                var textBackgroundColor = styleObject._textBackgroundColor || \"\";\r\n                this.$(\".text .background\").css({ \r\n                    \"background-color\": textBackgroundColor\r\n                });\r\n\r\n                var textTitleColor = styleObject._textTitleColor || \"\";\r\n                this.$(\".text .title\").css({ \r\n                    \"color\": textTitleColor\r\n                });\r\n\r\n                var textTitleFontSize = styleObject._textTitleFontSize || \"\";\r\n                this.$(\".text .title\").css({ \r\n                    \"font-size\": textTitleFontSize\r\n                });\r\n\r\n                var textBodyColor = styleObject._textBodyColor || \"\";\r\n                this.$(\".text .body\").css({ \r\n                    \"color\": textBodyColor\r\n                });\r\n\r\n                var textInstructionColor = styleObject._textInstructionColor || \"\";\r\n                this.$(\".text .instruction\").css({ \r\n                    \"color\": textInstructionColor\r\n                });\r\n\r\n                this.checkIfTextIsBiggerThanImage();\r\n\r\n                \r\n\r\n            }),\r\n\r\n            checkIfTextIsBiggerThanImage: function() {\r\n                var $text = this.$(\".text\");\r\n                var $image = this.$(\".media .media-item\");\r\n\r\n                switch (this.model.get(\"_textPosition\")) {\r\n                case \"top\": case \"bottom\":\r\n                    this.model.set(\"_textBigger\", false);\r\n                    this.$el.attr(\"textbigger\", \"false\");\r\n                    return;\r\n                case \"left\":\r\n                    $text = $text.filter(\".top\");\r\n                    break;\r\n                case \"right\":\r\n                    $text = $text.filter(\".bottom\");\r\n                    break;\r\n                }\r\n\r\n                $text = $text.find(\".text-inner\");\r\n\r\n                var textHeight = $text.outerHeight();\r\n                var imageHeight = $image.outerHeight();\r\n\r\n                var isTextBigger = textHeight > imageHeight;\r\n                this.model.set(\"_textBigger\", isTextBigger);\r\n                this.$el.attr(\"textbigger\", isTextBigger ? \"true\" : \"false\");\r\n            }\r\n\r\n        }),\r\n\r\n        Model: LightboxTile.Model.extend({\r\n\r\n            defaults: Backbone.ascend(\"defaults\", function() {\r\n                return {\r\n                    \"#showText\": \"true,true,true,true\",\r\n                    \"#textPosition\": \"bottom,bottom,bottom,bottom\",\r\n                    \"#textOverlay\": \"false,false,false,false\",\r\n                    \"#textRounded\": \"false,false,false,false\",\r\n                    \"#textPortion\": \"40%,40%,40%,40%\",\r\n                    /*\"#textBackgroundColor\":\"rgb(127,127,127),rgb(127,127,127),rgb(127,127,127)\",\r\n                    \"#textRoundedCorderColor\":\"rgb(0,0,0),rgb(0,0,0),rgb(0,0,0)\",\r\n                    \"#spaceBetween\": \"0,0,0,0\",*/\r\n                    \"#mediaSize\": \"cover,cover,cover,cover\",\r\n                    \"#mediaRestrict\": \"100% auto,100% auto,100% auto,100% auto\",\r\n                    \"#mediaPosition\": \"center center,center center,center center,center center\",\r\n                    \"#mediaDynamicRatio\": \"false,false,false,false\"\r\n                };\r\n            })\r\n            \r\n        })\r\n\r\n    });\r\n\r\n    return MediaTile;\r\n\r\n});\r\n\n","define('extensions/adapt-editorial/js/tiles/e-image',[\r\n    'coreJS/adapt',\r\n    './media'\r\n], function(Adapt, Media) {\r\n\r\n    var ImageTile = { \r\n\r\n        View: Media.View.extend({\r\n\r\n            checkReadyStatus: function() {\r\n                if (this.$(\"img\").length > 0) this.$el.imageready(_.bind(this.setReadyStatus, this), { allowTimeout: false });\r\n                else this.setReadyStatus.call(this);\r\n            }\r\n\r\n        }),\r\n\r\n        Model: Media.Model.extend({})\r\n\r\n    };\r\n\r\n    Media.register('image', ImageTile);\r\n\r\n    return ImageTile;\r\n\r\n});\r\n\n","/*!\r\n* MediaElement.js\r\n* HTML5 <video> and <audio> shim and player\r\n* http://mediaelementjs.com/\r\n*\r\n* Creates a JavaScript object that mimics HTML5 MediaElement API\r\n* for browsers that don't understand HTML5 or can't play the provided codec\r\n* Can play MP4 (H.264), Ogg, WebM, FLV, WMV, WMA, ACC, and MP3\r\n*\r\n* Copyright 2010-2013, John Dyer (http://j.hn)\r\n* License: MIT\r\n*\r\n*/var mejs=mejs||{};mejs.version=\"2.13.2\";mejs.meIndex=0;\r\nmejs.plugins={silverlight:[{version:[3,0],types:[\"video/mp4\",\"video/m4v\",\"video/mov\",\"video/wmv\",\"audio/wma\",\"audio/m4a\",\"audio/mp3\",\"audio/wav\",\"audio/mpeg\"]}],flash:[{version:[9,0,124],types:[\"video/mp4\",\"video/m4v\",\"video/mov\",\"video/flv\",\"video/rtmp\",\"video/x-flv\",\"audio/flv\",\"audio/x-flv\",\"audio/mp3\",\"audio/m4a\",\"audio/mpeg\",\"video/youtube\",\"video/x-youtube\"]}],youtube:[{version:null,types:[\"video/youtube\",\"video/x-youtube\",\"audio/youtube\",\"audio/x-youtube\"]}],vimeo:[{version:null,types:[\"video/vimeo\",\r\n\"video/x-vimeo\"]}]};\r\nmejs.Utility={encodeUrl:function(a){return encodeURIComponent(a)},escapeHTML:function(a){return a.toString().split(\"&\").join(\"&amp;\").split(\"<\").join(\"&lt;\").split('\"').join(\"&quot;\")},absolutizeUrl:function(a){var b=document.createElement(\"div\");b.innerHTML='<a href=\"'+this.escapeHTML(a)+'\">x</a>';return b.firstChild.href},getScriptPath:function(a){for(var b=0,c,d=\"\",e=\"\",g,f,h=document.getElementsByTagName(\"script\"),l=h.length,j=a.length;b<l;b++){g=h[b].src;c=g.lastIndexOf(\"/\");if(c>-1){f=g.substring(c+\r\n1);g=g.substring(0,c+1)}else{f=g;g=\"\"}for(c=0;c<j;c++){e=a[c];e=f.indexOf(e);if(e>-1){d=g;break}}if(d!==\"\")break}return d},secondsToTimeCode:function(a,b,c,d){if(typeof c==\"undefined\")c=false;else if(typeof d==\"undefined\")d=25;var e=Math.floor(a/3600)%24,g=Math.floor(a/60)%60,f=Math.floor(a%60);a=Math.floor((a%1*d).toFixed(3));return(b||e>0?(e<10?\"0\"+e:e)+\":\":\"\")+(g<10?\"0\"+g:g)+\":\"+(f<10?\"0\"+f:f)+(c?\":\"+(a<10?\"0\"+a:a):\"\")},timeCodeToSeconds:function(a,b,c,d){if(typeof c==\"undefined\")c=false;else if(typeof d==\r\n\"undefined\")d=25;a=a.split(\":\");b=parseInt(a[0],10);var e=parseInt(a[1],10),g=parseInt(a[2],10),f=0,h=0;if(c)f=parseInt(a[3])/d;return h=b*3600+e*60+g+f},convertSMPTEtoSeconds:function(a){if(typeof a!=\"string\")return false;a=a.replace(\",\",\".\");var b=0,c=a.indexOf(\".\")!=-1?a.split(\".\")[1].length:0,d=1;a=a.split(\":\").reverse();for(var e=0;e<a.length;e++){d=1;if(e>0)d=Math.pow(60,e);b+=Number(a[e])*d}return Number(b.toFixed(c))},removeSwf:function(a){var b=document.getElementById(a);if(b&&/object|embed/i.test(b.nodeName))if(mejs.MediaFeatures.isIE){b.style.display=\r\n\"none\";(function(){b.readyState==4?mejs.Utility.removeObjectInIE(a):setTimeout(arguments.callee,10)})()}else b.parentNode.removeChild(b)},removeObjectInIE:function(a){if(a=document.getElementById(a)){for(var b in a)if(typeof a[b]==\"function\")a[b]=null;a.parentNode.removeChild(a)}}};\r\nmejs.PluginDetector={hasPluginVersion:function(a,b){var c=this.plugins[a];b[1]=b[1]||0;b[2]=b[2]||0;return c[0]>b[0]||c[0]==b[0]&&c[1]>b[1]||c[0]==b[0]&&c[1]==b[1]&&c[2]>=b[2]?true:false},nav:window.navigator,ua:window.navigator.userAgent.toLowerCase(),plugins:[],addPlugin:function(a,b,c,d,e){this.plugins[a]=this.detectPlugin(b,c,d,e)},detectPlugin:function(a,b,c,d){var e=[0,0,0],g;if(typeof this.nav.plugins!=\"undefined\"&&typeof this.nav.plugins[a]==\"object\"){if((c=this.nav.plugins[a].description)&&\r\n!(typeof this.nav.mimeTypes!=\"undefined\"&&this.nav.mimeTypes[b]&&!this.nav.mimeTypes[b].enabledPlugin)){e=c.replace(a,\"\").replace(/^\\s+/,\"\").replace(/\\sr/gi,\".\").split(\".\");for(a=0;a<e.length;a++)e[a]=parseInt(e[a].match(/\\d+/),10)}}else if(typeof window.ActiveXObject!=\"undefined\")try{if(g=new ActiveXObject(c))e=d(g)}catch(f){}return e}};\r\nmejs.PluginDetector.addPlugin(\"flash\",\"Shockwave Flash\",\"application/x-shockwave-flash\",\"ShockwaveFlash.ShockwaveFlash\",function(a){var b=[];if(a=a.GetVariable(\"$version\")){a=a.split(\" \")[1].split(\",\");b=[parseInt(a[0],10),parseInt(a[1],10),parseInt(a[2],10)]}return b});\r\nmejs.PluginDetector.addPlugin(\"silverlight\",\"Silverlight Plug-In\",\"application/x-silverlight-2\",\"AgControl.AgControl\",function(a){var b=[0,0,0,0],c=function(d,e,g,f){for(;d.isVersionSupported(e[0]+\".\"+e[1]+\".\"+e[2]+\".\"+e[3]);)e[g]+=f;e[g]-=f};c(a,b,0,1);c(a,b,1,1);c(a,b,2,1E4);c(a,b,2,1E3);c(a,b,2,100);c(a,b,2,10);c(a,b,2,1);c(a,b,3,1);return b});\r\nmejs.MediaFeatures={init:function(){var a=this,b=document,c=mejs.PluginDetector.nav,d=mejs.PluginDetector.ua.toLowerCase(),e,g=[\"source\",\"track\",\"audio\",\"video\"];a.isiPad=d.match(/ipad/i)!==null;a.isiPhone=d.match(/iphone/i)!==null;a.isiOS=a.isiPhone||a.isiPad;a.isAndroid=d.match(/android/i)!==null;a.isBustedAndroid=d.match(/android 2\\.[12]/)!==null;a.isBustedNativeHTTPS=location.protocol===\"https:\"&&(d.match(/android [12]\\./)!==null||d.match(/macintosh.* version.* safari/)!==null);a.isIE=c.appName.toLowerCase().indexOf(\"microsoft\")!=\r\n-1||c.appName.toLowerCase().match(/trident/gi)!==null;a.isChrome=d.match(/chrome/gi)!==null;a.isFirefox=d.match(/firefox/gi)!==null;a.isWebkit=d.match(/webkit/gi)!==null;a.isGecko=d.match(/gecko/gi)!==null&&!a.isWebkit&&!a.isIE;a.isOpera=d.match(/opera/gi)!==null;a.hasTouch=\"ontouchstart\"in window;a.svg=!!document.createElementNS&&!!document.createElementNS(\"http://www.w3.org/2000/svg\",\"svg\").createSVGRect;for(c=0;c<g.length;c++)e=document.createElement(g[c]);a.supportsMediaTag=typeof e.canPlayType!==\r\n\"undefined\"||a.isBustedAndroid;try{e.canPlayType(\"video/mp4\")}catch(f){a.supportsMediaTag=false}a.hasSemiNativeFullScreen=typeof e.webkitEnterFullscreen!==\"undefined\";a.hasNativeFullscreen=typeof e.requestFullscreen!==\"undefined\";a.hasWebkitNativeFullScreen=typeof e.webkitRequestFullScreen!==\"undefined\";a.hasMozNativeFullScreen=typeof e.mozRequestFullScreen!==\"undefined\";a.hasMsNativeFullScreen=typeof e.msRequestFullscreen!==\"undefined\";a.hasTrueNativeFullScreen=a.hasWebkitNativeFullScreen||a.hasMozNativeFullScreen||\r\na.hasMsNativeFullScreen;a.nativeFullScreenEnabled=a.hasTrueNativeFullScreen;if(a.hasMozNativeFullScreen)a.nativeFullScreenEnabled=document.mozFullScreenEnabled;else if(a.hasMsNativeFullScreen)a.nativeFullScreenEnabled=document.msFullscreenEnabled;if(a.isChrome)a.hasSemiNativeFullScreen=false;if(a.hasTrueNativeFullScreen){a.fullScreenEventName=\"\";if(a.hasWebkitNativeFullScreen)a.fullScreenEventName=\"webkitfullscreenchange\";else if(a.hasMozNativeFullScreen)a.fullScreenEventName=\"mozfullscreenchange\";\r\nelse if(a.hasMsNativeFullScreen)a.fullScreenEventName=\"MSFullscreenChange\";a.isFullScreen=function(){if(e.mozRequestFullScreen)return b.mozFullScreen;else if(e.webkitRequestFullScreen)return b.webkitIsFullScreen;else if(e.hasMsNativeFullScreen)return b.msFullscreenElement!==null};a.requestFullScreen=function(h){if(a.hasWebkitNativeFullScreen)h.webkitRequestFullScreen();else if(a.hasMozNativeFullScreen)h.mozRequestFullScreen();else a.hasMsNativeFullScreen&&h.msRequestFullscreen()};a.cancelFullScreen=\r\nfunction(){if(a.hasWebkitNativeFullScreen)document.webkitCancelFullScreen();else if(a.hasMozNativeFullScreen)document.mozCancelFullScreen();else a.hasMsNativeFullScreen&&document.msExitFullscreen()}}if(a.hasSemiNativeFullScreen&&d.match(/mac os x 10_5/i)){a.hasNativeFullScreen=false;a.hasSemiNativeFullScreen=false}}};mejs.MediaFeatures.init();\r\nmejs.HtmlMediaElement={pluginType:\"native\",isFullScreen:false,setCurrentTime:function(a){this.currentTime=a},setMuted:function(a){this.muted=a},setVolume:function(a){this.volume=a},stop:function(){this.pause()},setSrc:function(a){for(var b=this.getElementsByTagName(\"source\");b.length>0;)this.removeChild(b[0]);if(typeof a==\"string\")this.src=a;else{var c;for(b=0;b<a.length;b++){c=a[b];if(this.canPlayType(c.type)){this.src=c.src;break}}}},setVideoSize:function(a,b){this.width=a;this.height=b}};\r\nmejs.PluginMediaElement=function(a,b,c){this.id=a;this.pluginType=b;this.src=c;this.events={};this.attributes={}};\r\nmejs.PluginMediaElement.prototype={pluginElement:null,pluginType:\"\",isFullScreen:false,playbackRate:-1,defaultPlaybackRate:-1,seekable:[],played:[],paused:true,ended:false,seeking:false,duration:0,error:null,tagName:\"\",muted:false,volume:1,currentTime:0,play:function(){if(this.pluginApi!=null){this.pluginType==\"youtube\"?this.pluginApi.playVideo():this.pluginApi.playMedia();this.paused=false}},load:function(){if(this.pluginApi!=null){this.pluginType!=\"youtube\"&&this.pluginApi.loadMedia();this.paused=\r\nfalse}},pause:function(){if(this.pluginApi!=null){this.pluginType==\"youtube\"?this.pluginApi.pauseVideo():this.pluginApi.pauseMedia();this.paused=true}},stop:function(){if(this.pluginApi!=null){this.pluginType==\"youtube\"?this.pluginApi.stopVideo():this.pluginApi.stopMedia();this.paused=true}},canPlayType:function(a){var b,c,d,e=mejs.plugins[this.pluginType];for(b=0;b<e.length;b++){d=e[b];if(mejs.PluginDetector.hasPluginVersion(this.pluginType,d.version))for(c=0;c<d.types.length;c++)if(a==d.types[c])return\"probably\"}return\"\"},\r\npositionFullscreenButton:function(a,b,c){this.pluginApi!=null&&this.pluginApi.positionFullscreenButton&&this.pluginApi.positionFullscreenButton(Math.floor(a),Math.floor(b),c)},hideFullscreenButton:function(){this.pluginApi!=null&&this.pluginApi.hideFullscreenButton&&this.pluginApi.hideFullscreenButton()},setSrc:function(a){if(typeof a==\"string\"){this.pluginApi.setSrc(mejs.Utility.absolutizeUrl(a));this.src=mejs.Utility.absolutizeUrl(a)}else{var b,c;for(b=0;b<a.length;b++){c=a[b];if(this.canPlayType(c.type)){this.pluginApi.setSrc(mejs.Utility.absolutizeUrl(c.src));\r\nthis.src=mejs.Utility.absolutizeUrl(a);break}}}},setCurrentTime:function(a){if(this.pluginApi!=null){this.pluginType==\"youtube\"?this.pluginApi.seekTo(a):this.pluginApi.setCurrentTime(a);this.currentTime=a}},setVolume:function(a){if(this.pluginApi!=null){this.pluginType==\"youtube\"?this.pluginApi.setVolume(a*100):this.pluginApi.setVolume(a);this.volume=a}},setMuted:function(a){if(this.pluginApi!=null){if(this.pluginType==\"youtube\"){a?this.pluginApi.mute():this.pluginApi.unMute();this.muted=a;this.dispatchEvent(\"volumechange\")}else this.pluginApi.setMuted(a);\r\nthis.muted=a}},setVideoSize:function(a,b){if(this.pluginElement.style){this.pluginElement.style.width=a+\"px\";this.pluginElement.style.height=b+\"px\"}this.pluginApi!=null&&this.pluginApi.setVideoSize&&this.pluginApi.setVideoSize(a,b)},setFullscreen:function(a){this.pluginApi!=null&&this.pluginApi.setFullscreen&&this.pluginApi.setFullscreen(a)},enterFullScreen:function(){this.pluginApi!=null&&this.pluginApi.setFullscreen&&this.setFullscreen(true)},exitFullScreen:function(){this.pluginApi!=null&&this.pluginApi.setFullscreen&&\r\nthis.setFullscreen(false)},addEventListener:function(a,b){this.events[a]=this.events[a]||[];this.events[a].push(b)},removeEventListener:function(a,b){if(!a){this.events={};return true}var c=this.events[a];if(!c)return true;if(!b){this.events[a]=[];return true}for(i=0;i<c.length;i++)if(c[i]===b){this.events[a].splice(i,1);return true}return false},dispatchEvent:function(a){var b,c,d=this.events[a];if(d){c=Array.prototype.slice.call(arguments,1);for(b=0;b<d.length;b++)d[b].apply(null,c)}},hasAttribute:function(a){return a in\r\nthis.attributes},removeAttribute:function(a){delete this.attributes[a]},getAttribute:function(a){if(this.hasAttribute(a))return this.attributes[a];return\"\"},setAttribute:function(a,b){this.attributes[a]=b},remove:function(){mejs.Utility.removeSwf(this.pluginElement.id);mejs.MediaPluginBridge.unregisterPluginElement(this.pluginElement.id)}};\r\nmejs.MediaPluginBridge={pluginMediaElements:{},htmlMediaElements:{},registerPluginElement:function(a,b,c){this.pluginMediaElements[a]=b;this.htmlMediaElements[a]=c},unregisterPluginElement:function(a){delete this.pluginMediaElements[a];delete this.htmlMediaElements[a]},initPlugin:function(a){var b=this.pluginMediaElements[a],c=this.htmlMediaElements[a];if(b){switch(b.pluginType){case \"flash\":b.pluginElement=b.pluginApi=document.getElementById(a);break;case \"silverlight\":b.pluginElement=document.getElementById(b.id);\r\nb.pluginApi=b.pluginElement.Content.MediaElementJS}b.pluginApi!=null&&b.success&&b.success(b,c)}},fireEvent:function(a,b,c){var d,e;if(a=this.pluginMediaElements[a]){b={type:b,target:a};for(d in c){a[d]=c[d];b[d]=c[d]}e=c.bufferedTime||0;b.target.buffered=b.buffered={start:function(){return 0},end:function(){return e},length:1};a.dispatchEvent(b.type,b)}}};\r\nmejs.MediaElementDefaults={mode:\"auto\",plugins:[\"flash\",\"silverlight\",\"youtube\",\"vimeo\"],enablePluginDebug:false,httpsBasicAuthSite:false,type:\"\",pluginPath:mejs.Utility.getScriptPath([\"mediaelement.js\",\"mediaelement.min.js\",\"mediaelement-and-player.js\",\"mediaelement-and-player.min.js\"]),flashName:\"flashmediaelement.swf\",flashStreamer:\"\",enablePluginSmoothing:false,enablePseudoStreaming:false,pseudoStreamingStartQueryParam:\"start\",silverlightName:\"silverlightmediaelement.xap\",defaultVideoWidth:480,\r\ndefaultVideoHeight:270,pluginWidth:-1,pluginHeight:-1,pluginVars:[],timerRate:250,startVolume:0.8,success:function(){},error:function(){}};mejs.MediaElement=function(a,b){return mejs.HtmlMediaElementShim.create(a,b)};\r\nmejs.HtmlMediaElementShim={create:function(a,b){var c=mejs.MediaElementDefaults,d=typeof a==\"string\"?document.getElementById(a):a,e=d.tagName.toLowerCase(),g=e===\"audio\"||e===\"video\",f=g?d.getAttribute(\"src\"):d.getAttribute(\"href\");e=d.getAttribute(\"poster\");var h=d.getAttribute(\"autoplay\"),l=d.getAttribute(\"preload\"),j=d.getAttribute(\"controls\"),k;for(k in b)c[k]=b[k];f=typeof f==\"undefined\"||f===null||f==\"\"?null:f;e=typeof e==\"undefined\"||e===null?\"\":e;l=typeof l==\"undefined\"||l===null||l===\"false\"?\r\n\"none\":l;h=!(typeof h==\"undefined\"||h===null||h===\"false\");j=!(typeof j==\"undefined\"||j===null||j===\"false\");k=this.determinePlayback(d,c,mejs.MediaFeatures.supportsMediaTag,g,f);k.url=k.url!==null?mejs.Utility.absolutizeUrl(k.url):\"\";if(k.method==\"native\"){if(mejs.MediaFeatures.isBustedAndroid){d.src=k.url;d.addEventListener(\"click\",function(){d.play()},false)}return this.updateNative(k,c,h,l)}else if(k.method!==\"\")return this.createPlugin(k,c,e,h,l,j);else{this.createErrorMessage(k,c,e);return this}},\r\ndeterminePlayback:function(a,b,c,d,e){var g=[],f,h,l,j={method:\"\",url:\"\",htmlMediaElement:a,isVideo:a.tagName.toLowerCase()!=\"audio\"},k;if(typeof b.type!=\"undefined\"&&b.type!==\"\")if(typeof b.type==\"string\")g.push({type:b.type,url:e});else for(f=0;f<b.type.length;f++)g.push({type:b.type[f],url:e});else if(e!==null){l=this.formatType(e,a.getAttribute(\"type\"));g.push({type:l,url:e})}else for(f=0;f<a.childNodes.length;f++){h=a.childNodes[f];if(h.nodeType==1&&h.tagName.toLowerCase()==\"source\"){e=h.getAttribute(\"src\");\r\nl=this.formatType(e,h.getAttribute(\"type\"));h=h.getAttribute(\"media\");if(!h||!window.matchMedia||window.matchMedia&&window.matchMedia(h).matches)g.push({type:l,url:e})}}if(!d&&g.length>0&&g[0].url!==null&&this.getTypeFromFile(g[0].url).indexOf(\"audio\")>-1)j.isVideo=false;if(mejs.MediaFeatures.isBustedAndroid)a.canPlayType=function(m){return m.match(/video\\/(mp4|m4v)/gi)!==null?\"maybe\":\"\"};if(c&&(b.mode===\"auto\"||b.mode===\"auto_plugin\"||b.mode===\"native\")&&!(mejs.MediaFeatures.isBustedNativeHTTPS&&\r\nb.httpsBasicAuthSite===true)){if(!d){f=document.createElement(j.isVideo?\"video\":\"audio\");a.parentNode.insertBefore(f,a);a.style.display=\"none\";j.htmlMediaElement=a=f}for(f=0;f<g.length;f++)if(a.canPlayType(g[f].type).replace(/no/,\"\")!==\"\"||a.canPlayType(g[f].type.replace(/mp3/,\"mpeg\")).replace(/no/,\"\")!==\"\"){j.method=\"native\";j.url=g[f].url;break}if(j.method===\"native\"){if(j.url!==null)a.src=j.url;if(b.mode!==\"auto_plugin\")return j}}if(b.mode===\"auto\"||b.mode===\"auto_plugin\"||b.mode===\"shim\")for(f=\r\n0;f<g.length;f++){l=g[f].type;for(a=0;a<b.plugins.length;a++){e=b.plugins[a];h=mejs.plugins[e];for(c=0;c<h.length;c++){k=h[c];if(k.version==null||mejs.PluginDetector.hasPluginVersion(e,k.version))for(d=0;d<k.types.length;d++)if(l==k.types[d]){j.method=e;j.url=g[f].url;return j}}}}if(b.mode===\"auto_plugin\"&&j.method===\"native\")return j;if(j.method===\"\"&&g.length>0)j.url=g[0].url;return j},formatType:function(a,b){return a&&!b?this.getTypeFromFile(a):b&&~b.indexOf(\";\")?b.substr(0,b.indexOf(\";\")):b},\r\ngetTypeFromFile:function(a){a=a.split(\"?\")[0];a=a.substring(a.lastIndexOf(\".\")+1).toLowerCase();return(/(mp4|m4v|ogg|ogv|webm|webmv|flv|wmv|mpeg|mov)/gi.test(a)?\"video\":\"audio\")+\"/\"+this.getTypeFromExtension(a)},getTypeFromExtension:function(a){switch(a){case \"mp4\":case \"m4v\":return\"mp4\";case \"webm\":case \"webma\":case \"webmv\":return\"webm\";case \"ogg\":case \"oga\":case \"ogv\":return\"ogg\";default:return a}},createErrorMessage:function(a,b,c){var d=a.htmlMediaElement,e=document.createElement(\"div\");e.className=\r\n\"me-cannotplay\";try{e.style.width=d.width+\"px\";e.style.height=d.height+\"px\"}catch(g){}e.innerHTML=b.customError?b.customError:c!==\"\"?'<a href=\"'+a.url+'\"><img src=\"'+c+'\" width=\"100%\" height=\"100%\" /></a>':'<a href=\"'+a.url+'\"><span>'+mejs.i18n.t(\"Download File\")+\"</span></a>\";d.parentNode.insertBefore(e,d);d.style.display=\"none\";b.error(d)},createPlugin:function(a,b,c,d,e,g){c=a.htmlMediaElement;var f=1,h=1,l=\"me_\"+a.method+\"_\"+mejs.meIndex++,j=new mejs.PluginMediaElement(l,a.method,a.url),k=document.createElement(\"div\"),\r\nm;j.tagName=c.tagName;for(m=0;m<c.attributes.length;m++){var n=c.attributes[m];n.specified==true&&j.setAttribute(n.name,n.value)}for(m=c.parentNode;m!==null&&m.tagName.toLowerCase()!=\"body\";){if(m.parentNode.tagName.toLowerCase()==\"p\"){m.parentNode.parentNode.insertBefore(m,m.parentNode);break}m=m.parentNode}if(a.isVideo){f=b.pluginWidth>0?b.pluginWidth:b.videoWidth>0?b.videoWidth:c.getAttribute(\"width\")!==null?c.getAttribute(\"width\"):b.defaultVideoWidth;h=b.pluginHeight>0?b.pluginHeight:b.videoHeight>\r\n0?b.videoHeight:c.getAttribute(\"height\")!==null?c.getAttribute(\"height\"):b.defaultVideoHeight;f=mejs.Utility.encodeUrl(f);h=mejs.Utility.encodeUrl(h)}else if(b.enablePluginDebug){f=320;h=240}j.success=b.success;mejs.MediaPluginBridge.registerPluginElement(l,j,c);k.className=\"me-plugin\";k.id=l+\"_container\";a.isVideo?c.parentNode.insertBefore(k,c):document.body.insertBefore(k,document.body.childNodes[0]);d=[\"id=\"+l,\"isvideo=\"+(a.isVideo?\"true\":\"false\"),\"autoplay=\"+(d?\"true\":\"false\"),\"preload=\"+e,\"width=\"+\r\nf,\"startvolume=\"+b.startVolume,\"timerrate=\"+b.timerRate,\"flashstreamer=\"+b.flashStreamer,\"height=\"+h,\"pseudostreamstart=\"+b.pseudoStreamingStartQueryParam];if(a.url!==null)a.method==\"flash\"?d.push(\"file=\"+mejs.Utility.encodeUrl(a.url)):d.push(\"file=\"+a.url);b.enablePluginDebug&&d.push(\"debug=true\");b.enablePluginSmoothing&&d.push(\"smoothing=true\");b.enablePseudoStreaming&&d.push(\"pseudostreaming=true\");g&&d.push(\"controls=true\");if(b.pluginVars)d=d.concat(b.pluginVars);switch(a.method){case \"silverlight\":k.innerHTML=\r\n'<object data=\"data:application/x-silverlight-2,\" type=\"application/x-silverlight-2\" id=\"'+l+'\" name=\"'+l+'\" width=\"'+f+'\" height=\"'+h+'\" class=\"mejs-shim\"><param name=\"initParams\" value=\"'+d.join(\",\")+'\" /><param name=\"windowless\" value=\"true\" /><param name=\"background\" value=\"black\" /><param name=\"minRuntimeVersion\" value=\"3.0.0.0\" /><param name=\"autoUpgrade\" value=\"true\" /><param name=\"source\" value=\"'+b.pluginPath+b.silverlightName+'\" /></object>';break;case \"flash\":if(mejs.MediaFeatures.isIE){a=\r\ndocument.createElement(\"div\");k.appendChild(a);a.outerHTML='<object classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" codebase=\"//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab\" id=\"'+l+'\" width=\"'+f+'\" height=\"'+h+'\" class=\"mejs-shim\"><param name=\"movie\" value=\"'+b.pluginPath+b.flashName+\"?x=\"+new Date+'\" /><param name=\"flashvars\" value=\"'+d.join(\"&amp;\")+'\" /><param name=\"quality\" value=\"high\" /><param name=\"bgcolor\" value=\"#000000\" /><param name=\"wmode\" value=\"transparent\" /><param name=\"allowScriptAccess\" value=\"always\" /><param name=\"allowFullScreen\" value=\"true\" /><param name=\"scale\" value=\"default\" /></object>'}else k.innerHTML=\r\n'<embed id=\"'+l+'\" name=\"'+l+'\" play=\"true\" loop=\"false\" quality=\"high\" bgcolor=\"#000000\" wmode=\"transparent\" allowScriptAccess=\"always\" allowFullScreen=\"true\" type=\"application/x-shockwave-flash\" pluginspage=\"//www.macromedia.com/go/getflashplayer\" src=\"'+b.pluginPath+b.flashName+'\" flashvars=\"'+d.join(\"&\")+'\" width=\"'+f+'\" height=\"'+h+'\" scale=\"default\"class=\"mejs-shim\"></embed>';break;case \"youtube\":b=a.url.substr(a.url.lastIndexOf(\"=\")+1);youtubeSettings={container:k,containerId:k.id,pluginMediaElement:j,\r\npluginId:l,videoId:b,height:h,width:f};mejs.PluginDetector.hasPluginVersion(\"flash\",[10,0,0])?mejs.YouTubeApi.createFlash(youtubeSettings):mejs.YouTubeApi.enqueueIframe(youtubeSettings);break;case \"vimeo\":j.vimeoid=a.url.substr(a.url.lastIndexOf(\"/\")+1);k.innerHTML='<iframe src=\"http://player.vimeo.com/video/'+j.vimeoid+'?portrait=0&byline=0&title=0\" width=\"'+f+'\" height=\"'+h+'\" frameborder=\"0\" class=\"mejs-shim\"></iframe>'}c.style.display=\"none\";c.removeAttribute(\"autoplay\");return j},updateNative:function(a,\r\nb){var c=a.htmlMediaElement,d;for(d in mejs.HtmlMediaElement)c[d]=mejs.HtmlMediaElement[d];b.success(c,c);return c}};\r\nmejs.YouTubeApi={isIframeStarted:false,isIframeLoaded:false,loadIframeApi:function(){if(!this.isIframeStarted){var a=document.createElement(\"script\");a.src=\"//www.youtube.com/player_api\";var b=document.getElementsByTagName(\"script\")[0];b.parentNode.insertBefore(a,b);this.isIframeStarted=true}},iframeQueue:[],enqueueIframe:function(a){if(this.isLoaded)this.createIframe(a);else{this.loadIframeApi();this.iframeQueue.push(a)}},createIframe:function(a){var b=a.pluginMediaElement,c=new YT.Player(a.containerId,\r\n{height:a.height,width:a.width,videoId:a.videoId,playerVars:{controls:0},events:{onReady:function(){a.pluginMediaElement.pluginApi=c;mejs.MediaPluginBridge.initPlugin(a.pluginId);setInterval(function(){mejs.YouTubeApi.createEvent(c,b,\"timeupdate\")},250)},onStateChange:function(d){mejs.YouTubeApi.handleStateChange(d.data,c,b)}}})},createEvent:function(a,b,c){c={type:c,target:b};if(a&&a.getDuration){b.currentTime=c.currentTime=a.getCurrentTime();b.duration=c.duration=a.getDuration();c.paused=b.paused;\r\nc.ended=b.ended;c.muted=a.isMuted();c.volume=a.getVolume()/100;c.bytesTotal=a.getVideoBytesTotal();c.bufferedBytes=a.getVideoBytesLoaded();var d=c.bufferedBytes/c.bytesTotal*c.duration;c.target.buffered=c.buffered={start:function(){return 0},end:function(){return d},length:1}}b.dispatchEvent(c.type,c)},iFrameReady:function(){for(this.isIframeLoaded=this.isLoaded=true;this.iframeQueue.length>0;)this.createIframe(this.iframeQueue.pop())},flashPlayers:{},createFlash:function(a){this.flashPlayers[a.pluginId]=\r\na;var b,c=\"//www.youtube.com/apiplayer?enablejsapi=1&amp;playerapiid=\"+a.pluginId+\"&amp;version=3&amp;autoplay=0&amp;controls=0&amp;modestbranding=1&loop=0\";if(mejs.MediaFeatures.isIE){b=document.createElement(\"div\");a.container.appendChild(b);b.outerHTML='<object classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" codebase=\"//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab\" id=\"'+a.pluginId+'\" width=\"'+a.width+'\" height=\"'+a.height+'\" class=\"mejs-shim\"><param name=\"movie\" value=\"'+\r\nc+'\" /><param name=\"wmode\" value=\"transparent\" /><param name=\"allowScriptAccess\" value=\"always\" /><param name=\"allowFullScreen\" value=\"true\" /></object>'}else a.container.innerHTML='<object type=\"application/x-shockwave-flash\" id=\"'+a.pluginId+'\" data=\"'+c+'\" width=\"'+a.width+'\" height=\"'+a.height+'\" style=\"visibility: visible; \" class=\"mejs-shim\"><param name=\"allowScriptAccess\" value=\"always\"><param name=\"wmode\" value=\"transparent\"></object>'},flashReady:function(a){var b=this.flashPlayers[a],c=\r\ndocument.getElementById(a),d=b.pluginMediaElement;d.pluginApi=d.pluginElement=c;mejs.MediaPluginBridge.initPlugin(a);c.cueVideoById(b.videoId);a=b.containerId+\"_callback\";window[a]=function(e){mejs.YouTubeApi.handleStateChange(e,c,d)};c.addEventListener(\"onStateChange\",a);setInterval(function(){mejs.YouTubeApi.createEvent(c,d,\"timeupdate\")},250)},handleStateChange:function(a,b,c){switch(a){case -1:c.paused=true;c.ended=true;mejs.YouTubeApi.createEvent(b,c,\"loadedmetadata\");break;case 0:c.paused=false;\r\nc.ended=true;mejs.YouTubeApi.createEvent(b,c,\"ended\");break;case 1:c.paused=false;c.ended=false;mejs.YouTubeApi.createEvent(b,c,\"play\");mejs.YouTubeApi.createEvent(b,c,\"playing\");break;case 2:c.paused=true;c.ended=false;mejs.YouTubeApi.createEvent(b,c,\"pause\");break;case 3:mejs.YouTubeApi.createEvent(b,c,\"progress\")}}};function onYouTubePlayerAPIReady(){mejs.YouTubeApi.iFrameReady()}function onYouTubePlayerReady(a){mejs.YouTubeApi.flashReady(a)}window.mejs=mejs;window.MediaElement=mejs.MediaElement;\r\n(function(a,b){var c={locale:{language:\"\",strings:{}},methods:{}};c.getLanguage=function(){return(c.locale.language||window.navigator.userLanguage||window.navigator.language).substr(0,2).toLowerCase()};if(typeof mejsL10n!=\"undefined\")c.locale.language=mejsL10n.language;c.methods.checkPlain=function(d){var e,g,f={\"&\":\"&amp;\",'\"':\"&quot;\",\"<\":\"&lt;\",\">\":\"&gt;\"};d=String(d);for(e in f)if(f.hasOwnProperty(e)){g=RegExp(e,\"g\");d=d.replace(g,f[e])}return d};c.methods.t=function(d,e){if(c.locale.strings&&\r\nc.locale.strings[e.context]&&c.locale.strings[e.context][d])d=c.locale.strings[e.context][d];return c.methods.checkPlain(d)};c.t=function(d,e){if(typeof d===\"string\"&&d.length>0){var g=c.getLanguage();e=e||{context:g};return c.methods.t(d,e)}else throw{name:\"InvalidArgumentException\",message:\"First argument is either not a string or empty.\"};};b.i18n=c})(document,mejs);(function(a){if(typeof mejsL10n!=\"undefined\")a[mejsL10n.language]=mejsL10n.strings})(mejs.i18n.locale.strings);\r\n(function(a){if(typeof a.de===\"undefined\")a.de={Fullscreen:\"Vollbild\",\"Go Fullscreen\":\"Vollbild an\",\"Turn off Fullscreen\":\"Vollbild aus\",Close:\"Schlie\\u00dfen\"}})(mejs.i18n.locale.strings);(function(a){if(typeof a.zh===\"undefined\")a.zh={Fullscreen:\"\\u5168\\u87a2\\u5e55\",\"Go Fullscreen\":\"\\u5168\\u5c4f\\u6a21\\u5f0f\",\"Turn off Fullscreen\":\"\\u9000\\u51fa\\u5168\\u5c4f\\u6a21\\u5f0f\",Close:\"\\u95dc\\u9589\"}})(mejs.i18n.locale.strings);\r\n\r\n/*!\r\n * MediaElementPlayer\r\n * http://mediaelementjs.com/\r\n *\r\n * Creates a controller bar for HTML5 <video> add <audio> tags\r\n * using jQuery and MediaElement.js (HTML5 Flash/Silverlight wrapper)\r\n *\r\n * Copyright 2010-2013, John Dyer (http://j.hn/)\r\n * License: MIT\r\n *\r\n */if(typeof jQuery!=\"undefined\")mejs.$=jQuery;else if(typeof ender!=\"undefined\")mejs.$=ender;\r\n(function(f){mejs.MepDefaults={poster:\"\",showPosterWhenEnded:false,defaultVideoWidth:480,defaultVideoHeight:270,videoWidth:-1,videoHeight:-1,defaultAudioWidth:400,defaultAudioHeight:30,defaultSeekBackwardInterval:function(a){return a.duration*0.05},defaultSeekForwardInterval:function(a){return a.duration*0.05},audioWidth:-1,audioHeight:-1,startVolume:0.8,loop:false,autoRewind:true,enableAutosize:true,alwaysShowHours:false,showTimecodeFrameCount:false,framesPerSecond:25,autosizeProgress:true,alwaysShowControls:false,\r\nhideVideoControlsOnLoad:false,clickToPlayPause:true,iPadUseNativeControls:false,iPhoneUseNativeControls:false,AndroidUseNativeControls:false,features:[\"playpause\",\"current\",\"progress\",\"duration\",\"tracks\",\"volume\",\"fullscreen\"],isVideo:true,enableKeyboard:true,pauseOtherPlayers:true,keyActions:[{keys:[32,179],action:function(a,b){b.paused||b.ended?a.play():a.pause()}},{keys:[38],action:function(a,b){b.setVolume(Math.min(b.volume+0.1,1))}},{keys:[40],action:function(a,b){b.setVolume(Math.max(b.volume-\r\n0.1,0))}},{keys:[37,227],action:function(a,b){if(!isNaN(b.duration)&&b.duration>0){if(a.isVideo){a.showControls();a.startControlsTimer()}var c=Math.max(b.currentTime-a.options.defaultSeekBackwardInterval(b),0);b.setCurrentTime(c)}}},{keys:[39,228],action:function(a,b){if(!isNaN(b.duration)&&b.duration>0){if(a.isVideo){a.showControls();a.startControlsTimer()}var c=Math.min(b.currentTime+a.options.defaultSeekForwardInterval(b),b.duration);b.setCurrentTime(c)}}},{keys:[70],action:function(a){if(typeof a.enterFullScreen!=\r\n\"undefined\")a.isFullScreen?a.exitFullScreen():a.enterFullScreen()}}]};mejs.mepIndex=0;mejs.players={};mejs.MediaElementPlayer=function(a,b){if(!(this instanceof mejs.MediaElementPlayer))return new mejs.MediaElementPlayer(a,b);this.$media=this.$node=f(a);this.node=this.media=this.$media[0];if(typeof this.node.player!=\"undefined\")return this.node.player;else this.node.player=this;if(typeof b==\"undefined\")b=this.$node.data(\"mejsoptions\");this.options=f.extend({},mejs.MepDefaults,b);this.id=\"mep_\"+mejs.mepIndex++;\r\nmejs.players[this.id]=this;this.init();return this};mejs.MediaElementPlayer.prototype={hasFocus:false,controlsAreVisible:true,init:function(){var a=this,b=mejs.MediaFeatures,c=f.extend(true,{},a.options,{success:function(d,g){a.meReady(d,g)},error:function(d){a.handleError(d)}}),e=a.media.tagName.toLowerCase();a.isDynamic=e!==\"audio\"&&e!==\"video\";a.isVideo=a.isDynamic?a.options.isVideo:e!==\"audio\"&&a.options.isVideo;if(b.isiPad&&a.options.iPadUseNativeControls||b.isiPhone&&a.options.iPhoneUseNativeControls){a.$media.attr(\"controls\",\r\n\"controls\");b.isiPad&&a.media.getAttribute(\"autoplay\")!==null&&a.play()}else if(!(b.isAndroid&&a.options.AndroidUseNativeControls)){a.$media.removeAttr(\"controls\");a.container=f('<div id=\"'+a.id+'\" class=\"mejs-container '+(mejs.MediaFeatures.svg?\"svg\":\"no-svg\")+'\"><div class=\"mejs-inner\"><div class=\"mejs-mediaelement\"></div><div class=\"mejs-layers\"></div><div class=\"mejs-controls\"></div><div class=\"mejs-clear\"></div></div></div>').addClass(a.$media[0].className).insertBefore(a.$media);a.container.addClass((b.isAndroid?\r\n\"mejs-android \":\"\")+(b.isiOS?\"mejs-ios \":\"\")+(b.isiPad?\"mejs-ipad \":\"\")+(b.isiPhone?\"mejs-iphone \":\"\")+(a.isVideo?\"mejs-video \":\"mejs-audio \"));if(b.isiOS){b=a.$media.clone();a.container.find(\".mejs-mediaelement\").append(b);a.$media.remove();a.$node=a.$media=b;a.node=a.media=b[0]}else a.container.find(\".mejs-mediaelement\").append(a.$media);a.controls=a.container.find(\".mejs-controls\");a.layers=a.container.find(\".mejs-layers\");b=a.isVideo?\"video\":\"audio\";e=b.substring(0,1).toUpperCase()+b.substring(1);\r\na.width=a.options[b+\"Width\"]>0||a.options[b+\"Width\"].toString().indexOf(\"%\")>-1?a.options[b+\"Width\"]:a.media.style.width!==\"\"&&a.media.style.width!==null?a.media.style.width:a.media.getAttribute(\"width\")!==null?a.$media.attr(\"width\"):a.options[\"default\"+e+\"Width\"];a.height=a.options[b+\"Height\"]>0||a.options[b+\"Height\"].toString().indexOf(\"%\")>-1?a.options[b+\"Height\"]:a.media.style.height!==\"\"&&a.media.style.height!==null?a.media.style.height:a.$media[0].getAttribute(\"height\")!==null?a.$media.attr(\"height\"):\r\na.options[\"default\"+e+\"Height\"];a.setPlayerSize(a.width,a.height);c.pluginWidth=a.width;c.pluginHeight=a.height}mejs.MediaElement(a.$media[0],c);typeof a.container!=\"undefined\"&&a.controlsAreVisible&&a.container.trigger(\"controlsshown\")},showControls:function(a){var b=this;a=typeof a==\"undefined\"||a;if(!b.controlsAreVisible){if(a){b.controls.css(\"visibility\",\"visible\").stop(true,true).fadeIn(200,function(){b.controlsAreVisible=true;b.container.trigger(\"controlsshown\")});b.container.find(\".mejs-control\").css(\"visibility\",\r\n\"visible\").stop(true,true).fadeIn(200,function(){b.controlsAreVisible=true})}else{b.controls.css(\"visibility\",\"visible\").css(\"display\",\"block\");b.container.find(\".mejs-control\").css(\"visibility\",\"visible\").css(\"display\",\"block\");b.controlsAreVisible=true;b.container.trigger(\"controlsshown\")}b.setControlsSize()}},hideControls:function(a){var b=this;a=typeof a==\"undefined\"||a;if(!(!b.controlsAreVisible||b.options.alwaysShowControls))if(a){b.controls.stop(true,true).fadeOut(200,function(){f(this).css(\"visibility\",\r\n\"hidden\").css(\"display\",\"block\");b.controlsAreVisible=false;b.container.trigger(\"controlshidden\")});b.container.find(\".mejs-control\").stop(true,true).fadeOut(200,function(){f(this).css(\"visibility\",\"hidden\").css(\"display\",\"block\")})}else{b.controls.css(\"visibility\",\"hidden\").css(\"display\",\"block\");b.container.find(\".mejs-control\").css(\"visibility\",\"hidden\").css(\"display\",\"block\");b.controlsAreVisible=false;b.container.trigger(\"controlshidden\")}},controlsTimer:null,startControlsTimer:function(a){var b=\r\nthis;a=typeof a!=\"undefined\"?a:1500;b.killControlsTimer(\"start\");b.controlsTimer=setTimeout(function(){b.hideControls();b.killControlsTimer(\"hide\")},a)},killControlsTimer:function(){if(this.controlsTimer!==null){clearTimeout(this.controlsTimer);delete this.controlsTimer;this.controlsTimer=null}},controlsEnabled:true,disableControls:function(){this.killControlsTimer();this.hideControls(false);this.controlsEnabled=false},enableControls:function(){this.showControls(false);this.controlsEnabled=true},\r\nmeReady:function(a,b){var c=this,e=mejs.MediaFeatures,d=b.getAttribute(\"autoplay\");d=!(typeof d==\"undefined\"||d===null||d===\"false\");var g;if(!c.created){c.created=true;c.media=a;c.domNode=b;if(!(e.isAndroid&&c.options.AndroidUseNativeControls)&&!(e.isiPad&&c.options.iPadUseNativeControls)&&!(e.isiPhone&&c.options.iPhoneUseNativeControls)){c.buildposter(c,c.controls,c.layers,c.media);c.buildkeyboard(c,c.controls,c.layers,c.media);c.buildoverlays(c,c.controls,c.layers,c.media);c.findTracks();for(g in c.options.features){e=\r\nc.options.features[g];if(c[\"build\"+e])try{c[\"build\"+e](c,c.controls,c.layers,c.media)}catch(k){}}c.container.trigger(\"controlsready\");c.setPlayerSize(c.width,c.height);c.setControlsSize();if(c.isVideo){if(mejs.MediaFeatures.hasTouch)c.$media.bind(\"touchstart\",function(){if(c.controlsAreVisible)c.hideControls(false);else c.controlsEnabled&&c.showControls(false)});else{mejs.MediaElementPlayer.prototype.clickToPlayPauseCallback=function(){if(c.options.clickToPlayPause)c.media.paused?c.play():c.pause()};\r\nc.media.addEventListener(\"click\",c.clickToPlayPauseCallback,false);c.container.bind(\"mouseenter mouseover\",function(){if(c.controlsEnabled)if(!c.options.alwaysShowControls){c.killControlsTimer(\"enter\");c.showControls();c.startControlsTimer(2500)}}).bind(\"mousemove\",function(){if(c.controlsEnabled){c.controlsAreVisible||c.showControls();c.options.alwaysShowControls||c.startControlsTimer(2500)}}).bind(\"mouseleave\",function(){c.controlsEnabled&&!c.media.paused&&!c.options.alwaysShowControls&&c.startControlsTimer(1E3)})}c.options.hideVideoControlsOnLoad&&\r\nc.hideControls(false);d&&!c.options.alwaysShowControls&&c.hideControls();c.options.enableAutosize&&c.media.addEventListener(\"loadedmetadata\",function(j){if(c.options.videoHeight<=0&&c.domNode.getAttribute(\"height\")===null&&!isNaN(j.target.videoHeight)){c.setPlayerSize(j.target.videoWidth,j.target.videoHeight);c.setControlsSize();c.media.setVideoSize(j.target.videoWidth,j.target.videoHeight)}},false)}a.addEventListener(\"play\",function(){for(var j in mejs.players){var m=mejs.players[j];m.id!=c.id&&\r\nc.options.pauseOtherPlayers&&!m.paused&&!m.ended&&m.pause();m.hasFocus=false}c.hasFocus=true},false);c.media.addEventListener(\"ended\",function(){if(c.options.autoRewind)try{c.media.setCurrentTime(0)}catch(j){}c.media.pause();c.setProgressRail&&c.setProgressRail();c.setCurrentRail&&c.setCurrentRail();if(c.options.loop)c.play();else!c.options.alwaysShowControls&&c.controlsEnabled&&c.showControls()},false);c.media.addEventListener(\"loadedmetadata\",function(){c.updateDuration&&c.updateDuration();c.updateCurrent&&\r\nc.updateCurrent();if(!c.isFullScreen){c.setPlayerSize(c.width,c.height);c.setControlsSize()}},false);setTimeout(function(){c.setPlayerSize(c.width,c.height);c.setControlsSize()},50);c.globalBind(\"resize\",function(){c.isFullScreen||mejs.MediaFeatures.hasTrueNativeFullScreen&&document.webkitIsFullScreen||c.setPlayerSize(c.width,c.height);c.setControlsSize()});c.media.pluginType==\"youtube\"&&c.container.find(\".mejs-overlay-play\").hide()}d&&a.pluginType==\"native\"&&c.play();if(c.options.success)typeof c.options.success==\r\n\"string\"?window[c.options.success](c.media,c.domNode,c):c.options.success(c.media,c.domNode,c)}},handleError:function(a){this.controls.hide();this.options.error&&this.options.error(a)},setPlayerSize:function(a,b){if(typeof a!=\"undefined\")this.width=a;if(typeof b!=\"undefined\")this.height=b;if(this.height.toString().indexOf(\"%\")>0||this.$node.css(\"max-width\")===\"100%\"||parseInt(this.$node.css(\"max-width\").replace(/px/,\"\"),10)/this.$node.offsetParent().width()===1||this.$node[0].currentStyle&&this.$node[0].currentStyle.maxWidth===\r\n\"100%\"){var c=this.isVideo?this.media.videoWidth&&this.media.videoWidth>0?this.media.videoWidth:this.options.defaultVideoWidth:this.options.defaultAudioWidth,e=this.isVideo?this.media.videoHeight&&this.media.videoHeight>0?this.media.videoHeight:this.options.defaultVideoHeight:this.options.defaultAudioHeight,d=this.container.parent().closest(\":visible\").width();c=this.isVideo||!this.options.autosizeProgress?parseInt(d*e/c,10):e;if(this.container.parent()[0].tagName.toLowerCase()===\"body\"){d=f(window).width();\r\nc=f(window).height()}if(c!=0&&d!=0){this.container.width(d).height(c);this.$media.add(this.container.find(\".mejs-shim\")).width(\"100%\").height(\"100%\");this.isVideo&&this.media.setVideoSize&&this.media.setVideoSize(d,c);this.layers.children(\".mejs-layer\").width(\"100%\").height(\"100%\")}}else{this.container.width(this.width).height(this.height);this.layers.children(\".mejs-layer\").width(this.width).height(this.height)}d=this.layers.find(\".mejs-overlay-play\");c=d.find(\".mejs-overlay-button\");d.height(this.container.height()-\r\nthis.controls.height());c.css(\"margin-top\",\"-\"+(c.height()/2-this.controls.height()/2).toString()+\"px\")},setControlsSize:function(){var a=0,b=0,c=this.controls.find(\".mejs-time-rail\"),e=this.controls.find(\".mejs-time-total\");this.controls.find(\".mejs-time-current\");this.controls.find(\".mejs-time-loaded\");var d=c.siblings();if(this.options&&!this.options.autosizeProgress)b=parseInt(c.css(\"width\"));if(b===0||!b){d.each(function(){var g=f(this);if(g.css(\"position\")!=\"absolute\"&&g.is(\":visible\"))a+=f(this).outerWidth(true)});\r\nb=this.controls.width()-a-(c.outerWidth(true)-c.width())}b=b-1;c.width(b);e.width(b-(e.outerWidth(true)-e.width()));this.setProgressRail&&this.setProgressRail();this.setCurrentRail&&this.setCurrentRail()},buildposter:function(a,b,c,e){var d=f('<div class=\"mejs-poster mejs-layer\"></div>').appendTo(c);b=a.$media.attr(\"poster\");if(a.options.poster!==\"\")b=a.options.poster;b!==\"\"&&b!=null?this.setPoster(b):d.hide();e.addEventListener(\"play\",function(){d.hide()},false);a.options.showPosterWhenEnded&&a.options.autoRewind&&\r\ne.addEventListener(\"ended\",function(){d.show()},false)},setPoster:function(a){var b=this.container.find(\".mejs-poster\"),c=b.find(\"img\");if(c.length==0)c=f('<img width=\"100%\" height=\"100%\" />').appendTo(b);c.attr(\"src\",a);b.css({\"background-image\":\"url(\"+a+\")\"})},buildoverlays:function(a,b,c,e){var d=this;if(a.isVideo){var g=f('<div class=\"mejs-overlay mejs-layer\"><div class=\"mejs-overlay-loading\"><span></span></div></div>').hide().appendTo(c),k=f('<div class=\"mejs-overlay mejs-layer\"><div class=\"mejs-overlay-error\"></div></div>').hide().appendTo(c),\r\nj=f('<div class=\"mejs-overlay mejs-layer mejs-overlay-play\"><div class=\"mejs-overlay-button\"></div></div>').appendTo(c).bind(\"click touchstart\",function(){d.options.clickToPlayPause&&e.paused&&d.play()});e.addEventListener(\"play\",function(){j.hide();g.hide();b.find(\".mejs-time-buffering\").hide();k.hide()},false);e.addEventListener(\"playing\",function(){j.hide();g.hide();b.find(\".mejs-time-buffering\").hide();k.hide()},false);e.addEventListener(\"seeking\",function(){g.show();b.find(\".mejs-time-buffering\").show()},\r\nfalse);e.addEventListener(\"seeked\",function(){g.hide();b.find(\".mejs-time-buffering\").hide()},false);e.addEventListener(\"pause\",function(){mejs.MediaFeatures.isiPhone||j.show()},false);e.addEventListener(\"waiting\",function(){g.show();b.find(\".mejs-time-buffering\").show()},false);e.addEventListener(\"loadeddata\",function(){g.show();b.find(\".mejs-time-buffering\").show()},false);e.addEventListener(\"canplay\",function(){g.hide();b.find(\".mejs-time-buffering\").hide()},false);e.addEventListener(\"error\",function(){g.hide();\r\nb.find(\".mejs-time-buffering\").hide();k.show();k.find(\"mejs-overlay-error\").html(\"Error loading this resource\")},false)}},buildkeyboard:function(a,b,c,e){this.globalBind(\"keydown\",function(d){if(a.hasFocus&&a.options.enableKeyboard)for(var g=0,k=a.options.keyActions.length;g<k;g++)for(var j=a.options.keyActions[g],m=0,q=j.keys.length;m<q;m++)if(d.keyCode==j.keys[m]){d.preventDefault();j.action(a,e,d.keyCode);return false}return true});this.globalBind(\"click\",function(d){if(f(d.target).closest(\".mejs-container\").length==\r\n0)a.hasFocus=false})},findTracks:function(){var a=this,b=a.$media.find(\"track\");a.tracks=[];b.each(function(c,e){e=f(e);a.tracks.push({srclang:e.attr(\"srclang\")?e.attr(\"srclang\").toLowerCase():\"\",src:e.attr(\"src\"),kind:e.attr(\"kind\"),label:e.attr(\"label\")||\"\",entries:[],isLoaded:false})})},changeSkin:function(a){this.container[0].className=\"mejs-container \"+a;this.setPlayerSize(this.width,this.height);this.setControlsSize()},play:function(){this.load();this.media.play()},pause:function(){try{this.media.pause()}catch(a){}},\r\nload:function(){this.isLoaded||this.media.load();this.isLoaded=true},setMuted:function(a){this.media.setMuted(a)},setCurrentTime:function(a){this.media.setCurrentTime(a)},getCurrentTime:function(){return this.media.currentTime},setVolume:function(a){this.media.setVolume(a)},getVolume:function(){return this.media.volume},setSrc:function(a){this.media.setSrc(a)},remove:function(){var a,b;for(a in this.options.features){b=this.options.features[a];if(this[\"clean\"+b])try{this[\"clean\"+b](this)}catch(c){}}if(this.isDynamic)this.$node.insertBefore(this.container);\r\nelse{this.$media.prop(\"controls\",true);this.$node.clone().show().insertBefore(this.container);this.$node.remove()}this.media.pluginType!==\"native\"&&this.media.remove();delete mejs.players[this.id];this.container.remove();this.globalUnbind();delete this.node.player}};(function(){function a(c,e){var d={d:[],w:[]};f.each((c||\"\").split(\" \"),function(g,k){var j=k+\".\"+e;if(j.indexOf(\".\")===0){d.d.push(j);d.w.push(j)}else d[b.test(k)?\"w\":\"d\"].push(j)});d.d=d.d.join(\" \");d.w=d.w.join(\" \");return d}var b=\r\n/^((after|before)print|(before)?unload|hashchange|message|o(ff|n)line|page(hide|show)|popstate|resize|storage)\\b/;mejs.MediaElementPlayer.prototype.globalBind=function(c,e,d){c=a(c,this.id);c.d&&f(document).bind(c.d,e,d);c.w&&f(window).bind(c.w,e,d)};mejs.MediaElementPlayer.prototype.globalUnbind=function(c,e){c=a(c,this.id);c.d&&f(document).unbind(c.d,e);c.w&&f(window).unbind(c.w,e)}})();if(typeof jQuery!=\"undefined\")jQuery.fn.mediaelementplayer=function(a){a===false?this.each(function(){var b=jQuery(this).data(\"mediaelementplayer\");\r\nb&&b.remove();jQuery(this).removeData(\"mediaelementplayer\")}):this.each(function(){jQuery(this).data(\"mediaelementplayer\",new mejs.MediaElementPlayer(this,a))});return this};f(document).ready(function(){f(\".mejs-player\").mediaelementplayer()});window.MediaElementPlayer=mejs.MediaElementPlayer})(mejs.$);\r\n(function(f){f.extend(mejs.MepDefaults,{playpauseText:mejs.i18n.t(\"Play/Pause\")});f.extend(MediaElementPlayer.prototype,{buildplaypause:function(a,b,c,e){var d=f('<div class=\"mejs-button mejs-playpause-button mejs-play\" ><button type=\"button\" aria-controls=\"'+this.id+'\" title=\"'+this.options.playpauseText+'\" aria-label=\"'+this.options.playpauseText+'\"></button></div>').appendTo(b).click(function(g){g.preventDefault();e.paused?e.play():e.pause();return false});e.addEventListener(\"play\",function(){d.removeClass(\"mejs-play\").addClass(\"mejs-pause\")},\r\nfalse);e.addEventListener(\"playing\",function(){d.removeClass(\"mejs-play\").addClass(\"mejs-pause\")},false);e.addEventListener(\"pause\",function(){d.removeClass(\"mejs-pause\").addClass(\"mejs-play\")},false);e.addEventListener(\"paused\",function(){d.removeClass(\"mejs-pause\").addClass(\"mejs-play\")},false)}})})(mejs.$);\r\n(function(f){f.extend(mejs.MepDefaults,{stopText:\"Stop\"});f.extend(MediaElementPlayer.prototype,{buildstop:function(a,b,c,e){f('<div class=\"mejs-button mejs-stop-button mejs-stop\"><button type=\"button\" aria-controls=\"'+this.id+'\" title=\"'+this.options.stopText+'\" aria-label=\"'+this.options.stopText+'\"></button></div>').appendTo(b).click(function(){e.paused||e.pause();if(e.currentTime>0){e.setCurrentTime(0);e.pause();b.find(\".mejs-time-current\").width(\"0px\");b.find(\".mejs-time-handle\").css(\"left\",\r\n\"0px\");b.find(\".mejs-time-float-current\").html(mejs.Utility.secondsToTimeCode(0));b.find(\".mejs-currenttime\").html(mejs.Utility.secondsToTimeCode(0));c.find(\".mejs-poster\").show()}})}})})(mejs.$);\r\n(function(f){f.extend(MediaElementPlayer.prototype,{buildprogress:function(a,b,c,e){f('<div class=\"mejs-time-rail\"><span class=\"mejs-time-total\"><span class=\"mejs-time-buffering\"></span><span class=\"mejs-time-loaded\"></span><span class=\"mejs-time-current\"></span><span class=\"mejs-time-handle\"></span><span class=\"mejs-time-float\"><span class=\"mejs-time-float-current\">00:00</span><span class=\"mejs-time-float-corner\"></span></span></span></div>').appendTo(b);b.find(\".mejs-time-buffering\").hide();var d=\r\nthis,g=b.find(\".mejs-time-total\");c=b.find(\".mejs-time-loaded\");var k=b.find(\".mejs-time-current\"),j=b.find(\".mejs-time-handle\"),m=b.find(\".mejs-time-float\"),q=b.find(\".mejs-time-float-current\"),p=function(h){h=h.pageX;var l=g.offset(),r=g.outerWidth(true),n=0,o=n=0;if(e.duration){if(h<l.left)h=l.left;else if(h>r+l.left)h=r+l.left;o=h-l.left;n=o/r;n=n<=0.02?0:n*e.duration;t&&n!==e.currentTime&&e.setCurrentTime(n);if(!mejs.MediaFeatures.hasTouch){m.css(\"left\",o);q.html(mejs.Utility.secondsToTimeCode(n));\r\nm.show()}}},t=false;g.bind(\"mousedown\",function(h){if(h.which===1){t=true;p(h);d.globalBind(\"mousemove.dur\",function(l){p(l)});d.globalBind(\"mouseup.dur\",function(){t=false;m.hide();d.globalUnbind(\".dur\")});return false}}).bind(\"mouseenter\",function(){d.globalBind(\"mousemove.dur\",function(h){p(h)});mejs.MediaFeatures.hasTouch||m.show()}).bind(\"mouseleave\",function(){if(!t){d.globalUnbind(\".dur\");m.hide()}});e.addEventListener(\"progress\",function(h){a.setProgressRail(h);a.setCurrentRail(h)},false);\r\ne.addEventListener(\"timeupdate\",function(h){a.setProgressRail(h);a.setCurrentRail(h)},false);d.loaded=c;d.total=g;d.current=k;d.handle=j},setProgressRail:function(a){var b=a!=undefined?a.target:this.media,c=null;if(b&&b.buffered&&b.buffered.length>0&&b.buffered.end&&b.duration)c=b.buffered.end(0)/b.duration;else if(b&&b.bytesTotal!=undefined&&b.bytesTotal>0&&b.bufferedBytes!=undefined)c=b.bufferedBytes/b.bytesTotal;else if(a&&a.lengthComputable&&a.total!=0)c=a.loaded/a.total;if(c!==null){c=Math.min(1,\r\nMath.max(0,c));this.loaded&&this.total&&this.loaded.width(this.total.width()*c)}},setCurrentRail:function(){if(this.media.currentTime!=undefined&&this.media.duration)if(this.total&&this.handle){var a=Math.round(this.total.width()*this.media.currentTime/this.media.duration),b=a-Math.round(this.handle.outerWidth(true)/2);this.current.width(a);this.handle.css(\"left\",b)}}})})(mejs.$);\r\n(function(f){f.extend(mejs.MepDefaults,{duration:-1,timeAndDurationSeparator:\"<span> | </span>\"});f.extend(MediaElementPlayer.prototype,{buildcurrent:function(a,b,c,e){f('<div class=\"mejs-time\"><span class=\"mejs-currenttime\">'+(a.options.alwaysShowHours?\"00:\":\"\")+(a.options.showTimecodeFrameCount?\"00:00:00\":\"00:00\")+\"</span></div>\").appendTo(b);this.currenttime=this.controls.find(\".mejs-currenttime\");e.addEventListener(\"timeupdate\",function(){a.updateCurrent()},false)},buildduration:function(a,b,\r\nc,e){if(b.children().last().find(\".mejs-currenttime\").length>0)f(this.options.timeAndDurationSeparator+'<span class=\"mejs-duration\">'+(this.options.duration>0?mejs.Utility.secondsToTimeCode(this.options.duration,this.options.alwaysShowHours||this.media.duration>3600,this.options.showTimecodeFrameCount,this.options.framesPerSecond||25):(a.options.alwaysShowHours?\"00:\":\"\")+(a.options.showTimecodeFrameCount?\"00:00:00\":\"00:00\"))+\"</span>\").appendTo(b.find(\".mejs-time\"));else{b.find(\".mejs-currenttime\").parent().addClass(\"mejs-currenttime-container\");\r\nf('<div class=\"mejs-time mejs-duration-container\"><span class=\"mejs-duration\">'+(this.options.duration>0?mejs.Utility.secondsToTimeCode(this.options.duration,this.options.alwaysShowHours||this.media.duration>3600,this.options.showTimecodeFrameCount,this.options.framesPerSecond||25):(a.options.alwaysShowHours?\"00:\":\"\")+(a.options.showTimecodeFrameCount?\"00:00:00\":\"00:00\"))+\"</span></div>\").appendTo(b)}this.durationD=this.controls.find(\".mejs-duration\");e.addEventListener(\"timeupdate\",function(){a.updateDuration()},\r\nfalse)},updateCurrent:function(){if(this.currenttime)this.currenttime.html(mejs.Utility.secondsToTimeCode(this.media.currentTime,this.options.alwaysShowHours||this.media.duration>3600,this.options.showTimecodeFrameCount,this.options.framesPerSecond||25))},updateDuration:function(){this.container.toggleClass(\"mejs-long-video\",this.media.duration>3600);if(this.durationD&&(this.options.duration>0||this.media.duration))this.durationD.html(mejs.Utility.secondsToTimeCode(this.options.duration>0?this.options.duration:\r\nthis.media.duration,this.options.alwaysShowHours,this.options.showTimecodeFrameCount,this.options.framesPerSecond||25))}})})(mejs.$);\r\n(function(f){f.extend(mejs.MepDefaults,{muteText:mejs.i18n.t(\"Mute Toggle\"),hideVolumeOnTouchDevices:true,audioVolume:\"horizontal\",videoVolume:\"vertical\"});f.extend(MediaElementPlayer.prototype,{buildvolume:function(a,b,c,e){if(!(mejs.MediaFeatures.hasTouch&&this.options.hideVolumeOnTouchDevices)){var d=this,g=d.isVideo?d.options.videoVolume:d.options.audioVolume,k=g==\"horizontal\"?f('<div class=\"mejs-button mejs-volume-button mejs-mute\"><button type=\"button\" aria-controls=\"'+d.id+'\" title=\"'+d.options.muteText+\r\n'\" aria-label=\"'+d.options.muteText+'\"></button></div><div class=\"mejs-horizontal-volume-slider\"><div class=\"mejs-horizontal-volume-total\"></div><div class=\"mejs-horizontal-volume-current\"></div><div class=\"mejs-horizontal-volume-handle\"></div></div>').appendTo(b):f('<div class=\"mejs-button mejs-volume-button mejs-mute\"><button type=\"button\" aria-controls=\"'+d.id+'\" title=\"'+d.options.muteText+'\" aria-label=\"'+d.options.muteText+'\"></button><div class=\"mejs-volume-slider\"><div class=\"mejs-volume-total\"></div><div class=\"mejs-volume-current\"></div><div class=\"mejs-volume-handle\"></div></div></div>').appendTo(b),\r\nj=d.container.find(\".mejs-volume-slider, .mejs-horizontal-volume-slider\"),m=d.container.find(\".mejs-volume-total, .mejs-horizontal-volume-total\"),q=d.container.find(\".mejs-volume-current, .mejs-horizontal-volume-current\"),p=d.container.find(\".mejs-volume-handle, .mejs-horizontal-volume-handle\"),t=function(n,o){if(!j.is(\":visible\")&&typeof o==\"undefined\"){j.show();t(n,true);j.hide()}else{n=Math.max(0,n);n=Math.min(n,1);n==0?k.removeClass(\"mejs-mute\").addClass(\"mejs-unmute\"):k.removeClass(\"mejs-unmute\").addClass(\"mejs-mute\");\r\nif(g==\"vertical\"){var s=m.height(),u=m.position(),v=s-s*n;p.css(\"top\",Math.round(u.top+v-p.height()/2));q.height(s-v);q.css(\"top\",u.top+v)}else{s=m.width();u=m.position();s=s*n;p.css(\"left\",Math.round(u.left+s-p.width()/2));q.width(Math.round(s))}}},h=function(n){var o=null,s=m.offset();if(g==\"vertical\"){o=m.height();parseInt(m.css(\"top\").replace(/px/,\"\"),10);o=(o-(n.pageY-s.top))/o;if(s.top==0||s.left==0)return}else{o=m.width();o=(n.pageX-s.left)/o}o=Math.max(0,o);o=Math.min(o,1);t(o);o==0?e.setMuted(true):\r\ne.setMuted(false);e.setVolume(o)},l=false,r=false;k.hover(function(){j.show();r=true},function(){r=false;!l&&g==\"vertical\"&&j.hide()});j.bind(\"mouseover\",function(){r=true}).bind(\"mousedown\",function(n){h(n);d.globalBind(\"mousemove.vol\",function(o){h(o)});d.globalBind(\"mouseup.vol\",function(){l=false;d.globalUnbind(\".vol\");!r&&g==\"vertical\"&&j.hide()});l=true;return false});k.find(\"button\").click(function(){e.setMuted(!e.muted)});e.addEventListener(\"volumechange\",function(){if(!l)if(e.muted){t(0);\r\nk.removeClass(\"mejs-mute\").addClass(\"mejs-unmute\")}else{t(e.volume);k.removeClass(\"mejs-unmute\").addClass(\"mejs-mute\")}},false);if(d.container.is(\":visible\")){t(a.options.startVolume);a.options.startVolume===0&&e.setMuted(true);e.pluginType===\"native\"&&e.setVolume(a.options.startVolume)}}}})})(mejs.$);\r\n(function(f){f.extend(mejs.MepDefaults,{usePluginFullScreen:true,newWindowCallback:function(){return\"\"},fullscreenText:mejs.i18n.t(\"Fullscreen\")});f.extend(MediaElementPlayer.prototype,{isFullScreen:false,isNativeFullScreen:false,isInIframe:false,buildfullscreen:function(a,b,c,e){if(a.isVideo){a.isInIframe=window.location!=window.parent.location;if(mejs.MediaFeatures.hasTrueNativeFullScreen){c=function(){if(a.isFullScreen)if(mejs.MediaFeatures.isFullScreen()){a.isNativeFullScreen=true;a.setControlsSize()}else{a.isNativeFullScreen=\r\nfalse;a.exitFullScreen()}};mejs.MediaFeatures.hasMozNativeFullScreen?a.globalBind(mejs.MediaFeatures.fullScreenEventName,c):a.container.bind(mejs.MediaFeatures.fullScreenEventName,c)}var d=this,g=f('<div class=\"mejs-button mejs-fullscreen-button\"><button type=\"button\" aria-controls=\"'+d.id+'\" title=\"'+d.options.fullscreenText+'\" aria-label=\"'+d.options.fullscreenText+'\"></button></div>').appendTo(b);if(d.media.pluginType===\"native\"||!d.options.usePluginFullScreen&&!mejs.MediaFeatures.isFirefox)g.click(function(){mejs.MediaFeatures.hasTrueNativeFullScreen&&\r\nmejs.MediaFeatures.isFullScreen()||a.isFullScreen?a.exitFullScreen():a.enterFullScreen()});else{var k=null;if(function(){var h=document.createElement(\"x\"),l=document.documentElement,r=window.getComputedStyle;if(!(\"pointerEvents\"in h.style))return false;h.style.pointerEvents=\"auto\";h.style.pointerEvents=\"x\";l.appendChild(h);r=r&&r(h,\"\").pointerEvents===\"auto\";l.removeChild(h);return!!r}()&&!mejs.MediaFeatures.isOpera){var j=false,m=function(){if(j){for(var h in q)q[h].hide();g.css(\"pointer-events\",\r\n\"\");d.controls.css(\"pointer-events\",\"\");d.media.removeEventListener(\"click\",d.clickToPlayPauseCallback);j=false}},q={};b=[\"top\",\"left\",\"right\",\"bottom\"];var p,t=function(){var h=g.offset().left-d.container.offset().left,l=g.offset().top-d.container.offset().top,r=g.outerWidth(true),n=g.outerHeight(true),o=d.container.width(),s=d.container.height();for(p in q)q[p].css({position:\"absolute\",top:0,left:0});q.top.width(o).height(l);q.left.width(h).height(n).css({top:l});q.right.width(o-h-r).height(n).css({top:l,\r\nleft:h+r});q.bottom.width(o).height(s-n-l).css({top:l+n})};d.globalBind(\"resize\",function(){t()});p=0;for(c=b.length;p<c;p++)q[b[p]]=f('<div class=\"mejs-fullscreen-hover\" />').appendTo(d.container).mouseover(m).hide();g.on(\"mouseover\",function(){if(!d.isFullScreen){var h=g.offset(),l=a.container.offset();e.positionFullscreenButton(h.left-l.left,h.top-l.top,false);g.css(\"pointer-events\",\"none\");d.controls.css(\"pointer-events\",\"none\");d.media.addEventListener(\"click\",d.clickToPlayPauseCallback);for(p in q)q[p].show();\r\nt();j=true}});e.addEventListener(\"fullscreenchange\",function(){d.isFullScreen=!d.isFullScreen;d.isFullScreen?d.media.removeEventListener(\"click\",d.clickToPlayPauseCallback):d.media.addEventListener(\"click\",d.clickToPlayPauseCallback);m()});d.globalBind(\"mousemove\",function(h){if(j){var l=g.offset();if(h.pageY<l.top||h.pageY>l.top+g.outerHeight(true)||h.pageX<l.left||h.pageX>l.left+g.outerWidth(true)){g.css(\"pointer-events\",\"\");d.controls.css(\"pointer-events\",\"\");j=false}}})}else g.on(\"mouseover\",\r\nfunction(){if(k!==null){clearTimeout(k);delete k}var h=g.offset(),l=a.container.offset();e.positionFullscreenButton(h.left-l.left,h.top-l.top,true)}).on(\"mouseout\",function(){if(k!==null){clearTimeout(k);delete k}k=setTimeout(function(){e.hideFullscreenButton()},1500)})}a.fullscreenBtn=g;d.globalBind(\"keydown\",function(h){if((mejs.MediaFeatures.hasTrueNativeFullScreen&&mejs.MediaFeatures.isFullScreen()||d.isFullScreen)&&h.keyCode==27)a.exitFullScreen()})}},cleanfullscreen:function(a){a.exitFullScreen()},\r\ncontainerSizeTimeout:null,enterFullScreen:function(){var a=this;if(!(a.media.pluginType!==\"native\"&&(mejs.MediaFeatures.isFirefox||a.options.usePluginFullScreen))){f(document.documentElement).addClass(\"mejs-fullscreen\");normalHeight=a.container.height();normalWidth=a.container.width();if(a.media.pluginType===\"native\")if(mejs.MediaFeatures.hasTrueNativeFullScreen){mejs.MediaFeatures.requestFullScreen(a.container[0]);a.isInIframe&&setTimeout(function c(){if(a.isNativeFullScreen)f(window).width()!==\r\nscreen.width?a.exitFullScreen():setTimeout(c,500)},500)}else if(mejs.MediaFeatures.hasSemiNativeFullScreen){a.media.webkitEnterFullscreen();return}if(a.isInIframe){var b=a.options.newWindowCallback(this);if(b!==\"\")if(mejs.MediaFeatures.hasTrueNativeFullScreen)setTimeout(function(){if(!a.isNativeFullScreen){a.pause();window.open(b,a.id,\"top=0,left=0,width=\"+screen.availWidth+\",height=\"+screen.availHeight+\",resizable=yes,scrollbars=no,status=no,toolbar=no\")}},250);else{a.pause();window.open(b,a.id,\r\n\"top=0,left=0,width=\"+screen.availWidth+\",height=\"+screen.availHeight+\",resizable=yes,scrollbars=no,status=no,toolbar=no\");return}}a.container.addClass(\"mejs-container-fullscreen\").width(\"100%\").height(\"100%\");a.containerSizeTimeout=setTimeout(function(){a.container.css({width:\"100%\",height:\"100%\"});a.setControlsSize()},500);if(a.media.pluginType===\"native\")a.$media.width(\"100%\").height(\"100%\");else{a.container.find(\".mejs-shim\").width(\"100%\").height(\"100%\");a.media.setVideoSize(f(window).width(),\r\nf(window).height())}a.layers.children(\"div\").width(\"100%\").height(\"100%\");a.fullscreenBtn&&a.fullscreenBtn.removeClass(\"mejs-fullscreen\").addClass(\"mejs-unfullscreen\");a.setControlsSize();a.isFullScreen=true}},exitFullScreen:function(){clearTimeout(this.containerSizeTimeout);if(this.media.pluginType!==\"native\"&&mejs.MediaFeatures.isFirefox)this.media.setFullscreen(false);else{if(mejs.MediaFeatures.hasTrueNativeFullScreen&&(mejs.MediaFeatures.isFullScreen()||this.isFullScreen))mejs.MediaFeatures.cancelFullScreen();\r\nf(document.documentElement).removeClass(\"mejs-fullscreen\");this.container.removeClass(\"mejs-container-fullscreen\").width(normalWidth).height(normalHeight);if(this.media.pluginType===\"native\")this.$media.width(normalWidth).height(normalHeight);else{this.container.find(\".mejs-shim\").width(normalWidth).height(normalHeight);this.media.setVideoSize(normalWidth,normalHeight)}this.layers.children(\"div\").width(normalWidth).height(normalHeight);this.fullscreenBtn.removeClass(\"mejs-unfullscreen\").addClass(\"mejs-fullscreen\");\r\nthis.setControlsSize();this.isFullScreen=false}}})})(mejs.$);\r\n(function(f){f.extend(mejs.MepDefaults,{startLanguage:\"\",tracksText:mejs.i18n.t(\"Captions/Subtitles\"),hideCaptionsButtonWhenEmpty:true,toggleCaptionsButtonWhenOnlyOne:false,slidesSelector:\"\"});f.extend(MediaElementPlayer.prototype,{hasChapters:false,buildtracks:function(a,b,c,e){if(a.tracks.length!=0){var d;if(this.domNode.textTracks)for(d=this.domNode.textTracks.length-1;d>=0;d--)this.domNode.textTracks[d].mode=\"hidden\";a.chapters=f('<div class=\"mejs-chapters mejs-layer\"></div>').prependTo(c).hide();a.captions=\r\nf('<div class=\"mejs-captions-layer mejs-layer\"><div class=\"mejs-captions-position mejs-captions-position-hover\"><span class=\"mejs-captions-text\"></span></div></div>').prependTo(c).hide();a.captionsText=a.captions.find(\".mejs-captions-text\");a.captionsButton=f('<div class=\"mejs-button mejs-captions-button\"><button type=\"button\" aria-controls=\"'+this.id+'\" title=\"'+this.options.tracksText+'\" aria-label=\"'+this.options.tracksText+'\"></button><div class=\"mejs-captions-selector\"><ul><li><input type=\"radio\" name=\"'+\r\na.id+'_captions\" id=\"'+a.id+'_captions_none\" value=\"none\" checked=\"checked\" /><label for=\"'+a.id+'_captions_none\">'+mejs.i18n.t(\"None\")+\"</label></li></ul></div></div>\").appendTo(b);for(d=b=0;d<a.tracks.length;d++)a.tracks[d].kind==\"subtitles\"&&b++;this.options.toggleCaptionsButtonWhenOnlyOne&&b==1?a.captionsButton.on(\"click\",function(){a.setTrack(a.selectedTrack==null?a.tracks[0].srclang:\"none\")}):a.captionsButton.hover(function(){f(this).find(\".mejs-captions-selector\").css(\"visibility\",\"visible\")},\r\nfunction(){f(this).find(\".mejs-captions-selector\").css(\"visibility\",\"hidden\")}).on(\"click\",\"input[type=radio]\",function(){lang=this.value;a.setTrack(lang)});a.options.alwaysShowControls?a.container.find(\".mejs-captions-position\").addClass(\"mejs-captions-position-hover\"):a.container.bind(\"controlsshown\",function(){a.container.find(\".mejs-captions-position\").addClass(\"mejs-captions-position-hover\")}).bind(\"controlshidden\",function(){e.paused||a.container.find(\".mejs-captions-position\").removeClass(\"mejs-captions-position-hover\")});\r\na.trackToLoad=-1;a.selectedTrack=null;a.isLoadingTrack=false;for(d=0;d<a.tracks.length;d++)a.tracks[d].kind==\"subtitles\"&&a.addTrackButton(a.tracks[d].srclang,a.tracks[d].label);a.loadNextTrack();e.addEventListener(\"timeupdate\",function(){a.displayCaptions()},false);if(a.options.slidesSelector!=\"\"){a.slidesContainer=f(a.options.slidesSelector);e.addEventListener(\"timeupdate\",function(){a.displaySlides()},false)}e.addEventListener(\"loadedmetadata\",function(){a.displayChapters()},false);a.container.hover(function(){if(a.hasChapters){a.chapters.css(\"visibility\",\r\n\"visible\");a.chapters.fadeIn(200).height(a.chapters.find(\".mejs-chapter\").outerHeight())}},function(){a.hasChapters&&!e.paused&&a.chapters.fadeOut(200,function(){f(this).css(\"visibility\",\"hidden\");f(this).css(\"display\",\"block\")})});a.node.getAttribute(\"autoplay\")!==null&&a.chapters.css(\"visibility\",\"hidden\")}},setTrack:function(a){var b;if(a==\"none\"){this.selectedTrack=null;this.captionsButton.removeClass(\"mejs-captions-enabled\")}else for(b=0;b<this.tracks.length;b++)if(this.tracks[b].srclang==a){this.selectedTrack==\r\nnull&&this.captionsButton.addClass(\"mejs-captions-enabled\");this.selectedTrack=this.tracks[b];this.captions.attr(\"lang\",this.selectedTrack.srclang);this.displayCaptions();break}},loadNextTrack:function(){this.trackToLoad++;if(this.trackToLoad<this.tracks.length){this.isLoadingTrack=true;this.loadTrack(this.trackToLoad)}else{this.isLoadingTrack=false;this.checkForTracks()}},loadTrack:function(a){var b=this,c=b.tracks[a];f.ajax({url:c.src,dataType:\"text\",success:function(e){c.entries=typeof e==\"string\"&&\r\n/<tt\\s+xml/ig.exec(e)?mejs.TrackFormatParser.dfxp.parse(e):mejs.TrackFormatParser.webvvt.parse(e);c.isLoaded=true;b.enableTrackButton(c.srclang,c.label);b.loadNextTrack();c.kind==\"chapters\"&&b.media.addEventListener(\"play\",function(){b.media.duration>0&&b.displayChapters(c)},false);c.kind==\"slides\"&&b.setupSlides(c)},error:function(){b.loadNextTrack()}})},enableTrackButton:function(a,b){if(b===\"\")b=mejs.language.codes[a]||a;this.captionsButton.find(\"input[value=\"+a+\"]\").prop(\"disabled\",false).siblings(\"label\").html(b);\r\nthis.options.startLanguage==a&&f(\"#\"+this.id+\"_captions_\"+a).click();this.adjustLanguageBox()},addTrackButton:function(a,b){if(b===\"\")b=mejs.language.codes[a]||a;this.captionsButton.find(\"ul\").append(f('<li><input type=\"radio\" name=\"'+this.id+'_captions\" id=\"'+this.id+\"_captions_\"+a+'\" value=\"'+a+'\" disabled=\"disabled\" /><label for=\"'+this.id+\"_captions_\"+a+'\">'+b+\" (loading)</label></li>\"));this.adjustLanguageBox();this.container.find(\".mejs-captions-translations option[value=\"+a+\"]\").remove()},\r\nadjustLanguageBox:function(){this.captionsButton.find(\".mejs-captions-selector\").height(this.captionsButton.find(\".mejs-captions-selector ul\").outerHeight(true)+this.captionsButton.find(\".mejs-captions-translations\").outerHeight(true))},checkForTracks:function(){var a=false;if(this.options.hideCaptionsButtonWhenEmpty){for(i=0;i<this.tracks.length;i++)if(this.tracks[i].kind==\"subtitles\"){a=true;break}if(!a){this.captionsButton.hide();this.setControlsSize()}}},displayCaptions:function(){if(typeof this.tracks!=\r\n\"undefined\"){var a,b=this.selectedTrack;if(b!=null&&b.isLoaded)for(a=0;a<b.entries.times.length;a++)if(this.media.currentTime>=b.entries.times[a].start&&this.media.currentTime<=b.entries.times[a].stop){this.captionsText.html(b.entries.text[a]);this.captions.show().height(0);return}this.captions.hide()}},setupSlides:function(a){this.slides=a;this.slides.entries.imgs=[this.slides.entries.text.length];this.showSlide(0)},showSlide:function(a){if(!(typeof this.tracks==\"undefined\"||typeof this.slidesContainer==\r\n\"undefined\")){var b=this,c=b.slides.entries.text[a],e=b.slides.entries.imgs[a];if(typeof e==\"undefined\"||typeof e.fadeIn==\"undefined\")b.slides.entries.imgs[a]=e=f('<img src=\"'+c+'\">').on(\"load\",function(){e.appendTo(b.slidesContainer).hide().fadeIn().siblings(\":visible\").fadeOut()});else!e.is(\":visible\")&&!e.is(\":animated\")&&e.fadeIn().siblings(\":visible\").fadeOut()}},displaySlides:function(){if(typeof this.slides!=\"undefined\"){var a=this.slides,b;for(b=0;b<a.entries.times.length;b++)if(this.media.currentTime>=\r\na.entries.times[b].start&&this.media.currentTime<=a.entries.times[b].stop){this.showSlide(b);break}}},displayChapters:function(){var a;for(a=0;a<this.tracks.length;a++)if(this.tracks[a].kind==\"chapters\"&&this.tracks[a].isLoaded){this.drawChapters(this.tracks[a]);this.hasChapters=true;break}},drawChapters:function(a){var b=this,c,e,d=e=0;b.chapters.empty();for(c=0;c<a.entries.times.length;c++){e=a.entries.times[c].stop-a.entries.times[c].start;e=Math.floor(e/b.media.duration*100);if(e+d>100||c==a.entries.times.length-\r\n1&&e+d<100)e=100-d;b.chapters.append(f('<div class=\"mejs-chapter\" rel=\"'+a.entries.times[c].start+'\" style=\"left: '+d.toString()+\"%;width: \"+e.toString()+'%;\"><div class=\"mejs-chapter-block'+(c==a.entries.times.length-1?\" mejs-chapter-block-last\":\"\")+'\"><span class=\"ch-title\">'+a.entries.text[c]+'</span><span class=\"ch-time\">'+mejs.Utility.secondsToTimeCode(a.entries.times[c].start)+\"&ndash;\"+mejs.Utility.secondsToTimeCode(a.entries.times[c].stop)+\"</span></div></div>\"));d+=e}b.chapters.find(\"div.mejs-chapter\").click(function(){b.media.setCurrentTime(parseFloat(f(this).attr(\"rel\")));\r\nb.media.paused&&b.media.play()});b.chapters.show()}});mejs.language={codes:{af:\"Afrikaans\",sq:\"Albanian\",ar:\"Arabic\",be:\"Belarusian\",bg:\"Bulgarian\",ca:\"Catalan\",zh:\"Chinese\",\"zh-cn\":\"Chinese Simplified\",\"zh-tw\":\"Chinese Traditional\",hr:\"Croatian\",cs:\"Czech\",da:\"Danish\",nl:\"Dutch\",en:\"English\",et:\"Estonian\",tl:\"Filipino\",fi:\"Finnish\",fr:\"French\",gl:\"Galician\",de:\"German\",el:\"Greek\",ht:\"Haitian Creole\",iw:\"Hebrew\",hi:\"Hindi\",hu:\"Hungarian\",is:\"Icelandic\",id:\"Indonesian\",ga:\"Irish\",it:\"Italian\",ja:\"Japanese\",\r\nko:\"Korean\",lv:\"Latvian\",lt:\"Lithuanian\",mk:\"Macedonian\",ms:\"Malay\",mt:\"Maltese\",no:\"Norwegian\",fa:\"Persian\",pl:\"Polish\",pt:\"Portuguese\",ro:\"Romanian\",ru:\"Russian\",sr:\"Serbian\",sk:\"Slovak\",sl:\"Slovenian\",es:\"Spanish\",sw:\"Swahili\",sv:\"Swedish\",tl:\"Tagalog\",th:\"Thai\",tr:\"Turkish\",uk:\"Ukrainian\",vi:\"Vietnamese\",cy:\"Welsh\",yi:\"Yiddish\"}};mejs.TrackFormatParser={webvvt:{pattern_identifier:/^([a-zA-z]+-)?[0-9]+$/,pattern_timecode:/^([0-9]{2}:[0-9]{2}:[0-9]{2}([,.][0-9]{1,3})?) --\\> ([0-9]{2}:[0-9]{2}:[0-9]{2}([,.][0-9]{3})?)(.*)$/,\r\nparse:function(a){var b=0;a=mejs.TrackFormatParser.split2(a,/\\r?\\n/);for(var c={text:[],times:[]},e,d;b<a.length;b++)if(this.pattern_identifier.exec(a[b])){b++;if((e=this.pattern_timecode.exec(a[b]))&&b<a.length){b++;d=a[b];for(b++;a[b]!==\"\"&&b<a.length;){d=d+\"\\n\"+a[b];b++}d=f.trim(d).replace(/(\\b(https?|ftp|file):\\/\\/[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|])/ig,\"<a href='$1' target='_blank'>$1</a>\");c.text.push(d);c.times.push({start:mejs.Utility.convertSMPTEtoSeconds(e[1])==0?0.2:mejs.Utility.convertSMPTEtoSeconds(e[1]),\r\nstop:mejs.Utility.convertSMPTEtoSeconds(e[3]),settings:e[5]})}}return c}},dfxp:{parse:function(a){a=f(a).filter(\"tt\");var b=0;b=a.children(\"div\").eq(0);var c=b.find(\"p\");b=a.find(\"#\"+b.attr(\"style\"));var e,d;a={text:[],times:[]};if(b.length){d=b.removeAttr(\"id\").get(0).attributes;if(d.length){e={};for(b=0;b<d.length;b++)e[d[b].name.split(\":\")[1]]=d[b].value}}for(b=0;b<c.length;b++){var g;d={start:null,stop:null,style:null};if(c.eq(b).attr(\"begin\"))d.start=mejs.Utility.convertSMPTEtoSeconds(c.eq(b).attr(\"begin\"));\r\nif(!d.start&&c.eq(b-1).attr(\"end\"))d.start=mejs.Utility.convertSMPTEtoSeconds(c.eq(b-1).attr(\"end\"));if(c.eq(b).attr(\"end\"))d.stop=mejs.Utility.convertSMPTEtoSeconds(c.eq(b).attr(\"end\"));if(!d.stop&&c.eq(b+1).attr(\"begin\"))d.stop=mejs.Utility.convertSMPTEtoSeconds(c.eq(b+1).attr(\"begin\"));if(e){g=\"\";for(var k in e)g+=k+\":\"+e[k]+\";\"}if(g)d.style=g;if(d.start==0)d.start=0.2;a.times.push(d);d=f.trim(c.eq(b).html()).replace(/(\\b(https?|ftp|file):\\/\\/[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|])/ig,\r\n\"<a href='$1' target='_blank'>$1</a>\");a.text.push(d);if(a.times.start==0)a.times.start=2}return a}},split2:function(a,b){return a.split(b)}};if(\"x\\n\\ny\".split(/\\n/gi).length!=3)mejs.TrackFormatParser.split2=function(a,b){var c=[],e=\"\",d;for(d=0;d<a.length;d++){e+=a.substring(d,d+1);if(b.test(e)){c.push(e.replace(b,\"\"));e=\"\"}}c.push(e);return c}})(mejs.$);\r\n(function(f){f.extend(mejs.MepDefaults,{contextMenuItems:[{render:function(a){if(typeof a.enterFullScreen==\"undefined\")return null;return a.isFullScreen?mejs.i18n.t(\"Turn off Fullscreen\"):mejs.i18n.t(\"Go Fullscreen\")},click:function(a){a.isFullScreen?a.exitFullScreen():a.enterFullScreen()}},{render:function(a){return a.media.muted?mejs.i18n.t(\"Unmute\"):mejs.i18n.t(\"Mute\")},click:function(a){a.media.muted?a.setMuted(false):a.setMuted(true)}},{isSeparator:true},{render:function(){return mejs.i18n.t(\"Download Video\")},\r\nclick:function(a){window.location.href=a.media.currentSrc}}]});f.extend(MediaElementPlayer.prototype,{buildcontextmenu:function(a){a.contextMenu=f('<div class=\"mejs-contextmenu\"></div>').appendTo(f(\"body\")).hide();a.container.bind(\"contextmenu\",function(b){if(a.isContextMenuEnabled){b.preventDefault();a.renderContextMenu(b.clientX-1,b.clientY-1);return false}});a.container.bind(\"click\",function(){a.contextMenu.hide()});a.contextMenu.bind(\"mouseleave\",function(){a.startContextMenuTimer()})},cleancontextmenu:function(a){a.contextMenu.remove()},\r\nisContextMenuEnabled:true,enableContextMenu:function(){this.isContextMenuEnabled=true},disableContextMenu:function(){this.isContextMenuEnabled=false},contextMenuTimeout:null,startContextMenuTimer:function(){var a=this;a.killContextMenuTimer();a.contextMenuTimer=setTimeout(function(){a.hideContextMenu();a.killContextMenuTimer()},750)},killContextMenuTimer:function(){var a=this.contextMenuTimer;if(a!=null){clearTimeout(a);delete a}},hideContextMenu:function(){this.contextMenu.hide()},renderContextMenu:function(a,\r\nb){for(var c=this,e=\"\",d=c.options.contextMenuItems,g=0,k=d.length;g<k;g++)if(d[g].isSeparator)e+='<div class=\"mejs-contextmenu-separator\"></div>';else{var j=d[g].render(c);if(j!=null)e+='<div class=\"mejs-contextmenu-item\" data-itemindex=\"'+g+'\" id=\"element-'+Math.random()*1E6+'\">'+j+\"</div>\"}c.contextMenu.empty().append(f(e)).css({top:b,left:a}).show();c.contextMenu.find(\".mejs-contextmenu-item\").each(function(){var m=f(this),q=parseInt(m.data(\"itemindex\"),10),p=c.options.contextMenuItems[q];typeof p.show!=\r\n\"undefined\"&&p.show(m,c);m.click(function(){typeof p.click!=\"undefined\"&&p.click(c);c.contextMenu.hide()})});setTimeout(function(){c.killControlsTimer(\"rev3\")},100)}})})(mejs.$);\r\n(function(f){f.extend(mejs.MepDefaults,{postrollCloseText:mejs.i18n.t(\"Close\")});f.extend(MediaElementPlayer.prototype,{buildpostroll:function(a,b,c){var e=this.container.find('link[rel=\"postroll\"]').attr(\"href\");if(typeof e!==\"undefined\"){a.postroll=f('<div class=\"mejs-postroll-layer mejs-layer\"><a class=\"mejs-postroll-close\" onclick=\"$(this).parent().hide();return false;\">'+this.options.postrollCloseText+'</a><div class=\"mejs-postroll-layer-content\"></div></div>').prependTo(c).hide();this.media.addEventListener(\"ended\",\r\nfunction(){f.ajax({dataType:\"html\",url:e,success:function(d){c.find(\".mejs-postroll-layer-content\").html(d)}});a.postroll.show()},false)}}})})(mejs.$);\r\n\r\n\ndefine(\"extensions/adapt-editorial/js/lib/mediaelement-and-player.min\", function(){});\n\n","define('extensions/adapt-editorial/js/tiles/e-video',[\r\n    'coreJS/adapt',\r\n    './media',\r\n    '../lib/mediaelement-and-player.min'\r\n], function(Adapt, MediaTile) {\r\n\r\n    var VideoTile = {\r\n        \r\n        View: MediaTile.View.extend({\r\n\r\n            events: {\r\n                \"click .media-inline-transcript-button\": \"onToggleInlineTranscript\",\r\n                \"mouseover\": \"onMouseOver\",\r\n                \"mouseout\": \"onMouseOut\"\r\n            },\r\n\r\n            _mouseOn: false,\r\n            _blockFade: false,\r\n            _isTouch: false,\r\n            _isPlaying: false,\r\n            _forceResize: true,\r\n\r\n            onInitialize: Backbone.ascend(\"onInitialize\", function() {\r\n                this.onPause();\r\n                this._isTouch = Modernizr.touch;\r\n                this._onFadeInOut = _.debounce(_.bind(this.onFadeInOut, this), 100);\r\n                this._unblockFade = _.bind(this.unblockFade, this);\r\n                this._onWindowResize = _.bind(this.onWindowResize, this);\r\n                $(window).on(\"resize\", this._onWindowResize);\r\n                this.listenTo(Adapt, 'accessibility:toggle', this.onAccessibilityToggle);\r\n            }),\r\n\r\n            onMouseOver: function(event) {\r\n                if (this._isTouch) return;\r\n                if (this._mouseOn) return;\r\n                this._onFadeInOut();\r\n                this._mouseOn = true;\r\n            },\r\n\r\n            onMouseOut: function(event) {\r\n                if (this._isTouch) return;\r\n                if (!this._mouseOn) return;\r\n                this._onFadeInOut();\r\n                this._mouseOn = false;\r\n            },\r\n\r\n            onFadeInOut: function() {\r\n                if (!this.model.get(\"_textOverlay\")) return;\r\n                if (this._blockFade) return;\r\n                if (this._mouseOn) {\r\n                    this.$(\".text\").velocity(\"stop\").velocity({opacity:.5}, {duration:250});\r\n                } else {\r\n                    this.$(\".text\").velocity(\"stop\").velocity({opacity:1}, {duration:250});\r\n                }\r\n            },\r\n\r\n            unblockFade: function() {\r\n                this._blockFade = false;\r\n                this._onFadeInOut();            \r\n            },\r\n\r\n            onPlay: function() {\r\n                this.$el.attr(\"playing\", true);\r\n                this._isPlaying = true;\r\n\r\n                this.toggleText();\r\n            },\r\n\r\n            onPause: function() {\r\n                this.$el.attr(\"playing\", false);\r\n                this._isPlaying = false;\r\n\r\n                this.toggleText();\r\n            },\r\n\r\n            toggleText: function() {\r\n                if (!this.model.get(\"_textOverlay\")) {\r\n                    this.resetText();\r\n                    return;\r\n                };\r\n                this._blockFade = true;\r\n                if (this._isPlaying) {\r\n                    switch (this.model.get(\"_textPosition\")) {\r\n                    case \"left\":\r\n                        this.$(\".text.top\").velocity(\"stop\").velocity({ opacity: this._mouseOn ? .5 : 1, left: -this.$(\".text.top\").width()+\"px\"}, { complete: this._unblockFade});\r\n                        break;\r\n                    case \"top\":\r\n                        this.$(\".text.top\").velocity(\"stop\").velocity({ opacity: this._mouseOn ? .5 : 1, top: -this.$(\".text.top\").height()+\"px\"}, { complete: this._unblockFade});\r\n                        break;\r\n                    case \"right\":\r\n                        this.$(\".text.bottom\").velocity(\"stop\").velocity({ opacity: this._mouseOn ? .5 : 1, right: -this.$(\".text.top\").width()+\"px\"}, { complete: this._unblockFade});\r\n                        break;\r\n                    case \"bottom\":\r\n                        this.$(\".text.bottom\").velocity(\"stop\").velocity({ opacity: this._mouseOn ? .5 : 1, bottom: -this.$(\".text.top\").height()+\"px\"}, { complete: this._unblockFade});\r\n                    }\r\n                } else {\r\n                    switch (this.model.get(\"_textPosition\")) {\r\n                    case \"left\":\r\n                        this.$(\".text.top\").velocity(\"stop\").velocity({ opacity: this._mouseOn ? .5 : 1, left: 0+\"px\"}, { complete: this._unblockFade })\r\n                        break;\r\n                    case \"top\":\r\n                        this.$(\".text.top\").velocity(\"stop\").velocity({ opacity: this._mouseOn ? .5 : 1, top: 0+\"px\"}, { complete: this._unblockFade })\r\n                        break;\r\n                    case \"right\":\r\n                        this.$(\".text.bottom\").velocity(\"stop\").velocity({ opacity: this._mouseOn ? .5 : 1, right: 0+\"px\"}, { complete: this._unblockFade })\r\n                        break;\r\n                    case \"bottom\":\r\n                        this.$(\".text.bottom\").velocity(\"stop\").velocity({ opacity: this._mouseOn ? .5 : 1, bottom: 0+\"px\"}, { complete: this._unblockFade })\r\n                        break;\r\n                    }\r\n                }\r\n            },\r\n\r\n            resetText: function() {\r\n                this.$(\".text\").css({\r\n                    top: \"\",\r\n                    left: \"\",\r\n                    right: \"\",\r\n                    bottom: \"\",\r\n                });\r\n            },\r\n\r\n            postRender: Backbone.ascend(\"postRender\", function() {\r\n                this.setupPlayer();\r\n            }),\r\n\r\n            setupPlayer: function() {\r\n                if(!this.model.get('_playerOptions')) this.model.set('_playerOptions', {});\r\n\r\n                var modelOptions = this.model.get('_playerOptions');\r\n\r\n                if(modelOptions.pluginPath === undefined) modelOptions.pluginPath = 'assets/';\r\n                if(modelOptions.features === undefined) modelOptions.features = ['playpause','progress','current','duration'];\r\n                if(modelOptions.clickToPlayPause === undefined) modelOptions.clickToPlayPause = true;\r\n                modelOptions.success = _.bind(this.onPlayerReady, this);\r\n\r\n                var hasAccessibility = Adapt.config.has('_accessibility') && Adapt.config.get('_accessibility')._isActive\r\n                    ? true\r\n                    : false;\r\n                    \r\n                if (hasAccessibility) modelOptions.alwaysShowControls = true;\r\n\r\n                // create the player\r\n                this.$('audio, video').mediaelementplayer(modelOptions);\r\n\r\n                // We're streaming - set ready now, as success won't be called above\r\n                if (this.model.get('_media').source) {\r\n                    this.$('.media-widget').addClass('external-source');\r\n                    this.setReadyStatus();\r\n                }\r\n            },\r\n\r\n            // Overrides the default play/pause functionality to stop accidental playing on touch devices\r\n            setupPlayPauseToggle: function() {\r\n                // bit sneaky, but we don't have a this.mediaElement.player ref on iOS devices\r\n                var player = this.mediaElement.player;\r\n\r\n                if(!player) {\r\n                    console.log(\"Media.setupPlayPauseToggle: OOPS! there's no player reference.\");\r\n                    return;\r\n                }\r\n\r\n                // stop the player dealing with this, we'll do it ourselves\r\n                player.options.clickToPlayPause = false;\r\n\r\n                // play on 'big button' click\r\n                $('.mejs-overlay-button',this.$el).click(_.bind(function(event) {\r\n                    player.play();\r\n                }, this));\r\n\r\n                // pause on player click\r\n                $('.mejs-mediaelement',this.$el).click(_.bind(function(event) {\r\n                    var isPaused = player.media.paused;\r\n                    if(!isPaused) player.pause();\r\n                }, this));\r\n            },\r\n\r\n            onRemove: Backbone.descend(\"onRemove\", function() {\r\n                if ($(\"html\").is(\".ie8\")) {\r\n                    var obj = this.$(\"object\")[0];\r\n                    if(obj) {\r\n                        obj.style.display = \"none\";\r\n                    }\r\n                }\r\n                if(this.mediaElement) {\r\n                    $(this.mediaElement.pluginElement).remove();\r\n                    delete this.mediaElement;\r\n                }\r\n                if (this._onWindowResize) {\r\n                     $(window).on(\"resize\", this._onWindowResize);\r\n                     delete this._onWindowResize;\r\n                }\r\n            }),\r\n\r\n            onPlayerReady: function (mediaElement, domObject) {\r\n                this.mediaElement = mediaElement;\r\n\r\n                if (!this.mediaElement.player) {\r\n                    this.mediaElement.player =  mejs.players[$('.mejs-container').attr('id')];\r\n                }\r\n\r\n                $(this.mediaElement).on(\"play\", _.bind(this.onPlay, this));\r\n                $(this.mediaElement).on(\"pause\", _.bind(this.onPause, this))\r\n\r\n                this.showControls();\r\n\r\n                var hasTouch = mejs.MediaFeatures.hasTouch;\r\n                if(hasTouch) {\r\n                    this.setupPlayPauseToggle();\r\n                }\r\n\r\n                this.setReadyStatus();\r\n            },\r\n\r\n            onAccessibilityToggle: function() {\r\n               this.showControls();\r\n            },\r\n\r\n            onToggleInlineTranscript: function(event) {\r\n                if (event) event.preventDefault();\r\n                var $transcriptBodyContainer = $(\".media-inline-transcript-body-container\");\r\n                var $button = $(\".media-inline-transcript-button\");\r\n\r\n                if  ($transcriptBodyContainer.hasClass(\"inline-transcript-open\")) {\r\n                    $transcriptBodyContainer.slideUp();\r\n                    $transcriptBodyContainer.removeClass(\"inline-transcript-open\");\r\n                    $button.html(this.model.get(\"_transcript\").inlineTranscriptButton);\r\n                } else {\r\n                    $transcriptBodyContainer.slideDown().a11y_focus();\r\n                    $transcriptBodyContainer.addClass(\"inline-transcript-open\");\r\n                    $button.html(this.model.get(\"_transcript\").inlineTranscriptCloseButton);\r\n                }\r\n            },\r\n\r\n            showControls: function() {\r\n                var hasAccessibility = Adapt.config.has('_accessibility') && Adapt.config.get('_accessibility')._isActive\r\n                    ? true\r\n                    : false;\r\n                    \r\n                if (hasAccessibility) {\r\n                    if (!this.mediaElement.player) return;\r\n\r\n                    var player = this.mediaElement.player;\r\n\r\n                    player.options.alwaysShowControls = true;\r\n                    player.enableControls();\r\n                    player.showControls();\r\n\r\n                    this.$('.mejs-playpause-button button').attr({\r\n                        \"role\": \"button\"\r\n                    });\r\n                    var screenReaderVideoTagFix = $(\"<div role='region' aria-label='.'>\");\r\n                    this.$('.mejs-playpause-button').prepend(screenReaderVideoTagFix);\r\n\r\n                    this.$('.mejs-time, .mejs-time-rail').attr({\r\n                        \"aria-hidden\": \"true\"\r\n                    });\r\n                }\r\n            },\r\n\r\n            onResize: Backbone.ascend(\"onResize\", function() {\r\n                \r\n                this.toggleText();\r\n\r\n                this._forceResize = true;\r\n                $(window).resize();\r\n            }),\r\n\r\n            getCalculatedStyleObject: Backbone.ascend(\"getCalculatedStyleObject\", function() {\r\n                var styleObject = this.model.toJSON();\r\n\r\n                switch (styleObject._textPosition) {\r\n                case \"top\": case \"bottom\":\r\n                    styleObject._mediaRestrict = \"100% auto\";\r\n                    styleObject._mediaPosition = \"center top\";\r\n                }\r\n\r\n                return styleObject;\r\n            }),\r\n\r\n            onWindowResize: function() {\r\n                if (!$(window).haveDimensionsChanged() && !this._forceResize) return;\r\n                this._forceResize = false;\r\n\r\n                if (this.model.get('_media').source) {\r\n                    this.$('.mejs-container').width(this.$('.component-widget').width());\r\n                } else {\r\n                    this.$('audio, video').width(this.$('.component-widget').width());\r\n                    this.$('.mejs-container').width(this.$('.component-widget').width());\r\n                }\r\n\r\n                var styleObject = this.getCalculatedStyleObject();\r\n                this.renderStyle(styleObject);\r\n            }\r\n\r\n        }),\r\n\r\n        Model: MediaTile.Model.extend({\r\n            defaults: Backbone.ascend(\"defaults\", function() {\r\n                return {\r\n                    \"#mediaRestrict\": \"100% 100%,100% 100%,100% 100%,100% 100%\",\r\n                    \"#mediaSize\": \"100% auto,100% auto,100% auto,100% auto\",\r\n                    \"#mediaDynamicRatio\": \"true,true,true,true\"\r\n                };\r\n            })\r\n        })\r\n    };\r\n\r\n    MediaTile.register('video', VideoTile);\r\n\r\n    return VideoTile;\r\n\r\n});\r\n\n","define('extensions/adapt-editorial/js/tiles/tiles',[\r\n    './e-group',\r\n    './e-text',\r\n    './e-image',\r\n    './e-video'\r\n], function() {});\n","define('extensions/adapt-editorial/js/adapt-editorialArticleExtension',[\r\n    'coreJS/adapt',\r\n    'coreViews/articleView',\r\n    'coreModels/articleModel',\r\n    './adapt-editorialArticleView',\r\n    './adapt-editorialArticleModel',\r\n    './tiles/tiles'\r\n], function(Adapt, ArticleView, ArticleModel, ExtensionView, ExtensionModel) {\r\n\r\n    /*  \r\n        Here we are extending the articleView and articleModel in Adapt.\r\n        This is to accomodate the new functionality on the article.\r\n        The advantage of this method is that the extension behaviour can utilize all of the predefined article behaviour in both the view and the model.\r\n    */  \r\n\r\n    //Extends core/js/views/articleView.js\r\n    var ViewInitialize = ArticleView.prototype.initialize;\r\n    ArticleView.prototype.initialize = function(options) {\r\n        if (this.model.get(\"_editorial\") && this.model.get(\"_editorial\")._isEnabled && !this.model.get(\"_editorial\")._isLightbox) {\r\n            //extend the articleView with new functionality\r\n            _.extend(this, ExtensionView);\r\n        }\r\n        //initialize the article in the normal manner\r\n        return ViewInitialize.apply(this, arguments);\r\n    };\r\n\r\n    //Extends core/js/models/articleModel.js\r\n    var ModelInitialize = ArticleModel.prototype.initialize;\r\n    ArticleModel.prototype.initialize = function(options) {\r\n        if (this.get(\"_editorial\") && this.get(\"_editorial\")._isEnabled && !this.get(\"_editorial\")._isLightbox) {\r\n            //extend the articleModel with new functionality\r\n            _.extend(this, ExtensionModel);\r\n\r\n            //initialize the article in the normal manner\r\n            var returnValue = ModelInitialize.apply(this, arguments);\r\n\r\n            //post initialize article extension\r\n            ExtensionModel.postInitialize.call(this);\r\n\r\n            return returnValue;\r\n        }\r\n\r\n        //initialize the article in the normal manner if no extension\r\n        return ModelInitialize.apply(this, arguments);\r\n    };\r\n\r\n    \r\n\r\n});\n","define('extensions/adapt-forceLoad/js/adapt-forceLoad',[ \"coreJS/adapt\" ], function(Adapt) {\r\n\r\n\tAdapt.once(\"app:dataReady\", function() {\r\n\t\tif (!Adapt.config.get(\"_forceLoad\")) return;\r\n\r\n\t\t$(\"<div/>\")\r\n\t\t\t.addClass(\"force-load\")\r\n\t\t\t.text(\"Force Load enabled\")\r\n\t\t\t.appendTo($(\"#wrapper\"));\r\n\r\n\t\tAdapt.on(\"menuView:postRender pageView:postRender\", function(view) {\r\n\t\t\t_.defer(function() { view.model.setOnChildren({ _isReady: true }); });\r\n\t\t});\r\n\t});\r\n\r\n});\n","define('extensions/adapt-hide-navigation-bar/js/adapt-hide-navigation-bar',[\r\n    'coreJS/adapt'\r\n], function(Adapt) {\r\n\r\n    var $html = null;\r\n\r\n\tAdapt.on(\"router:menu router:page\", function(model) {\r\n        if (!$html) $html = $(\"html\");\r\n\r\n    \tvar shouldHideNavigationBar = model.get(\"_hideNavigationBar\");\r\n    \tif (!shouldHideNavigationBar) showNavigationBar();\r\n        else hideNavigationBar();\r\n\r\n    });\r\n\r\n\r\n    function hideNavigationBar() {\r\n        $html.addClass(\"hide-navigation-bar\");\r\n    }\r\n\r\n    function showNavigationBar() {\r\n        $html.removeClass(\"hide-navigation-bar\");\r\n    }\r\n\r\n\r\n\r\n});\r\n\n","define('extensions/adapt-inspector/js/adapt-inspector',[ \"coreJS/adapt\" ], function(Adapt) {\r\n\r\n\tvar InspectorView = Backbone.View.extend({\r\n\r\n\t\tclassName: \"inspector\",\r\n\r\n\t\tids: [],\r\n\r\n\t\tinitialize: function() {\r\n\t\t\tthis.listenTo(Adapt, {\r\n\t\t\t\t\"inspector:id\": this.pushId,\r\n\t\t\t\t\"inspector:hover\": this.setVisibility,\r\n\t\t\t\t\"inspector:touch\": this.updateInspector,\r\n\t\t\t\t\"device:resize\": this.onResize,\r\n\t\t\t\t\"remove\": this.remove\r\n\t\t\t}).render();\r\n\t\t},\r\n\r\n\t\tevents: {\r\n\t\t\t\"mouseleave\": \"onLeave\"\r\n\t\t},\r\n\r\n\t\trender: function() {\r\n\t\t\t$(\"#wrapper\").append(this.$el);\r\n\t\t},\r\n\r\n\t\tpushId: function(id) {\r\n\t\t\tthis.ids.push(id);\r\n\t\t},\r\n\r\n\t\tsetVisibility: function() {\r\n\t\t\tif ($(\".inspector:hover\").length) return;\r\n\r\n\t\t\tfor (var i = this.ids.length - 1; i >= 0; --i) {\r\n\t\t\t\tvar $hovered = $(\"[data-id='\" + this.ids[i] + \"']:hover\");\r\n\r\n\t\t\t\tif ($hovered.length) return this.updateInspector($hovered);\r\n\t\t\t}\r\n\r\n\t\t\t$(\".inspector-visible\").removeClass(\"inspector-visible\");\r\n\t\t\tthis.$el.hide();\r\n\t\t},\r\n\r\n\t\tupdateInspector: function($hovered) {\r\n\t\t\tif ($hovered.hasClass(\"inspector-visible\")) return;\r\n\r\n\t\t\tvar data = [];\r\n\r\n\t\t\t$(\".inspector-visible\").removeClass(\"inspector-visible\");\r\n\t\t\tthis.addOverlappedElements($hovered).each(function() {\r\n\t\t\t\tvar $element = $(this);\r\n\t\t\t\tvar attributes = $element.data().attributes;\r\n\r\n\t\t\t\tif (!attributes) return;\r\n\r\n\t\t\t\tdata.push(attributes);\r\n\t\t\t\t$element.addClass(\"inspector-visible\");\r\n\t\t\t});\r\n\t\t\tthis.$el.html(Handlebars.templates.inspector(data)).removeAttr(\"style\");\r\n\t\t\tthis.positionInspector($hovered);\r\n\t\t},\r\n\r\n\t\taddOverlappedElements: function($hovered) {\r\n\t\t\tvar checkOverlap = function() {\r\n\t\t\t\tvar $element = $(this);\r\n\t\t\t\tvar isOverlapped = $element.height() &&\r\n\t\t\t\t\t_.isEqual($element.offset(), $hovered.offset()) &&\r\n\t\t\t\t\t$element.width() === $hovered.width();\r\n\r\n\t\t\t\tif (isOverlapped) $hovered = $hovered.add($element);\r\n\t\t\t};\r\n\r\n\t\t\tfor (var i = this.ids.length - 1; i >= 0; --i) {\r\n\t\t\t\t$(\"[data-id='\" + this.ids[i] + \"']\").each(checkOverlap);\r\n\t\t\t}\r\n\r\n\t\t\treturn $hovered;\r\n\t\t},\r\n\r\n\t\tpositionInspector: function($hovered) {\r\n\t\t\tvar offset = $hovered.offset();\r\n\t\t\tvar inspectorHeight = this.getComputed(\"height\");\r\n\t\t\tvar $arrow = this.$(\".inspector-arrow\");\r\n\t\t\tvar arrowHeight = $arrow.outerHeight() / 2;\r\n\t\t\tvar inspectorWidth = this.getComputed(\"width\");\r\n\r\n\t\t\tthis.$el.css({\r\n\t\t\t\ttop: offset.top - inspectorHeight - arrowHeight,\r\n\t\t\t\tleft: offset.left + $hovered.width() / 2 - inspectorWidth / 2,\r\n\t\t\t\twidth: inspectorWidth,\r\n\t\t\t\theight: inspectorHeight + arrowHeight\r\n\t\t\t});\r\n\t\t\t$arrow.css(\"top\", Math.floor(inspectorHeight));\r\n\t\t},\r\n\r\n\t\tgetComputed: function(property) {\r\n\t\t\treturn typeof getComputedStyle !== \"undefined\" ?\r\n\t\t\t\tparseFloat(getComputedStyle(this.$el[0])[property], 10) :\r\n\t\t\t\tthis.$el[property]();\r\n\t\t},\r\n\r\n\t\tonResize: function() {\r\n\t\t\tvar $hovered = $(\".inspector-visible\");\r\n\r\n\t\t\tif (!$hovered.length) return;\r\n\r\n\t\t\t$hovered.removeClass(\"inspector-visible\");\r\n\r\n\t\t\tif (!Adapt.device.touch) this.setVisibility();\r\n\t\t\telse this.updateInspector($hovered.last());\r\n\t\t},\r\n\r\n\t\tonLeave: function() {\r\n\t\t\tif (!Adapt.device.touch) this.setVisibility();\r\n\t\t}\r\n\r\n\t});\r\n\r\n\tvar InspectorContainerView = Backbone.View.extend({\r\n\r\n\t\tinitialize: function() {\r\n\t\t\tvar id = this.model.get(\"_id\");\r\n\r\n\t\t\tthis.listenTo(Adapt, \"remove\", this.remove).addTracUrl(id);\r\n\t\t\tthis.$el.attr(\"data-id\", id).data(this.model);\r\n\t\t\tAdapt.trigger(\"inspector:id\", id);\r\n\t\t},\r\n\r\n\t\tevents: function() {\r\n\t\t\treturn !Adapt.device.touch ?\r\n\t\t\t\t{ \"mouseenter\": \"onHover\", \"mouseleave\": \"onHover\" } :\r\n\t\t\t\t{ \"touchend\": \"onTouch\" };\r\n\t\t},\r\n\r\n\t\taddTracUrl: function(id) {\r\n\t\t\tvar tracUrl = Adapt.config.get(\"_inspector\")._tracUrl;\r\n\r\n\t\t\tif (!tracUrl) return;\r\n\r\n\t\t\tvar title = $(\"<div/>\").html(this.model.get(\"displayTitle\")).text();\r\n\t\t\tvar params = id;\r\n\t\t\tvar adaptLocation = Adapt.location;\r\n\t\t\tvar location = adaptLocation._currentId;\r\n\t\t\tvar locationType = adaptLocation._contentType;\r\n\r\n\t\t\tif (title) params += \" \" + title;\r\n\t\t\tif (id !== location) params += \" (\" + locationType + \" \" + location + \")\";\r\n\r\n\t\t\ttracUrl += \"/newticket?summary=\" + encodeURIComponent(params);\r\n\t\t\tthis.model.set(\"_tracUrl\", tracUrl);\r\n\t\t},\r\n\r\n\t\tonHover: function() {\r\n\t\t\t_.defer(function() { Adapt.trigger(\"inspector:hover\"); });\r\n\t\t},\r\n\r\n\t\tonTouch: function(event) {\r\n\t\t\tif (event.originalEvent.inspectorStop) return;\r\n\t\t\tevent.originalEvent.inspectorStop = true;\r\n\r\n\t\t\tif (!$(event.target).is(\"[class*=inspector-]\")) {\r\n\t\t\t\tAdapt.trigger(\"inspector:touch\", this.$el);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t});\r\n\r\n\tAdapt.once(\"app:dataReady\", function() {\r\n\t\tvar config = Adapt.config.get(\"_inspector\");\r\n\r\n\t\tif (!config || !config._isEnabled) return;\r\n\t\tif (Adapt.device.touch && config._disableOnTouch) return;\r\n\r\n\t\tvar views = config._elementsToInspect ||\r\n\t\t\t[ \"menu\", \"page\", \"article\", \"block\", \"component\", \"tile\" ];\r\n\r\n\t\tAdapt.on(\"router:location\", function() {\r\n\t\t\tnew InspectorView();\r\n\t\t}).on(views.join(\"View:postRender \") + \"View:postRender\", function(view) {\r\n\t\t\tnew InspectorContainerView({ el: view.$el, model: view.model });\r\n\t\t});\r\n\t});\r\n\r\n});\n",";(function () {\n\t'use strict';\n\n\t/**\n\t * @preserve FastClick: polyfill to remove click delays on browsers with touch UIs.\n\t *\n\t * @codingstandard ftlabs-jsv2\n\t * @copyright The Financial Times Limited [All Rights Reserved]\n\t * @license MIT License (see LICENSE.txt)\n\t */\n\n\t/*jslint browser:true, node:true*/\n\t/*global define, Event, Node*/\n\n\n\t/**\n\t * Instantiate fast-clicking listeners on the specified layer.\n\t *\n\t * @constructor\n\t * @param {Element} layer The layer to listen on\n\t * @param {Object} [options={}] The options to override the defaults\n\t */\n\tfunction FastClick(layer, options) {\n\t\tvar oldOnClick;\n\n\t\toptions = options || {};\n\n\t\t/**\n\t\t * Whether a click is currently being tracked.\n\t\t *\n\t\t * @type boolean\n\t\t */\n\t\tthis.trackingClick = false;\n\n\n\t\t/**\n\t\t * Timestamp for when click tracking started.\n\t\t *\n\t\t * @type number\n\t\t */\n\t\tthis.trackingClickStart = 0;\n\n\n\t\t/**\n\t\t * The element being tracked for a click.\n\t\t *\n\t\t * @type EventTarget\n\t\t */\n\t\tthis.targetElement = null;\n\n\n\t\t/**\n\t\t * X-coordinate of touch start event.\n\t\t *\n\t\t * @type number\n\t\t */\n\t\tthis.touchStartX = 0;\n\n\n\t\t/**\n\t\t * Y-coordinate of touch start event.\n\t\t *\n\t\t * @type number\n\t\t */\n\t\tthis.touchStartY = 0;\n\n\n\t\t/**\n\t\t * ID of the last touch, retrieved from Touch.identifier.\n\t\t *\n\t\t * @type number\n\t\t */\n\t\tthis.lastTouchIdentifier = 0;\n\n\n\t\t/**\n\t\t * Touchmove boundary, beyond which a click will be cancelled.\n\t\t *\n\t\t * @type number\n\t\t */\n\t\tthis.touchBoundary = options.touchBoundary || 10;\n\n\n\t\t/**\n\t\t * The FastClick layer.\n\t\t *\n\t\t * @type Element\n\t\t */\n\t\tthis.layer = layer;\n\n\t\t/**\n\t\t * The minimum time between tap(touchstart and touchend) events\n\t\t *\n\t\t * @type number\n\t\t */\n\t\tthis.tapDelay = options.tapDelay || 200;\n\n\t\t/**\n\t\t * The maximum time for a tap\n\t\t *\n\t\t * @type number\n\t\t */\n\t\tthis.tapTimeout = options.tapTimeout || 700;\n\n\t\tif (FastClick.notNeeded(layer)) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Some old versions of Android don't have Function.prototype.bind\n\t\tfunction bind(method, context) {\n\t\t\treturn function() { return method.apply(context, arguments); };\n\t\t}\n\n\n\t\tvar methods = ['onMouse', 'onClick', 'onTouchStart', 'onTouchMove', 'onTouchEnd', 'onTouchCancel'];\n\t\tvar context = this;\n\t\tfor (var i = 0, l = methods.length; i < l; i++) {\n\t\t\tcontext[methods[i]] = bind(context[methods[i]], context);\n\t\t}\n\n\t\t// Set up event handlers as required\n\t\tif (deviceIsAndroid) {\n\t\t\tlayer.addEventListener('mouseover', this.onMouse, true);\n\t\t\tlayer.addEventListener('mousedown', this.onMouse, true);\n\t\t\tlayer.addEventListener('mouseup', this.onMouse, true);\n\t\t}\n\n\t\tlayer.addEventListener('click', this.onClick, true);\n\t\tlayer.addEventListener('touchstart', this.onTouchStart, false);\n\t\tlayer.addEventListener('touchmove', this.onTouchMove, false);\n\t\tlayer.addEventListener('touchend', this.onTouchEnd, false);\n\t\tlayer.addEventListener('touchcancel', this.onTouchCancel, false);\n\n\t\t// Hack is required for browsers that don't support Event#stopImmediatePropagation (e.g. Android 2)\n\t\t// which is how FastClick normally stops click events bubbling to callbacks registered on the FastClick\n\t\t// layer when they are cancelled.\n\t\tif (!Event.prototype.stopImmediatePropagation) {\n\t\t\tlayer.removeEventListener = function(type, callback, capture) {\n\t\t\t\tvar rmv = Node.prototype.removeEventListener;\n\t\t\t\tif (type === 'click') {\n\t\t\t\t\trmv.call(layer, type, callback.hijacked || callback, capture);\n\t\t\t\t} else {\n\t\t\t\t\trmv.call(layer, type, callback, capture);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tlayer.addEventListener = function(type, callback, capture) {\n\t\t\t\tvar adv = Node.prototype.addEventListener;\n\t\t\t\tif (type === 'click') {\n\t\t\t\t\tadv.call(layer, type, callback.hijacked || (callback.hijacked = function(event) {\n\t\t\t\t\t\tif (!event.propagationStopped) {\n\t\t\t\t\t\t\tcallback(event);\n\t\t\t\t\t\t}\n\t\t\t\t\t}), capture);\n\t\t\t\t} else {\n\t\t\t\t\tadv.call(layer, type, callback, capture);\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// If a handler is already declared in the element's onclick attribute, it will be fired before\n\t\t// FastClick's onClick handler. Fix this by pulling out the user-defined handler function and\n\t\t// adding it as listener.\n\t\tif (typeof layer.onclick === 'function') {\n\n\t\t\t// Android browser on at least 3.2 requires a new reference to the function in layer.onclick\n\t\t\t// - the old one won't work if passed to addEventListener directly.\n\t\t\toldOnClick = layer.onclick;\n\t\t\tlayer.addEventListener('click', function(event) {\n\t\t\t\toldOnClick(event);\n\t\t\t}, false);\n\t\t\tlayer.onclick = null;\n\t\t}\n\t}\n\n\t/**\n\t* Windows Phone 8.1 fakes user agent string to look like Android and iPhone.\n\t*\n\t* @type boolean\n\t*/\n\tvar deviceIsWindowsPhone = navigator.userAgent.indexOf(\"Windows Phone\") >= 0;\n\n\t/**\n\t * Android requires exceptions.\n\t *\n\t * @type boolean\n\t */\n\tvar deviceIsAndroid = navigator.userAgent.indexOf('Android') > 0 && !deviceIsWindowsPhone;\n\n\n\t/**\n\t * iOS requires exceptions.\n\t *\n\t * @type boolean\n\t */\n\tvar deviceIsIOS = /iP(ad|hone|od)/.test(navigator.userAgent) && !deviceIsWindowsPhone;\n\n\n\t/**\n\t * iOS 4 requires an exception for select elements.\n\t *\n\t * @type boolean\n\t */\n\tvar deviceIsIOS4 = deviceIsIOS && (/OS 4_\\d(_\\d)?/).test(navigator.userAgent);\n\n\n\t/**\n\t * iOS 6.0-7.* requires the target element to be manually derived\n\t *\n\t * @type boolean\n\t */\n\tvar deviceIsIOSWithBadTarget = deviceIsIOS && (/OS [6-7]_\\d/).test(navigator.userAgent);\n\n\t/**\n\t * BlackBerry requires exceptions.\n\t *\n\t * @type boolean\n\t */\n\tvar deviceIsBlackBerry10 = navigator.userAgent.indexOf('BB10') > 0;\n\n\t/**\n\t * Determine whether a given element requires a native click.\n\t *\n\t * @param {EventTarget|Element} target Target DOM element\n\t * @returns {boolean} Returns true if the element needs a native click\n\t */\n\tFastClick.prototype.needsClick = function(target) {\n\t\tswitch (target.nodeName.toLowerCase()) {\n\n\t\t// Don't send a synthetic click to disabled inputs (issue #62)\n\t\tcase 'button':\n\t\tcase 'select':\n\t\tcase 'textarea':\n\t\t\tif (target.disabled) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tbreak;\n\t\tcase 'input':\n\n\t\t\t// File inputs need real clicks on iOS 6 due to a browser bug (issue #68)\n\t\t\tif ((deviceIsIOS && target.type === 'file') || target.disabled) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tbreak;\n\t\tcase 'label':\n\t\tcase 'iframe': // iOS8 homescreen apps can prevent events bubbling into frames\n\t\tcase 'video':\n\t\t\treturn true;\n\t\t}\n\n\t\treturn (/\\bneedsclick\\b/).test(target.className);\n\t};\n\n\n\t/**\n\t * Determine whether a given element requires a call to focus to simulate click into element.\n\t *\n\t * @param {EventTarget|Element} target Target DOM element\n\t * @returns {boolean} Returns true if the element requires a call to focus to simulate native click.\n\t */\n\tFastClick.prototype.needsFocus = function(target) {\n\t\tswitch (target.nodeName.toLowerCase()) {\n\t\tcase 'textarea':\n\t\t\treturn true;\n\t\tcase 'select':\n\t\t\treturn !deviceIsAndroid;\n\t\tcase 'input':\n\t\t\tswitch (target.type) {\n\t\t\tcase 'button':\n\t\t\tcase 'checkbox':\n\t\t\tcase 'file':\n\t\t\tcase 'image':\n\t\t\tcase 'radio':\n\t\t\tcase 'submit':\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// No point in attempting to focus disabled inputs\n\t\t\treturn !target.disabled && !target.readOnly;\n\t\tdefault:\n\t\t\treturn (/\\bneedsfocus\\b/).test(target.className);\n\t\t}\n\t};\n\n\n\t/**\n\t * Send a click event to the specified element.\n\t *\n\t * @param {EventTarget|Element} targetElement\n\t * @param {Event} event\n\t */\n\tFastClick.prototype.sendClick = function(targetElement, event) {\n\t\tvar clickEvent, touch;\n\n\t\t// On some Android devices activeElement needs to be blurred otherwise the synthetic click will have no effect (#24)\n\t\tif (document.activeElement && document.activeElement !== targetElement) {\n\t\t\tdocument.activeElement.blur();\n\t\t}\n\n\t\ttouch = event.changedTouches[0];\n\n\t\t// Synthesise a click event, with an extra attribute so it can be tracked\n\t\tclickEvent = document.createEvent('MouseEvents');\n\t\tclickEvent.initMouseEvent(this.determineEventType(targetElement), true, true, window, 1, touch.screenX, touch.screenY, touch.clientX, touch.clientY, false, false, false, false, 0, null);\n\t\tclickEvent.forwardedTouchEvent = true;\n\t\ttargetElement.dispatchEvent(clickEvent);\n\t};\n\n\tFastClick.prototype.determineEventType = function(targetElement) {\n\n\t\t//Issue #159: Android Chrome Select Box does not open with a synthetic click event\n\t\tif (deviceIsAndroid && targetElement.tagName.toLowerCase() === 'select') {\n\t\t\treturn 'mousedown';\n\t\t}\n\n\t\treturn 'click';\n\t};\n\n\n\t/**\n\t * @param {EventTarget|Element} targetElement\n\t */\n\tFastClick.prototype.focus = function(targetElement) {\n\t\tvar length;\n\n\t\t// Issue #160: on iOS 7, some input elements (e.g. date datetime month) throw a vague TypeError on setSelectionRange. These elements don't have an integer value for the selectionStart and selectionEnd properties, but unfortunately that can't be used for detection because accessing the properties also throws a TypeError. Just check the type instead. Filed as Apple bug #15122724.\n\t\tif (deviceIsIOS && targetElement.setSelectionRange && targetElement.type.indexOf('date') !== 0 && targetElement.type !== 'time' && targetElement.type !== 'month') {\n\t\t\tlength = targetElement.value.length;\n\t\t\ttargetElement.setSelectionRange(length, length);\n\t\t} else {\n\t\t\ttargetElement.focus();\n\t\t}\n\t};\n\n\n\t/**\n\t * Check whether the given target element is a child of a scrollable layer and if so, set a flag on it.\n\t *\n\t * @param {EventTarget|Element} targetElement\n\t */\n\tFastClick.prototype.updateScrollParent = function(targetElement) {\n\t\tvar scrollParent, parentElement;\n\n\t\tscrollParent = targetElement.fastClickScrollParent;\n\n\t\t// Attempt to discover whether the target element is contained within a scrollable layer. Re-check if the\n\t\t// target element was moved to another parent.\n\t\tif (!scrollParent || !scrollParent.contains(targetElement)) {\n\t\t\tparentElement = targetElement;\n\t\t\tdo {\n\t\t\t\tif (parentElement.scrollHeight > parentElement.offsetHeight) {\n\t\t\t\t\tscrollParent = parentElement;\n\t\t\t\t\ttargetElement.fastClickScrollParent = parentElement;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tparentElement = parentElement.parentElement;\n\t\t\t} while (parentElement);\n\t\t}\n\n\t\t// Always update the scroll top tracker if possible.\n\t\tif (scrollParent) {\n\t\t\tscrollParent.fastClickLastScrollTop = scrollParent.scrollTop;\n\t\t}\n\t};\n\n\n\t/**\n\t * @param {EventTarget} targetElement\n\t * @returns {Element|EventTarget}\n\t */\n\tFastClick.prototype.getTargetElementFromEventTarget = function(eventTarget) {\n\n\t\t// On some older browsers (notably Safari on iOS 4.1 - see issue #56) the event target may be a text node.\n\t\tif (eventTarget.nodeType === Node.TEXT_NODE) {\n\t\t\treturn eventTarget.parentNode;\n\t\t}\n\n\t\treturn eventTarget;\n\t};\n\n\n\t/**\n\t * On touch start, record the position and scroll offset.\n\t *\n\t * @param {Event} event\n\t * @returns {boolean}\n\t */\n\tFastClick.prototype.onTouchStart = function(event) {\n\t\tvar targetElement, touch, selection;\n\n\t\t// Ignore multiple touches, otherwise pinch-to-zoom is prevented if both fingers are on the FastClick element (issue #111).\n\t\tif (event.targetTouches.length > 1) {\n\t\t\treturn true;\n\t\t}\n\n\t\ttargetElement = this.getTargetElementFromEventTarget(event.target);\n\t\ttouch = event.targetTouches[0];\n\n\t\tif (deviceIsIOS) {\n\n\t\t\t// Only trusted events will deselect text on iOS (issue #49)\n\t\t\tselection = window.getSelection();\n\t\t\tif (selection.rangeCount && !selection.isCollapsed) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (!deviceIsIOS4) {\n\n\t\t\t\t// Weird things happen on iOS when an alert or confirm dialog is opened from a click event callback (issue #23):\n\t\t\t\t// when the user next taps anywhere else on the page, new touchstart and touchend events are dispatched\n\t\t\t\t// with the same identifier as the touch event that previously triggered the click that triggered the alert.\n\t\t\t\t// Sadly, there is an issue on iOS 4 that causes some normal touch events to have the same identifier as an\n\t\t\t\t// immediately preceeding touch event (issue #52), so this fix is unavailable on that platform.\n\t\t\t\t// Issue 120: touch.identifier is 0 when Chrome dev tools 'Emulate touch events' is set with an iOS device UA string,\n\t\t\t\t// which causes all touch events to be ignored. As this block only applies to iOS, and iOS identifiers are always long,\n\t\t\t\t// random integers, it's safe to to continue if the identifier is 0 here.\n\t\t\t\tif (touch.identifier && touch.identifier === this.lastTouchIdentifier) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.lastTouchIdentifier = touch.identifier;\n\n\t\t\t\t// If the target element is a child of a scrollable layer (using -webkit-overflow-scrolling: touch) and:\n\t\t\t\t// 1) the user does a fling scroll on the scrollable layer\n\t\t\t\t// 2) the user stops the fling scroll with another tap\n\t\t\t\t// then the event.target of the last 'touchend' event will be the element that was under the user's finger\n\t\t\t\t// when the fling scroll was started, causing FastClick to send a click event to that layer - unless a check\n\t\t\t\t// is made to ensure that a parent layer was not scrolled before sending a synthetic click (issue #42).\n\t\t\t\tthis.updateScrollParent(targetElement);\n\t\t\t}\n\t\t}\n\n\t\tthis.trackingClick = true;\n\t\tthis.trackingClickStart = event.timeStamp;\n\t\tthis.targetElement = targetElement;\n\n\t\tthis.touchStartX = touch.pageX;\n\t\tthis.touchStartY = touch.pageY;\n\n\t\t// Prevent phantom clicks on fast double-tap (issue #36)\n\t\tif ((event.timeStamp - this.lastClickTime) < this.tapDelay) {\n\t\t\tevent.preventDefault();\n\t\t}\n\n\t\treturn true;\n\t};\n\n\n\t/**\n\t * Based on a touchmove event object, check whether the touch has moved past a boundary since it started.\n\t *\n\t * @param {Event} event\n\t * @returns {boolean}\n\t */\n\tFastClick.prototype.touchHasMoved = function(event) {\n\t\tvar touch = event.changedTouches[0], boundary = this.touchBoundary;\n\n\t\tif (Math.abs(touch.pageX - this.touchStartX) > boundary || Math.abs(touch.pageY - this.touchStartY) > boundary) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t};\n\n\n\t/**\n\t * Update the last position.\n\t *\n\t * @param {Event} event\n\t * @returns {boolean}\n\t */\n\tFastClick.prototype.onTouchMove = function(event) {\n\t\tif (!this.trackingClick) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// If the touch has moved, cancel the click tracking\n\t\tif (this.targetElement !== this.getTargetElementFromEventTarget(event.target) || this.touchHasMoved(event)) {\n\t\t\tthis.trackingClick = false;\n\t\t\tthis.targetElement = null;\n\t\t}\n\n\t\treturn true;\n\t};\n\n\n\t/**\n\t * Attempt to find the labelled control for the given label element.\n\t *\n\t * @param {EventTarget|HTMLLabelElement} labelElement\n\t * @returns {Element|null}\n\t */\n\tFastClick.prototype.findControl = function(labelElement) {\n\n\t\t// Fast path for newer browsers supporting the HTML5 control attribute\n\t\tif (labelElement.control !== undefined) {\n\t\t\treturn labelElement.control;\n\t\t}\n\n\t\t// All browsers under test that support touch events also support the HTML5 htmlFor attribute\n\t\tif (labelElement.htmlFor) {\n\t\t\treturn document.getElementById(labelElement.htmlFor);\n\t\t}\n\n\t\t// If no for attribute exists, attempt to retrieve the first labellable descendant element\n\t\t// the list of which is defined here: http://www.w3.org/TR/html5/forms.html#category-label\n\t\treturn labelElement.querySelector('button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea');\n\t};\n\n\n\t/**\n\t * On touch end, determine whether to send a click event at once.\n\t *\n\t * @param {Event} event\n\t * @returns {boolean}\n\t */\n\tFastClick.prototype.onTouchEnd = function(event) {\n\t\tvar forElement, trackingClickStart, targetTagName, scrollParent, touch, targetElement = this.targetElement;\n\n\t\tif (!this.trackingClick) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Prevent phantom clicks on fast double-tap (issue #36)\n\t\tif ((event.timeStamp - this.lastClickTime) < this.tapDelay) {\n\t\t\tthis.cancelNextClick = true;\n\t\t\treturn true;\n\t\t}\n\n\t\tif ((event.timeStamp - this.trackingClickStart) > this.tapTimeout) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Reset to prevent wrong click cancel on input (issue #156).\n\t\tthis.cancelNextClick = false;\n\n\t\tthis.lastClickTime = event.timeStamp;\n\n\t\ttrackingClickStart = this.trackingClickStart;\n\t\tthis.trackingClick = false;\n\t\tthis.trackingClickStart = 0;\n\n\t\t// On some iOS devices, the targetElement supplied with the event is invalid if the layer\n\t\t// is performing a transition or scroll, and has to be re-detected manually. Note that\n\t\t// for this to function correctly, it must be called *after* the event target is checked!\n\t\t// See issue #57; also filed as rdar://13048589 .\n\t\tif (deviceIsIOSWithBadTarget) {\n\t\t\ttouch = event.changedTouches[0];\n\n\t\t\t// In certain cases arguments of elementFromPoint can be negative, so prevent setting targetElement to null\n\t\t\ttargetElement = document.elementFromPoint(touch.pageX - window.pageXOffset, touch.pageY - window.pageYOffset) || targetElement;\n\t\t\ttargetElement.fastClickScrollParent = this.targetElement.fastClickScrollParent;\n\t\t}\n\n\t\ttargetTagName = targetElement.tagName.toLowerCase();\n\t\tif (targetTagName === 'label') {\n\t\t\tforElement = this.findControl(targetElement);\n\t\t\tif (forElement) {\n\t\t\t\tthis.focus(targetElement);\n\t\t\t\tif (deviceIsAndroid) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\ttargetElement = forElement;\n\t\t\t}\n\t\t} else if (this.needsFocus(targetElement)) {\n\n\t\t\t// Case 1: If the touch started a while ago (best guess is 100ms based on tests for issue #36) then focus will be triggered anyway. Return early and unset the target element reference so that the subsequent click will be allowed through.\n\t\t\t// Case 2: Without this exception for input elements tapped when the document is contained in an iframe, then any inputted text won't be visible even though the value attribute is updated as the user types (issue #37).\n\t\t\tif ((event.timeStamp - trackingClickStart) > 100 || (deviceIsIOS && window.top !== window && targetTagName === 'input')) {\n\t\t\t\tthis.targetElement = null;\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.focus(targetElement);\n\t\t\tthis.sendClick(targetElement, event);\n\n\t\t\t// Select elements need the event to go through on iOS 4, otherwise the selector menu won't open.\n\t\t\t// Also this breaks opening selects when VoiceOver is active on iOS6, iOS7 (and possibly others)\n\t\t\tif (!deviceIsIOS || targetTagName !== 'select') {\n\t\t\t\tthis.targetElement = null;\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\tif (deviceIsIOS && !deviceIsIOS4) {\n\n\t\t\t// Don't send a synthetic click event if the target element is contained within a parent layer that was scrolled\n\t\t\t// and this tap is being used to stop the scrolling (usually initiated by a fling - issue #42).\n\t\t\tscrollParent = targetElement.fastClickScrollParent;\n\t\t\tif (scrollParent && scrollParent.fastClickLastScrollTop !== scrollParent.scrollTop) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\t// Prevent the actual click from going though - unless the target node is marked as requiring\n\t\t// real clicks or if it is in the whitelist in which case only non-programmatic clicks are permitted.\n\t\tif (!this.needsClick(targetElement)) {\n\t\t\tevent.preventDefault();\n\t\t\tthis.sendClick(targetElement, event);\n\t\t}\n\n\t\treturn false;\n\t};\n\n\n\t/**\n\t * On touch cancel, stop tracking the click.\n\t *\n\t * @returns {void}\n\t */\n\tFastClick.prototype.onTouchCancel = function() {\n\t\tthis.trackingClick = false;\n\t\tthis.targetElement = null;\n\t};\n\n\n\t/**\n\t * Determine mouse events which should be permitted.\n\t *\n\t * @param {Event} event\n\t * @returns {boolean}\n\t */\n\tFastClick.prototype.onMouse = function(event) {\n\n\t\t// If a target element was never set (because a touch event was never fired) allow the event\n\t\tif (!this.targetElement) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (event.forwardedTouchEvent) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Programmatically generated events targeting a specific element should be permitted\n\t\tif (!event.cancelable) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Derive and check the target element to see whether the mouse event needs to be permitted;\n\t\t// unless explicitly enabled, prevent non-touch click events from triggering actions,\n\t\t// to prevent ghost/doubleclicks.\n\t\tif (!this.needsClick(this.targetElement) || this.cancelNextClick) {\n\n\t\t\t// Prevent any user-added listeners declared on FastClick element from being fired.\n\t\t\tif (event.stopImmediatePropagation) {\n\t\t\t\tevent.stopImmediatePropagation();\n\t\t\t} else {\n\n\t\t\t\t// Part of the hack for browsers that don't support Event#stopImmediatePropagation (e.g. Android 2)\n\t\t\t\tevent.propagationStopped = true;\n\t\t\t}\n\n\t\t\t// Cancel the event\n\t\t\tevent.stopPropagation();\n\t\t\tevent.preventDefault();\n\n\t\t\treturn false;\n\t\t}\n\n\t\t// If the mouse event is permitted, return true for the action to go through.\n\t\treturn true;\n\t};\n\n\n\t/**\n\t * On actual clicks, determine whether this is a touch-generated click, a click action occurring\n\t * naturally after a delay after a touch (which needs to be cancelled to avoid duplication), or\n\t * an actual click which should be permitted.\n\t *\n\t * @param {Event} event\n\t * @returns {boolean}\n\t */\n\tFastClick.prototype.onClick = function(event) {\n\t\tvar permitted;\n\n\t\t// It's possible for another FastClick-like library delivered with third-party code to fire a click event before FastClick does (issue #44). In that case, set the click-tracking flag back to false and return early. This will cause onTouchEnd to return early.\n\t\tif (this.trackingClick) {\n\t\t\tthis.targetElement = null;\n\t\t\tthis.trackingClick = false;\n\t\t\treturn true;\n\t\t}\n\n\t\t// Very odd behaviour on iOS (issue #18): if a submit element is present inside a form and the user hits enter in the iOS simulator or clicks the Go button on the pop-up OS keyboard the a kind of 'fake' click event will be triggered with the submit-type input element as the target.\n\t\tif (event.target.type === 'submit' && event.detail === 0) {\n\t\t\treturn true;\n\t\t}\n\n\t\tpermitted = this.onMouse(event);\n\n\t\t// Only unset targetElement if the click is not permitted. This will ensure that the check for !targetElement in onMouse fails and the browser's click doesn't go through.\n\t\tif (!permitted) {\n\t\t\tthis.targetElement = null;\n\t\t}\n\n\t\t// If clicks are permitted, return true for the action to go through.\n\t\treturn permitted;\n\t};\n\n\n\t/**\n\t * Remove all FastClick's event listeners.\n\t *\n\t * @returns {void}\n\t */\n\tFastClick.prototype.destroy = function() {\n\t\tvar layer = this.layer;\n\n\t\tif (deviceIsAndroid) {\n\t\t\tlayer.removeEventListener('mouseover', this.onMouse, true);\n\t\t\tlayer.removeEventListener('mousedown', this.onMouse, true);\n\t\t\tlayer.removeEventListener('mouseup', this.onMouse, true);\n\t\t}\n\n\t\tlayer.removeEventListener('click', this.onClick, true);\n\t\tlayer.removeEventListener('touchstart', this.onTouchStart, false);\n\t\tlayer.removeEventListener('touchmove', this.onTouchMove, false);\n\t\tlayer.removeEventListener('touchend', this.onTouchEnd, false);\n\t\tlayer.removeEventListener('touchcancel', this.onTouchCancel, false);\n\t};\n\n\n\t/**\n\t * Check whether FastClick is needed.\n\t *\n\t * @param {Element} layer The layer to listen on\n\t */\n\tFastClick.notNeeded = function(layer) {\n\t\tvar metaViewport;\n\t\tvar chromeVersion;\n\t\tvar blackberryVersion;\n\t\tvar firefoxVersion;\n\n\t\t// Devices that don't support touch don't need FastClick\n\t\tif (typeof window.ontouchstart === 'undefined') {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Chrome version - zero for other browsers\n\t\tchromeVersion = +(/Chrome\\/([0-9]+)/.exec(navigator.userAgent) || [,0])[1];\n\n\t\tif (chromeVersion) {\n\n\t\t\tif (deviceIsAndroid) {\n\t\t\t\tmetaViewport = document.querySelector('meta[name=viewport]');\n\n\t\t\t\tif (metaViewport) {\n\t\t\t\t\t// Chrome on Android with user-scalable=\"no\" doesn't need FastClick (issue #89)\n\t\t\t\t\tif (metaViewport.content.indexOf('user-scalable=no') !== -1) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\t// Chrome 32 and above with width=device-width or less don't need FastClick\n\t\t\t\t\tif (chromeVersion > 31 && document.documentElement.scrollWidth <= window.outerWidth) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t// Chrome desktop doesn't need FastClick (issue #15)\n\t\t\t} else {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tif (deviceIsBlackBerry10) {\n\t\t\tblackberryVersion = navigator.userAgent.match(/Version\\/([0-9]*)\\.([0-9]*)/);\n\n\t\t\t// BlackBerry 10.3+ does not require Fastclick library.\n\t\t\t// https://github.com/ftlabs/fastclick/issues/251\n\t\t\tif (blackberryVersion[1] >= 10 && blackberryVersion[2] >= 3) {\n\t\t\t\tmetaViewport = document.querySelector('meta[name=viewport]');\n\n\t\t\t\tif (metaViewport) {\n\t\t\t\t\t// user-scalable=no eliminates click delay.\n\t\t\t\t\tif (metaViewport.content.indexOf('user-scalable=no') !== -1) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\t// width=device-width (or less than device-width) eliminates click delay.\n\t\t\t\t\tif (document.documentElement.scrollWidth <= window.outerWidth) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// IE10 with -ms-touch-action: none or manipulation, which disables double-tap-to-zoom (issue #97)\n\t\tif (layer.style.msTouchAction === 'none' || layer.style.touchAction === 'manipulation') {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Firefox version - zero for other browsers\n\t\tfirefoxVersion = +(/Firefox\\/([0-9]+)/.exec(navigator.userAgent) || [,0])[1];\n\n\t\tif (firefoxVersion >= 27) {\n\t\t\t// Firefox 27+ does not have tap delay if the content is not zoomable - https://bugzilla.mozilla.org/show_bug.cgi?id=922896\n\n\t\t\tmetaViewport = document.querySelector('meta[name=viewport]');\n\t\t\tif (metaViewport && (metaViewport.content.indexOf('user-scalable=no') !== -1 || document.documentElement.scrollWidth <= window.outerWidth)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\t// IE11: prefixed -ms-touch-action is no longer supported and it's recomended to use non-prefixed version\n\t\t// http://msdn.microsoft.com/en-us/library/windows/apps/Hh767313.aspx\n\t\tif (layer.style.touchAction === 'none' || layer.style.touchAction === 'manipulation') {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t};\n\n\n\t/**\n\t * Factory method for creating a FastClick object\n\t *\n\t * @param {Element} layer The layer to listen on\n\t * @param {Object} [options={}] The options to override the defaults\n\t */\n\tFastClick.attach = function(layer, options) {\n\t\treturn new FastClick(layer, options);\n\t};\n\n\n\tif (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\n\t\t// AMD. Register as an anonymous module.\n\t\tdefine('extensions/adapt-ios-fastclick/js/lib/fastclick',[],function() {\n\t\t\treturn FastClick;\n\t\t});\n\t} else if (typeof module !== 'undefined' && module.exports) {\n\t\tmodule.exports = FastClick.attach;\n\t\tmodule.exports.FastClick = FastClick;\n\t} else {\n\t\twindow.FastClick = FastClick;\n\t}\n}());\n","define('extensions/adapt-ios-fastclick/js/adapt-ios',[\n        './lib/fastclick'\n], function(FastClick) {\n\n    $(function() {\n        FastClick.attach(document.body);\n    });\n\n});\n","define('extensions/adapt-lightbox/js/adapt-lightbox-view',[\r\n\t\"coreJS/adapt\"\r\n], function(Adapt) {\r\n\r\n\tvar defaultConfig = {\r\n\t\t\"_background\": null,\r\n\t};\r\n\r\n\tvar LightboxView = Backbone.View.extend({\r\n\r\n\t\tactiveModel: null,\r\n\t\tactiveConfig: null,\r\n\t\tisLightboxShowing: false,\r\n\t\thasBackground: false,\r\n\t\tisInAnimation: false,\r\n\t\tclassName : \"lightbox-container clearfix notify\",\r\n\t\t_disableAnimations: false,\r\n\r\n\t\tevents : {\r\n\t\t\t'click .close-button': 'onLightboxClose'\r\n\t\t},\r\n\r\n\t\tinitialize : function(){\r\n\r\n\t\t\t_.bindAll(this, 'setupContent', 'setupBackground', 'tearDownContent','tearDownBackground','show','hide', 'scrollTo', 'onShowComplete', 'onHideComplete', 'onResize');\r\n\t\t\tthis._disableAnimations = $('html').is(\".ie8, .iPhone.version-7\\\\.0, .iPad, .iOS, .iPhone\");\r\n\t\t\tthis._isIOS = $('html').is(\".iPad, .iOS, .iPhone\");\r\n\t\t\tthis.setupListeners();\r\n\t\t\tthis.render();\r\n\t\t},\r\n\r\n\t\tsetupListeners : function(){\r\n\t\t\tthis.listenTo(Adapt, 'pageView:ready menuView:ready', this.onLocationReady);\r\n\t\t\tthis.listenTo(Adapt, 'lightbox:show', this.onLightboxShow);\r\n\t\t\tthis.listenTo(Adapt, 'lightbox:close', this.onLightboxClose);\r\n\t\t\tthis.listenTo(Adapt, 'page:scrollTo', this.onWillScrollTo);\r\n\t\t\tthis.listenTo(Adapt, 'remove', this.onRemove);\r\n\r\n\t\t\tthis.listenTo(Adapt, 'articleBlockSlider:begin', this.onArticleBlockSliderBegin);\r\n\t\t\tthis.listenTo(Adapt, 'articleBlockSlider:progress', this.onArticleBlockSliderProgress);\r\n\t\t\tthis.listenTo(Adapt, 'articleBlockSlider:resize', this.onArticleBlockSliderResize);\r\n\t\t\tthis.listenTo(Adapt, 'articleBlockSlider:complete', this.onArticleBlockSliderComplete);\r\n\t\t},\r\n\r\n\t\trender : function(){\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\t\"isIOS\": this._isIOS,\r\n\t\t\t\t\"_globals\": Adapt.course.get(\"_globals\")\r\n\t\t\t};\r\n\t    \tvar template = Handlebars.templates['lightbox'];\r\n\t        this.$el.html(template(data));\r\n\r\n\t        this.setupResizeListeners();\r\n\t\t},\r\n\r\n\t\tsetupResizeListeners: function() {\r\n\t\t\tthis.onResize = _.debounce(this.onResize, 500);\r\n\t\t\t$(window).on(\"resize\", this.onResize);\r\n\t\t\tthis.$(\".lightbox-popup-inner\").on(\"resize\", this.onResize);\r\n\t\t},\r\n\r\n\t\tonLocationReady: function() {\r\n\t\t\tthis.$el.addClass(\"display-none\");\r\n\t\t},\r\n\r\n\t\tonLightboxShow : function(lightboxId, scrollTo, scrollToSettings){\r\n\r\n\t\t\tif(!lightboxId) return;\r\n\t\t\tif (this.isLightboxShowing) return;\r\n\r\n\r\n\t\t\tif (_.indexOf(lightboxId, \" \") > -1) {\r\n\t\t\t\tvar lightboxIds = lightboxId.split(\" \");\r\n\t\t\t\tlightboxId = lightboxIds[0];\r\n\t\t\t\tchildId = lightboxIds[1];\r\n\t\t\t\tAdapt.trigger(\"articleBlockSlider:moveTo\", \".\"+childId);\r\n\t\t\t\t/*Adapt.trigger(\"page:scrollTo\", \".\"+childId);\r\n\t\t\t\tAdapt.trigger(\"page:scrolledTo\", \".\"+childId);*/\r\n\t\t\t} else {\r\n\t\t\t\tAdapt.trigger(\"articleBlockSlider:moveTo\", \".\"+lightboxId);\r\n\t\t\t\t/*Adapt.trigger(\"page:scrollTo\", \".\"+lightboxId);\r\n\t\t\t\tAdapt.trigger(\"page:scrolledTo\", \".\"+lightboxId);*/\r\n\t\t\t}\r\n\r\n\t\t\tthis.isLightboxShowing = true;\r\n\r\n\t\t\tthis.activeModel = Adapt.findById(lightboxId);\r\n\t\t\tthis.activeConfig = _.extend({}, defaultConfig, this.activeModel.get('_lightbox') );\r\n\r\n\t\t\tAdapt.trigger('lightbox:will-show',  this.activeModel);\r\n\r\n\t\t\t$(\"body\").scrollDisable();\r\n\r\n\t\t\tthis.setupContent()\r\n\t\t\t.done(this.setupBackground)\r\n\t\t\t.done(this.show)\r\n\t\t\t.done(_.bind(this.scrollTo, this, scrollTo))\r\n\t\t\t.done(this.onShowComplete);\r\n\t\t},\r\n\r\n\t\tonLightboxClose : function(){\r\n\r\n\t\t\tif (!this.isLightboxShowing) return;\r\n\r\n\t\t\tAdapt.trigger('lightbox:will-hide',  this.activeModel);\r\n\r\n\t\t\t$(\"body\").scrollEnable();\r\n\r\n\t\t\tthis.hide()\r\n\t\t\t.done(this.tearDownBackground)\r\n\t\t\t.done(this.tearDownContent)\r\n\t\t\t.done(this.onHideComplete);\r\n\t\t},\r\n\r\n\r\n\t\tonWillScrollTo : function(selector){\r\n\r\n\t\t\tvar id;\r\n\t\t\tif (selector.selector) {\r\n\t\t\t\tid = selector.selector.replace('.','');\r\n\t\t\t} else {\r\n\t\t\t\tid = selector.replace('.','');\r\n\t\t\t}\r\n\r\n\r\n\t\t\tvar component = Adapt.findById(id);\r\n\r\n\t\t\tvar lightboxParent = component.get('_lightboxParent');\r\n\t\t\tif(!lightboxParent) return;\r\n\r\n\t\t\tAdapt.set(\"_canScroll\", false, {pluginName:\"lightbox\"});\r\n\t\t\tAdapt.trigger('lightbox:show', lightboxParent, selector);\r\n\t\t},\r\n\r\n\t\tsetupBackground : function(){\r\n\r\n\t\t\tvar deferred = $.Deferred();\r\n\r\n\t\t\tvar $img = this.$('.lightbox-popup-background img');\r\n\t\t\tif (this.activeConfig._background && this.activeConfig._background._src) {\r\n\t\t\t\t$img.attr('src', this.activeConfig._background._src);\r\n\t\t\t\tthis.$el.addClass('has-background');\r\n\t\t\t\tthis.hasBackground = true;\r\n\t\t\t\t$img.imageready(deferred.resolve, { allowTimeout:false });\r\n\t\t\t} else {\r\n\t\t\t\t$img.attr('src', '');\r\n\t\t\t\tthis.$el.removeClass('has-background');\r\n\t\t\t\tthis.hasBackground = false;\r\n\t\t\t\tdeferred.resolve();\r\n\t\t\t}\r\n\r\n\r\n\t\t\treturn deferred;\r\n\t\t},\r\n\r\n\t\ttearDownBackground : function(){\r\n\r\n\t\t\tvar deferred = $.Deferred();\r\n\r\n\t\t\tthis.$el.removeClass('has-background');\r\n\r\n\t\t\tvar $background = this.$('.lightbox-popup-background');\r\n\t\t\tvar $backgroundImage = $background.find(\".background-image\");\r\n\t\t\t$backgroundImage.removeAttr(\"style\");\r\n\t\t\tvar $offset = $background.find(\".offset\");\r\n\t\t\t$offset.removeAttr(\"style\");\r\n\r\n\t\t\tvar $img = this.$('.lightbox-popup-background img');\r\n\t\t\t$img.attr('src', \"\").removeAttr(\"style\");\r\n\r\n\t\t\treturn deferred.resolve();\r\n\t\t},\r\n\r\n\t\tsetupContent\t: function(id){\r\n\r\n\t\t\tvar deferred = $.Deferred();\r\n\r\n\t\t\tvar components = this.activeModel.findDescendants('components');\r\n\r\n\t\t\t/*for(var i=0, model;model=components.models[i];i++){\r\n\t\t\t\tmodel.set('_isOptional', false);\r\n\t\t\t}*/\r\n\r\n\t\t\tthis.$('.article-block-container >*').css('display','none');\r\n\r\n\t\t\tvar $activeContent;\r\n\t\t\tif (this.activeModel.get(\"_type\") == \"article\") {\r\n\t\t\t\t$activeContent = this.$('.article-block-container .' +this.activeModel.get('_id'));\r\n\t\t\t\tvar $blocks = $activeContent.find(\".block\");\r\n\t\t\t\t$blocks.css(\"display\", \"inherit\");\r\n\t\t\t} else if (this.activeModel.get(\"_type\") == \"block\") {\r\n\t\t\t\t$activeContent = this.$('.article-block-container .' +this.activeModel.get('_id')).parent();\r\n\t\t\t\tvar $blocks = $activeContent.find(\".block\");\r\n\t\t\t\t$blocks.css(\"display\", \"none\").filter(\".\"+this.activeModel.get('_id')).css(\"display\",\"inherit\");\r\n\t\t\t}\r\n\r\n\t\t\t$activeContent.addClass('active');\r\n\t\t\t$activeContent.css('display','inherit');\r\n\r\n\r\n\r\n\t\t\treturn deferred.resolve();\r\n\t\t},\r\n\r\n\r\n\t\ttearDownContent : function(){\r\n\r\n\t\t\tvar deferred = $.Deferred();\r\n\r\n\t\t\tvar $activeContent;\r\n\t\t\tif (this.activeModel.get(\"_type\") == \"article\") {\r\n\t\t\t\t$activeContent = this.$('.article-block-container .' +this.activeModel.get('_id'));\r\n\t\t\t} else if (this.activeModel.get(\"_type\") == \"block\") {\r\n\t\t\t\t$activeContent = this.$('.article-block-container .' +this.activeModel.get('_id')).parent();\r\n\t\t\t}\r\n\r\n\t\t\t$activeContent.removeClass('active');\r\n\r\n\t\t\treturn deferred.resolve();\r\n\t\t},\r\n\r\n\t\tshow : function(id){\r\n\t\t\tvar deferred = $.Deferred();\r\n\t\t\tvar onDone = _.bind(function() {\r\n\t\t\t\tthis.$('.popup').a11y_focus();\r\n\t\t\t\tdeferred.resolved;\r\n\t\t\t}, this);\r\n\r\n\t\t\tthis.$el.css({\r\n\t\t\t\ttop: 0,\r\n\t\t\t\topacity: 0\r\n\t\t\t});\r\n\t\t\tthis.$el.removeClass(\"display-none\");\r\n\r\n\t\t\t_.delay(_.bind(function() {\r\n\t\t\t\tthis.alignPopup();\r\n\t\t\t\tthis.configureBackground();\r\n\r\n\t\t\t\tvar duration = 600;\r\n\t\t\t\tif (this._disableAnimations) duration = 0;\r\n\r\n\t\t\t\tAdapt.trigger(\"popup:opened\", this.$('.popup'));\r\n\r\n\r\n\t\t\t\tthis.$el.velocity({\r\n\t\t\t\t\topacity:1\r\n\t\t\t\t},{\r\n\t\t\t\t\tcomplete:onDone,\r\n\t\t\t\t\tduration: duration\r\n\t\t\t\t});\r\n\t\t\t}, this), 250);\r\n\r\n\t\t\treturn deferred;\r\n\t\t},\r\n\r\n\t\talignPopup: function(height) {\r\n\r\n\t\t\tthis.$el.removeClass(\"fullscreen\");\r\n\r\n\t\t\tvar size = Adapt.device.screenSize;\r\n\t\t\tif (this.activeConfig._minHeight && this.activeConfig._minHeight[\"_\"+size]) {\r\n\t\t\t\tthis.$el.css({\r\n\t\t\t\t\t\"min-height\":this.activeConfig._minHeight[\"_\"+size]\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tvar popupHeight = height || this.$('.lightbox-popup').outerHeight();\r\n\t\t\tvar windowHeight = $(window).innerHeight();\r\n\r\n\t\t\tvar isFullscreen = this.activeConfig._fullscreen || false;\r\n\t\t\tif (windowHeight < popupHeight && !isFullscreen) {\r\n\t\t\t\tisFullscreen = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (isFullscreen) {\r\n\t\t\t\tthis.$el.addClass(\"fullscreen\");\r\n\t\t\t\tthis.$(\".lightbox-popup-container\").css({\r\n\t\t\t\t\ttop: 0\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tthis.$el.removeClass(\"fullscreen\");\r\n\t\t\t\tthis.$(\".lightbox-popup-container\").css({\r\n\t\t\t\t\ttop: (windowHeight/2) - (popupHeight/2)\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tconfigureBackground: function() {\r\n\t\t\tif (!this.hasBackground) return;\r\n\r\n\t\t\tvar $img = this.$('.lightbox-popup-background img');\r\n\t\t\t$img.backgroundImage({\r\n\t\t\t\t\"size\": this.activeConfig._background._size,\r\n\t\t\t\t\"position\": this.activeConfig._background._position,\r\n\t\t\t\t\"restrict\": this.activeConfig._background._restrict\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\thide : function(id){\r\n\r\n\t\t\tvar deferred = $.Deferred();\r\n\r\n\t\t\tvar onDone = _.bind(function(){\r\n\t\t\t\tthis.$el.css('top', '100%');\r\n\t\t\t\tthis.$el.addClass(\"display-none\");\r\n\t\t\t\tdeferred.resolve();\r\n\t\t\t}, this);\r\n\r\n\t\t\tvar duration = 600;\r\n\t\t\tif (this._disableAnimations) duration = 0;\r\n\r\n\t\t\tAdapt.trigger(\"popup:closed\");\r\n\r\n\t\t\tthis.$el.velocity({\r\n\t\t\t\topacity:0\r\n\t\t\t},{\r\n\t\t\t\tcomplete:onDone,\r\n\t\t\t\tduration:duration\r\n\t\t\t});\r\n\r\n\t\t\treturn deferred;\r\n\t\t},\r\n\r\n\t\tscrollTo : function(selector){\r\n\t\t\tvar deferred = $.Deferred();\r\n\t\t\tif(!selector) return deferred.resolve();\r\n\r\n\t\t\tselector.velocity(\"scroll\", {\r\n\t\t\t\tcontainer: this.$(\".lightbox-popup.popup\"),\r\n\t\t\t\tduration:2000\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tonShowComplete : function(){\r\n\r\n\t\t\tAdapt.trigger('lightbox:did-show',  this.activeModel);\r\n\t\t},\r\n\r\n\t\tonHideComplete : function(){\r\n\r\n\t\t\tAdapt.trigger('lightbox:did-hide',  this.activeModel);\r\n\t\t\tthis.activeModel = null;\r\n\t\t\tthis.activeConfig = null;\r\n\t\t\tthis.isLightboxShowing = false;\r\n\t\t},\r\n\r\n\t\tonResize: function() {\r\n\t\t\tif (!this.isLightboxShowing) return;\r\n\t\t\tif (this.isInAnimation) return;\r\n\t\t\t_.defer(_.bind(function() {\r\n\t\t\t\tif (!this.isLightboxShowing) return;\r\n\t\t\t\tif (this.isInAnimation) return;\r\n\t\t\t\tthis.alignPopup();\r\n\t\t\t\tthis.configureBackground();\r\n\t\t\t}, this));\r\n\t\t},\r\n\r\n\t\tonRemove: function() {\r\n\t\t\tthis.onLightboxClose();\r\n\t\t},\r\n\r\n\t\tonArticleBlockSliderBegin: function() {\r\n\t\t\tthis.isInAnimation = true;\r\n\t\t},\r\n\r\n\t\tonArticleBlockSliderProgress: function() {\r\n\t\t\tif (!this.isLightboxShowing) return;\r\n\t\t\tthis.alignPopup();\r\n\t\t\tthis.configureBackground();\r\n\t\t},\r\n\r\n\t\tonArticleBlockSliderResize: function() {\r\n\t\t\tif (!this.isLightboxShowing) return;\r\n\t\t\tthis.alignPopup();\r\n\t\t\tthis.configureBackground();\r\n\t\t},\r\n\r\n\t\tonArticleBlockSliderComplete: function() {\r\n\t\t\tthis.isInAnimation = false;\r\n\t\t\tif (!this.isLightboxShowing) return;\r\n\t\t\tthis.alignPopup();\r\n\t\t\tthis.configureBackground();\r\n\t\t}\r\n\r\n\t});\r\n\r\n\r\n\treturn LightboxView;\r\n\r\n});\n","define('extensions/adapt-lightbox/js/adapt-lightbox-view-extension',[\n    'coreJS/adapt',\n    'coreViews/pageView', \n    'coreViews/articleView',    \n], function(Adapt, PageView, ArticleView) {\n    \n    var LightBoxViewExtension = {\n\n        addChildren: function() {\n\n            var $lightbox = $(\".lightbox-container .article-block-container\");            \n\n            if (this.model.get(\"_type\") == \"article\") {\n                var $blockContainer = $lightbox.find(\"[name='\"+ this.model.get(\"_id\")+\"']\");\n                if ($blockContainer.length === 0) $blockContainer = $('<div class=\"' + this.model.get(\"_id\") + '\" name=\"' + this.model.get(\"_id\") + '\"></div>' );\n                $lightbox.append( $blockContainer );\n                $lightbox = $blockContainer;\n            }\n            \n            var nthChild = 0;\n            var children = this.model.getChildren();\n            var models = children.models;\n\n            for (var i = 0, len = models.length; i < len; i++) {\n\n                var model = models[i];\n                nthChild ++;\n                var ChildView = this.constructor.childView || Adapt.componentStore[model.get(\"_component\")];\n                \n                if (model.get('_isAvailable')) {\n\n                    var lightboxConfig = model.get(\"_lightbox\");\n                    var $parentContainer;\n\n                    var $childView = new ChildView({model:model}).$el;  \n\n                    if (lightboxConfig && lightboxConfig._isEnabled) {\n\n                        $parentContainer = $lightbox;\n                        $childView.attr(\"name\", model.get(\"_id\"));                        \n\n                        var components = model.findDescendants(\"components\");\n                        _.each(components.models, function(component) {\n\n                            //component.set('_isOptional', true);\n                            component.set('_lightboxParent', model.get('_id'));\n                            \n                            if (component.get(\"_isQuestionType\") && component.get(\"_feedback\") && lightboxConfig._feedback) {                                \n                                component.get(\"_feedback\")._type = lightboxConfig._feedback._type;                                \n                            }\n                        });\n                    } \n                    else {\n                        $parentContainer = this.$(this.constructor.childContainer);\n                    }\n\n                    model.set(\"_nthChild\", nthChild);\n\n                    $parentContainer.append($childView); \n                }\n            }\n        }\n\n    };      \n\n\n\n\n    /*  \n        Here we are extending the pageView in Adapt.\n        This is to accomodate the new functionality on the page.\n        The advantage of this method is that the extension behaviour can utilize all of the predefined page behaviour in both the view.\n    */  \n\n    //Extends core/js/views/pageView.js\n    var ViewInitialize = PageView.prototype.initialize;\n    PageView.prototype.initialize = function(options) {\n        \n        var lightboxExtensions = this.model.getChildren().filter(function(item) {            \n            return item.get(\"_lightbox\") && item.get(\"_lightbox\")._isEnabled;\n        });        \n        if (lightboxExtensions.length > 0) {\n            //extend the pageView with new functionality\n            _.extend(this, LightBoxViewExtension);\n        }\n        //initialize the page in the normal manner\n        return ViewInitialize.apply(this, arguments);\n    };\n\n\n\n\n\n    /*  \n        Here we are extending the articleView in Adapt.\n        This is to accomodate the new functionality on the article.\n        The advantage of this method is that the extension behaviour can utilize all of the predefined article behaviour in both the view.\n    */  \n\n    //Extends core/js/views/articleView.js\n    var ViewInitialize = ArticleView.prototype.initialize;\n    ArticleView.prototype.initialize = function(options) {\n        \n        var lightboxExtensions = this.model.getChildren().filter(function(item) {            \n            return item.get(\"_lightbox\") && item.get(\"_lightbox\")._isEnabled;\n        });        \n        if (lightboxExtensions.length > 0) {\n            //extend the articleView with new functionality\n            _.extend(this, LightBoxViewExtension);\n        }\n        //initialize the page in the normal manner\n        return ViewInitialize.apply(this, arguments);\n    };\n\n\n});\n",";(function( $) {\r\n\r\n\tif ($.fn.haveDimensionsChanged) return;\r\n\r\n\t$.fn.haveDimensionsChanged = function(oldDimensions) {\r\n\t\tif (this.length === 0) return false;\r\n\t\treturn haveDimensionsChanged(this, oldDimensions);\r\n\t};\r\n\r\n\tfunction haveDimensionsChanged($ele, oldDimensions) {\r\n        oldDimensions = oldDimensions || $ele.data(\"dimensions\");\r\n\r\n        var height = $ele.height();\r\n        var width = $ele.width();\r\n        var ratio = width / height;\r\n        var dimensions = {\r\n            \"width\": width,\r\n            \"height\": height,\r\n            \"ratio\": ratio\r\n        };\r\n\r\n        var hasChanged = false;\r\n\r\n        if (oldDimensions) {\r\n            if (oldDimensions.ratio != dimensions.ratio) hasChanged = true;\r\n            else if (oldDimensions.height != dimensions.height) hasChanged = true;\r\n        }\r\n\r\n        if (!hasChanged) return false;\r\n           \r\n        $ele.data(\"dimensions\", dimensions);\r\n\r\n        return true;\r\n\r\n    }\r\n\r\n    $.fn.getDimensions = function(dynamicRatio) {\r\n\t\tif (this.length === 0) return false;\r\n\t\treturn getDimensions(this, dynamicRatio);\r\n\t};\r\n\r\n    function getDimensions($ele, dynamicRatio) {\r\n        var dimensions;\r\n        if (dynamicRatio === undefined) dynamicRatio = false;\r\n        if (!dynamicRatio) {\r\n            dimensions = $ele.data(\"dimensions\");\r\n            if (dimensions) return dimensions;\r\n        }\r\n        var height;\r\n        var width;\r\n        if ($ele.is(\"img\")) {\r\n            height = $ele[0].height;\r\n            width = $ele[0].width;\r\n        } else {\r\n            height = $ele.height();\r\n            width = $ele.width();\r\n        }\r\n        var ratio = width / height;\r\n        var dimensions = {\r\n            \"width\": width,\r\n            \"height\": height,\r\n            \"ratio\": ratio\r\n        };\r\n        if (!dynamicRatio) {\r\n            $ele.data(\"dimensions\", dimensions);\r\n        }\r\n        return dimensions;\r\n    }\r\n\r\n})( jQuery );\ndefine(\"extensions/adapt-lightbox/js/libs/jquery.dimensions\", function(){});\n\n","//https://github.com/cgkineo/jquery.backgroundImage 2015-08-18\r\n\r\n;(function( $ ) {\r\n\r\n    if ($.fn.backgroundImage) return;\r\n\r\n    $.fn.backgroundImage = function(options) {\r\n\r\n        options = options || {};\r\n        if (options.dynamicRatio === undefined) options.dynamicRatio = false;\r\n        if (options.expandContainerHeight === undefined) options.expandContainerHeight = true;\r\n        if (options.expandHeight === undefined) options.expandHeight = undefined;\r\n        if (options.selector === undefined) options.selector = \"img\";\r\n        if (options.restrict === undefined) options.restrict = \"auto auto\";\r\n\r\n        var $images = this.find(options.selector).add( this.filter(options.selector) );\r\n\r\n        if ($images.length === 0) return;\r\n\r\n        $images.each(function() {\r\n            process($(this), options);\r\n        });\r\n\r\n    };\r\n\r\n    function process($image, options) {\r\n        var $offset = $image.parent();\r\n        var $container = $offset.parent();\r\n        var $containerParent = $container.parent();\r\n        \r\n        //reset image and offset\r\n        $offset.css({\r\n            \"height\": \"\",\r\n            \"width\": \"\",\r\n            \"overflow\": \"hidden\",\r\n            \"max-width\": \"100%\",\r\n            \"max-height\": \"100%\"\r\n        });\r\n        $image.css({\r\n            \"top\": \"\",\r\n            \"left\": \"\",\r\n            \"bottom\": \"\",\r\n            \"right\": \"\",\r\n            \"width\": \"\",\r\n            \"height\": \"\",\r\n            \"max-width\": \"100%\",\r\n            \"max-height\": \"100%\"\r\n        });\r\n\r\n        var imageDim = $image.getDimensions(options.dynamicRatio);\r\n\r\n        //set/unset container height if required\r\n        if (options.expandContainerHeight === true) {\r\n            $container.css({\r\n                \"height\": \"100%\"\r\n            });\r\n            if ($containerParent.height() > 0) {\r\n                $container.css({\r\n                    \"height\": $containerParent.height() + \"px\"\r\n                });\r\n            }\r\n        } else if (options.expandContainerHeight === false) {\r\n            $container.css({\r\n                \"height\": \"\"\r\n            });\r\n        }\r\n\r\n        var containerDim = $container.getDimensions(true);\r\n\r\n\r\n        // set offset container to fill the width\r\n        var offsetDimensions = {\r\n            \"width\": \"100%\"\r\n        };        \r\n        \r\n        /* only fill the height if asked in the settings or if the container height is larger than the offset height, \r\n        *  otherwise where content height is generated from the conent image, \r\n        *  100% height is meaningless before the image is in\r\n        */\r\n        if (containerDim.height > $offset.height() && offsetDimensions.height === undefined && options.expandHeight === undefined) {\r\n            options.expandHeight = true;\r\n            offsetDimensions.height = containerDim.height + \"px\";\r\n        }\r\n        //set offset style\r\n        $offset.css(offsetDimensions);\r\n\r\n        //capture body and container fontsize for rem and em calculations\r\n        containerDim['fontSize'] = $container.css(\"font-size\");\r\n        var documentFontSize = $(\"body\").css(\"font-size\");\r\n        \r\n        //setup image for styling\r\n        var imageDimensions = {\r\n            \"max-width\": \"none\",\r\n            \"max-height\": \"none\"\r\n        };\r\n\r\n\r\n        /* check the position variable to set the top left position of the image \r\n        *  inside it's overall container\r\n        */\r\n        var positionsDim;\r\n        if (options.position !== undefined) {\r\n\r\n            //setup image position styles for filling\r\n            $.extend(imageDimensions, {\r\n                \"top\": \"\",\r\n                \"left\": \"\",\r\n                \"bottom\": \"\",\r\n                \"right\": \"\"\r\n            });\r\n\r\n            var positions = (options.position || \"top left\").split(\" \");\r\n\r\n            positionsDim = convertPositions(containerDim, imageDim, {\r\n                \"left\": positions[0], \r\n                \"top\": positions[1], \r\n                \"documentFontSize\": documentFontSize\r\n            });\r\n            imageDimensions.top = positionsDim.top;\r\n            imageDimensions.left = positionsDim.left;\r\n\r\n        }\r\n\r\n        //setup image size styles for filling\r\n        if (options.size !== undefined) {\r\n            $.extend(imageDimensions, {\r\n                \"width\": \"\",\r\n                \"height\": \"\"\r\n            });\r\n        }\r\n\r\n        //setup image size (height / width);\r\n        switch (options.size) {\r\n        case undefined:\r\n        case \"contain\":\r\n            //default to contain if size is undefined, auto auto, or contain\r\n            if (containerDim.ratio < imageDim.ratio) {\r\n                var width = containerDim.width;\r\n                imageDimensions.width = width + \"px\";\r\n                imageDimensions.height = width / imageDim.ratio + \"px\"\r\n            } else {\r\n                var height = containerDim.height;\r\n                imageDimensions.height = height + \"px\";\r\n                imageDimensions.width = height * imageDim.ratio + \"px\"\r\n            }\r\n            break;\r\n\r\n        case \"cover\":\r\n\r\n            if (containerDim.ratio > imageDim.ratio) {\r\n                var width = containerDim.width;\r\n                imageDimensions.width = width + \"px\";\r\n                imageDimensions.height = width / imageDim.ratio + \"px\"\r\n            } else {\r\n                var height = containerDim.height;\r\n                imageDimensions.height = height + \"px\";\r\n                imageDimensions.width = height * imageDim.ratio + \"px\"\r\n            }\r\n            break;\r\n\r\n        default:\r\n            //setup image value styles\r\n            var sizes = (options.size || \"100% auto\").split(\" \");\r\n            var widthSize = sizes[0];\r\n            var heightSize = sizes[1];\r\n\r\n            var dims = convertDimensions(containerDim, imageDim, {\r\n                \"width\": widthSize, \r\n                \"height\": heightSize,\r\n                \"documentFontSize\": documentFontSize\r\n            });\r\n\r\n            imageDimensions.height = dims.height;\r\n            imageDimensions.width = dims.width;\r\n\r\n        }\r\n\r\n        //correct any leftover styles with the image height/width if required\r\n        if (imageDimensions.height === \"auto\") {\r\n            imageDimensions.height = imageDim.height;\r\n        }\r\n\r\n        if (imageDimensions.width === \"auto\") {\r\n            imageDimensions.width = imageDim.width;\r\n        }\r\n\r\n        //restrict the offset container (height/width) if required\r\n        if (options.restrict !== undefined) {\r\n            var restricts = options.restrict.split(\" \");\r\n            \r\n            imageDimensions.ratio = imageDim.ratio;\r\n\r\n            var dims = convertRestricts(containerDim, imageDimensions, {\r\n                \"width\": restricts[0], \r\n                \"height\": restricts[1], \r\n                \"documentFontSize\": documentFontSize\r\n            });\r\n\r\n            offsetDimensions.width = dims.width;\r\n            offsetDimensions.height = dims.height;\r\n\r\n            $offset.css(offsetDimensions);\r\n        }\r\n        \r\n\r\n        var offsetDim = $offset.getDimensions(true);\r\n\r\n        //center, bottom or right align the image inside the offset container\r\n        if (imageDimensions.top === \"center\") {\r\n            var height = imageDimensions.height === undefined ? imageDim.height : parseInt(imageDimensions.height);\r\n            imageDimensions.top = ((offsetDim.height / 2) - (parseFloat(height) / 2)) + \"px\";\r\n        } else if (imageDimensions.top === \"bottom\") {\r\n            var height = imageDimensions.height === undefined ? imageDim.height : parseInt(imageDimensions.height);\r\n            imageDimensions.top = ((offsetDim.height) - (parseFloat(height))) + \"px\";\r\n        }\r\n        if (imageDimensions.left === \"center\") {\r\n            var width = imageDimensions.width === undefined ? imageDim.width : parseFloat(imageDimensions.width);\r\n            imageDimensions.left = ((offsetDim.width / 2) - (parseFloat(width) / 2)) + \"px\";\r\n        } else if (imageDimensions.left === \"right\") {\r\n            var width = imageDimensions.width === undefined ? imageDim.width : parseFloat(imageDimensions.width);\r\n            imageDimensions.left = ((offsetDim.width) - (parseFloat(width))) + \"px\";\r\n        }\r\n\r\n        //apply the style\r\n        $image.css(imageDimensions);\r\n    }\r\n\r\n    function arrayIndexOf(arr, value) {\r\n        if (arr.indexOf) return arr.indexOf(value);\r\n        for (var i = 0, l = arr.length; i < l; i++) {\r\n            if (arr[i] == value) return i;\r\n        }\r\n        return -1;\r\n    }\r\n\r\n    function convertDimensions(container, image, settings) {\r\n        var dim = {\r\n            \"width\": 0,\r\n            \"height\": 0\r\n        };\r\n        if (settings.width === undefined) settings.width = \"auto\";\r\n        if (settings.height === undefined) settings.height = \"auto\";\r\n\r\n        dim.width = convertDimension(container.width, settings.width, container.fontSize, settings.documentFontSize);\r\n        dim.height = convertDimension(container.height, settings.height, container.fontSize, settings.documentFontSize);\r\n\r\n        var autos = {\r\n            \"width\": isAuto(dim.width),\r\n            \"height\": isAuto(dim.height)\r\n        };\r\n\r\n        if (autos.width && autos.height) {\r\n            if (container.ratio < image.ratio) {\r\n                dim.width = container.width + \"px\";\r\n                dim.height = (container.width / image.ratio) + \"px\"\r\n            } else {\r\n                dim.height = container.height + \"px\";\r\n                dim.width = (container.height * image.ratio) + \"px\";\r\n            }\r\n        } else if (autos.width) {\r\n            dim.width = (parseFloat(dim.height) * image.ratio) + \"px\";\r\n        } else if (autos.height) {\r\n            dim.height = (parseFloat(dim.width) / image.ratio) + \"px\";\r\n        }\r\n\r\n        return dim;\r\n\r\n    }\r\n\r\n    function convertDimension(containerValue, settingsValue, containerFontSize, documentFontSize) {\r\n        if (isAuto(settingsValue)) {\r\n            return \"auto\";\r\n        } else if (isPercent(settingsValue)) {\r\n            var val = parseFloat(settingsValue);\r\n            return ((containerValue / 100) * val) + \"px\";\r\n        } else if (isPixel(settingsValue)) {\r\n            return parseFloat(settingsValue) + \"px\";\r\n        } else if (isREM(settingsValue)) {\r\n            return (documentFontSize * parseFloat(settingsValue)) + \"px\";\r\n        } else if (isEM(settingsValue)) {\r\n            return (containerFontSize * parseFloat(settingsValue)) + \"px\";\r\n        }\r\n        return \"auto\";\r\n    }\r\n\r\n    function convertPositions(container, image, settings) {\r\n        var dim = {\r\n            \"left\": 0,\r\n            \"top\": 0\r\n        };\r\n        if (settings.left === undefined) settings.left = \"left\";\r\n        if (settings.top === undefined) settings.top = \"top\";\r\n\r\n        var swapped = false;\r\n        switch (settings.left) {\r\n        case \"top\": case \"bottom\":\r\n            var a = settings.top;\r\n            settings.top = settings.left;\r\n            settings.left = a;\r\n            swapped = true;\r\n        }\r\n\r\n        switch (settings.top) {\r\n        case \"left\": case \"right\":\r\n            if (!swapped) {\r\n                var a = settings.top;\r\n                settings.top = settings.left;\r\n                settings.left = a;\r\n                swapped = true;\r\n            } else {\r\n                settings.top = \"top\";\r\n            }\r\n        }\r\n\r\n        dim.left = convertPosition(container.width, settings.left, container.fontSize, settings.documentFontSize);\r\n        dim.top = convertPosition(container.height, settings.top, container.fontSize, settings.documentFontSize);\r\n\r\n        if (dim.left === \"auto\") dim.left = \"0px\";\r\n        if (dim.top === \"auto\") dim.top = \"0px\";\r\n\r\n        return dim;\r\n    }\r\n\r\n    function convertPosition(containerValue, settingsValue, containerFontSize, documentFontSize) {\r\n        if (isAuto(settingsValue)) {\r\n            return \"auto\";\r\n        } else if (isPercent(settingsValue)) {\r\n            var val = parseFloat(settingsValue);\r\n            return ((containerValue / 100) * val) + \"px\";\r\n        } else if (isPixel(settingsValue)) {\r\n            return parseFloat(settingsValue) + \"px\";\r\n        } else if (isREM(settingsValue)) {\r\n            return (documentFontSize * parseFloat(settingsValue)) + \"px\";\r\n        } else if (isEM(settingsValue)) {\r\n            return (containerFontSize * parseFloat(settingsValue)) + \"px\";\r\n        }\r\n        switch(settingsValue) {\r\n        case \"center\":\r\n            return \"center\";\r\n        case \"top\":\r\n            return \"0px\"\r\n        case \"left\":\r\n            return \"0px\"\r\n        case \"bottom\":\r\n            return \"bottom\";\r\n        case \"right\":\r\n            return \"right\";\r\n        }\r\n        return \"auto\";\r\n    }\r\n\r\n    function convertRestricts(container, image, settings) {\r\n        var dim = {\r\n            \"width\": 0,\r\n            \"height\": 0\r\n        };\r\n        if (settings.width === undefined) settings.width = \"auto\";\r\n        if (settings.height === undefined) settings.height = \"auto\";\r\n\r\n        dim.width = convertDimension(container.width, settings.width, container.fontSize, settings.documentFontSize);\r\n        dim.height = convertDimension(container.height, settings.height, container.fontSize, settings.documentFontSize);\r\n\r\n        var autos = {\r\n            \"width\": isAuto(dim.width),\r\n            \"height\": isAuto(dim.height)\r\n        };\r\n\r\n        if (autos.width && autos.height) {\r\n            dim.height = parseFloat(image.height) + \"px\";\r\n            dim.width =  parseFloat(image.width) + \"px\";\r\n        } else if (autos.width) {\r\n            dim.width = parseFloat(image.width) + \"px\";\r\n        } else if (autos.height) {\r\n            dim.height = parseFloat(image.height) + \"px\";\r\n        }\r\n\r\n        return dim;\r\n\r\n    }\r\n\r\n    function isAuto(value) {\r\n        return (/(auto){1}/gi).test(value);\r\n    }\r\n\r\n    function isRelative(value) {\r\n        return (/^(\\+|\\-){1}/g).text(value);\r\n    }\r\n\r\n    function isPercent(value) {\r\n        return (/\\%{1}/g).test(value);\r\n    }\r\n\r\n    function isPixel(value) {\r\n        return (/(px){1}/gi).test(value);\r\n    }\r\n\r\n    function isREM(value) {\r\n        return (/(rem){1}/gi).test(value);\r\n    }\r\n\r\n    function isEM(value) {\r\n        return (/(em){1}/gi).test(value);\r\n    }\r\n  \r\n\r\n})( jQuery );\r\n\ndefine(\"extensions/adapt-lightbox/js/libs/jquery.backgroundimage\", function(){});\n\n","$(function() {\r\n\r\n\r\n\t\r\n\t$.scrollBarSize = function() {\r\n\t\tvar scrollDiv = $('<div style=\"width: 100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;\"></div>');\r\n\t\t$(\"body\").append(scrollDiv);\r\n\t\tvar scrollBarSize = scrollDiv[0].offsetWidth - scrollDiv[0].clientWidth;\r\n\t\tscrollDiv.remove();\r\n\t\treturn scrollBarSize;\r\n\t};\r\n\t\r\n\r\n});\ndefine(\"extensions/adapt-lightbox/js/libs/jquery.scrollBarSize\", function(){});\n\n","define('extensions/adapt-lightbox/js/adapt-lightbox',[\r\n\t\"coreJS/adapt\",\r\n\t\"./adapt-lightbox-view\",\r\n\t\"./adapt-lightbox-view-extension\",\r\n\t\"./libs/jquery.dimensions\",\r\n\t\"./libs/jquery.backgroundimage\",\r\n\t\"./libs/jquery.scrollBarSize\",\r\n], function(Adapt, LightboxView) {\t\r\n\r\n    Adapt.on(\"app:dataReady\", function() {\r\n\r\n    \tvar _globals = Adapt.course.get(\"_globals\");\r\n        var lightbox = Adapt.course.get(\"_lightbox\");\r\n\r\n    \t//super hacky fix for ios fixed position elements and desktop window scrolling\r\n        var isHackOn =  (lightbox && \r\n                        lightbox._hackOnClasses && \r\n                        $(\"html\").is(lightbox._hackOnClasses));\r\n        var isNoConfig = (!lightbox ||\r\n                        !lightbox._hackOnClasses);\r\n        if (isHackOn || isNoConfig) {\r\n            $(\"html\").addClass(\"lightbox-hack\");\r\n        \tvar $scrollingContainer = $('<div class=\"scrolling-container\"><div class=\"scrolling-inner body\"></div></div>');\r\n            var $scrollingInner = $scrollingContainer.find(\".scrolling-inner\");\r\n        \t$(\"body\").append($scrollingContainer);\r\n        \t$(\"#wrapper\").appendTo($scrollingInner);\r\n        \tvar originalScrollTo = $.fn.scrollTo;\r\n        \t$.fn.scrollTo = function(target, duration, settings) {\r\n        \t\tif (this[0] === window) {\r\n        \t\t\treturn originalScrollTo.apply($(\".scrolling-container\"), arguments);\r\n        \t\t} else {\r\n        \t\t\treturn originalScrollTo.apply(this, arguments);\r\n        \t\t}\r\n        \t};\r\n        \tvar originalScrollTop = $.fn.scrollTop;\r\n        \t$.fn.scrollTop = function() {\r\n        \t\tif (this[0] === window) {\r\n        \t\t\treturn originalScrollTop.apply($(\".scrolling-container\"), arguments);\r\n        \t\t} else {\r\n        \t\t\treturn originalScrollTop.apply(this, arguments);\r\n        \t\t}\r\n        \t};\r\n            var jqueryOffset = $.fn.offset;\r\n            $.fn.offset = function() {\r\n                var offset = jqueryOffset.call(this);\r\n                //console.log(\"fetching offset\", offset.top, offset.left);\r\n                var $stack = this.parents().add(this);\r\n                var $scrollParents = $stack.filter(\".scrolling-container\");\r\n                $scrollParents.each(function(index, item) {\r\n                    var $item = $(item);\r\n                    var scrolltop = parseInt($item.scrollTop());\r\n                    var scrollleft = parseInt($item.scrollLeft());\r\n                    offset.top += scrolltop;\r\n                    offset.left += scrollleft;\r\n                });\r\n                return offset;\r\n            };\r\n            window.scrollTo = function(x,y) {\r\n                //console.log(\"window scrollTo\", x || 0, y || 0);\r\n                $(\".scrolling-container\")[0].scrollTop = y || 0;\r\n                $(\".scrolling-container\")[0].scrollLeft = x || 0;\r\n            };\r\n\r\n            //ios navigation fixed inside scrollable jump fix\r\n            var $navigationContainer = $('<div class=\"navigation-container\"></div>');\r\n            $(\"body\").prepend($navigationContainer);\r\n\r\n            Adapt.once(\"adapt:initialize\", function() {\r\n                $(\".navigation\").prependTo($navigationContainer);\r\n            });\r\n\r\n            //ios rendering glitch fix\r\n            Adapt.on(\"menuView:ready pageView:ready\", function() {\r\n                $(\"html\").removeClass(\"lightbox-hack\");\r\n                _.defer(function() {\r\n                    $(\"html\").addClass(\"lightbox-hack\");                })\r\n            });\r\n            $(\".scrolling-container\").on(\"scroll\", function() {\r\n                $(window).trigger(\"scroll\");\r\n            });\r\n        }\r\n    \t//end of super hacky fix\r\n\r\n    \t$(\"body\").prepend(new LightboxView({\r\n    \t\t_globals: _globals\r\n    \t}).$el);\r\n    });\t\r\n\r\n});\n","/*\n* adapt-menu-controller\n* License - https://github.com/cgkineo/adapt-menu-controller/LICENSE\n* Maintainers - Dan Ghost <daniel.ghost@kineo.com>, Oliver Foster<oliver.foster@kineo.com>\n*/\ndefine('extensions/adapt-menu-controller/js/adapt-menu-controller',['require','coreJS/adapt'],function(require) {\n\n    var Adapt = require('coreJS/adapt');\n\n    var MenuController = Backbone.View.extend({\n\n        initialize: function() {\n            this.listenToOnce(Adapt, \"app:dataReady\", this.onDataReady);\n        },\n\n        onDataReady: function() {\n            \n            //check if any menus have been registered\n            if (_.keys(Adapt.menuStore).length === 0) {\n                console.log(\"No menus registered, using old menu format\");\n            } else {\n                console.log(\"Menus registered, disabling old menu format\");\n                //Adapt.off(\"router:menu\");\n                this.listenTo(Adapt, \"router:menu\", this.onMenu)\n                this.listenTo(Adapt, \"router:page\", this.onPage);\n                this.listenTo(Adapt, \"device:change\", this.onDeviceChange);\n            }\n\n        },\n\n        onMenu: function(model) {\n            this.stopListening(Adapt, \"device:change\", this.onDeviceChange);\n\n            //fetch the type of menu that should be drawn\n            var menuType = model.get('_menuType');\n            menuType = this.compareScreenSize(menuType);\n\n            if (!menuType) {\n                console.log(\"No menu found for this route!\");\n                return;\n            }\n\n            this.listenTo(Adapt, \"device:change\", this.onDeviceChange);\n\n            var MenuView = Adapt.menuStore[menuType];\n            var menuItem = new MenuView({model:model}).$el;\n            $('#wrapper').append(menuItem);\n\n        },\n\n        onPage: function() {\n            this.stopListening(Adapt, \"device:change\", this.onDeviceChange);\n        },\n\n        onDeviceChange: function() {\n            //dynamically change the menu by rerouting to current location\n            var to = window.location.hash == \"\" ? \"#/\" : window.location.hash;\n            Backbone.history.navigate(to, {trigger: true, replace: true});\n        },\n\n        compareScreenSize: function(settings) {\n            if (typeof settings == \"object\") {\n\n                /*\n                    takes:\n\n                    {\n                        \"small medium large\": \"co-30\",\n                        \"medium large\": \"co-25\",\n                        \"small touch\": \"co-19\",\n                        \"small notouch\": \"co-21\"\n                    }\n\n                    or any combination of the small medium and large names\n                    touch and notouch are exclusive parameters\n\n                */\n\n                var found = undefined;\n                for (var screenSize in settings) {\n\n                    var sizes =  screenSize.split(\" \");\n\n                    var isMatchingSize = _.indexOf(sizes, Adapt.device.screenSize) > -1;\n                    var isTouchMenuType = _.indexOf(sizes, \"touch\") > -1;\n                    var isNoTouchMenuType = _.indexOf(sizes, \"notouch\") > -1;\n\n                    if ( isMatchingSize && ((isNoTouchMenuType && !Modernizr.touch) || (!isNoTouchMenuType)) && ((isTouchMenuType && Modernizr.touch) || (!isTouchMenuType)) ) {\n                        found = settings[screenSize];\n                        break;\n                    }\n                }\n                if (found === undefined) return false;\n                \n                return found;\n            }\n\n            //assume settings is a string id \"co-30\"\n            return settings;\n        }\n\n    });\n\n    //Allow menus to store their instanciators, like with components\n    Adapt.menuStore = {};\n    Adapt.registerMenu = function(name, object) {\n        if (Adapt.menuStore[name]) throw Error('This menu already exists in your project');\n\n        Adapt.menuStore[name] = object;\n    }\n\n    Adapt.menuController = new MenuController();\n\n});\n","define('extensions/adapt-navigation-title/js/navigation',[\r\n\t'core/js/adapt'\r\n], function(Adapt) {\r\n\r\n\r\n\r\n\tvar NavigationView = Backbone.View.extend({\r\n\r\n\t\tclassName: function() {\r\n\t\t\treturn [\r\n\t\t\t\t'navigation-title'\r\n\t\t\t].join(\" \");\r\n\t\t},\r\n\r\n\t\ttagName: \"div\",\r\n\r\n\t\tevents: {\r\n\t\t\t\"click button\": \"onClick\"\r\n\t\t},\r\n\r\n\t\tinitialize: function(options) {\r\n\t\t\tthis.parent = options.parent;\r\n\t\t\tthis.setUpEventListeners();\r\n\t\t\tthis.render();\r\n\t\t},\r\n\r\n\t\tsetUpEventListeners: function() {\r\n\t\t\tthis.onScroll = _.debounce(_.bind(this.onScroll, this), 17);\r\n\t\t\t$(window).on(\"scroll\", this.onScroll);\r\n\t\t},\r\n\r\n\t\tonScroll: function() {\r\n\t\t\tif ($(\"html\").is(\".size-large\")) {\r\n\t\t\t\t$(\".navigation\").css({\r\n\t\t\t\t\t\"transform\": \"translateY(0%)\",\r\n\t\t\t\t\t\"-webkit-transform\": \"translateY(0%)\"\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif ($(window).scrollTop() >= 32) {\r\n\t\t\t\t$(\".navigation\").css({\r\n\t\t\t\t\t\"transform\": \"translateY(-100%)\",\r\n\t\t\t\t\t\"-webkit-transform\": \"translateY(-100%)\"\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\t$(\".navigation\").css({\r\n\t\t\t\t\t\"transform\": \"translateY(0%)\",\r\n\t\t\t\t\t\"-webkit-transform\": \"translateY(0%)\"\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\trender: function() {\r\n\t\t\tvar template = Handlebars.templates[this.constructor.template];\r\n\t\t\tthis.$el.append(template(this.model.toJSON()));\r\n\t\t},\r\n\r\n\t\tremove: function() {\r\n\t\t\tthis.parent = null;\r\n\t\t\tBackbone.View.prototype.remove.call(this);\r\n\t\t}\r\n\r\n\t}, {\r\n\t\ttemplate: \"navigation-title\"\r\n\t});\r\n\r\n\treturn NavigationView;\r\n\r\n});\n","define('extensions/adapt-navigation-title/js/adapt-navigation-title',[\r\n    'coreJS/adapt',\r\n    './navigation'\r\n], function(Adapt,NavigationView) {\r\n\r\n    var Nav = Backbone.View.extend({\r\n\r\n        initialize: function() {\r\n            this.listenTo(Adapt, \"remove\", this.remove);\r\n            this.setUpNavigation();\r\n            this.setUpNavigationBackButton();\r\n        },\r\n\r\n        setUpNavigation: function() {\r\n            this.navigationView = new NavigationView({\r\n                model: this.model,\r\n                parent: this\r\n            });\r\n            this.navigationView.$el.insertBefore($(\".navigation-back-button\"));\r\n        },\r\n\r\n        setUpNavigationBackButton: function() {\r\n            var hideBackButton = this.model.get(\"_hideBackButton\");\r\n            if (!hideBackButton) return;\r\n\r\n            $('.navigation-back-button').addClass('display-none');\r\n        },\r\n\r\n        remove: function() {\r\n            this.unsetNavigationBackButton();\r\n            this.removeNavigationView();\r\n            Backbone.View.prototype.remove.call(this);\r\n        },\r\n\r\n        unsetNavigationBackButton: function() {\r\n            var hideBackButton = this.model.get(\"_hideBackButton\");\r\n            if (!hideBackButton) return;\r\n\r\n            $('.navigation-back-button').removeClass('display-none');\r\n        },\r\n\r\n        removeNavigationView: function() {\r\n            if (!this.navigationView) return;\r\n            this.navigationView.remove();\r\n            this.navigationView = null;\r\n        }\r\n\r\n    }, {\r\n        template: 'video-cover'\r\n    });\r\n\r\n    Adapt.on(\"pageView:postRender\", function(view) {\r\n\r\n        if (!view.model.get(\"_navigation-title\")) return;\r\n\r\n        new Nav({model:view.model});\r\n\r\n    });\r\n\r\n});\r\n\n","define('extensions/adapt-pageIncompletePrompt/js/adapt-pageIncompletePrompt',[\n    'coreJS/adapt'\n], function(Adapt) {\n\n\n    var PageIncompletePrompt = _.extend({\n        \n        PLUGIN_NAME: \"_pageIncompletePrompt\",\n\n        handleRoute: true,\n        inPage: false,\n        inPopup: false,\n        pageComponents: null,\n        pageModel: null,\n        routeArguments: null,\n        model: null,\n\n        _ignoreAccessibilityNavigation: false,\n\n        initialize: function() {\n            this.setupEventListeners();\n        },\n\n        setupEventListeners: function() {\n            this.listenToOnce(Adapt, \"app:dataLoaded\", this.setupModel);\n            this.listenTo(Adapt, \"pageView:ready\", this.onPageViewReady);\n            this.listenTo(Adapt, \"pageIncompletePrompt:leavePage\", this.onLeavePage);\n            this.listenTo(Adapt, \"pageIncompletePrompt:cancel\", this.onLeaveCancel);\n            this.listenTo(Adapt, \"router:navigate\", this.onRouterNavigate);\n        },\n\n        setupModel: function() {\n            this.model = Adapt.course.get(this.PLUGIN_NAME);\n            this.listenTo(Adapt, \"accessibility:toggle\", this.onAccessibilityToggle);\n        },\n\n        onPageViewReady: function() {\n            this.inPage = true;\n            this.pageModel = Adapt.findById(Adapt.location._currentId);\n            this.pageComponents = this.pageModel.findDescendants(\"components\").where({\"_isAvailable\": true});\n        },\n\n        onLeavePage: function() {\n            if (!this.inPopup) return;\n            this.inPopup = false;\n\n            this.stopListening(Adapt, \"notify:cancelled\");\n            this.enableRouterNavigation(true);\n            this.handleRoute = false;\n            this.inPage = false;\n\n            Adapt.trigger(\"router:navigateTo\", this.routeArguments);\n\n            this.handleRoute = true;\n        },\n\n        onLeaveCancel: function() {\n            if (!this.inPopup) return;\n            this.inPopup = false;\n            \n            this.stopListening(Adapt, \"notify:cancelled\");\n            this.routeArguments = undefined;\n            this.enableRouterNavigation(true);\n            this.handleRoute = true;\n        },\n\n        onRouterNavigate: function(routeArguments) {\n            \n            if(!this.isEnabled() || this.allComponentsComplete()) return;\n\n            if (routeArguments[0]) {\n                //check if routing to current page child\n                //exit if on same page\n                try {\n                    var id = routeArguments[0];\n                    var model = Adapt.findById(id);\n                    var parent = model.findAncestor(\"contentObjects\");\n                    if (parent.get(\"_id\") == this.pageModel.get(\"_id\")) return;\n                } catch (e) {}\n            }\n\n            if (this._ignoreAccessibilityNavigation) {\n                this._ignoreAccessibilityNavigation = false;\n                return;\n            }\n\n            this.enableRouterNavigation(false)\n            this.routeArguments = routeArguments;\n            this.inPopup = true;\n            \n            var promptObject;\n    \t\tvar pageIncompletePromptConfig = this.pageModel.get(\"_pageIncompletePrompt\");\n    \t\tif (pageIncompletePromptConfig && pageIncompletePromptConfig._buttons) {\n    \t\t\tpromptObject = {\n    \t\t\t\ttitle: pageIncompletePromptConfig.title,\n    \t\t\t\tbody: pageIncompletePromptConfig.message,\n    \t\t\t\t_prompts:[{\n    \t\t\t\t        promptText: pageIncompletePromptConfig._buttons.yes,\n    \t\t\t\t        _callbackEvent: \"pageIncompletePrompt:leavePage\",\n    \t\t\t\t},{\n    \t\t\t\t        promptText: pageIncompletePromptConfig._buttons.no,\n    \t\t\t\t        _callbackEvent: \"pageIncompletePrompt:cancel\"\n    \t\t\t\t}],\n    \t\t\t\t_showIcon: true\n    \t\t\t};\n    \t\t} else {\n    \t\t\tpromptObject = {\n    \t\t\t\ttitle: this.model.title,\n    \t\t\t\tbody: this.model.message,\n    \t\t\t\t_prompts:[{\n    \t\t\t\t        promptText: this.model._buttons.yes,\n    \t\t\t\t        _callbackEvent: \"pageIncompletePrompt:leavePage\",\n    \t\t\t\t},{\n    \t\t\t\t        promptText: this.model._buttons.no,\n    \t\t\t\t        _callbackEvent: \"pageIncompletePrompt:cancel\"\n    \t\t\t\t}],\n    \t\t\t\t_showIcon: true\n    \t\t\t};\n    \t\t}\n\n            this.listenToOnce(Adapt, \"notify:cancelled\", this.onLeaveCancel);\n\n            Adapt.trigger(\"notify:prompt\", promptObject);\n        },\n\n        onAccessibilityToggle: function() {\n            if (Adapt.device.touch) {\n                //accessibility is always on for touch devices\n                //ignore toggle\n                this._ignoreAccessibilityNavigation = false;\n            } else {\n                //skip renavigate for accessibility on desktop\n                this._ignoreAccessibilityNavigation = true;\n            }\n        },\n\n        isEnabled: function() {\n            if (!Adapt.location._currentId) return false;\n            if (!this.handleRoute) return false;\n            if (!this.inPage) return false;\n            if (this.inPopup) return false;\n            \n            switch (Adapt.location._contentType) {\n            case \"menu\": case \"course\":\n                this.inPage = false;\n                return false;\n            }\n            var pageModel = Adapt.findById(Adapt.location._currentId);\n            if (pageModel.get(\"_isOptional\")) return false;\n            var isEnabledForCourse = this.model && !!this.model._isEnabled;\n            var isEnabledForPage = pageModel.get(\"_pageIncompletePrompt\") && !!pageModel.get(\"_pageIncompletePrompt\")._isEnabled;               \n            return (isEnabledForCourse && isEnabledForPage !== false) || isEnabledForPage;\n        },\n\n        allComponentsComplete: function() {\n            \n            if(this.pageComponents === null) return true;\n            \n            for(var i = 0, count = this.pageComponents.length; i < count; i++) {\n                var component  = this.pageComponents[i];\n                var isMandatory = (component.get('_isOptional') === false);\n                var isComplete = component.get(\"_isComplete\");\n            \n                if(isMandatory && !isComplete) return false;   \n            }\n            \n            return true;\n        },\n\n        enableRouterNavigation: function(value) {\n            Adapt.router.set(\"_canNavigate\", value, { pluginName: this.PLUGIN_NAME });\n        }\n\n    }, Backbone.Events);\n\n    PageIncompletePrompt.initialize();\n\n    return PageIncompletePrompt;\n\n});\n\n","/* 2016-04-20 https://github.com/cgkineo/speedtest */\r\n/*!\r\n * JavaScript Cookie v2.1.1\r\n * https://github.com/js-cookie/js-cookie\r\n *\r\n * Copyright 2006, 2015 Klaus Hartl & Fagner Brack\r\n * Released under the MIT license\r\n */\r\n\r\n\r\n(function() {\r\n\r\n\tif (window.speedtest) return;\r\n\r\n//COOKIES\r\n\tfunction extend () {\r\n\t\tvar i = 0;\r\n\t\tvar result = {};\r\n\t\tfor (; i < arguments.length; i++) {\r\n\t\t\tvar attributes = arguments[ i ];\r\n\t\t\tfor (var key in attributes) {\r\n\t\t\t\tresult[key] = attributes[key];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tfunction overlay (a,b) {\r\n\t\tfor (var k in b) {\r\n\t\t\ta[k] = b[k];\r\n\t\t}\r\n\t\treturn a;\r\n\t}\r\n\r\n\tfunction initCookie (converter) {\r\n\t\tfunction api (key, value, attributes) {\r\n\t\t\tvar result;\r\n\t\t\tif (typeof document === 'undefined') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Write\r\n\r\n\t\t\tif (arguments.length > 1) {\r\n\t\t\t\tattributes = extend({\r\n\t\t\t\t\tpath: '/'\r\n\t\t\t\t}, api.defaults, attributes);\r\n\r\n\t\t\t\tif (typeof attributes.expires === 'number') {\r\n\t\t\t\t\tvar expires = new Date();\r\n\t\t\t\t\texpires.setMilliseconds(expires.getMilliseconds() + attributes.expires * 864e+5);\r\n\t\t\t\t\tattributes.expires = expires;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\tresult = JSON.stringify(value);\r\n\t\t\t\t\tif (/^[\\{\\[]/.test(result)) {\r\n\t\t\t\t\t\tvalue = result;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (e) {}\r\n\r\n\t\t\t\tif (!converter.write) {\r\n\t\t\t\t\tvalue = encodeURIComponent(String(value))\r\n\t\t\t\t\t\t.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvalue = converter.write(value, key);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tkey = encodeURIComponent(String(key));\r\n\t\t\t\tkey = key.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent);\r\n\t\t\t\tkey = key.replace(/[\\(\\)]/g, escape);\r\n\r\n\t\t\t\treturn (document.cookie = [\r\n\t\t\t\t\tkey, '=', value,\r\n\t\t\t\t\tattributes.expires && '; expires=' + attributes.expires.toUTCString(), // use expires attribute, max-age is not supported by IE\r\n\t\t\t\t\tattributes.path    && '; path=' + attributes.path,\r\n\t\t\t\t\tattributes.domain  && '; domain=' + attributes.domain,\r\n\t\t\t\t\tattributes.secure ? '; secure' : ''\r\n\t\t\t\t].join(''));\r\n\t\t\t}\r\n\r\n\t\t\t// Read\r\n\r\n\t\t\tif (!key) {\r\n\t\t\t\tresult = {};\r\n\t\t\t}\r\n\r\n\t\t\t// To prevent the for loop in the first place assign an empty array\r\n\t\t\t// in case there are no cookies at all. Also prevents odd result when\r\n\t\t\t// calling \"get()\"\r\n\t\t\tvar cookies = document.cookie ? document.cookie.split('; ') : [];\r\n\t\t\tvar rdecode = /(%[0-9A-Z]{2})+/g;\r\n\t\t\tvar i = 0;\r\n\r\n\t\t\tfor (; i < cookies.length; i++) {\r\n\t\t\t\tvar parts = cookies[i].split('=');\r\n\t\t\t\tvar name = parts[0].replace(rdecode, decodeURIComponent);\r\n\t\t\t\tvar cookie = parts.slice(1).join('=');\r\n\r\n\t\t\t\tif (cookie.charAt(0) === '\"') {\r\n\t\t\t\t\tcookie = cookie.slice(1, -1);\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\tcookie = converter.read ?\r\n\t\t\t\t\t\tconverter.read(cookie, name) : converter(cookie, name) ||\r\n\t\t\t\t\t\tcookie.replace(rdecode, decodeURIComponent);\r\n\r\n\t\t\t\t\tif (this.json) {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tcookie = JSON.parse(cookie);\r\n\t\t\t\t\t\t} catch (e) {}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (key === name) {\r\n\t\t\t\t\t\tresult = cookie;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (!key) {\r\n\t\t\t\t\t\tresult[name] = cookie;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (e) {}\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\tapi.set = api;\r\n\t\tapi.get = function (key) {\r\n\t\t\treturn api(key);\r\n\t\t};\r\n\t\tapi.getJSON = function () {\r\n\t\t\treturn api.apply({\r\n\t\t\t\tjson: true\r\n\t\t\t}, [].slice.call(arguments));\r\n\t\t};\r\n\t\tapi.defaults = {};\r\n\r\n\t\tapi.remove = function (key, attributes) {\r\n\t\t\tapi(key, '', extend(attributes, {\r\n\t\t\t\texpires: -1\r\n\t\t\t}));\r\n\t\t};\r\n\r\n\t\tapi.withConverter = initCookie;\r\n\r\n\t\treturn api;\r\n\t}\r\n\tvar Cookie = initCookie(function () {});\r\n\r\n//DOM MANIPULATION\r\n\tvar $ = {\r\n\r\n\t\tdomloaded: false,\r\n\t\thtml: document.getElementsByTagName(\"html\")[0],\r\n\r\n\t\tdebounce: function(callback, timeout) {\r\n\t\t\tvar timerhandle = null;\r\n\t\t\treturn function() {\r\n\t\t\t\tif (timerhandle) clearTimeout(timerhandle);\r\n\t\t\t\ttimerhandle = setTimeout(function() {\r\n\t\t\t\t\tcallback();\r\n\t\t\t\t}, timeout || 17);\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\tone: function(dom, event, callback) {\r\n\t\t\tdom['_speedtest'+event] = $.callbackOnce(callback, dom);\r\n\t\t\tif (document.addEventListener) {\r\n\t\t\t\tdom.addEventListener(event, dom['_speedtest'+event], false);\r\n\t\t\t} else if (document.attachEvent)  {\r\n\t\t\t\tdom.attachEvent(\"on\"+event, dom['_speedtest'+event]);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\ton: function(dom, event, callback) {\r\n\t\t\tif (document.addEventListener) {\r\n\t\t\t\tdom.addEventListener(event, callback, false);\r\n\t\t\t} else if (document.attachEvent)  {\r\n\t\t\t\tdom.attachEvent(\"on\"+event, callback);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tcallbackOnce: function(callback, dom) {\r\n\t\t\tvar callbackOnce =  function(e) {\r\n\t\t\t\tcallback();\r\n\t\t\t\t$.off(dom, e.type, callbackOnce);\r\n\t\t\t};\r\n\t\t\treturn callbackOnce;\r\n\t\t},\r\n\r\n\t\toff: function(dom, event, callback) {\r\n\t\t\tif (document.addEventListener) {\r\n\t\t\t\tdom.removeEventListener(event, callback);\r\n\t\t\t} else if (document.attachEvent)  {\r\n\t\t\t\tdom.detachEvent(\"on\"+event, callback);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tattr: function(dom, name, value) {\r\n\t\t\tif (value === undefined) {\r\n\t\t\t\treturn dom.getAttribute(name) || \"\";\r\n\t\t\t} else {\r\n\t\t\t\tdom.setAttribute(name, value);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tonDocumentLoaded: function(callback, no_wait_for_document) {\r\n\t\t\tif ($.domloaded) callback();\r\n\t\t\tif (no_wait_for_document) {\r\n\t\t\t\tsetTimeout(callback, no_wait_for_document);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (document.addEventListener) {\r\n\t\t\t\t$.one(document, \"DOMContentLoaded\", callback);\r\n\t\t\t} else if (document.attachEvent)  {\r\n\t\t\t\t$.on(document, \"readystatechange\", function() {\r\n\t\t\t\t\tif (document.readyState == \"interactive\") {\r\n\t\t\t\t\t\tcallback();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\taddClass: function(dom, className) {\r\n\t\t\tvar classNames = $.attr(dom, \"class\").split(\" \");\r\n\t\t\tfor (var i = classNames.length-1, l = -1; i > l; i--) {\r\n\t\t\t\tif (classNames[i].toLowerCase() === className) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (classNames[i] === \"\") {\r\n\t\t\t\t\tclassNames.splice(i,1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tclassNames.push(className);\r\n\t\t\t$.attr(dom, \"class\", classNames.join(\" \"));\r\n\t\t},\r\n\r\n\t\tremoveClass: function(dom, className) {\r\n\t\t\tvar classNames = $.attr(dom, \"class\").split(\" \");\r\n\t\t\tfor (var i = classNames.length-1, l = -1; i > l; i--) {\r\n\t\t\t\tif (classNames[i].toLowerCase() === className) {\r\n\t\t\t\t\tclassNames.splice(i,1);\r\n\t\t\t\t}\r\n\t\t\t\tif (classNames[i] === \"\") {\r\n\t\t\t\t\tclassNames.splice(i,1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t$.attr(dom, \"class\", classNames.join(\" \"));\r\n\t\t}\r\n\t};\r\n\r\n//SPEED TEST\r\n\tvar speedtest = window.speedtest = {\r\n\r\n\t\tkbps: 0,\r\n\t\tlow_kbps: 10000000,\r\n\r\n\t\tconfig: function(config) {\r\n\t\t\tspeedtest.config.imagesURL = config.imagesURL;\r\n\t\t\tspeedtest.config.interval = config.interval || speedtest.config.interval;\r\n\t\t\tspeedtest.config.sample_age = config.sample_age || speedtest.config.sample_age;\r\n\t\t\tspeedtest.config.idle_timeout = config.idle_timeout || speedtest.config.idle_timeout;\r\n\t\t\tspeedtest.config.slow_threshold_kbps = config.slow_threshold_kbps || speedtest.config.slow_threshold_kbps;\r\n\t\t\tspeedtest.config.offline_threshold_kbps = config.offline_threshold_kbps || speedtest.config.offline_threshold_kbps;\r\n\t\t\tspeedtest.config.no_wait_for_document = config.no_wait_for_document || speedtest.config.no_wait_for_document;\r\n\t\t\treturn speedtest;\r\n\t\t},\r\n\r\n\t\ttest: function(callback) {\r\n\r\n\t\t\tfor (var i = 0, l = priv.images.length; i < l; i++) {\r\n\t\t\t\tvar img = priv.images[i];\r\n\t\t\t\timg.url = speedtest.config.imagesURL + \"/\" + img.name;\r\n\t\t\t\tpriv.images[i].index = i;\r\n\t\t\t}\r\n\r\n\t\t\tpriv.bandwidth({\r\n\t\t\t\tcompletedCount: 0,\r\n\t\t\t\tcomplete: function(rate) {\r\n\t\t\t\r\n\t\t\t\t\tvar bytes_per_second = (priv.bytes_per_millisecond) * 1000;\r\n\t\t\t\t\tvar bits_per_second = (bytes_per_second) * 8;\r\n\t\t\t\t\tvar average_kilobits_per_second = (bits_per_second) / 1024;\r\n\r\n\t\t\t\t\tspeedtest.kbps = Math.round(average_kilobits_per_second);\r\n\t\t\t\t\tspeedtest.name = priv.get_speed_name(speedtest.kbps);\r\n\r\n\t\t\t\t\tvar low_name = speedtest.low_name;\r\n\t\t\t\t\tvar low_kbps = speedtest.low_kbps;\r\n\r\n\t\t\t\t\tif (speedtest.kbps < speedtest.low_kbps) {\r\n\t\t\t\t\t\tlow_name = speedtest.name;\r\n\t\t\t\t\t\tlow_kbps = speedtest.kbps;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tpriv.overtime.push({\r\n\t\t\t\t\t\ttimestamp: (new Date()).getTime(),\r\n\t\t\t\t\t\tkbps: speedtest.kbps\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tvar overtime = priv.calculateOvertime();\r\n\t\t\t\t\tif (overtime && overtime.kbps <= speedtest.kbps) {\r\n\t\t\t\t\t\tlow_name = overtime.name;\r\n\t\t\t\t\t\tlow_kbps = overtime.kbps;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tCookie.set(\"speedtest\", JSON.stringify({\r\n\t\t\t\t\t\tlow_name: low_name,\r\n\t\t\t\t\t\tlow_kbps: low_kbps\r\n\t\t\t\t\t}));\r\n\r\n\t\t\t\t\tif (speedtest.low_name && speedtest.low_name !== low_name) {\r\n\t\t\t\t\t\t$.removeClass($.html, \"speedtest-\"+speedtest.low_name);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$.addClass($.html, \"speedtest-\"+low_name);\r\n\t\t\t\t\t\r\n\t\t\t\t\tspeedtest.low_name = low_name;\r\n\t\t\t\t\tspeedtest.low_kbps = low_kbps;\r\n\r\n\t\t\t\t\tif (typeof callback === \"function\") {\r\n\t\t\t\t\t\tcallback.call(speedtest, low_name, low_kbps);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\treturn speedtest;\r\n\t\t},\r\n\r\n\t\tonchange: function(callback, options) {\r\n\r\n\t\t\toptions = options || {};\r\n\t\t\tif (options.immediate === undefined) options.immediate = true;\r\n\t\t\tif (options.on_rate_change === undefined) options.on_rate_change = false;\r\n\r\n\t\t\tpriv.inchange = false;\r\n\r\n\t\t\tif (typeof callback !== \"function\") throw \"onchange requires a callback function\";\r\n\r\n\t\t\tpriv.onchanges.push({\r\n\t\t\t\tcallback: callback,\r\n\t\t\t\toptions: options\r\n\t\t\t});\r\n\t\t\tcallback._speedtestid = priv.uid++;\r\n\r\n\t\t\tpriv.startChangeTimeout(options && options.immediate);\r\n\r\n\t\t\tpriv.onInteraction();\r\n\r\n\t\t\treturn speedtest;\r\n\t\t},\r\n\r\n\t\toffchange: function(callback) {\r\n\t\t\tfor (var i = priv.onchanges.length-1, l = -1; i > l; i--) {\r\n\t\t\t\tif (callback === undefined || priv.onchanges[i].callback._speedtestid === callback._speedtestid) {\r\n\t\t\t\t\tpriv.onchanges.splice(i,1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (priv.onchanges.length === 0) {\r\n\t\t\t\tpriv.finishChangeTimeout();\r\n\t\t\t}\r\n\t\t\treturn speedtest;\r\n\t\t},\r\n\r\n\t\t\r\n\r\n\t};\r\n\r\n//PRIVATE SPEEDTEST\r\n\tvar priv = {\r\n\r\n\t\timgs: [],\r\n\r\n\t\treceived_bytes: 0,\r\n\t\toverall_milliseconds: 0,\r\n\t\tbytes_per_millisecond: 0,\r\n\r\n\t\tmin_timeout: 500, // timeout before cancelling unfinished image downloads\r\n\t\tmax_timeout: 2000,  // timeout before cancelling all image downloads\r\n\t\tallow_timeout: false,\r\n\t\ttimedout: false,\r\n\r\n\t\tonchanges: [],\r\n\t\tchange_timeout: null,\r\n\t\tinteraction_timeout: null,\r\n\t\tuid: 0,\t\t\r\n\r\n\t\tprevious_low_kbps: null,\r\n\t\tprevious_low_name: null,\r\n\r\n\t\tovertime: [],\r\n\r\n\t\timages: [\r\n\t\t\t{\r\n\t\t\t\tname: 'image-0.gif', //to determine latency\r\n\t\t\t\ttype: 'overhead',\r\n\t\t\t\tsize: 35\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: 'image-1.png', //inaccurate but need for slow gprs, 2g, 3g\r\n\t\t\t\ttype: 'minimum',\r\n\t\t\t\tsize: 440\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: 'image-4.png', //more accurate needed for 3g, dsl\r\n\t\t\t\ttype: 'reset',\r\n\t\t\t\tsize: 40836\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: 'image-6.png', //better accuracty for 4g+\r\n\t\t\t\tsize: 381756\r\n\t\t\t}\r\n\t\t],\r\n\r\n\t\tcalculateOvertime: function() {\r\n\t\t\tvar now = (new Date()).getTime();\r\n\r\n\t\t\tvar min_kbps = 1000000000, total_count = 0, total_kbps = 0;\r\n\t\t\tfor (var i = priv.overtime.length -1, l = -1; i > l; i--) {\r\n\t\t\t\tvar ot = priv.overtime[i];\r\n\t\t\t\tif (now - ot.timestamp > speedtest.config.sample_age) {\r\n\t\t\t\t\tpriv.overtime.splice(i,1);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (ot.kbps < min_kbps) min_kbps = ot.kbps;\r\n\t\t\t\t\ttotal_kbps += ot.kbps;\r\n\t\t\t\t\ttotal_count++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (total_count === 0) return;\r\n\r\n\t\t\tvar average_kbps = total_kbps / total_count;\r\n\r\n\t\t\tvar overtime = {};\r\n\t\t\tovertime.kbps = Math.round((min_kbps + average_kbps) / 2);\r\n\t\t\tovertime.name = priv.get_speed_name(overtime.kbps);\r\n\r\n\t\t\treturn overtime;\r\n\r\n\t\t},\r\n\r\n\t\tstartChangeTimeout: function(immediate) {\r\n\r\n\t\t\tif (priv.change_timeout) return;\r\n\r\n\t\t\tif (immediate) {\r\n\t\t\t\tpriv.inchange = true;\r\n\t\t\t\tspeedtest.test(priv.performChange);\r\n\t\t\t}\r\n\r\n\t\t\tpriv.change_timeout = setInterval(function() {\r\n\r\n\t\t\t\tif (priv.inchange) return;\r\n\t\t\t\tpriv.inchange = true;\r\n\r\n\t\t\t\tspeedtest.test(priv.performChange);\r\n\r\n\t\t\t}, speedtest.config.interval);\r\n\t\t},\r\n\r\n\t\tfinishChangeTimeout: function() {\r\n\t\t\tclearInterval(priv.change_timeout);\r\n\t\t\tpriv.change_timeout = null;\r\n\t\t},\r\n\r\n\t\tperformChange: function(rounded_average_kilobits_per_second, speed_name) {\r\n\r\n\t\t\tpriv.inchange = false;\r\n\r\n\t\t\tfor (var i = 0, l = priv.onchanges.length; i < l; i++) {\r\n\t\t\t\tif (priv.previous_low_name !== null && priv.previous_low_name === speedtest.low_name && !priv.onchanges[i].options.on_rate_change) continue;\r\n\t\t\t\tif (priv.previous_low_kbps !== null && priv.previous_low_kbps === speedtest.low_kbps) continue;\r\n\t\t\t\tpriv.onchanges[i].callback(speedtest.low_name, speedtest.low_kbps);\r\n\t\t\t}\r\n\r\n\t\t\tpriv.previous_low_name = speedtest.low_name;\r\n\t\t\tpriv.previous_low_kbps = speedtest.low_kbps;\r\n\r\n\t\t},\r\n\r\n\t\tget_speed_name: function(rounded_average_kilobits_per_second) {\r\n\t\t\tif (speedtest.config.offline_threshold_kbps >= rounded_average_kilobits_per_second) return \"offline\";\r\n\t\t\tif (speedtest.config.slow_threshold_kbps >= rounded_average_kilobits_per_second) return \"slow\";\r\n\t\t\treturn \"fast\";\r\n\t\t},\r\n\r\n\t\tbandwidth: function(options) {\r\n\t\t\tvar start = (new Date()).getTime();\r\n\r\n\t\t\tpriv.overall_milliseconds = 0;\r\n\t\t\tpriv.received_bytes = 0;\r\n\t\t\tpriv.timedout = false;\r\n\t\t\tpriv.cancelled = false;\r\n\t\t\tpriv.allow_timeout = false;\r\n\t\t\tpriv.bytes_per_millisecond = 0;\r\n\t\t\toptions.completed = false;\r\n\r\n\t\t\tif ($.domloaded) run();\r\n\t\t\telse $.onDocumentLoaded(run, speedtest.config.no_wait_for_document);\r\n\r\n\t\t\tfunction run() {\r\n\t\t\t\tpriv.bandwidth_unit({\r\n\t\t\t\t\timageIndex: 0,\r\n\t\t\t\t\tcomplete: function(image) {\r\n\t\t\t\t\t\tpriv.bandwidth_count.call(speedtest, options, image)\r\n\t\t\t\t\t\tfor (var i = 1, l = priv.images.length; i < l; i++) {\r\n\t\t\t\t\t\t\tpriv.bandwidth_unit({\r\n\t\t\t\t\t\t\t\timageIndex: i,\r\n\t\t\t\t\t\t\t\tcomplete: function(image) {\r\n\t\t\t\t\t\t\t\t\tpriv.bandwidth_count.call(speedtest, options, image)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\t\tif (priv.timedout) return;\r\n\t\t\t\t\t\t\tpriv.timedout = true;\r\n\t\t\t\t\t\t\tif (priv.allow_timeout) {\r\n\t\t\t\t\t\t\t\tpriv.cancelled = true;\r\n\t\t\t\t\t\t\t\tpriv.bandwidth_complete.call(speedtest, options);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, priv.min_timeout);\r\n\t\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\t\tif (priv.cancelled) return;\r\n\t\t\t\t\t\t\tpriv.cancelled = true;\r\n\t\t\t\t\t\t\tpriv.bandwidth_complete.call(speedtest, options);\r\n\t\t\t\t\t\t}, priv.max_timeout);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\t\t\r\n\t\t},\r\n\r\n\t\tbandwidth_unit: function(imageOptions) {\r\n\t\t\tfunction load() {\r\n\t\t\t\tvar finish = (new Date()).getTime();\r\n\t\t\t\timage.error = false;\r\n\t\t\t\timage.milliseconds = finish-start;\r\n\t\t\t\timageOptions.complete.call(speedtest, image);\r\n\t\t\t}\r\n\t\t\tfunction error() {\r\n\t\t\t\tvar finish = (new Date()).getTime();\r\n\t\t\t\timage.error = true;\r\n\t\t\t\timage.milliseconds = 100000000;\r\n\t\t\t\timageOptions.complete.call(speedtest, image);\r\n\t\t\t}\r\n\r\n\t\t\tvar image = priv.images[imageOptions.imageIndex];\r\n\t\t\tvar img = document.createElement(\"img\");\r\n\t\t\tvar start = (new Date()).getTime();\r\n\r\n\t\t\t$.one(img, \"load\", load);\r\n\t\t\t$.one(img, \"error\", error);\r\n\r\n\t\t\tpriv.imgs.push(img);\r\n\t\t\timg.setAttribute(\"src\", image.url + \"?t=\"+start);\t\t\t\r\n\t\t},\r\n\r\n\t\tbandwidth_count: function(options, image, force) {\r\n\t\t\toptions.completedCount++;\r\n\r\n\t\t\tif (image.error) {\r\n\t\t\t\tpriv.overall_milliseconds = 0;\r\n\t\t\t\tpriv.received_bytes = 0;\r\n\r\n\t\t\t\tpriv.bytes_per_millisecond = 0;\r\n\t\t\t\treturn priv.bandwidth_complete(options);\r\n\t\t\t}\r\n\r\n\t\t\tif (image.type === \"overhead\") {\r\n\t\t\t\tpriv.overhead_milliseconds = image.milliseconds;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tpriv.allow_timeout = true;\r\n\r\n\t\t\tif (image.type === \"reset\") {\r\n\t\t\t\tpriv.overall_milliseconds = 0;\r\n\t\t\t\tpriv.received_bytes = 0;\r\n\t\t\t}\r\n\r\n\t\t\tvar milliseconds = image.milliseconds - priv.overhead_milliseconds;\r\n\t\t\tif (milliseconds < 0) {\r\n\t\t\t\tmilliseconds = Math.abs(milliseconds);\r\n\t\t\t}\r\n\r\n\t\t\tpriv.overall_milliseconds += milliseconds;\r\n\t\t\tpriv.received_bytes += image.size;\r\n\r\n\t\t\tpriv.bytes_per_millisecond = priv.received_bytes / priv.overall_milliseconds;\r\n\r\n\t\t\tif (priv.timedout) return priv.bandwidth_complete(options);\r\n\r\n\t\t\tif (image.type === \"minimum\") {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (options.completedCount === priv.images.length || force) {\r\n\t\t\t\tpriv.bandwidth_complete(options);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tbandwidth_complete: function(options) {\r\n\t\t\tif (options.completed) return;\r\n\t\t\toptions.completed = true;\r\n\r\n\t\t\tfor (var i = 0, l = priv.imgs.length; i < l; i++) {\r\n\t\t\t\tvar img = priv.imgs[i];\r\n\t\t\t\t$.off(img, \"load\", img._speedtestload);\r\n\t\t\t\t$.off(img, \"error\", img._speedtesterror);\r\n\t\t\t\t$.attr(img, \"src\",\"\");\t\r\n\t\t\t}\r\n\r\n\t\t\tpriv.imgs = [];\r\n\r\n\t\t\tif (typeof options.complete === \"function\") {\r\n\t\t\t\toptions.complete();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tonInteraction: function() {\r\n\t\t\tvar now = (new Date()).getTime();\r\n\r\n\t\t\tvar immediate = false;\r\n\t\t\tif (now - priv.last_interaction > speedtest.min_timeout) {\r\n\t\t\t\timmediate = true;\r\n\t\t\t}\r\n\r\n\t\t\tpriv.last_interaction = now;\r\n\r\n\t\t\tclearTimeout(priv.interaction_timeout);\r\n\t\t\tpriv.interaction_timeout = setTimeout(priv.finishChangeTimeout, speedtest.config.idle_timeout);\r\n\r\n\t\t\tpriv.startChangeTimeout(immediate);\r\n\t\t}\r\n\r\n\t};\r\n\r\n\r\n//INITIALIZATION\r\n\toverlay(speedtest.config, {\r\n\t\timagesURL: null, //location of sample images\r\n\t\tinterval: 20000, // milliseconds between checks (20sec)\r\n\t\tsample_age: 60000, // take lowest speed in latest timeslice (1min)\r\n\t\tidle_timeout: 60000, // time before idle state (1min)\r\n\t\toffline_threshold_kbps: 0,\r\n\t\tslow_threshold_kbps: 1000,\r\n\t\tno_wait_for_document: false\r\n\t});\r\n\r\n\t$.on(document, \"click\", priv.onInteraction);\r\n\t$.on(document, \"keyup\", priv.onInteraction);\r\n\t$.on(document, \"scroll\", $.debounce(priv.onInteraction, 250));\r\n\r\n\t$.onDocumentLoaded(function() {\r\n\t\t$.domloaded = true;\r\n\t}, speedtest.config.no_wait_for_document);\r\n\r\n\tvar cookie = Cookie.get(\"speedtest\");\r\n\tif (cookie) {\r\n\t\t//restore previous class on load\r\n\r\n\t\tcookie = JSON.parse(cookie);\r\n\t\tspeedtest.low_name = cookie.low_name;\r\n\t\tspeedtest.low_kbps = cookie.low_kbps;\r\n\r\n\t\t$.addClass($.html, \"speedtest-\"+speedtest.low_name);\r\n\r\n\t} else {\r\n\t\t//start slow\r\n\r\n\t\tspeedtest.low_name = \"slow\";\r\n\t\tspeedtest.low_kbps = 25;\r\n\t\t$.addClass($.html, \"speedtest-slow\");\r\n\t}\r\n\r\n})();\ndefine(\"extensions/adapt-speedtest/js/speedtest.min\", function(){});\n\n","define('extensions/adapt-speedtest/js/adapt-speedtest',[\r\n    'coreJS/adapt',\r\n    './speedtest.min',\r\n],function(Adapt, SpeedTest) {\r\n\r\n    speedtest.config({\r\n        imagesURL: \"assets/speedtest\",\r\n        no_wait_for_document: 1,\r\n        interval: 20000, // milliseconds between checks (20sec)\r\n        sample_age: 60000, // take lowest speed in latest timeslice (1min)\r\n        idle_timeout: 60000, // time before idle state (1min)\r\n        offline_threshold_kbps: 0,\r\n        slow_threshold_kbps: 2000,\r\n    });\r\n\r\n    Adapt.once('configModel:dataLoaded', function(view) {\r\n\r\n        if (Adapt.config.get(\"_speedtest\") && Adapt.config.get(\"_speedtest\")._isEnabled === false) {\r\n            speedtest.low_kbps = speedtest.kbps = 100000000;\r\n            speedtest.low_name = speedtest.name = \"fast\";\r\n            $(\"html\").removeClass(\"speedtest-slow\").addClass(\"speedtest-fast\");\r\n            console.log(\"speedtest disabled\", speedtest.name, speedtest.kbps);\r\n            return;\r\n        }\r\n\r\n        var url = document.createElement(\"a\");\r\n        url.href = window.location.href;\r\n        if (url.search.indexOf(\"speedtest=slow\") > -1) {\r\n            speedtest.low_kbps = speedtest.kbps = 400;\r\n            speedtest.low_name = speedtest.name = \"slow\";\r\n            $(\"html\").addClass(\"speedtest-slow\").removeClass(\"speedtest-fast\");\r\n            console.log(\"speedtest force\", speedtest.name, speedtest.kbps);\r\n            return;\r\n        } else if (url.search.indexOf(\"speedtest=fast\") > -1) {\r\n            speedtest.low_kbps = speedtest.kbps = 100000000;\r\n            speedtest.low_name = speedtest.name = \"fast\";\r\n            $(\"html\").removeClass(\"speedtest-slow\").addClass(\"speedtest-fast\");\r\n            console.log(\"speedtest force\", speedtest.name, speedtest.kbps);\r\n            return;\r\n        }\r\n\r\n\r\n        Adapt.config.set('_canLoadData', false);\r\n\r\n        var continued = false;\r\n\r\n        speedtest.onchange(function(name, kbps) {\r\n            console.log(\"speedtest\", name, kbps);\r\n\r\n            Adapt.trigger(\"network:change\", name, kbps);\r\n\r\n            if (continued) return;\r\n            continued = true;\r\n            _.defer(function() {\r\n                Adapt.trigger('configModel:loadCourseData');\r\n            });\r\n        },{\r\n            immediate: true, // (default: true) callback once bound\r\n            on_rate_change: true  // (default: false) callback on kbps change and connection name change\r\n        });\r\n\r\n    });\r\n\r\n});\r\n\n","define('extensions/adapt-tutor/js/tutorOverlay',[\r\n\t'coreJS/adapt'\r\n], function(Adapt) {\r\n\r\n\r\n\tvar TutorOverlay = Backbone.View.extend({\r\n\r\n\t\tevents: {\r\n\t\t\t\"click .close-button, .close-button-text\": \"onCloseClick\"\r\n\t\t},\r\n\r\n\t\tinitialize: function () {\r\n\t\t\tthis._onTutorOpened = _.bind(this.onTutorOpened, this);\r\n\t\t\tthis._onTutorClosed = _.bind(this.onTutorClosed, this);\r\n\t\t\tthis.listenTo(Adapt, \"remove\", this._onTutorClosed);\r\n\t\t\tthis.listenTo(Adapt, \"close\", this._onTutorClosed);\r\n\t\t\tthis.render();\r\n\t\t},\r\n\r\n\t\trender: function() {\r\n\t\t\tvar alertObject = {\r\n                title: this.model.get(\"feedbackTitle\"),\r\n                body: this.model.get(\"feedbackMessage\"),\r\n                _feedback: this.model.get(\"_feedback\")\r\n            };\r\n\r\n\t\t\tvar $componentInner = this.$(\".component-inner\");\r\n\t\t\tvar $tutorOvelay = $(Handlebars.templates[\"tutor-overlay\"](alertObject));\r\n            $componentInner.append($tutorOvelay);\r\n\r\n            $tutorOvelay.find(\".tutor-overlay\").velocity(\"stop\").velocity({\r\n            \t\"opacity\": 0\r\n            }, {\r\n            \t\"duration\": 0,\r\n            \t\"display\": \"block\"\r\n            }).velocity({\r\n            \t\"opacity\": 1\r\n            }, {\r\n            \t\"duration\": 600,\r\n            \t\"complete\": this._onTutorOpened\r\n            });\r\n\r\n\t\t},\r\n\r\n\t\tonTutorOpened: function() {\r\n\t\t\tAdapt.trigger(\"popup:opened\", this.$(\".tutor-overlay\"));\r\n\t\t},\r\n\r\n\t\tonTutorClosed: function() {\r\n            \t\t\r\n    \t\tthis.$(\".tutor-container\").remove();\r\n    \t\tAdapt.trigger(\"popup:closed\");\r\n\r\n    \t\tthis.stopListening();\r\n    \t\tthis.undelegateEvents();\r\n\r\n\r\n    \t},\r\n\r\n\t\tonCloseClick: function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\te.stopPropagation();\r\n\t\t\tthis.$(\".tutor-overlay\").velocity(\"stop\").velocity({\r\n            \t\"opacity\": 0\r\n            }, {\r\n            \t\"duration\": 600,\r\n            \t\"complete\": this._onTutorClosed\r\n            });\r\n\t\t}\r\n\r\n\t});\r\n\r\n\treturn TutorOverlay;\r\n\r\n});\n","/*\r\n * adapt-contrib-tutor\r\n * License - http://github.com/adaptlearning/adapt_framework/blob/master/LICENSE\r\n * Maintainers - Kevin Corry <kevinc@learningpool.com>, Daryl Hedley <darylhedley@hotmail.com>,\r\n *               Himanshu Rajotia <himanshu.rajotia@exultcorp.com>\r\n */\r\ndefine('extensions/adapt-tutor/js/adapt-tutor',[\r\n    'coreJS/adapt',\r\n    './tutorOverlay'\r\n],function(Adapt, TutorOverlay) {\r\n\r\n    Adapt.on('questionView:showFeedback', function(view) {\r\n        \r\n        if (!view.model.get(\"_feedback\")) return;\r\n        \r\n        switch (view.model.get(\"_feedback\")._type) {\r\n        case \"overlay\":\r\n\r\n            var tutorOverlay = new TutorOverlay({model:view.model, el:view.el});\r\n\r\n            break;\r\n        case \"notify\":\r\n        default:\r\n\r\n            var alertObject = {\r\n                title: view.model.get(\"feedbackTitle\"),\r\n                body: view.model.get(\"feedbackMessage\")\r\n            };\r\n\r\n            if (view.model.has('_isCorrect')) {\r\n                // Attach specific classes so that feedback can be styled.\r\n                if (view.model.get('_isCorrect')) {\r\n                    alertObject._classes = 'correct';\r\n                } else {\r\n                    if (view.model.has('_isAtLeastOneCorrectSelection')) {\r\n                        // Partially correct feedback is an option.\r\n                        alertObject._classes = view.model.get('_isAtLeastOneCorrectSelection')\r\n                            ? 'partially-correct'\r\n                            : 'incorrect';\r\n                    } else {\r\n                        alertObject._classes = 'incorrect';\r\n                    }\r\n                }\r\n            }\r\n\r\n            Adapt.once(\"notify:closed\", function() {\r\n                Adapt.trigger(\"tutor:closed\");\r\n            });\r\n\r\n            Adapt.trigger('notify:popup', alertObject);\r\n\r\n            Adapt.trigger('tutor:opened');\r\n            \r\n            break;\r\n        }\r\n\r\n    });\r\n\r\n});\r\n\n","/*\r\n* adapt-contrib-article-reveal\r\n* License - http://github.com/adaptlearning/adapt_framework/LICENSE\r\n* Maintainers - Stuart Nicholls <stuart@stuartnicholls.com>, Mohammed Salamat Ali <Mohammed.SalamatAli@kineo.com>\r\n*/\r\ndefine('components/adapt-article-reveal/js/adapt-article-reveal',[\r\n    'core/js/adapt'\r\n], function(Adapt) {\r\n\r\n    var ArticleRevealView = Backbone.View.extend({\r\n\r\n        className: \"article-reveal\",\r\n\r\n        events: {\r\n            \"click .article-reveal-open-button\":\"revealArticle\",\r\n            \"click .article-reveal-close-button\":\"closeArticle\"\r\n        },\r\n\r\n        initialize: function () {\r\n\t\t\tif (this.model.get('_articleReveal') && this.model.get('_articleReveal')._isEnabled) {\r\n\t\t\t\tthis.render();\r\n\t\t\t\tthis.setup();\r\n\t\t\t\tthis.listenTo(Adapt, \"remove\", this.remove);\r\n\t\t\t\tthis.listenTo(Adapt, 'device:changed', this.setDeviceSize);\r\n\t\t\t\tAdapt.on(\"page:scrollTo\", _.bind(this.onProgressBarScrollTo, this));\r\n\t\t\t}\r\n        },\r\n\r\n        render: function () {\r\n            var data = this.model.toJSON();\r\n            var template = Handlebars.templates[\"adapt-article-reveal\"];\r\n            $(this.el).html(template(data)).prependTo('.' + this.model.get(\"_id\"));\r\n\r\n            var incomplete = this.model.findDescendants(\"components\").where({_isComplete:false});\r\n            if (incomplete.length === 0) this.setOpenButtonState();\r\n\r\n            return this;\r\n        },\r\n\r\n        setup: function(event) {\r\n            if (event) event.preventDefault();\r\n            //prevent drag on buttons\r\n            this.preventDrag();\r\n\r\n            //hide articles\r\n            var $articleInner = $(\".\" + this.model.get(\"_id\") + \" > .article-inner \");\r\n\r\n            var incomplete = this.model.findDescendants(\"components\").where({_isComplete:false});\r\n            if (incomplete.length > 0){\r\n                $articleInner.css({display:\"none\"});\r\n\r\n                //hide the components inside the article\r\n                this.toggleisVisible( false );\r\n            }\r\n            this.setDeviceSize();\r\n        },\r\n\r\n        setDeviceSize: function() {\r\n            if (Adapt.device.screenSize === 'large' || Adapt.device.screenSize === 'medium') {\r\n                this.$el.addClass('desktop').removeClass('mobile');\r\n                this.model.set('_isDesktop', true);\r\n            } else {\r\n                this.$el.addClass('mobile').removeClass('desktop');\r\n                this.model.set('_isDesktop', false);\r\n            }\r\n            this.render();\r\n        },\r\n\r\n        setOpenButtonState: function() {\r\n            this.$(\".article-reveal-open-button\").addClass('visited show');\r\n            this.$(\".article-reveal-close-button\").addClass('show');\r\n        },\r\n\r\n        setClosedButtonState: function() {\r\n            this.$(\".article-reveal-open-button\").removeClass('show');\r\n        },\r\n\r\n        closeArticle: function(event) {\r\n            if (event) event.preventDefault();\r\n\r\n            this.setClosedButtonState();\r\n\r\n            //animate Close..\r\n            // this.$(\".article-reveal-close-button\").velocity(\"fadeOut\", 500);\r\n\r\n            //..and set components to isVisible false\r\n            this.$el.siblings(\".article-inner\").velocity(\"slideUp\", 600, _.bind(function() {\r\n                this.toggleisVisible(false);\r\n            }, this));\r\n            this.$el.velocity(\"scroll\", {\r\n                duration: 600,\r\n                offset: -$(\".navigation\").outerHeight()\r\n            });\r\n            this.$(\".article-reveal-open-button\").focus();\r\n            this.$(\".article-reveal-close-button\").removeClass('show');\r\n        },\r\n\r\n        revealArticle: function(event) {\r\n            if (event) event.preventDefault();\r\n            if(this.$el.closest(\".article\").hasClass(\"locked\")) return; // in conjunction with pageLocking\r\n\r\n            this.setOpenButtonState();\r\n\r\n            //animate reveal\r\n            Adapt.trigger(\"article:revealing\", this);\r\n            this.$el.siblings(\".article-inner\").velocity(\"slideDown\", 800, _.bind(function() {\r\n                Adapt.trigger(\"article:revealed\", this);\r\n                // Call window resize to force components to rerender -\r\n                // fixes components that depend on being visible for setting up layout\r\n                $(window).resize();\r\n            }, this));\r\n            this.$el.velocity(\"scroll\", {\r\n                delay: 400,\r\n                duration: 800,\r\n                offset: this.$el.height() - $(\".navigation\").outerHeight()\r\n            });\r\n            // this.$(\".article-reveal-close-button\").velocity(\"fadeIn\", {\r\n            //     delay: 400,\r\n            //     duration: 500\r\n            // });\r\n\r\n            //set components to isVisible true\r\n            this.toggleisVisible(true);\r\n        },\r\n\r\n        /**\r\n         * Toggles the visibility of the components inside the article\r\n         */\r\n        toggleisVisible: function(view) {\r\n            var allComponents = this.model.findDescendants('components');\r\n            allComponents.each(function(component) {\r\n                component.setLocking(\"_isVisible\", false);\r\n                component.set('_isVisible', view, {\r\n                    pluginName:\"_articleReveal\"\r\n                });\r\n            });\r\n        },\r\n\r\n        preventDrag: function() {\r\n            $(\".article-reveal-open-button\").on(\"dragstart\", function(event) {\r\n                event.preventDefault();\r\n            });\r\n            $(\".article-reveal-close-button\").on(\"dragstart\", function(event) {\r\n                event.preventDefault();\r\n            });\r\n        },\r\n\r\n        // Handles the Adapt page scrollTo event\r\n        onProgressBarScrollTo: function(componentSelector) {\r\n            if (typeof componentSelector == \"object\") componentSelector = componentSelector.selector;\r\n            var allComponents = this.model.findDescendants('components');\r\n            var componentID = componentSelector;\r\n            if(componentID.indexOf('.') === 0) componentID = componentID.slice(1);\r\n            allComponents.each(_.bind(function(component){\r\n                if(component.get('_id') === componentID && !component.get('_isVisible')){\r\n                    this.revealComponent(componentSelector);\r\n                    return;\r\n                }\r\n            }, this));\r\n        },\r\n\r\n        revealComponent: function(componentSelector) {\r\n            this.setOpenButtonState();\r\n\r\n            this.toggleisVisible(true);\r\n\r\n            $(\".\" + this.model.get(\"_id\") + \" > .article-inner \").slideDown(0);\r\n\r\n            this.$(\".article-reveal-close-button\").fadeIn(1);\r\n\r\n            $(window).scrollTo($(componentSelector), {\r\n                offset:{\r\n                    top:-$('.navigation').height()\r\n                }\r\n            }).resize();\r\n        }\r\n\r\n    });\r\n\r\n    Adapt.on('articleView:postRender', function(view) {\r\n        if (view.model.get(\"_articleReveal\")) {\r\n            new ArticleRevealView({\r\n                model:view.model\r\n            });\r\n        }\r\n    });\r\n\r\n});\r\n\n","define('components/adapt-articleBlockSlider/js/adapt-articleView',[\r\n    'coreJS/adapt',\r\n    'coreViews/articleView'\r\n], function(Adapt, AdaptArticleView) {\r\n\r\n    var BlockSliderView = {\r\n\r\n        _disableAnimationOnce: false,\r\n        _disableAnimations: false,\r\n\r\n        events: {\r\n            \"click [data-block-slider]\": \"_onBlockSliderClick\"\r\n        },\r\n\r\n        preRender: function() {\r\n\r\n            AdaptArticleView.prototype.preRender.call(this);\r\n            if (this.model.isBlockSliderEnabled()) this._blockSliderPreRender();\r\n\r\n        },\r\n\r\n        _blockSliderPreRender: function() {\r\n            this._disableAnimations = $('html').is(\".ie8\") || $('html').is(\".iPhone.version-7\\\\.0\");\r\n            this._blockSliderSetupEventListeners();\r\n        },\r\n\r\n        _blockSliderSetupEventListeners: function() {\r\n\r\n            this._onBlockSliderResize = _.bind(this._onBlockSliderResize, this);\r\n            this._blockSliderResizeHeight = _.bind(this._blockSliderResizeHeight, this);\r\n\r\n            this.listenTo(Adapt, \"device:resize\", this._onBlockSliderResize);\r\n            this.listenTo(Adapt, \"device:changed\", this._onBlockSliderDeviceChanged);\r\n            \r\n            this.listenToOnce(Adapt, \"remove\", this._onBlockSliderRemove);\r\n            this.listenToOnce(this.model, \"change:_isReady\", this._onBlockSliderReady);\r\n\r\n            this.listenTo(Adapt, \"page:scrollTo\", this._onBlockSliderPageScrollTo);\r\n            this.listenTo(Adapt, \"page:scrolledTo\", this._onBlockSliderPageScrolledTo);\r\n\r\n        },\r\n\r\n        render: function() {\r\n\r\n            if (this.model.isBlockSliderEnabled()) {\r\n\r\n                this._blockSliderRender();\r\n\r\n            } else AdaptArticleView.prototype.render.call(this);\r\n        \r\n        },\r\n\r\n        _blockSliderRender: function() {\r\n            Adapt.trigger(this.constructor.type + 'View:preRender', this);\r\n          \r\n            this._blockSliderConfigureVariables();\r\n\r\n            var data = this.model.toJSON();\r\n            var template = Handlebars.templates['articleBlockSlider-article'];\r\n            this.$el.html(template(data));\r\n\r\n            this.addChildren();\r\n\r\n            _.defer(_.bind(function() {\r\n                this._blockSliderPostRender();\r\n\r\n            }, this));\r\n\r\n            this.$el.addClass('article-block-slider-enabled');\r\n\r\n            this.delegateEvents();\r\n\r\n            return this;\r\n        },\r\n\r\n        _blockSliderConfigureVariables: function() {\r\n            var blocks = this.model.getChildren().models;\r\n            var totalBlocks = blocks.length;\r\n\r\n            this.model.set(\"_currentBlock\", 0);\r\n            this.model.set(\"_totalBlocks\", totalBlocks);\r\n\r\n            var itemButtons = [];\r\n\r\n            for (var i = 0, l = totalBlocks; i < l; i++) {\r\n                itemButtons.push({\r\n                    _className: (i === 0 ? \"home\" : \"not-home\") + (\" i\"+i),\r\n                    _index: i,\r\n                    _includeNumber: i != 0,\r\n                    _title: blocks[i].get('title')\r\n                });\r\n            }\r\n\r\n            this.model.set(\"_itemButtons\", itemButtons);\r\n        },\r\n\r\n        _blockSliderConfigureControls: function(animate) {\r\n\r\n            var duration = this.model.get(\"_articleBlockSlider\")._slideAnimationDuration || 200;\r\n\r\n            if (this._disableAnimationOnce) animate = false;\r\n            if (this._disableAnimations) animate = false;\r\n\r\n            var _currentBlock = this.model.get(\"_currentBlock\");\r\n            var _totalBlocks = this.model.get(\"_totalBlocks\");\r\n\r\n            var $left = this.$el.find(\"[data-block-slider='left']\");\r\n            var $right = this.$el.find(\"[data-block-slider='right']\");\r\n\r\n            if (_currentBlock === 0) {\r\n                $left.a11y_cntrl_enabled(false);\r\n                $right.a11y_cntrl_enabled(true);\r\n            } else if (_currentBlock == _totalBlocks - 1 ) {\r\n                $left.a11y_cntrl_enabled(true);\r\n                $right.a11y_cntrl_enabled(false);\r\n            } else {\r\n                $left.a11y_cntrl_enabled(true);\r\n                $right.a11y_cntrl_enabled(true);\r\n            }\r\n\r\n            var $indexes = this.$el.find(\"[data-block-slider='index']\");\r\n            $indexes.a11y_cntrl_enabled(true).removeClass(\"selected\");\r\n            $indexes.eq(_currentBlock).a11y_cntrl_enabled(false).addClass(\"selected visited\");\r\n\r\n            var $blocks = this.$el.find(\".block\");\r\n\r\n            $blocks.a11y_on(false).eq(_currentBlock).a11y_on(true);\r\n            \r\n            _.delay(_.bind(function() {\r\n                if ($blocks.eq(_currentBlock).onscreen().onscreen) $blocks.eq(_currentBlock).a11y_focus();\r\n            }, this), duration);\r\n\r\n        },\r\n\r\n        _blockSliderSetButtonLayout: function() {\r\n            var buttonsLength = this.model.get('_itemButtons').length;\r\n            var itemwidth = 100 / buttonsLength;\r\n            this.$('.item-button').css({\r\n                width: itemwidth + '%'\r\n            });\r\n        },\r\n\r\n        _blockSliderPostRender: function() {\r\n            this._blockSliderConfigureControls(false);\r\n\r\n            \r\n\r\n            if (this.model.get(\"_articleBlockSlider\")._hasTabs) {\r\n                var parentHeight = this.$('.item-button').parent().height();\r\n                this.$('.item-button').css({\r\n                    height: parentHeight + 'px'\r\n                });\r\n\r\n                var toolbarHeight = this.$('.article-block-toolbar').height();\r\n                var additionalMargin = '30';\r\n                this.$('.article-block-toolbar').css({\r\n                    top: '-' + (toolbarHeight + (additionalMargin/2)) + 'px'\r\n                });\r\n\r\n                var toolbarMargin = parseFloat(toolbarHeight) + parseFloat(additionalMargin);\r\n                this.$('.article-block-slider').css({\r\n                    marginTop: toolbarMargin + 'px'\r\n                });\r\n                this._blockSliderSetButtonLayout();\r\n            }\r\n\r\n            this._onBlockSliderDeviceChanged();\r\n\r\n            var startIndex = this.model.get(\"_articleBlockSlider\")._startIndex || 0;\r\n\r\n            this._blockSliderMoveIndex(startIndex, false);\r\n\r\n            Adapt.trigger(this.constructor.type + 'View:postRender', this);\r\n            \r\n        },\r\n\r\n        _onBlockSliderReady: function() {\r\n            this._blockSliderHideOthers();\r\n            _.delay(_.bind(function(){\r\n                this._blockSliderConfigureControls(false);\r\n            },this),250);\r\n            this.$(\".component\").on(\"resize\", this._blockSliderResizeHeight);\r\n        },\r\n\r\n        _onBlockSliderClick: function(event) {\r\n            event.preventDefault();\r\n\r\n            var id = $(event.currentTarget).attr(\"data-block-slider\");\r\n\r\n            switch(id) {\r\n            case \"left\":\r\n                this._blockSliderMoveLeft();\r\n                break;\r\n            case \"index\":\r\n                var index = parseInt($(event.currentTarget).attr(\"data-block-slider-index\"));\r\n                this._blockSliderMoveIndex(index);\r\n                break;\r\n            case \"right\":\r\n                this._blockSliderMoveRight();\r\n                break;\r\n            }\r\n\r\n        },\r\n\r\n        _blockSliderMoveLeft: function() {\r\n            if (this.model.get(\"_currentBlock\") === 0) return;\r\n\r\n            var index = this.model.get(\"_currentBlock\");\r\n            index--;\r\n            this._blockSliderMoveIndex(index);\r\n        },\r\n\r\n        _blockSliderMoveIndex: function(index, animate) {\r\n            if (this.model.get(\"_currentBlock\") != index) {\r\n\r\n                this.model.set(\"_currentBlock\", index);\r\n                this._blockSliderSetVisible(this.model.getChildren().models[index], true);\r\n\r\n                this._blockSliderResizeHeight(animate);\r\n                this._blockSliderScrollToCurrent(animate);\r\n                this._blockSliderConfigureControls(animate);\r\n            }\r\n\r\n            var duration = this.model.get(\"_articleBlockSlider\")._slideAnimationDuration || 200;\r\n\r\n            if (this._disableAnimationOnce) animate = false;\r\n            if (this._disableAnimations) animate = false;\r\n\r\n            if (animate !== false) {\r\n                _.delay(function() {\r\n                    $(window).resize();\r\n                }, duration);\r\n            } else {\r\n                $(window).resize();\r\n            }\r\n        },\r\n\r\n        _blockSliderMoveRight: function() {\r\n            if (this.model.get(\"_currentBlock\") == this.model.get(\"_totalBlocks\") - 1 ) return;\r\n\r\n            var index = this.model.get(\"_currentBlock\");\r\n            index++;\r\n            this._blockSliderMoveIndex(index);\r\n        },\r\n\r\n        _blockSliderScrollToCurrent: function(animate) {\r\n            var isEnabled = this._blockSliderIsEnabledOnScreenSizes();\r\n            var $container = this.$el.find(\".article-block-slider\");\r\n\r\n            if (!isEnabled) {\r\n                return $container.scrollLeft(0);\r\n            }\r\n\r\n            var blocks = this.$el.find(\".block\");\r\n            var blockWidth = $(blocks[0]).outerWidth();\r\n            var totalLeft = this.model.get(\"_currentBlock\") * blockWidth;\r\n\r\n            this._blockSliderShowAll();\r\n\r\n            var duration = this.model.get(\"_articleBlockSlider\")._slideAnimationDuration || 200;\r\n\r\n            var currentBlock = this.model.get(\"_currentBlock\")\r\n            var $currentBlock = $(blocks[currentBlock]);\r\n\r\n            if (this._disableAnimationOnce) animate = false;\r\n            if (this._disableAnimations) animate = false;\r\n            \r\n            if (animate === false) {\r\n                _.defer(_.bind(function(){\r\n                    $container.scrollLeft(totalLeft );\r\n                    this._blockSliderHideOthers();\r\n                }, this));\r\n            } else {\r\n                $container.stop(true).animate({scrollLeft:totalLeft}, duration, _.bind(function() {\r\n                    $container.scrollLeft(totalLeft );\r\n                    this._blockSliderHideOthers();\r\n                }, this));\r\n            }\r\n\r\n        },\r\n\r\n        _blockSliderIsEnabledOnScreenSizes: function() {\r\n            var isEnabledOnScreenSizes = this.model.get(\"_articleBlockSlider\")._isEnabledOnScreenSizes;\r\n\r\n            var sizes = isEnabledOnScreenSizes.split(\" \");\r\n            if (_.indexOf(sizes, Adapt.device.screenSize) > -1) {\r\n                return true;\r\n            }\r\n            return false;\r\n        },\r\n\r\n        _blockSliderShowAll: function() {\r\n            var blocks = this.model.getChildren().models;\r\n            var currentIndex = this.model.get(\"_currentBlock\");\r\n\r\n            for (var i = 0, l = blocks.length; i < l; i++) {\r\n                this._blockSliderSetVisible(blocks[i], true);\r\n            }\r\n        },\r\n        \r\n        _blockSliderHideOthers: function() {\r\n            var blocks = this.model.getChildren().models;\r\n            var currentIndex = this.model.get(\"_currentBlock\");\r\n\r\n            for (var i = 0, l = blocks.length; i < l; i++) {\r\n                if (i != currentIndex) {\r\n                    this._blockSliderSetVisible(blocks[i], false);\r\n                } else {\r\n                    this._blockSliderSetVisible(blocks[i], true);\r\n                }\r\n            }\r\n\r\n        },\r\n\r\n        _blockSliderSetVisible: function(model, value) {\r\n            var id = model.get(\"_id\");\r\n\r\n            this.$el.find(\".\"+id + \" *\").css(\"visibility\", value ? \"\" : \"hidden\");\r\n\r\n        },\r\n\r\n        _onBlockSliderResize: function() {\r\n            \r\n            this._blockSliderResizeWidth(false);\r\n            this._blockSliderResizeHeight(false);\r\n            this._blockSliderScrollToCurrent(false);\r\n\r\n        },\r\n\r\n        _blockSliderResizeHeight: function(animate) {\r\n            var $container = this.$el.find(\".article-block-slider\");\r\n            var isEnabled = this._blockSliderIsEnabledOnScreenSizes();\r\n\r\n            if (!isEnabled) {\r\n                this._blockSliderShowAll();\r\n                return $container.velocity(\"stop\").css({\"height\": \"\", \"min-height\": \"\"});\r\n            }\r\n\r\n            var currentBlock = this.model.get(\"_currentBlock\");\r\n            var $blocks = this.$el.find(\".block\");\r\n\r\n            var currentHeight = $container.height();\r\n            var blockHeight = $blocks.eq(currentBlock).height();\r\n\r\n            var maxHeight = -1;\r\n            $container.find(\".block\").each(function() { \r\n            \r\n            if ($(this).height() > maxHeight)\r\n                maxHeight = $(this).height();\r\n            });\r\n\r\n            var duration = (this.model.get(\"_articleBlockSlider\")._heightAnimationDuration || 200) * 2;\r\n\r\n            if (this._disableAnimationOnce) animate = false;\r\n            if (this._disableAnimations) animate = false;\r\n\r\n            if (this.model.get(\"_articleBlockSlider\")._hasUniformHeight) {\r\n                if (animate === false) {\r\n                    $container.css({\"height\": maxHeight+\"px\"});\r\n                } else {\r\n                    $container.velocity(\"stop\").velocity({\"height\": maxHeight+\"px\"}, {duration: duration });//, easing: \"ease-in\"});\r\n                }\r\n            } else if (currentHeight <= blockHeight) {\r\n\r\n                if (animate === false) {\r\n                    $container.css({\"height\": blockHeight+\"px\"});\r\n                } else {\r\n                    $container.velocity(\"stop\").velocity({\"height\": blockHeight+\"px\"}, {duration: duration });//, easing: \"ease-in\"});\r\n                }\r\n\r\n            } else if (currentHeight > blockHeight) {\r\n\r\n                if (animate === false) {\r\n                    $container.css({\"height\": blockHeight+\"px\"});\r\n                } else {\r\n                    $container.velocity(\"stop\").velocity({\"height\": blockHeight+\"px\"}, {duration: duration });//, easing: \"ease-in\"});\r\n                }\r\n\r\n            }\r\n\r\n            var minHeight = this.model.get(\"_articleBlockSlider\")._minHeight;\r\n            if (minHeight) {\r\n                $container.css({\"min-height\": minHeight+\"px\"});\r\n            }\r\n        },\r\n\r\n        _blockSliderResizeWidth: function() {\r\n            var isEnabled = this._blockSliderIsEnabledOnScreenSizes();\r\n            var $blockContainer = this.$el.find(\".block-container\");\r\n            var $blocks = this.$el.find(\".block\");\r\n\r\n            if (!isEnabled) {\r\n                $blocks.css(\"width\", \"\");\r\n                return $blockContainer.css({\"width\": \"100%\"});\r\n            }\r\n\r\n            var $container = this.$el.find(\".article-block-slider\");\r\n\r\n            $blocks.css(\"width\", $container.width()+\"px\");\r\n                \r\n            var blockWidth = $($blocks[0]).outerWidth();\r\n            var totalWidth = $blocks.length * (blockWidth);\r\n\r\n            $blockContainer.width(totalWidth + \"px\");\r\n\r\n        },\r\n\r\n        _onBlockSliderDeviceChanged: function() {\r\n            var isEnabled = this._blockSliderIsEnabledOnScreenSizes();\r\n\r\n            if (isEnabled) {\r\n                this.$(\".article-block-toolbar, .article-block-bottombar\").removeClass(\"display-none\")\r\n            } else {\r\n                this.$(\".article-block-toolbar, .article-block-bottombar\").addClass(\"display-none\");\r\n            }\r\n\r\n            _.delay(function() {\r\n                $(window).resize();\r\n            }, 250);\r\n        },\r\n\r\n        _onBlockSliderPageScrollTo: function(selector) {\r\n            this._disableAnimationOnce = true;\r\n            _.defer(_.bind(function() {\r\n                this._disableAnimationOnce = false;\r\n            }, this));\r\n\r\n            if (typeof selector === \"object\") selector = selector.selector;\r\n\r\n            var isEnabled = this._blockSliderIsEnabledOnScreenSizes();\r\n            if (!isEnabled) {\r\n                return;\r\n            }\r\n\r\n            if (this.$el.find(selector).length == 0) return;\r\n            \r\n            var id = selector.substr(1);\r\n\r\n            var model = Adapt.findById(id);\r\n            if (!model) return;\r\n\r\n            var block;\r\n            if (model.get(\"_type\") == \"block\") block = model;\r\n            else block = model.findAncestor(\"blocks\");\r\n            if (!block) return;\r\n\r\n            var children = this.model.getChildren();\r\n            for (var i = 0, item; item = children.models[i++];) {\r\n                if (item.get(\"_id\") == block.get(\"_id\")) {\r\n                    _.defer(_.bind(function() {\r\n                        this._blockSliderMoveIndex(i-1, false);\r\n                    }, this));\r\n                    return;\r\n                }\r\n            }\r\n\r\n        },\r\n\r\n        _onBlockSliderPageScrolledTo: function() {\r\n            _.defer(_.bind(function() {\r\n                this._blockSliderScrollToCurrent(false);\r\n            }, this));\r\n        },\r\n\r\n        _onBlockSliderRemove: function() {\r\n            this._blockSliderRemoveEventListeners();\r\n        },\r\n\r\n        _blockSliderRemoveEventListeners: function() {\r\n            this.$(\".component\").off(\"resize\", this._blockSliderResizeHeight);\r\n            this.stopListening(Adapt, \"device:changed\", this._onBlockSliderDeviceChanged);\r\n        }\r\n    };\r\n\r\n    return BlockSliderView;\r\n\r\n});\r\n\n","define('components/adapt-articleBlockSlider/js/adapt-articleModel',[\r\n\t'coreJS/adapt'\r\n], function(Adapt) {\r\n\r\n\tvar BlockSliderModel = {\r\n\r\n\t\tisBlockSliderEnabled: function() {\r\n\t\t\treturn this.get(\"_articleBlockSlider\") && this.get(\"_articleBlockSlider\")._isEnabled;\r\n\t\t}\r\n\r\n\t};\r\n\r\n\treturn BlockSliderModel;\r\n});\r\n\n","//https://github.com/cgkineo/jquery.resize 2016-09-30\r\n\r\n(function() {\r\n\r\n  if ($.fn.off.elementResizeOriginalOff) return;\r\n\r\n\r\n  var orig = $.fn.on;\r\n  $.fn.on = function () {\r\n    if (arguments[0] !== \"resize\") return $.fn.on.elementResizeOriginalOn.apply(this, _.toArray(arguments));\r\n    if (this[0] === window) return $.fn.on.elementResizeOriginalOn.apply(this, _.toArray(arguments));\r\n\r\n    addResizeListener.call(this, (new Date()).getTime());\r\n\r\n    return $.fn.on.elementResizeOriginalOn.apply(this, _.toArray(arguments));\r\n  };\r\n  $.fn.on.elementResizeOriginalOn = orig;\r\n  var orig = $.fn.off;\r\n  $.fn.off = function () {\r\n    if (arguments[0] !== \"resize\") return $.fn.off.elementResizeOriginalOff.apply(this, _.toArray(arguments));\r\n    if (this[0] === window) return $.fn.off.elementResizeOriginalOff.apply(this, _.toArray(arguments));\r\n\r\n    removeResizeListener.call(this, (new Date()).getTime());\r\n\r\n    return $.fn.off.elementResizeOriginalOff.apply(this, _.toArray(arguments));\r\n  };\r\n  $.fn.off.elementResizeOriginalOff = orig;\r\n\r\n  var expando = $.expando;\r\n  var expandoIndex = 0;\r\n\r\n  function checkExpando(element) {\r\n    if (!element[expando]) element[expando] = ++expandoIndex;\r\n    }\r\n\r\n  //element + event handler storage\r\n  var resizeObjs = {};\r\n\r\n  //jQuery element + event handler attachment / removal\r\n  var addResizeListener = function(data) {\r\n      checkExpando(this);\r\n      var $item = $(this);\r\n      var measure = getDimensions($item);\r\n      resizeObjs[data.guid + \"-\" + this[expando]] = { \r\n        data: data, \r\n        $element: $item,\r\n        _resizeData: measure.uniqueMeasurementId\r\n      };\r\n  };\r\n\r\n  var removeResizeListener = function(data) {\r\n    try { \r\n      delete resizeObjs[data.guid + \"-\" + this[expando]]; \r\n    } catch(e) {\r\n\r\n    }\r\n  };\r\n\r\n  function checkLoopExpired() {\r\n    if ((new Date()).getTime() - loopData.lastEvent > 1500) {\r\n      stopLoop()\r\n      return true;\r\n    }\r\n  }\r\n\r\n  function resizeLoop () {\r\n    if (checkLoopExpired()) return;\r\n\r\n    var resizeHandlers = getEventHandlers(\"resize\");\r\n\r\n    if (resizeHandlers.length === 0) {\r\n      //nothing to resize\r\n      stopLoop();\r\n      resizeIntervalDuration = 500;\r\n      repeatLoop();\r\n    } else {\r\n      //something to resize\r\n      stopLoop();\r\n      resizeIntervalDuration = 250;\r\n      repeatLoop();\r\n    }\r\n\r\n    if  (resizeHandlers.length > 0) {\r\n      var items = resizeHandlers;\r\n      for (var i = 0; i < items.length; i++) {\r\n        var item = items[i];\r\n        triggerResize(item);\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  function getEventHandlers(eventName) {\r\n    var items = [];\r\n    \r\n    switch (eventName) {\r\n    case \"resize\":\r\n      for (var k in resizeObjs) {\r\n        items.push(resizeObjs[k]);\r\n      }\r\n      break;\r\n    }\r\n\r\n    return items;\r\n  }\r\n\r\n  function getDimensions($element) {\r\n      var height = $element.outerHeight();\r\n      var width = $element.outerWidth();\r\n\r\n      return {\r\n        uniqueMeasurementId: height+\",\"+width\r\n      };\r\n  }\r\n\r\n  function triggerResize(item) {\r\n    var measure = getDimensions(item.$element);\r\n    //check if measure has the same values as last\r\n    if (item._resizeData !== undefined && item._resizeData === measure.uniqueMeasurementId) return;\r\n    item._resizeData = measure.uniqueMeasurementId;\r\n    \r\n    //make sure to keep listening until no more resize changes are found\r\n    loopData.lastEvent = (new Date()).getTime();\r\n    \r\n    item.$element.trigger('resize');\r\n  }\r\n\r\n\r\n  //checking loop interval duration\r\n  var resizeIntervalDuration = 250;\r\n\r\n  var loopData = {\r\n    lastEvent: 0,\r\n    interval: null\r\n  };\r\n\r\n  //checking loop start and end\r\n  function startLoop() {\r\n    loopData.lastEvent = (new Date()).getTime();\r\n    if (loopData.interval !== null) {\r\n      stopLoop();\r\n    }\r\n    loopData.interval = setTimeout(resizeLoop, resizeIntervalDuration);\r\n  }\r\n\r\n  function repeatLoop() {\r\n    if (loopData.interval !== null) {\r\n      stopLoop();\r\n    }\r\n    loopData.interval = setTimeout(resizeLoop, resizeIntervalDuration);\r\n  }\r\n\r\n  function stopLoop() {\r\n    clearInterval(loopData.interval);\r\n    loopData.interval = null;\r\n  }\r\n\r\n  $('body').on(\"mousedown mouseup keyup keydown\", startLoop);\r\n  $(window).on(\"resize\", startLoop);\r\n\r\n\r\n})();\r\n\ndefine(\"components/adapt-articleBlockSlider/js/lib/jquery.resize\", function(){});\n\n","define('components/adapt-articleBlockSlider/js/adapt-articleExtension',[\r\n\t'coreJS/adapt',\r\n\t'coreViews/articleView',\r\n\t'coreModels/articleModel',\r\n\t'./adapt-articleView',\r\n\t'./adapt-articleModel',\r\n\t'./lib/jquery.resize'\r\n], function(Adapt, ArticleView, ArticleModel, ArticleViewExtension, ArticleModelExtension) {\r\n\r\n\t/*\t\r\n\t\tHere we are extending the articleView and articleModel in Adapt.\r\n\t\tThis is to accomodate the block slider functionality on the article.\r\n\t\tThe advantage of this method is that the block slider behaviour can utilize all of the predefined article behaviour in both the view and the model.\r\n\t*/\t\r\n\r\n\t//Extends core/js/views/articleView.js\r\n\tvar ArticleViewInitialize = ArticleView.prototype.initialize;\r\n\tArticleView.prototype.initialize = function(options) {\r\n\t\tif (this.model.get(\"_articleBlockSlider\")) {\r\n\t\t\t//extend the articleView with new functionality\r\n\t\t\t_.extend(this, ArticleViewExtension);\r\n\t\t}\r\n\t\t//initialize the article in the normal manner\r\n\t\treturn ArticleViewInitialize.apply(this, arguments);\r\n\t};\r\n\r\n\t//Extends core/js/models/articleModel.js\r\n\tvar ArticleModelInitialize = ArticleModel.prototype.initialize;\r\n\tArticleModel.prototype.initialize = function(options) {\r\n\t\tif (this.get(\"_articleBlockSlider\")) {\r\n\t\t\t//extend the articleModel with new functionality\r\n\t\t\t_.extend(this, ArticleModelExtension);\r\n\r\n\t\t\t//initialize the article in the normal manner\r\n\t\t\tvar returnValue = ArticleModelInitialize.apply(this, arguments);\r\n\r\n\t\t\treturn returnValue;\r\n\t\t}\r\n\r\n\t\t//initialize the article in the normal manner if no assessment\r\n\t\treturn ArticleModelInitialize.apply(this, arguments);\r\n\t};\r\n\r\n});\n","define('components/adapt-articleBlockSlider/js/articleBlockSlider',[\r\n\t'coreJS/adapt',\r\n\t'./adapt-articleExtension'\r\n], function(Adapt) {\r\n\r\n});\n","/*\r\n * adapt-audio\r\n * License - http://github.com/cgkineo/adapt_framework/LICENSE\r\n */\r\ndefine('components/adapt-audio/js/adapt-audio',['require','coreJS/adapt','backbone'],function(require) {\r\n\r\n    var Adapt = require('coreJS/adapt');\r\n    var Backbone = require('backbone');\r\n\r\n    var AudioView = Backbone.View.extend({\r\n\r\n        className: \"extension-audio\",\r\n\r\n        initialize: function() {\r\n            this.render();\r\n            this.listenTo(Adapt, 'audio', this.onAudioInvoked);\r\n            this.listenTo(Adapt, 'audio:stop', this.onAudioStop);\r\n\r\n            if (Modernizr.audio) {\r\n                this.audio = new Audio();\r\n\r\n                $(this.audio).on('ended', _.bind(this.onAudioEnded, this));\r\n            } else if ($(\"#audioPlayer\")[0] == undefined) {\r\n                this.embedFlashAudioPlayer();\r\n            }\r\n        },\r\n\r\n        render: function() {\r\n            var template = Handlebars.templates[\"audio\"]\r\n            this.$el.html(template()).appendTo('#wrapper');\r\n            return this;\r\n        },\r\n\r\n        embedFlashAudioPlayer: function() {\r\n\r\n            window.onFlashAudioFinished = _.bind(this.onAudioEnded, this);\r\n\r\n            var params = {\r\n                swliveconnect: \"true\",\r\n                allowscriptaccess: \"always\"\r\n            };\r\n\r\n            var attributes = {\r\n                id: \"audioPlayer\",\r\n                name: \"audioPlayer\"\r\n            };\r\n\r\n            swfobject.embedSWF(\"assets/audioplayer.swf\", \"flashPlayer\", \"1\", \"1\", \"8.0.22\", \"assets/express_install.swf\", false, params, attributes);\r\n\r\n            console.log($(\"#audioPlayer\")[0]);\r\n        },\r\n\r\n        play: function() {\r\n            try {\r\n                if (this.audio) this.audio.play();\r\n                else {\r\n                    $(\"#audioPlayer\")[0].loadAudio(this.$active.data('mp3'));\r\n                }\r\n            } catch (e) {\r\n                console.error(\"play error\");\r\n            }\r\n        },\r\n\r\n        pause: function() {\r\n            try {\r\n                if (this.audio) this.audio.pause();\r\n                else {\r\n                    $(\"#audioPlayer\")[0].controlAudio(\"pause\");\r\n                }\r\n            } catch (e) {\r\n                console.error(\"pause error\");\r\n            }\r\n        },\r\n\r\n        stop: function() {\r\n            try {\r\n                if (this.audio) {\r\n                    this.audio.pause();\r\n                    this.audio.currentTime = 0;\r\n                } else {\r\n                    $(\"#audioPlayer\")[0].controlAudio(\"pause\");\r\n                }\r\n            } catch (e) {\r\n                console.error(\"stop error\");\r\n            }\r\n        },\r\n\r\n        onAudioInvoked: function(el) {\r\n            var $el = $(el);\r\n\r\n            if (this.$active && this.$active.is($el)) {\r\n                if (this.$active.hasClass('play')) {\r\n                    this.$active.addClass('pause').removeClass('play');\r\n                    this.play();\r\n                } else {\r\n                    this.$active.addClass('play').removeClass('pause');\r\n                    this.pause();\r\n                }\r\n            } else {\r\n                if (this.$active) {\r\n                    this.$active.addClass('play').removeClass('pause');\r\n                    this.pause();\r\n                }\r\n\r\n                this.$active = $el;\r\n                this.$active.addClass('pause').removeClass('play');\r\n\r\n                if (Modernizr.audio) {\r\n                    if (this.audio.canPlayType('audio/ogg')) this.audio.src = this.$active.data('ogg');\r\n                    if (this.audio.canPlayType('audio/mpeg')) this.audio.src = this.$active.data('mp3');\r\n                }\r\n\r\n                this.play();\r\n            }\r\n        },\r\n\r\n        onAudioEnded: function() {\r\n            if (this.$active) {\r\n                this.$active.addClass('play').removeClass('pause');\r\n            }\r\n            this.stop();\r\n        },\r\n\r\n        onAudioStop: function(el) {\r\n\r\n            if (el == null || el == undefined) {\r\n                // console.log('stop any audio currently playing');\r\n                if (this.$active) {\r\n                    this.$active.addClass('play').removeClass('pause');\r\n                    this.stop();\r\n                }\r\n            } else if (this.$active && (this.$active.is(el) || this.$active.parents(el).length > 0)) {\r\n                // console.log('stop audio for specific element/descendents if currently playing');\r\n                if (this.$active) {\r\n                    this.$active.addClass('play').removeClass('pause');\r\n                    this.stop();\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n\r\n    Adapt.once(\"app:dataLoaded\", function() {\r\n        new AudioView();\r\n    });\r\n\r\n    Adapt.on('router:location', function() {\r\n        Adapt.trigger('audio:stop');\r\n    });\r\n\r\n});\r\n\n","define('components/adapt-backgroundScroll/js/adapt-backgroundScroll',['require','coreViews/componentView','coreJS/adapt'],function(require) {\r\n\r\n\tvar ComponentView = require('coreViews/componentView');\r\n\tvar Adapt = require('coreJS/adapt');\r\n\r\n\tvar BackgroundScroll = ComponentView.extend({\r\n\r\n\t\tevents: {\r\n\t\t\t\"click .bg-scroll-next\": \"nextItem\"\r\n\t\t},\r\n\r\n\t\tpreRender: function() {\r\n\t\t\t// Checks to see if the text should be reset on revisit\r\n\t\t\tthis.viewHeight = $(window).height();\r\n\t\t\tif (this.model.get(\"_isComplete\")) {\r\n\t\t\t\tthis.setCompletionStatus();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tpostRender: function() {\r\n\t\t\tthis.offsetTop = $(\".navigation\").height();\r\n\t\t\tthis.numItems = this.model.get(\"_items\").length;\r\n\t\t\tthis.$items = this.$(\".bg-scroll-item\");\r\n\t\t\tthis.$images = this.$(\".bg-scroll-background\");\r\n\t\t\tthis.visitedItems = 1;\r\n\t\t\tthis.setupScrollListener();\r\n\t\t\tthis.setupHeights();\r\n\t\t\tthis.setReadyStatus();\r\n\t\t\tthis.setupTimer();\r\n\t\t},\r\n\r\n\t\tsetupTimer: function() {\r\n\t\t\tthis.time = 0;\r\n\t\t\tthis.timer = setInterval(function() {\r\n\t\t\t\tthis.time++;\r\n\t\t\t}.bind(this), 1000);\r\n\t\t},\r\n\r\n\t\tsetupScrollListener: function() {\r\n\t\t\t$(window).on(\"scroll\", function() {\r\n\t\t\t\tvar st = window.pageYOffset || document.documentElement.scrollTop;\r\n\t\t\t\tvar top = this.$el.offset().top;\r\n\t\t\t\tvar iStart = this.model.get(\"_fadeFirstImage\") ? 0 : 1;\r\n\t\t\t\tvar distanceFromBottom = st - (this.$el.height() + top - (this.viewHeight / 2));\r\n\t\t\t\tvar distanceFromTop = st - (top - this.viewHeight);\r\n\t\t\t\tvar opacity;\r\n\t\t\t\tvar imgTop = 100;\r\n\r\n\t\t\t\t// Scroll the first image into view\r\n\t\t\t\tif (distanceFromTop > 0 && distanceFromTop < this.viewHeight) {\r\n\t\t\t\t\timgTop = 100 - ((st - (top - this.viewHeight)) / this.viewHeight) * 100;\r\n\t\t\t\t} else if (distanceFromBottom > 0) {\r\n\t\t\t\t\t// Scroll last image when user reaches the bottom of the component\r\n\t\t\t\t\timgTop = - (distanceFromBottom / this.viewHeight) * 100;\r\n\t\t\t\t} else if (distanceFromTop > this.viewHeight) {\r\n\t\t\t\t\timgTop = 0;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.$(\".bg-scroll-images\").css({top: imgTop + \"%\"});\r\n\r\n\t\t\t\tif (iStart === 1) {\r\n\t\t\t\t\topacity = st + this.viewHeight >= top - 60 ? 1 : 0;\r\n\t\t\t\t\tthis.$images[0].style.opacity = opacity;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (var i = iStart; i < this.numItems; i++) {\r\n\t\t\t\t\tvar item = this.$items.eq(i);\r\n\t\t\t\t\tvar diff = item.offset().top - st - (this.viewHeight / 3);\r\n\t\t\t\t\tvar img = this.$images[i];\r\n\t\t\t\t\tif (diff < 0) {\r\n\t\t\t\t\t\tvar currItem = i;\r\n\t\t\t\t\t\topacity = 1;\r\n\t\t\t\t\t} else if (diff < 400) {\r\n\t\t\t\t\t\topacity = 1 - (diff / 400);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\topacity = 0;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\timg.style.opacity = opacity;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (currItem && currItem !== this.currItem) this.setCurrItem(currItem);\r\n\t\t\t}.bind(this));\r\n\t\t},\r\n\r\n\t\tsetupHeights: function() {\r\n\t\t\tthis.el.style.paddingBottom = this.viewHeight / 2 + \"px\";\r\n\t\t\t_.each(this.$items, function(el) {\r\n\t\t\t\tvar $el = $(el);\r\n\t\t\t\tvar padding = (this.viewHeight - $el.height()) / 2 + \"px 0\";\r\n\t\t\t\t$el.css({padding: padding});\r\n\t\t\t}, this);\r\n\t\t},\r\n\r\n\t\tsetCurrItem: function(i) {\r\n\t\t\t// Prevent user from scrolling straight to bottom\r\n\t\t\t// 2 Seconds should be about right to ensure they have read the material\r\n\t\t\tif (this.time < 2) return;\r\n\t\t\tthis.currItem = i;\r\n\t\t\tthis.time = 0;\r\n\t\t\tthis.visitedItems ++;\r\n\t\t\tif (this.checkCompletionStatus()) {\r\n\t\t\t\tthis.onComplete();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tnextItem: function() {\r\n\r\n\t\t},\r\n\r\n\t\tprevItem: function() {\r\n\r\n\t\t},\r\n\r\n\t\tcheckCompletionStatus: function() {\r\n\t\t\treturn this.numItems === this.visitedItems;\r\n\t\t},\r\n\r\n\t\tonComplete: function () {\r\n\t\t\tthis.setCompletionStatus();\r\n\t\t}\r\n\t});\r\n\r\n\tAdapt.register('backgroundScroll', BackgroundScroll);\r\n\r\n\treturn BackgroundScroll;\r\n\r\n});\r\n\n","define('components/adapt-blinds/js/adapt-blinds',['require','coreViews/componentView','coreJS/adapt'],function(require) {\r\n\r\n\tvar ComponentView = require('coreViews/componentView');\r\n\tvar Adapt = require('coreJS/adapt');\r\n\r\n\tvar Blinds = ComponentView.extend({\r\n\r\n\t\tpreRender: function() {\r\n\r\n\t\t\tthis.listenTo(Adapt, 'device:resize', this.calculateWidths, this);\r\n\t\t\tthis.setDeviceSize();\r\n\r\n\t\t\t// Checks to see if the text should be reset on revisit\r\n\t\t\tthis.checkIfResetOnRevisit();\r\n\t\t},\r\n\r\n\t\tpostRender: function() {\r\n\t\t\tthis.setReadyStatus();\r\n\t\t\tthis.$('.blinds-inner').imageready(_.bind(function() {\r\n\t\t\t\tthis.setupBlinds();\r\n\t\t\t\tthis.setReadyStatus();\r\n\t\t\t}, this));\r\n\r\n\t\t},\r\n\r\n\t\tsetupBlinds: function() {\r\n\t\t\tif(!this.model.has('_items') || !this.model.get('_items').length) return;\r\n\t\t\tthis.model.set('_itemCount', this.model.get('_items').length);\r\n\t\t\tthis.model.set('_active', true);\r\n\t\t\tthis.calculateWidths();\r\n\t\t\tthis.setupEventListeners();\r\n\t\t},\r\n\r\n\t\tsetupEventListeners: function() {\r\n\t\t\tvar that = this;\r\n\t\t\tvar $items = this.$(\".blinds-item\");\r\n\t\t\tvar _items = this.model.get(\"_items\");\r\n\t\t\tvar wItem = this.itemWidth;\r\n\t\t\tvar animationTime = 400;\r\n\t\t\tvar captionDelay = this.model.has(\"captionDelay\") ? this.model.get(\"captionDelay\") : 800;\r\n\t\t\tvar expandBy = this.model.get(\"expandBy\") || 2;\r\n\t\t\tvar count = 0;\r\n\t\t\tvar currentItem;\r\n\t\t\tvar queue = [];\r\n\r\n\t\t\t$items.on({\r\n\t\t\t\tmouseenter: function() {\r\n\t\t\t\t\tcurrentItem = this;\r\n\r\n\t\t\t\t\tvar $this = $(this);\r\n\t\t\t\t\tvar itemIndex = $this.index();\r\n\t\t\t\t\tvar _item = _items[itemIndex];\r\n\t\t\t\t\tvar $siblings = $this.siblings();\r\n\t\t\t\t\tvar $p = $this.find(\"p\");\r\n\t\t\t\t\tvar wItemNew = wItem * expandBy;\r\n\t\t\t\t\tvar wSiblingsNew = wItem - ((wItemNew - wItem) / $siblings.length);\r\n\t\t\t\t\tvar currTop = 10;\r\n\r\n\t\t\t\t\t$this.outerWidth(wItemNew);\r\n\r\n\t\t\t\t\tthat.setStage(itemIndex);\r\n\r\n\t\t\t\t\t$p.each(function(i, el) {\r\n\t\t\t\t\t\t(function(i, el) {\r\n\t\t\t\t\t\t\tvar t = animationTime + (i * captionDelay);\r\n\t\t\t\t\t\t\tvar caption = _item.captions[i];\r\n\t\t\t\t\t\t\tvar left = caption.left || _item.left || 0;\r\n\t\t\t\t\t\t\tvar top = caption.top;\r\n\t\t\t\t\t\t\tif (!top && i === 0) top = 0;\r\n\t\t\t\t\t\t\tvar width = caption.width || wItem * expandBy + \"px\";\r\n\t\t\t\t\t\t\tqueue[i] = setTimeout(function() {\r\n\t\t\t\t\t\t\t\tif (top === undefined) {\r\n\t\t\t\t\t\t\t\t\ttop = $p.eq(i - 1).outerHeight() + currTop + 10;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tcurrTop = parseInt(top);\r\n\t\t\t\t\t\t\t\t$(el).css({\r\n\t\t\t\t\t\t\t\t\topacity: 1,\r\n\t\t\t\t\t\t\t\t\ttop: top,\r\n\t\t\t\t\t\t\t\t\tleft: left,\r\n\t\t\t\t\t\t\t\t\tmaxWidth: width\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}, t);\r\n\t\t\t\t\t\t})(i, el);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t$siblings.outerWidth(wSiblingsNew);\r\n\t\t\t\t},\r\n\t\t\t\tmouseleave: function() {\r\n\t\t\t\t\tfor (var i = 0; i < queue.length; i++) {\r\n\t\t\t\t\t\tclearTimeout(queue[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcurrentItem = null;\r\n\t\t\t\t\tcount = 0;\r\n\t\t\t\t\tvar $this = $(this);\r\n\t\t\t\t\t$this.outerWidth(wItem);\r\n\t\t\t\t\t$this.find(\"p\").css(\"opacity\", 0);\r\n\t\t\t\t\t$this.siblings().outerWidth(wItem);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tthis.completionEvent = this.model.get('_setCompletionOn') || 'allItems';\r\n\r\n\t\t\tif (this.completionEvent !== 'inview' && this.model.get('_items').length > 1) {\r\n\t\t\t\tthis.on(this.completionEvent, _.bind(this.onCompletion, this));\r\n\t\t\t} else {\r\n\t\t\t\tthis.$('.component-widget').on('inview', _.bind(this.inview, this));\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tcalculateWidths: function() {\r\n\t\t\tif (this.model.get(\"height\")) this.$(\".blinds-item\").height(this.model.get(\"height\"));\r\n\t\t\tvar wTotal = this.$(\".blinds-container\").width();\r\n\t\t\tvar $items = this.$(\".blinds-item\");\r\n\t\t\tvar margin = parseInt($items.css(\"marginRight\"));\r\n\t\t\tvar wItem = (wTotal / $items.length) - (margin * 2);\r\n\t\t\tthis.itemWidth = wItem;\r\n\t\t\t$items.outerWidth(wItem);\r\n\t\t},\r\n\r\n\t\t// Used to check if the text should reset on revisit\r\n\t\tcheckIfResetOnRevisit: function() {\r\n\t\t\tvar isResetOnRevisit = this.model.get('_isResetOnRevisit');\r\n\r\n\t\t\t// If reset is enabled set defaults\r\n\t\t\tif (isResetOnRevisit) {\r\n\t\t\t\tthis.model.reset(isResetOnRevisit);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tsetStage: function(stage) {\r\n\t\t\tthis.model.set('_stage', stage);\r\n\t\t\tif (this.model.get('_isDesktop')) {\r\n\t\t\t\t// Set the visited attribute for large screen devices\r\n\t\t\t\tvar currentItem = this.getCurrentItem(stage);\r\n\t\t\t\tcurrentItem._isVisited = true;\r\n\t\t\t}\r\n\r\n\t\t\tthis.evaluateCompletion();\r\n\t\t},\r\n\r\n\t\tgetCurrentItem: function(index) {\r\n\t\t\treturn this.model.get('_items')[index];\r\n\t\t},\r\n\r\n\t\tgetVisitedItems: function() {\r\n\t\t\treturn _.filter(this.model.get('_items'), function(item) {\r\n\t\t\t\treturn item._isVisited;\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tevaluateCompletion: function() {\r\n\t\t\tif (this.getVisitedItems().length === this.model.get('_items').length) {\r\n\t\t\t\tthis.trigger('allItems');\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tinview: function(event, visible, visiblePartX, visiblePartY) {\r\n\t\t\tif (visible) {\r\n\t\t\t\tif (visiblePartY === 'top') {\r\n\t\t\t\t\tthis._isVisibleTop = true;\r\n\t\t\t\t} else if (visiblePartY === 'bottom') {\r\n\t\t\t\t\tthis._isVisibleBottom = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._isVisibleTop = true;\r\n\t\t\t\t\tthis._isVisibleBottom = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this._isVisibleTop && this._isVisibleBottom) {\r\n\t\t\t\t\tthis.$('.component-inner').off('inview');\r\n\t\t\t\t\tthis.setCompletionStatus();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tonCompletion: function() {\r\n\t\t\tthis.setCompletionStatus();\r\n\t\t\tif (this.completionEvent && this.completionEvent != 'inview') {\r\n\t\t\t\tthis.off(this.completionEvent, this);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tsetDeviceSize: function() {\r\n\t\t\tif (Adapt.device.screenSize === 'large') {\r\n\t\t\t\tthis.$el.addClass('desktop').removeClass('mobile');\r\n\t\t\t\tthis.model.set('_isDesktop', true);\r\n\t\t\t} else {\r\n\t\t\t\tthis.$el.addClass('mobile').removeClass('desktop');\r\n\t\t\t\tthis.model.set('_isDesktop', false)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t});\r\n\r\n\tAdapt.register('blinds', Blinds);\r\n\r\n\treturn Blinds;\r\n\r\n});\r\n\n","define('components/adapt-contrib-accordion/js/adapt-contrib-accordion',['require','coreViews/componentView','coreJS/adapt'],function(require) {\n\n    var ComponentView = require('coreViews/componentView');\n    var Adapt = require('coreJS/adapt');\n\n    var Accordion = ComponentView.extend({\n\n        events: {\n            'click .accordion-item-title': 'toggleItem'\n        },\n\n        toggleSpeed: 200,\n\n        preRender: function() {\n            // Checks to see if the accordion should be reset on revisit\n            this.checkIfResetOnRevisit();\n        },\n\n        postRender: function() {\n            this.setReadyStatus();\n        },\n\n        // Used to check if the accordion should reset on revisit\n        checkIfResetOnRevisit: function() {\n            var isResetOnRevisit = this.model.get('_isResetOnRevisit');\n\n            // If reset is enabled set defaults\n            if (isResetOnRevisit) {\n                this.model.reset(isResetOnRevisit);\n\n                _.each(this.model.get('_items'), function(item) {\n                    item._isVisited = false;\n                });\n            }\n        },\n\n        toggleItem: function(event) {\n            event.preventDefault();\n\n            var $toggleButton = $(event.currentTarget);\n            var $accordionItem = $toggleButton.parent('.accordion-item');\n            var isCurrentlyExpanded = $toggleButton.hasClass('selected');\n\n            if (this.model.get('_shouldCollapseItems') === false) {\n                // Close and reset the selected Accordion item only\n                this.closeItem($accordionItem);\n            } else {\n                // Close and reset all Accordion items\n                var allAccordionItems = this.$('.accordion-item');\n                var count = allAccordionItems.length;\n                for (var i = 0; i < count; i++) {\n                    this.closeItem($(allAccordionItems[i]));\n                }\n            }\n\n            if (!isCurrentlyExpanded) {\n                this.openItem($accordionItem);\n            }\n        },\n\n        closeItem: function($itemEl) {\n            if (!$itemEl) {\n                return false;\n            }\n\n            var $body = $('.accordion-item-body', $itemEl).first();\n            var $button = $('button', $itemEl).first();\n            var $icon = $('.accordion-item-title-icon', $itemEl).first();\n\n            $body.stop(true, true).slideUp(this.toggleSpeed);\n            $button.removeClass('selected');\n            $button.attr('aria-expanded', false);\n            $icon.addClass('icon-plus');\n            $icon.removeClass('icon-minus');\n        },\n\n        openItem: function($itemEl) {\n            if (!$itemEl) {\n                return false;\n            }\n\n            var $body = $('.accordion-item-body', $itemEl).first();\n            var $button = $('button', $itemEl).first();\n            var $icon = $('.accordion-item-title-icon', $itemEl).first();\n\n            $body = $body.stop(true, true).slideDown(this.toggleSpeed, function() {\n                $body.a11y_focus();\n            });\n\n            $button.addClass('selected');\n            $button.attr('aria-expanded', true);\n\n            this.setVisited($itemEl.index());\n            $button.addClass('visited');\n\n            $icon.removeClass('icon-plus');\n            $icon.addClass('icon-minus');\n        },\n\n        setVisited: function(index) {\n            var item = this.model.get('_items')[index];\n            item._isVisited = true;\n            this.checkCompletionStatus();\n        },\n\n        getVisitedItems: function() {\n            return _.filter(this.model.get('_items'), function(item) {\n                return item._isVisited;\n            });\n        },\n\n        checkCompletionStatus: function() {\n            if (this.getVisitedItems().length == this.model.get('_items').length) {\n                this.setCompletionStatus();\n            }\n        }\n\n    });\n\n    Adapt.register('accordion', Accordion);\n\n    return Accordion;\n\n});\n\n","define('components/adapt-contrib-assessmentResults/js/adapt-contrib-assessmentResults',['require','coreViews/componentView','coreJS/adapt'],function(require) {\n\n    var ComponentView = require('coreViews/componentView');\n    var Adapt = require('coreJS/adapt');\n\n    var AssessmentResults = ComponentView.extend({\n\n        events: {\n            'inview': 'onInview',\n            'click .results-retry-button button': 'onRetry'\n        },\n\n        preRender: function () {\n            if (this.model.setLocking) this.model.setLocking(\"_isVisible\", false);\n\n            this.saveOriginalTexts();\n\n            this.setupEventListeners();\n            this.setupModelResetEvent();\n            this.checkIfComplete();\n            this.checkIfVisible();\n        },\n\n        saveOriginalTexts: function() {\n            this.model.set({\n                \"originalTitle\": this.model.get(\"title\"),\n                \"originalBody\": this.model.get(\"body\"),\n                \"originalInstruction\": this.model.get(\"instruction\")\n            });\n        },\n\n        checkIfVisible: function() {\n            \n            if (!Adapt.assessment) {\n                return false;\n            }\n\n            var isVisibleBeforeCompletion = this.model.get(\"_isVisibleBeforeCompletion\") || false;\n            var isVisible = false;\n\n            var wasVisible = this.model.get(\"_isVisible\");\n\n            var assessmentModel = Adapt.assessment.get(this.model.get(\"_assessmentId\"));\n            if (!assessmentModel || assessmentModel.length === 0) return;\n\n            var state = assessmentModel.getState();\n            var isComplete = state.isComplete;\n            var isAttemptInProgress = state.attemptInProgress;\n            var attemptsSpent = state.attemptsSpent;\n            var hasHadAttempt = (!isAttemptInProgress && attemptsSpent > 0);\n            \n            isVisible = (isVisibleBeforeCompletion && !isComplete) || hasHadAttempt;\n\n            if (!wasVisible && isVisible) isVisible = false;\n\n            this.model.set('_isVisible', isVisible, {pluginName: \"assessmentResults\"});\n        },\n\n        checkIfComplete: function() {\n            \n            if (!Adapt.assessment) {\n                return false;\n            }\n\n            var assessmentModel = Adapt.assessment.get(this.model.get(\"_assessmentId\"));\n            if (!assessmentModel || assessmentModel.length === 0) return;\n\n            var state = assessmentModel.getState();\n            var isComplete = state.isComplete;\n            if (isComplete) {\n                this.onAssessmentsComplete(state);\n            } else {\n                this.model.reset('hard', true);\n            }\n        },\n\n        setupModelResetEvent: function() {\n            if (this.model.onAssessmentsReset) return;\n            this.model.onAssessmentsReset = function(state) {\n                if (this.get(\"_assessmentId\") === undefined || \n                    this.get(\"_assessmentId\") != state.id) return;\n\n                this.reset('hard', true);\n            };\n            this.model.listenTo(Adapt, 'assessments:reset', this.model.onAssessmentsReset);\n        },\n\n        postRender: function() {\n            this.setReadyStatus();\n        },\n\n        setupEventListeners: function() {\n            this.listenTo(Adapt, 'assessments:complete', this.onAssessmentsComplete);\n            this.listenToOnce(Adapt, 'remove', this.onRemove);\n        },\n\n        removeEventListeners: function() {\n            this.stopListening(Adapt, 'assessments:complete', this.onAssessmentsComplete);\n            this.stopListening(Adapt, 'remove', this.onRemove);\n        },\n\n        onAssessmentsComplete: function(state) {\n            if (this.model.get(\"_assessmentId\") === undefined || \n                this.model.get(\"_assessmentId\") != state.id) return;\n\n            this.model.set(\"_state\", state);\n            \n            var feedbackBand = this.getFeedbackBand();\n            \n            this.setFeedback(feedbackBand);\n            \n            this.addClassesToArticle(feedbackBand);\n\n            this.render();\n            \n            this.show();\n        },\n\n        onAssessmentComplete: function(state) {\n            this.model.set(\"_state\", state);\n            \n            var feedbackBand = this.getFeedbackBand();\n            \n            this.setFeedback(feedbackBand);\n            \n            this.addClassesToArticle(feedbackBand);\n\n            this.render();\n            \n            this.show();\n        },\n\n        onInview: function(event, visible, visiblePartX, visiblePartY) {\n            if (visible) {\n                if (visiblePartY === 'top') {\n                    this._isVisibleTop = true;\n                } else if (visiblePartY === 'bottom') {\n                    this._isVisibleBottom = true;\n                } else {\n                    this._isVisibleTop = true;\n                    this._isVisibleBottom = true;\n                }\n                \n                if (this._isVisibleTop || this._isVisibleBottom) {\n                    this.setCompletionStatus();\n                    this.$el.off(\"inview\");\n                }\n            }\n        },\n\n        onRetry: function() {\n            var state = this.model.get(\"_state\");\n            var assessmentModel = Adapt.assessment.get(state.id);\n\n            this.restoreOriginalTexts();\n\n            assessmentModel.reset();\n        },\n\n        restoreOriginalTexts: function() {\n            this.model.set({\n                \"title\": this.model.get(\"originalTitle\"),\n                \"body\": this.model.get(\"originalBody\"),\n                \"instruction\": this.model.get(\"originalInstruction\")\n            });\n        },\n        \n        show: function() {\n             if(!this.model.get('_isVisible')) {\n                 this.model.set('_isVisible', true, {pluginName: \"assessmentResults\"});\n             }\n        },\n\n        setFeedback: function(feedbackBand) {\n\n            var completionBody = this.model.get(\"_completionBody\");\n\n            var state = this.model.get(\"_state\");\n            state.feedbackBand = feedbackBand;\n            state.feedback = feedbackBand.feedback;\n\n            this.checkRetryEnabled();\n\n            completionBody = this.stringReplace(completionBody, state);\n\n            this.model.set(\"body\", completionBody);\n\n        },\n        \n        /**\n         * If there are classes specified for the feedback band, apply them to the containing article\n         * This allows for custom styling based on the band the user's score falls into\n         */\n        addClassesToArticle: function(feedbackBand) {\n            \n            if(!feedbackBand.hasOwnProperty('_classes')) return;\n            \n            this.$el.parents('.article').addClass(feedbackBand._classes);\n        },\n\n        getFeedbackBand: function() {\n            var state = this.model.get(\"_state\");\n            var scoreProp = state.isPercentageBased ? 'scoreAsPercent' : 'score';\n            var bands = _.sortBy(this.model.get(\"_bands\"), '_score');\n            \n            for (var i = (bands.length - 1); i >= 0; i--) {\n                if (state[scoreProp] >= bands[i]._score) {\n                    return bands[i];\n                }\n            }\n\n            return \"\";\n        },\n\n        checkRetryEnabled: function() {\n            var state = this.model.get(\"_state\");\n\n            var assessmentModel = Adapt.assessment.get(state.id);\n            if (!assessmentModel.canResetInPage()) return false;\n\n            var isRetryEnabled = state.feedbackBand._allowRetry !== false;\n            var isAttemptsLeft = (state.attemptsLeft > 0 || state.attemptsLeft === \"infinite\");\n\n            var showRetry = isRetryEnabled && isAttemptsLeft;\n            this.model.set(\"_isRetryEnabled\", showRetry);\n\n            if (showRetry) {\n                var retryFeedback =  this.model.get(\"_retry\").feedback;\n                retryFeedback = this.stringReplace(retryFeedback, state);\n                this.model.set(\"retryFeedback\", retryFeedback);\n            } else {\n                this.model.set(\"retryFeedback\", \"\");\n            }\n        },\n\n        stringReplace: function(string, context) {\n            //use handlebars style escaping for string replacement\n            //only supports unescaped {{{ attributeName }}} and html escaped {{ attributeName }}\n            //will string replace recursively until no changes have occured\n\n            var changed = true;\n            while (changed) {\n                changed = false;\n                for (var k in context) {\n                    var contextValue = context[k];\n\n                    switch (typeof contextValue) {\n                    case \"object\":\n                        continue;\n                    case \"number\":\n                        contextValue = Math.floor(contextValue);\n                        break;\n                    }\n\n                    var regExNoEscaping = new RegExp(\"((\\\\{\\\\{\\\\{){1}[\\\\ ]*\"+k+\"[\\\\ ]*(\\\\}\\\\}\\\\}){1})\",\"g\");\n                    var regExEscaped = new RegExp(\"((\\\\{\\\\{){1}[\\\\ ]*\"+k+\"[\\\\ ]*(\\\\}\\\\}){1})\",\"g\");\n\n                    var preString = string;\n\n                    string = string.replace(regExNoEscaping, contextValue);\n                    var escapedText = $(\"<p>\").text(contextValue).html();\n                    string = string.replace(regExEscaped, escapedText);\n\n                    if (string != preString) changed = true;\n\n                }\n            }\n\n            return string;\n        },\n\n        onRemove: function() {\n            if (this.model.unsetLocking) this.model.unsetLocking(\"_isVisible\");\n\n            this.removeEventListeners();\n        }\n        \n    }, {\n        template: 'assessmentResults'\n    });\n    \n    Adapt.register(\"assessmentResults\", AssessmentResults);\n    \n    return AssessmentResults;\n});\n\n","define('components/adapt-contrib-blank/js/adapt-contrib-blank',['require','coreViews/componentView','coreJS/adapt'],function(require) {\n\n    var ComponentView = require('coreViews/componentView');\n    var Adapt = require('coreJS/adapt');\n\n    var Blank = ComponentView.extend({\n\n\n        preRender: function() {\n            this.$el.addClass(\"no-state\");\n            // Checks to see if the blank should be reset on revisit\n            this.checkIfResetOnRevisit();\n        },\n\n        postRender: function() {\n            this.setReadyStatus();\n            this.$('.component-inner').on('inview', _.bind(this.inview, this));\n        },\n\n        // Used to check if the blank should reset on revisit\n        checkIfResetOnRevisit: function() {\n            var isResetOnRevisit = this.model.get('_isResetOnRevisit');\n\n            // If reset is enabled set defaults\n            if (isResetOnRevisit) {\n                this.model.reset(isResetOnRevisit);\n            }\n        },\n\n        inview: function(event, visible, visiblePartX, visiblePartY) {\n            if (visible) {\n                if (visiblePartY === 'top') {\n                    this._isVisibleTop = true;\n                } else if (visiblePartY === 'bottom') {\n                    this._isVisibleBottom = true;\n                } else {\n                    this._isVisibleTop = true;\n                    this._isVisibleBottom = true;\n                }\n\n                if (this._isVisibleTop && this._isVisibleBottom) {\n                    this.$('.component-inner').off('inview');\n                    this.setCompletionStatus();\n                }\n\n            }\n        }\n\n    });\n\n    Adapt.register('blank', Blank);\n\n    return Blank;\n\n});\n\n","define('components/adapt-contrib-slider/js/adapt-contrib-slider',[\n  'coreViews/questionView',\n  'coreJS/adapt',\n  'libraries/rangeslider'\n], function(QuestionView, Adapt, Rangeslider) {\n\n    var Slider = QuestionView.extend({\n\n        tempValue:true,\n\n        events: {\n            'click .slider-scale-number': 'onNumberSelected',\n            'focus input[type=\"range\"]':'onHandleFocus',\n            'blur input[type=\"range\"]':'onHandleBlur'\n        },\n\n        // Used by the question to reset the question when revisiting the component\n        resetQuestionOnRevisit: function() {\n            this.setAllItemsEnabled();\n            this.deselectAllItems();\n            this.resetQuestion();\n        },\n\n        // Used by question to setup itself just before rendering\n        setupQuestion: function() {\n            if(!this.model.get('_items')) {\n                this.setupModelItems();\n            }\n\n            this.restoreUserAnswers();\n            if (this.model.get('_isSubmitted')) return;\n\n            this.selectItem(0, true);\n        },\n\n        setupRangeslider: function () {\n            this.$sliderScaleMarker = this.$('.slider-scale-marker');\n            this.$slider = this.$('input[type=\"range\"]');\n\n            if(this.model.has('_scaleStep')) {\n                this.$slider.attr({\"step\": this.model.get('_scaleStep')});\n            }\n\n            this.$slider.rangeslider({\n                polyfill: false,\n                onSlide: _.bind(this.handleSlide, this)\n            });\n            this.oldValue = 0;\n\n            if (this._deferEnable) {\n                this.setAllItemsEnabled();\n            }\n        },\n\n        handleSlide: function (position, value) {\n            if (this.oldValue === value) {\n               return;\n            }\n            if(this.model.get('_marginDir') == 'right'){\n                if(this.tempValue && (this.model.get('_userAnswer') == undefined)){\n                    value = this.model.get('_items').length - value + 1;\n                    this.tempValue = false;\n                    var tempPixels = this.mapIndexToPixels(value);\n                    var rangeSliderWidth = this.$('.rangeslider').width();\n                    var handleLeft = parseInt(this.$('.rangeslider__handle').css('left'));\n                    var sliderWidth = this.$('.rangeslider__fill').width();\n                    handleLeft = rangeSliderWidth - handleLeft -this.$('.rangeslider__handle').width();\n                    sliderWidth = rangeSliderWidth - sliderWidth;\n                    this.$('.rangeslider__handle').css('left',handleLeft);\n                    this.$('.rangeslider__fill').width(sliderWidth);\n                }\n            }\n            var itemIndex = this.getIndexFromValue(value);\n            var pixels = this.mapIndexToPixels(itemIndex);\n            this.selectItem(itemIndex, false);\n            this.animateToPosition(pixels);\n            this.oldValue = value;\n            this.tempValue = true;\n        },\n\n        setupModelItems: function() {\n            var items = [];\n            var answer = this.model.get('_correctAnswer');\n            var range = this.model.get('_correctRange');\n            var start = this.model.get('_scaleStart');\n            var end = this.model.get('_scaleEnd');\n            var step = this.model.get('_scaleStep') || 1;\n\n            for (var i = start; i <= end; i += step) {\n                if (answer) {\n                    items.push({value: i, selected: false, correct: (i == answer)});\n                } else {\n                    items.push({value: i, selected: false, correct: (i >= range._bottom && i <= range._top)});\n                }\n            }\n\n            this.model.set('_items', items);\n            this.model.set('_marginDir', (Adapt.config.get('_defaultDirection') === 'rtl' ? 'right' : 'left'));\n        },\n\n        restoreUserAnswers: function() {\n            if (!this.model.get('_isSubmitted')) {\n                this.model.set({\n                    _selectedItem: {},\n                    _userAnswer: undefined\n                });\n                return;\n            };\n\n            var items = this.model.get('_items');\n            var userAnswer = this.model.get('_userAnswer');\n            for (var i = 0, l = items.length; i < l; i++) {\n                var item = items[i];\n                if (item.value == userAnswer) {\n                    this.model.set('_selectedItem', item);\n                    this.selectItem(this.getIndexFromValue(item.value), true);\n                    break;\n                }\n            }\n\n            this.setQuestionAsSubmitted();\n            this.markQuestion();\n            this.setScore();\n            this.showMarking();\n            this.setupFeedback();\n        },\n\n        // Used by question to disable the question during submit and complete stages\n        disableQuestion: function() {\n            this.setAllItemsEnabled();\n        },\n\n        // Used by question to enable the question during interactions\n        enableQuestion: function() {\n            this.setAllItemsEnabled();\n        },\n\n        setAllItemsEnabled: function() {\n            var isEnabled = this.model.get('_isEnabled');\n\n            if (this.$slider) {\n                if (isEnabled) {\n                    this.$('.slider-widget').removeClass('disabled');\n                    this.$slider.prop('disabled', false);\n                    this.$slider.rangeslider('update', true);\n\n                } else {\n                    this.$('.slider-widget').addClass('disabled');\n                    this.$slider.prop('disabled', true);\n                    this.$slider.rangeslider('update', true);\n                }\n            } else {\n                this._deferEnable = true; // slider is not yet ready\n            }\n        },\n\n        // Used by question to setup itself just after rendering\n        onQuestionRendered: function() {\n            this.setupRangeslider();\n            this.setScalePositions();\n            this.onScreenSizeChanged();\n            this.showScaleMarker(true);\n            this.listenTo(Adapt, 'device:resize', this.onScreenSizeChanged);\n            this.setAltText(this.model.get('_scaleStart'));\n            this.setReadyStatus();\n        },\n\n        // this should make the slider handle, slider marker and slider bar to animate to give position\n        animateToPosition: function(newPosition) {\n            if (!this.$sliderScaleMarker) return;\n\n                this.$sliderScaleMarker\n                  .velocity('stop')\n                  .velocity({\n                    left: newPosition\n                  }, {\n                    duration: 200,\n                    easing: \"linear\"\n                  });\n        },\n\n        // this shoud give the index of item using given slider value\n        getIndexFromValue: function(itemValue) {\n            var scaleStart = this.model.get('_scaleStart'),\n                scaleEnd = this.model.get('_scaleEnd');\n            return Math.floor(this.mapValue(itemValue, scaleStart, scaleEnd, 0, this.model.get('_items').length - 1));\n        },\n\n        // this should set given value to slider handle\n        setAltText: function(value) {\n            this.$('.slider-handle').attr('aria-valuenow', value);\n        },\n\n        mapIndexToPixels: function(value, $widthObject) {\n            var numberOfItems = this.model.get('_items').length,\n                width = $widthObject ? $widthObject.width() : this.$('.slider-scaler').width();\n\n            return Math.round(this.mapValue(value, 0, numberOfItems - 1, 0, width));\n        },\n\n        mapPixelsToIndex: function(value) {\n            var numberOfItems = this.model.get('_items').length,\n                width = this.$('.slider-sliderange').width();\n\n            return Math.round(this.mapValue(value, 0, width, 0, numberOfItems - 1));\n        },\n\n        normalise: function(value, low, high) {\n            var range = high - low;\n            return (value - low) / range;\n        },\n\n        mapValue: function(value, inputLow, inputHigh, outputLow, outputHigh) {\n            var normal = this.normalise(value, inputLow, inputHigh);\n            return normal * (outputHigh - outputLow) + outputLow;\n        },\n\n        onHandleFocus: function(event) {\n            event.preventDefault();\n            this.$slider.on('keydown', _.bind(this.onKeyDown, this));\n        },\n\n        onHandleBlur: function(event) {\n            event.preventDefault();\n            this.$slider.off('keydown');\n        },\n\n        onKeyDown: function(event) {\n            if(event.which == 9) return; // tab key\n            event.preventDefault();\n\n            var newItemIndex = this.getIndexFromValue(this.model.get('_selectedItem').value);\n\n            switch (event.which) {\n                case 40: // ↓ down\n                case 37: // ← left\n                    newItemIndex = Math.max(newItemIndex - 1, 0);\n                    break;\n                case 38: // ↑ up\n                case 39: // → right\n                    newItemIndex = Math.min(newItemIndex + 1, this.model.get('_items').length - 1);\n                    break;\n            }\n\n            this.selectItem(newItemIndex);\n            if(typeof newItemIndex == 'number') this.showScaleMarker(true);\n            this.animateToPosition(this.mapIndexToPixels(newItemIndex));\n            this.setSliderValue(this.getValueFromIndex(newItemIndex));\n            this.setAltText(this.getValueFromIndex(newItemIndex));\n        },\n\n        onNumberSelected: function(event) {\n            event.preventDefault();\n            this.tempValue = false;\n\n            if (this.model.get('_isInteractionComplete')) {\n              return;\n            }\n\n            // when component is not reset, selecting a number should be prevented\n            if (this.$slider.prop('disabled')) {\n              return;\n            }\n\n            var itemValue = parseInt($(event.currentTarget).attr('data-id'));\n            var index = this.getIndexFromValue(itemValue);\n            this.selectItem(index);\n            this.animateToPosition(this.mapIndexToPixels(index));\n            this.setAltText(itemValue);\n            this.setSliderValue(itemValue)\n        },\n\n        getValueFromIndex: function(index) {\n          return this.model.get('_items')[index].value;\n        },\n\n        resetControlStyles: function() {\n            this.$('.slider-handle').empty();\n            this.showScaleMarker(false);\n            this.$('.slider-bar').animate({width:'0px'});\n            this.setSliderValue(this.model.get('_items')[0].value);\n        },\n\n        /**\n        * allow the user to submit immediately; the slider handle may already be in the position they want to choose\n        */\n        canSubmit: function() {\n            return true;\n        },\n\n        // Blank method for question to fill out when the question cannot be submitted\n        onCannotSubmit: function() {},\n\n        //This preserves the state of the users answers for returning or showing the users answer\n        storeUserAnswer: function() {\n            this.model.set('_userAnswer', this.model.get('_selectedItem').value);\n        },\n\n        isCorrect: function() {\n            var numberOfCorrectAnswers = 0;\n\n            _.each(this.model.get('_items'), function(item, index) {\n                if(item.selected && item.correct)  {\n                    this.model.set('_isAtLeastOneCorrectSelection', true);\n                    numberOfCorrectAnswers++;\n                }\n            }, this);\n\n            this.model.set('_numberOfCorrectAnswers', numberOfCorrectAnswers);\n\n            return this.model.get('_isAtLeastOneCorrectSelection') ? true : false;\n        },\n\n        // Used to set the score based upon the _questionWeight\n        setScore: function() {\n            var numberOfCorrectAnswers = this.model.get('_numberOfCorrectAnswers');\n            var questionWeight = this.model.get('_questionWeight');\n            var score = questionWeight * numberOfCorrectAnswers;\n            this.model.set('_score', score);\n        },\n\n        setSliderValue: function (value) {\n          if (this.$slider) {\n            this.$slider.val(value).change();\n          }\n        },\n\n        // This is important and should give the user feedback on how they answered the question\n        // Normally done through ticks and crosses by adding classes\n        showMarking: function() {\n            if (!this.model.get('_canShowMarking')) return;\n\n            this.$('.slider-widget').removeClass('correct incorrect')\n                .addClass(this.model.get('_selectedItem').correct ? 'correct' : 'incorrect');\n        },\n\n        isPartlyCorrect: function() {\n            return this.model.get('_isAtLeastOneCorrectSelection');\n        },\n\n        // Used by the question view to reset the stored user answer\n        resetUserAnswer: function() {\n            this.model.set({\n                _selectedItem: {},\n                _userAnswer: undefined\n            });\n        },\n\n        // Used by the question view to reset the look and feel of the component.\n        // This could also include resetting item data\n        resetQuestion: function() {\n            this.selectItem(0, true);\n            this.animateToPosition(0);\n            this.resetControlStyles();\n            this.showScaleMarker(true);\n            this.setAltText(this.model.get('_scaleStart'));\n        },\n\n        setScalePositions: function() {\n            var numberOfItems = this.model.get('_items').length;\n            _.each(this.model.get('_items'), function(item, index) {\n                var normalisedPosition = this.normalise(index, 0, numberOfItems -1);\n                this.$('.slider-scale-number').eq(index).data('normalisedPosition', normalisedPosition);\n            }, this);\n        },\n\n        showScale: function () {\n            this.$('.slider-markers').empty();\n            if (this.model.get('_showScale') === false) {\n                this.$('.slider-markers').eq(0).css({display: 'none'});\n                this.model.get('_showScaleIndicator')\n                    ? this.$('.slider-scale-numbers').eq(0).css({visibility: 'hidden'})\n                    : this.$('.slider-scale-numbers').eq(0).css({display: 'none'});\n            } else {\n                var $scaler = this.$('.slider-scaler');\n                var $markers = this.$('.slider-markers');\n                for (var i = 0, count = this.model.get('_items').length; i < count; i++) {\n                    $markers.append(\"<div class='slider-line component-item-color'>\");\n                    $('.slider-line', $markers).eq(i).css({left: this.mapIndexToPixels(i, $scaler) + 'px'});\n                }\n                var scaleWidth = $scaler.width(),\n                    $numbers = this.$('.slider-scale-number');\n                for (var i = 0, count = this.model.get('_items').length; i < count; i++) {\n                    var $number = $numbers.eq(i),\n                        newLeft = Math.round($number.data('normalisedPosition') * scaleWidth);\n                    if($('html').hasClass('ie9') && this.model.get('_marginDir')=='right'){\n\t\t\t\t\t\t$number.css({right: newLeft});\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\t$number.css({left: newLeft});\n                    }\n                }\n            }\n        },\n\n        //Labels are enabled in slider.hbs. Here we manage their containing div.\n        showLabels: function () {\n            if(!this.model.get('labelStart') && !this.model.get('labelEnd')) {\n                this.$('.slider-scale-labels').eq(0).css({display: 'none'});\n            }\n        },\n\n        remapSliderBar: function() {\n            var $scaler = this.$('.slider-scaler');\n            var currentIndex = this.getIndexFromValue(this.model.get('_selectedItem').value);\n            var left = this.mapIndexToPixels(currentIndex, $scaler);\n            this.$('.slider-handle').css({left: left + 'px'});\n            this.$('.slider-scale-marker').css({left: left + 'px'});\n            this.$('.slider-bar').width(left);\n            //updated position of rangeslider bar on window resize for RTL \n            if (this.model.get('_marginDir') == 'right') {\n                _.delay(function() {\n                    this.$('.rangeslider__handle').css('left', left);\n                    this.$('.rangeslider__fill').css('width', left + (this.$('.rangeslider__handle').width() / 2));\n                }, 300, this);\n            }\n        },\n\n        onScreenSizeChanged: function() {\n            this.showScale();\n            this.showLabels();\n            this.remapSliderBar();\n            if (this.$('.slider-widget').hasClass('show-user-answer')) {\n                this.hideCorrectAnswer();\n            } else if (this.$('.slider-widget').hasClass('show-correct-answer')) {\n                this.showCorrectAnswer();\n            }\n        },\n\n        showCorrectAnswer: function() {\n            var answers = [];\n\n            if(this.model.has('_correctAnswer')) {\n                var correctAnswer = this.model.get('_correctAnswer');\n            }\n\n            if (this.model.has('_correctRange')) {\n                var bottom = this.model.get('_correctRange')._bottom;\n                var top = this.model.get('_correctRange')._top;\n                var step = (this.model.has('_scaleStep') ? this.model.get('_scaleStep') : 1);\n            }\n\n            this.showScaleMarker(false);\n\n            //are we dealing with a single correct answer or a range?\n            if (correctAnswer) {\n                answers.push(correctAnswer);\n            } else if (bottom !== undefined && top !== undefined) {\n                var answer = this.model.get('_correctRange')._bottom;\n                var topOfRange = this.model.get('_correctRange')._top;\n                while(answer <= topOfRange) {\n                    answers.push(answer);\n                    answer += step;\n                }\n            } else {\n                console.log(\"adapt-contrib-slider::WARNING: no correct answer or correct range set in JSON\")\n            }\n\n            var middleAnswer = answers[Math.floor(answers.length / 2)];\n            this.animateToPosition(this.mapIndexToPixels(this.getIndexFromValue(middleAnswer)));\n\n            this.showModelAnswers(answers);\n\n            this.setSliderValue(middleAnswer);\n        },\n\n        showModelAnswers: function(correctAnswerArray) {\n            var $parentDiv = this.$('.slider-modelranges');\n            _.each(correctAnswerArray, function(correctAnswer, index) {\n                $parentDiv.append($(\"<div class='slider-model-answer component-item-color component-item-text-color'>\"));\n\n                var $element = $(this.$('.slider-modelranges .slider-model-answer')[index]),\n                    startingLeft = this.mapIndexToPixels(this.getIndexFromValue(this.model.get('_selectedItem').value));\n\n                if(this.model.get('_showNumber')) $element.html(correctAnswer);\n\n                $element.css({left:startingLeft}).fadeIn(0, _.bind(function() {\n                    $element.animate({left: this.mapIndexToPixels(this.getIndexFromValue(correctAnswer))});\n                }, this));\n            }, this);\n        },\n\n        // Used by the question to display the users answer and\n        // hide the correct answer\n        // Should use the values stored in storeUserAnswer\n        hideCorrectAnswer: function() {\n            var userAnswerIndex = this.getIndexFromValue(this.model.get('_userAnswer'));\n            this.$('.slider-modelranges').empty();\n\n            this.showScaleMarker(true);\n            this.selectItem(userAnswerIndex, true);\n            this.animateToPosition(this.mapIndexToPixels(userAnswerIndex));\n            this.setSliderValue(this.model.get('_userAnswer'));\n        },\n\n        // according to given item index this should make the item as selected\n        selectItem: function(itemIndex, noFocus) {\n            this.$el.a11y_selected(false);\n            _.each(this.model.get('_items'), function(item, index) {\n                item.selected = (index == itemIndex);\n                if(item.selected) {\n                    this.model.set('_selectedItem', item);\n                    this.$('.slider-scale-number[data-id=\"'+item.value+'\"]').a11y_selected(true, noFocus);\n                }\n            }, this);\n            this.showNumber(true);\n        },\n\n        // this should reset the selected state of each item\n        deselectAllItems: function() {\n            _.each(this.model.get('_items'), function(item) {\n                item.selected = false;\n            }, this);\n        },\n\n        // this makes the marker visible or hidden\n        showScaleMarker: function(show) {\n            var $scaleMarker = this.$('.slider-scale-marker');\n            if (this.model.get('_showScaleIndicator')) {\n                this.showNumber(show);\n                if(show) {\n                    $scaleMarker.addClass('display-block');\n                } else {\n                    $scaleMarker.removeClass('display-block');\n                }\n            }\n        },\n\n        // this should add the current slider value to the marker\n        showNumber: function(show) {\n            var $scaleMarker = this.$('.slider-scale-marker');\n            if(this.model.get('_showNumber')) {\n                if(show) {\n                    $scaleMarker.html(this.model.get('_selectedItem').value);\n                } else {\n                    $scaleMarker.html = \"\";\n                }\n            }\n        },\n\n        /**\n        * Used by adapt-contrib-spoor to get the user's answers in the format required by the cmi.interactions.n.student_response data field\n        */\n        getResponse:function() {\n            return this.model.get('_userAnswer').toString();\n        },\n\n        /**\n        * Used by adapt-contrib-spoor to get the type of this question in the format required by the cmi.interactions.n.type data field\n        */\n        getResponseType:function() {\n            return \"numeric\";\n        }\n\n    });\n\n    Adapt.register('slider', Slider);\n\n    return Slider;\n});\n\n","define('components/adapt-contrib-confidenceSlider/js/adapt-contrib-confidenceSlider',[\n    'components/adapt-contrib-slider/js/adapt-contrib-slider',\n    'core/js/adapt'\n], function(Slider, Adapt) {\n\n    var ConfidenceSlider = Slider.extend({\n\n        /* override */\n        preRender:function() {\n            this.model.set('_isEnabled', true);\n            Slider.prototype.preRender.apply(this, arguments);\n        },\n\n        /* override */\n        setupDefaultSettings: function() {\n            Slider.prototype.setupDefaultSettings.apply(this, arguments);\n            this.model.set('_canShowModelAnswer', false);\n            if (!this.model.has('_attempts') || this.model.get('_attempts') > 1) this.model.set('_attempts', 1);\n        },\n\n        /* override */\n        setupQuestion: function() {\n            if (this.model.get('_linkedToId')) {\n                this._setupLinkedModel();\n                this.listenTo(Adapt, \"buttonsView:postRender\", this.onButtonsRendered);\n            }\n            Slider.prototype.setupQuestion.apply(this, arguments);\n        },\n\n        /* override */\n        disableQuestion: function() {\n            if (this.model.get('_isReady')) this.setAllItemsEnabled(false);\n            if (this.model.has('_linkedModel')) this.$('.buttons-action').a11y_cntrl_enabled(false);\n        },\n\n        /* override */\n        enableQuestion: function() {\n            if (this.model.get('_isReady')) this.setAllItemsEnabled(true);\n            if (this.model.has('_linkedModel')) this.$('.buttons-action').a11y_cntrl_enabled(true);\n        },\n\n        /* override to indicate that all options are correct */\n        setupModelItems: function() {\n            var items = [];\n            var start = this.model.get('_scaleStart');\n            var end = this.model.get('_scaleEnd');\n            var step = this.model.get('_scaleStep') || 1;\n\n            for (var i = start; i <= end; i += step) {\n                items.push({value: i, selected: false, correct: true});\n            }\n\n            this.model.set('_items', items);\n            this.model.set('_marginDir', (Adapt.config.get('_defaultDirection') === 'rtl' ? 'right' : 'left'));\n        },\n\n        /* override */\n        restoreUserAnswers: function() {\n            if (!this.model.get('_isSubmitted')) {\n                this.model.set({\n                    _selectedItem: {},\n                    _userAnswer: undefined\n                });\n                return;\n            }\n\n            // this is only necessary to avoid an issue when using adapt-devtools\n            if (!this.model.has('_userAnswer')) this.model.set('_userAnswer', this.model.get('_items')[0].value);\n\n            Slider.prototype.restoreUserAnswers.apply(this, arguments);\n        },\n\n        /* override */\n        canSubmit: function() {\n            return !this.model.has('_linkedModel') || this.model.get('_linkedModel').get('_isSubmitted');\n        },\n\n        /* override */\n        setupFeedback: function(){\n            this.model.set('feedbackTitle', this.model.get('title'));\n            this.model.set('feedbackMessage', this._getFeedbackString());\n        },\n\n        /* override */\n        updateButtons: function() {\n            if (this.model.get('_attempts') > 0) {\n                Slider.prototype.updateButtons.apply(this, arguments);\n            }\n            else {\n                this.model.set('_buttonState', this.model.get('_isEnabled') ? 'submit' : 'reset');\n            }\n\n        },\n\n        _setupLinkedModel: function() {\n            var linkedModel = Adapt.components.findWhere({_id: this.model.get('_linkedToId')});\n            this.model.set({\n                '_showNumber':linkedModel.get('_showNumber'),\n                '_showScaleIndicator':linkedModel.get('_showScaleIndicator'),\n                '_showScale':linkedModel.get('_showScale'),\n                'labelStart':linkedModel.get('labelStart'),\n                'labelEnd':linkedModel.get('labelEnd'),\n                '_scaleStart':linkedModel.get('_scaleStart'),\n                '_scaleEnd':linkedModel.get('_scaleEnd')\n            });\n            this.model.set('_linkedModel', linkedModel);\n            if (this.model.get('_attempts') < 0) linkedModel.set('_attempts', 1);\n        },\n\n        _listenToLinkedModel: function() {\n            this.listenTo(this.model.get('_linkedModel'), 'change:_selectedItem', this.onLinkedConfidenceChanged);\n            this.listenTo(this.model.get('_linkedModel'), 'change:_isSubmitted', this.onLinkedSubmittedChanged);\n        },\n\n        _updateLinkedConfidenceIndicator: function() {\n            var lm = this.model.get('_linkedModel');\n            var linkedValue = 0;\n            var rangeslider = this.$slider.data('plugin_rangeslider');\n\n            //if (lm.get('_isSubmitted')) {\n                linkedValue = lm.has('_userAnswer') ? lm.get('_userAnswer') : lm.get('_selectedItem').value;\n            //}\n\n            if (linkedValue == this.model.get('_scaleEnd')) {\n                this.$('.linked-confidence-bar').css({width: '100%'});\n            }\n            else {\n                // follow rangeslider setPosition method\n                this.$('.linked-confidence-bar').css({width: (rangeslider.getPositionFromValue(linkedValue) + rangeslider.grabPos) + 'px'});\n            }\n        },\n\n        _getFeedbackString: function() {\n            var feedbackSeparator = this.model.get('_feedback').feedbackSeparator,\n                genericFeedback = this._getGenericFeedback(),\n                comparisonFeedback = this.model.has('_linkedModel') && this.model.get('_linkedModel').get('_isSubmitted') ? this._getComparisonFeedback() : null,\n                thresholdFeedback = this._getThresholdFeedback(),\n                needsSeparator = false,\n                feedbackString = \"\";\n\n            if (genericFeedback) {\n                feedbackString += genericFeedback;\n                needsSeparator = true;\n            }\n            if (comparisonFeedback) {\n                if(needsSeparator) feedbackString += feedbackSeparator;\n                feedbackString += comparisonFeedback;\n                needsSeparator = true;\n            }\n            if (thresholdFeedback) {\n                if(needsSeparator) feedbackString += feedbackSeparator;\n                feedbackString += thresholdFeedback;\n            }\n\n            return feedbackString;\n\n        },\n\n        _getGenericFeedback: function() {\n            return this.model.get('_feedback').generic;\n        },\n\n        _getComparisonFeedback: function() {\n            var lm = this.model.get('_linkedModel'),\n                confidence = this.model.get('_selectedItem').value,\n                linkedConfidence = lm.has('_userAnswer') ? lm.get('_userAnswer') : lm.get('_selectedItem').value,\n                feedbackString;\n            if (linkedConfidence < confidence) {\n                feedbackString = this.model.get('_feedback')._comparison.higher;\n            } else if (linkedConfidence > confidence) {\n                feedbackString = this.model.get('_feedback')._comparison.lower;\n            } else {\n                feedbackString = this.model.get('_feedback')._comparison.same;\n            }\n            return feedbackString;\n        },\n\n        _getThresholdFeedback: function() {\n            var feedbackList = this.model.get('_feedback')._threshold;\n\n            if (!feedbackList) return;\n\n            var confidenceValue = this.model.get('_selectedItem').value;\n\n            for (var i = 0, j = feedbackList.length; i < j; i++) {\n                var feedback = feedbackList[i];\n                var values = feedback._values;\n\n                if (confidenceValue >= values._low && confidenceValue <= values._high) {\n                    return feedback.text;\n                }\n            }\n        },\n\n        _getTrackingData:function() {\n            if (this.model.get('_isInteractionComplete') === false || this.model.get('_isComplete') === false) {\n                return null;\n            }\n\n            var hasUserAnswer = (this.model.get('_userAnswer') !== undefined);\n            var isUserAnswerArray = (this.model.get('_userAnswer') instanceof Array);\n\n            var numericParameters = [\n                    this.model.get('_score') || 0,\n                    this.model.get('_attemptsLeft') || 0\n                ];\n\n            var booleanParameters = [\n                    hasUserAnswer ? 1 : 0,\n                    isUserAnswerArray ? 1 : 0,\n                    this.model.get('_isInteractionComplete') ? 1 : 0,\n                    this.model.get('_isSubmitted') ? 1 : 0,\n                    this.model.get('_isCorrect') ? 1 : 0\n                ];\n\n            var data = [\n                numericParameters,\n                booleanParameters\n            ];\n\n\n            if (hasUserAnswer) {\n                var userAnswer = isUserAnswerArray ? this.model.get('_userAnswer') : [this.model.get('_userAnswer')];\n\n                data.push(userAnswer);\n            }\n\n            return data;\n        },\n\n        _updateTracking:function() {\n            // should we track this component?\n            if (this.model.get('_shouldStoreResponses')) {\n                // is tracking is enabled?\n                if (Adapt.config.has('_spoor') && Adapt.config.get('_spoor')._isEnabled) {\n                    // if spoor is handling response tracking we don't need to do anything\n                    if (!Adapt.config.get('_spoor')._tracking._shouldStoreResponses) {\n                        // otherwise write custom tracking data\n                        Adapt.offlineStorage.set(this.model.get('_id'), this._getTrackingData());\n                    }\n                }\n            }\n        },\n\n        onQuestionRendered: function() {\n            Slider.prototype.onQuestionRendered.apply(this, arguments);\n\n            if (this.model.has('_linkedModel')) {\n                this.$('.rangeslider').prepend($('<div class=\"linked-confidence-bar\"/>'));\n                this._listenToLinkedModel();\n                if (this.model.get('_linkedModel').get('_isSubmitted')) {\n                    this.onLinkedConfidenceChanged();\n                } else {\n                    this.model.set('_isEnabled', false);\n                    this.$('.component-body-inner').html(this.model.get('disabledBody'));\n                }\n            }\n\n            if (this.model.get('_isSubmitted') && this.model.has('_userAnswer')) {\n                this.model.set('feedbackTitle', this.model.get('title'));\n                this.model.set('feedbackMessage', this._getFeedbackString());\n            }\n        },\n\n        onScreenSizeChanged: function() {\n            Slider.prototype.onScreenSizeChanged.apply(this, arguments);\n\n            // if linked slider on same page update it with user interaction\n            if (this.model.has('_linkedModel') && this.model.get('_linkedModel').get('_isReady')) {\n                this._updateLinkedConfidenceIndicator();\n            }\n        },\n\n        onResetClicked: function() {\n            Slider.prototype.onResetClicked.apply(this, arguments);\n\n            this.model.reset('hard', true);\n\n            this._updateTracking();\n        },\n\n        onSubmitClicked: function() {\n            Slider.prototype.onSubmitClicked.apply(this, arguments);\n\n            this._updateTracking();\n        },\n\n        onButtonsRendered:function(buttonsView) {\n            // necessary due to deferred ButtonsView::postRender\n            if (this.buttonsView == buttonsView) {\n                if (!this.model.get('_isEnabled')) {\n                    if (!this.model.has('_linkedModel') || !this.model.get('_linkedModel').get('_isSubmitted')) {\n                        this.$('.buttons-action').a11y_cntrl_enabled(false);\n                    }\n                }\n            }\n        },\n\n        onLinkedConfidenceChanged: function() {\n            this._updateLinkedConfidenceIndicator();\n        },\n\n        onLinkedSubmittedChanged: function(linkedModel) {\n            if (linkedModel.get('_isSubmitted')) {\n                this.model.set('_isEnabled', true);\n            }\n            else {\n                this.model.set('_isEnabled', false);\n            }\n        }\n    }, {\n        template:'confidenceSlider'\n    });\n    \n    Adapt.register(\"confidenceSlider\", ConfidenceSlider);\n\n    Adapt.on('app:dataReady', function() {\n        // is tracking enabled?\n        if (Adapt.config.has('_spoor') && Adapt.config.get('_spoor')._isEnabled) {\n            // if spoor is handling response tracking we don't need to do anything\n            if (!Adapt.config.get('_spoor')._tracking._shouldStoreResponses) {\n                // ensure data is setup\n                Adapt.offlineStorage.get();\n\n                _.each(Adapt.components.where({'_component':'confidenceSlider', '_shouldStoreResponses':true}), function(confidenceSlider) {\n                    var dataItem = Adapt.offlineStorage.get(confidenceSlider.get('_id'));\n\n                    if (!dataItem) return;\n\n                    var numericParameters = dataItem[0];\n                    var booleanParameters = dataItem[1];\n\n                    var score = numericParameters[0];\n                    var attemptsLeft = numericParameters[1] || 0;\n\n                    var hasUserAnswer = booleanParameters[0];\n                    var isUserAnswerArray = booleanParameters[1];\n                    var isInteractionComplete = booleanParameters[2];\n                    var isSubmitted = booleanParameters[3];\n                    var isCorrect = booleanParameters[4];\n\n                    confidenceSlider.set(\"_isComplete\", true);\n                    confidenceSlider.set(\"_isInteractionComplete\", isInteractionComplete);\n                    confidenceSlider.set(\"_isSubmitted\", isSubmitted);\n                    confidenceSlider.set(\"_score\", score);\n                    confidenceSlider.set(\"_isCorrect\", isCorrect);\n                    confidenceSlider.set(\"_attemptsLeft\", attemptsLeft);\n\n                    if (hasUserAnswer) {\n                        var userAnswer = dataItem[2];\n                        if (!isUserAnswerArray) userAnswer = userAnswer[0];\n\n                        confidenceSlider.set(\"_userAnswer\", userAnswer);\n                    }\n                });\n            }\n        }\n    });\n    \n    return ConfidenceSlider;\n});\n\n","/*\n * adapt-contrib-flipcard\n * License - https://github.com/ExultCorp/adapt-contrib-flipcard/blob/master/LICENSE\n * Maintainers - Himanshu Rajotia <himanshu.rajotia@exultcorp.com>\n */\ndefine('components/adapt-contrib-flipcard/js/adapt-contrib-flipcard',[\n    'coreViews/componentView',\n    'coreJS/adapt'\n], function(ComponentView, Adapt) {\n\n    var Flipcard = ComponentView.extend({\n\n        events: {\n            'click .flipcard-item': 'onClickFlipItem'\n        },\n\n        preRender: function() {\n            this.listenTo(Adapt, 'device:resize', this.reRender, this);\n            this.checkIfResetOnRevisit();\n        },\n\n        // this is use to set ready status for current component on postRender.\n        postRender: function() {\n            if (!Modernizr.csstransforms3d) {\n                this.$('.flipcard-item-back').hide();\n            }\n\n            this.$('.flipcard-widget').imageready(_.bind(function() {\n                this.setReadyStatus();\n                this.reRender();\n            }, this));\n        },\n\n        // Used to check if the flipcard should reset on revisit\n        checkIfResetOnRevisit: function() {\n            var isResetOnRevisit = this.model.get('_isResetOnRevisit');\n\n            // If reset is enabled set defaults\n            if (isResetOnRevisit) {\n                this.model.reset(isResetOnRevisit);\n            }\n\n            _.each(this.model.get('_items'), function(item) {\n                item._isVisited = false;\n            });\n        },\n\n        // This function called on triggering of device resize and device change event of Adapt.\n        reRender: function() {\n            var imageHeight = this.$('.flipcard-item-frontImage').eq(0).height();\n            if (imageHeight) {\n                this.$('.flipcard-item').height(imageHeight);\n            }\n        },\n\n        // Click or Touch event handler for flip card.\n        onClickFlipItem: function(event) {\n            if(event && event.target.tagName.toLowerCase() === 'a') {\n                return;\n            } else {\n                event && event.preventDefault();\n            }\n\n            var $selectedElement = $(event.currentTarget);\n            var flipType = this.model.get('_flipType');\n            if (flipType === 'allFlip') {\n                this.performAllFlip($selectedElement);\n            } else if (flipType === 'singleFlip') {\n                this.performSingleFlip($selectedElement);\n            }\n        },\n\n        // This function will be responsible to perform All flip on flipcard\n        // where all cards can flip and stay in the flipped state.\n        performAllFlip: function($selectedElement) {\n            if (!Modernizr.csstransforms3d) {\n                var $frontflipcard = $selectedElement.find('.flipcard-item-front');\n                var $backflipcard = $selectedElement.find('.flipcard-item-back');\n                var flipTime = this.model.get('_flipTime') || 'fast';\n                if ($frontflipcard.is(':visible')) {\n                    $frontflipcard.fadeOut(flipTime, function() {\n                        $backflipcard.fadeIn(flipTime);\n                    });\n                } else if ($backflipcard.is(':visible')) {\n                    $backflipcard.fadeOut(flipTime, function() {\n                        $frontflipcard.fadeIn(flipTime);\n                    });\n                }\n            } else {\n                $selectedElement.toggleClass('flipcard-flip');\n            }\n\n            var flipcardElementIndex = this.$('.flipcard-item').index($selectedElement);\n            this.setVisited(flipcardElementIndex);\n        },\n\n        // This function will be responsible to perform Single flip on flipcard where\n        // only one card can flip and stay in the flipped state.\n        performSingleFlip: function($selectedElement) {\n            var flipcardContainer = $selectedElement.closest('.flipcard-widget');\n            if (!Modernizr.csstransforms3d) {\n                var frontflipcard = $selectedElement.find('.flipcard-item-front');\n                var backflipcard = $selectedElement.find('.flipcard-item-back');\n                var flipTime = this.model.get('_flipTime') || 'fast';\n\n                if (backflipcard.is(':visible')) {\n                    backflipcard.fadeOut(flipTime, function() {\n                        frontflipcard.fadeIn(flipTime);\n                    });\n                } else {\n                    var visibleflipcardBack = flipcardContainer.find('.flipcard-item-back:visible');\n                    if (visibleflipcardBack.length > 0) {\n                        visibleflipcardBack.fadeOut(flipTime, function() {\n                            flipcardContainer.find('.flipcard-item-front:hidden').fadeIn(flipTime);\n                        });\n                    }\n                    frontflipcard.fadeOut(flipTime, function() {\n                        backflipcard.fadeIn(flipTime);\n                    });\n                }\n            } else {\n                if ($selectedElement.hasClass('flipcard-flip')) {\n                    $selectedElement.removeClass('flipcard-flip');\n                } else {\n                    flipcardContainer.find('.flipcard-item').removeClass('flipcard-flip');\n                    $selectedElement.addClass('flipcard-flip');\n                }\n            }\n\n            var flipcardElementIndex = this.$('.flipcard-item').index($selectedElement);\n            this.setVisited(flipcardElementIndex);\n        },\n\n        // This function will set the visited status for particular flipcard item.\n        setVisited: function(index) {\n            var item = this.model.get('_items')[index];\n            item._isVisited = true;\n            this.checkCompletionStatus();\n        },\n\n        // This function will be used to get visited states of all flipcard items.\n        getVisitedItems: function() {\n            return _.filter(this.model.get('_items'), function(item) {\n                return item._isVisited;\n            });\n        },\n\n        // This function will check or set the completion status of current component.\n        checkCompletionStatus: function() {\n            if (this.getVisitedItems().length === this.model.get('_items').length) {\n                this.setCompletionStatus();\n            }\n        }\n    });\n\n    Adapt.register('flipcard', Flipcard);\n\n    return Flipcard;\n\n});\n\n","define('components/adapt-contrib-mcq/js/adapt-contrib-mcq',['require','coreViews/questionView','coreJS/adapt'],function(require) {\n    var QuestionView = require('coreViews/questionView');\n    var Adapt = require('coreJS/adapt');\n\n    var Mcq = QuestionView.extend({\n\n        events: {\n            'focus .mcq-item input':'onItemFocus',\n            'blur .mcq-item input':'onItemBlur',\n            'change .mcq-item input':'onItemSelected',\n            'keyup .mcq-item input':'onKeyPress'\n        },\n\n        resetQuestionOnRevisit: function() {\n            this.setAllItemsEnabled(true);\n            this.resetQuestion();\n        },\n\n        setupQuestion: function() {\n            // if only one answer is selectable, we should display radio buttons not checkboxes\n            this.model.set(\"_isRadio\", (this.model.get(\"_selectable\") == 1) );\n            \n            this.model.set('_selectedItems', []);\n\n            this.setupQuestionItemIndexes();\n\n            this.setupRandomisation();\n            \n            this.restoreUserAnswers();\n        },\n\n        setupQuestionItemIndexes: function() {\n            var items = this.model.get(\"_items\");\n            if (items && items.length > 0) {\n                for (var i = 0, l = items.length; i < l; i++) {\n                    if (items[i]._index === undefined) items[i]._index = i;\n                }\n            }\n        },\n\n        setupRandomisation: function() {\n            if (this.model.get('_isRandom') && this.model.get('_isEnabled')) {\n                this.model.set(\"_items\", _.shuffle(this.model.get(\"_items\")));\n            }\n        },\n\n        restoreUserAnswers: function() {\n            if (!this.model.get(\"_isSubmitted\")) return;\n\n            var selectedItems = [];\n            var items = this.model.get(\"_items\");\n            var userAnswer = this.model.get(\"_userAnswer\");\n            _.each(items, function(item, index) {\n                item._isSelected = userAnswer[item._index];\n                if (item._isSelected) {\n                    selectedItems.push(item)\n                }\n            });\n\n            this.model.set(\"_selectedItems\", selectedItems);\n\n            this.setQuestionAsSubmitted();\n            this.markQuestion();\n            this.setScore();\n            this.showMarking();\n            this.setupFeedback();\n        },\n\n        disableQuestion: function() {\n            this.setAllItemsEnabled(false);\n        },\n\n        enableQuestion: function() {\n            this.setAllItemsEnabled(true);\n        },\n\n        setAllItemsEnabled: function(isEnabled) {\n            _.each(this.model.get('_items'), function(item, index){\n                var $itemLabel = this.$('label').eq(index);\n                var $itemInput = this.$('input').eq(index);\n\n                if (isEnabled) {\n                    $itemLabel.removeClass('disabled');\n                    $itemInput.prop('disabled', false);\n                } else {\n                    $itemLabel.addClass('disabled');\n                    $itemInput.prop('disabled', true);\n                }\n            }, this);\n        },\n\n        onQuestionRendered: function() {\n            this.setReadyStatus();\n        },\n\n        onKeyPress: function(event) {\n            if (event.which === 13) { //<ENTER> keypress\n                this.onItemSelected(event);\n            }\n        },\n\n        onItemFocus: function(event) {\n            if(this.model.get('_isEnabled') && !this.model.get('_isSubmitted')){\n                $(\"label[for='\"+$(event.currentTarget).attr('id')+\"']\").addClass('highlighted');\n            }\n        },\n        \n        onItemBlur: function(event) {\n            $(\"label[for='\"+$(event.currentTarget).attr('id')+\"']\").removeClass('highlighted');\n        },\n\n        onItemSelected: function(event) {\n            if(this.model.get('_isEnabled') && !this.model.get('_isSubmitted')){\n                var selectedItemObject = this.model.get('_items')[$(event.currentTarget).parent('.component-item').index()];\n                this.toggleItemSelected(selectedItemObject, event);\n            }\n        },\n\n        toggleItemSelected:function(item, clickEvent) {\n            var selectedItems = this.model.get('_selectedItems');\n            var itemIndex = _.indexOf(this.model.get('_items'), item),\n                $itemLabel = this.$('label').eq(itemIndex),\n                $itemInput = this.$('input').eq(itemIndex),\n                selected = !$itemLabel.hasClass('selected');\n            \n                if(selected) {\n                    if(this.model.get('_selectable') === 1){\n                        this.$('label').removeClass('selected');\n                        this.$('input').prop('checked', false);\n                        this.deselectAllItems();\n                        selectedItems[0] = item;\n                    } else if(selectedItems.length < this.model.get('_selectable')) {\n                     selectedItems.push(item);\n                 } else {\n                    clickEvent.preventDefault();\n                    return;\n                }\n                $itemLabel.addClass('selected');\n                $itemLabel.a11y_selected(true);\n            } else {\n                selectedItems.splice(_.indexOf(selectedItems, item), 1);\n                $itemLabel.removeClass('selected');\n                $itemLabel.a11y_selected(false);\n            }\n            $itemInput.prop('checked', selected);\n            item._isSelected = selected;\n            this.model.set('_selectedItems', selectedItems);\n        },\n\n        // check if the user is allowed to submit the question\n        canSubmit: function() {\n            var count = 0;\n\n            _.each(this.model.get('_items'), function(item) {\n                if (item._isSelected) {\n                    count++;\n                }\n            }, this);\n\n            return (count > 0) ? true : false;\n\n        },\n\n        // Blank method to add functionality for when the user cannot submit\n        // Could be used for a popup or explanation dialog/hint\n        onCannotSubmit: function() {},\n\n        // This is important for returning or showing the users answer\n        // This should preserve the state of the users answers\n        storeUserAnswer: function() {\n            var userAnswer = [];\n\n            var items = this.model.get('_items').slice(0);\n            items.sort(function(a, b) {\n                return a._index - b._index;\n            });\n\n            _.each(items, function(item, index) {\n                userAnswer.push(item._isSelected);\n            }, this);\n            this.model.set('_userAnswer', userAnswer);\n        },\n\n        isCorrect: function() {\n\n            var numberOfRequiredAnswers = 0;\n            var numberOfCorrectAnswers = 0;\n            var numberOfIncorrectAnswers = 0;\n\n            _.each(this.model.get('_items'), function(item, index) {\n\n                var itemSelected = (item._isSelected || false);\n\n                if (item._shouldBeSelected) {\n                    numberOfRequiredAnswers ++;\n\n                    if (itemSelected) {\n                        numberOfCorrectAnswers ++;\n                        \n                        item._isCorrect = true;\n\n                        this.model.set('_isAtLeastOneCorrectSelection', true);\n                    }\n\n                } else if (!item._shouldBeSelected && itemSelected) {\n                    numberOfIncorrectAnswers ++;\n                }\n\n            }, this);\n\n            this.model.set('_numberOfCorrectAnswers', numberOfCorrectAnswers);\n            this.model.set('_numberOfRequiredAnswers', numberOfRequiredAnswers);\n\n            // Check if correct answers matches correct items and there are no incorrect selections\n            var answeredCorrectly = (numberOfCorrectAnswers === numberOfRequiredAnswers) && (numberOfIncorrectAnswers === 0);\n            return answeredCorrectly;\n        },\n\n        // Sets the score based upon the questionWeight\n        // Can be overwritten if the question needs to set the score in a different way\n        setScore: function() {\n            var questionWeight = this.model.get(\"_questionWeight\");\n            var answeredCorrectly = this.model.get('_isCorrect');\n            var score = answeredCorrectly ? questionWeight : 0;\n            this.model.set('_score', score);\n        },\n\n        setupFeedback: function() {\n\n            if (this.model.get('_isCorrect')) {\n                this.setupCorrectFeedback();\n            } else if (this.isPartlyCorrect()) {\n                this.setupPartlyCorrectFeedback();\n            } else {\n                // apply individual item feedback\n                if((this.model.get('_selectable') === 1) && this.model.get('_selectedItems')[0].feedback) {\n                    this.setupIndividualFeedback(this.model.get('_selectedItems')[0]);\n                    return;\n                } else {\n                    this.setupIncorrectFeedback();\n                }\n            }\n        },\n\n        setupIndividualFeedback: function(selectedItem) {\n             this.model.set({\n                 feedbackTitle: this.model.get('title'),\n                 feedbackMessage: selectedItem.feedback\n             });\n        },\n\n        // This is important and should give the user feedback on how they answered the question\n        // Normally done through ticks and crosses by adding classes\n        showMarking: function() {\n            if (!this.model.get('_canShowMarking')) return;\n\n            _.each(this.model.get('_items'), function(item, i) {\n                var $item = this.$('.component-item').eq(i);\n                $item.removeClass('correct incorrect').addClass(item._isCorrect ? 'correct' : 'incorrect');\n            }, this);\n        },\n\n        isPartlyCorrect: function() {\n            return this.model.get('_isAtLeastOneCorrectSelection');\n        },\n\n        resetUserAnswer: function() {\n            this.model.set({_userAnswer: []});\n        },\n\n        // Used by the question view to reset the look and feel of the component.\n        resetQuestion: function() {\n\n            this.deselectAllItems();\n            this.resetItems();\n        },\n\n        deselectAllItems: function() {\n            this.$el.a11y_selected(false);\n            _.each(this.model.get('_items'), function(item) {\n                item._isSelected = false;\n            }, this);\n        },\n\n        resetItems: function() {\n            this.$('.component-item label').removeClass('selected');\n            this.$('.component-item').removeClass('correct incorrect');\n            this.$('input').prop('checked', false);\n            this.model.set({\n                _selectedItems: [],\n                _isAtLeastOneCorrectSelection: false\n            });\n        },\n\n        showCorrectAnswer: function() {\n            _.each(this.model.get('_items'), function(item, index) {\n                this.setOptionSelected(index, item._shouldBeSelected);\n            }, this);\n        },\n\n        setOptionSelected:function(index, selected) {\n            var $itemLabel = this.$('label').eq(index);\n            var $itemInput = this.$('input').eq(index);\n            if (selected) {\n                $itemLabel.addClass('selected');\n                $itemInput.prop('checked', true);\n            } else {\n                $itemLabel.removeClass('selected');\n                $itemInput.prop('checked', false);\n            }\n        },\n\n        hideCorrectAnswer: function() {\n            _.each(this.model.get('_items'), function(item, index) {\n                this.setOptionSelected(index, this.model.get('_userAnswer')[item._index]);\n            }, this);\n        },\n\n        /**\n        * used by adapt-contrib-spoor to get the user's answers in the format required by the cmi.interactions.n.student_response data field\n        * returns the user's answers as a string in the format \"1,5,2\"\n        */\n        getResponse:function() {\n            var selected = _.where(this.model.get('_items'), {'_isSelected':true});\n            var selectedIndexes = _.pluck(selected, '_index');\n            // indexes are 0-based, we need them to be 1-based for cmi.interactions\n            for (var i = 0, count = selectedIndexes.length; i < count; i++) {\n                selectedIndexes[i]++;\n            }\n            return selectedIndexes.join(',');\n        },\n\n        /**\n        * used by adapt-contrib-spoor to get the type of this question in the format required by the cmi.interactions.n.type data field\n        */\n        getResponseType:function() {\n            return \"choice\";\n        }\n\n    });\n\n    Adapt.register(\"mcq\", Mcq);\n\n    return Mcq;\n});\n\n","define('components/adapt-contrib-gmcq/js/adapt-contrib-gmcq',['require','components/adapt-contrib-mcq/js/adapt-contrib-mcq','coreJS/adapt'],function(require) {\n    var Mcq = require('components/adapt-contrib-mcq/js/adapt-contrib-mcq');\n    var Adapt = require('coreJS/adapt');\n\n    var Gmcq = Mcq.extend({\n\n        events: function() {\n\n            var events = {\n                'focus .gmcq-item input': 'onItemFocus',\n                'blur .gmcq-item input': 'onItemBlur',\n                'change .gmcq-item input': 'onItemSelected',\n                'keyup .gmcq-item input':'onKeyPress'\n            };\n\n            if ($('html').hasClass('ie8')) {\n\n                var ie8Events = {\n                    'click label img': 'forceChangeEvent'\n                };\n\n                events = _.extend(events, ie8Events);\n            }\n\n            return events;\n\n        },\n\n        onItemSelected: function(event) {\n\n            var selectedItemObject = this.model.get('_items')[$(event.currentTarget).parent('.gmcq-item').index()];\n\n            if (this.model.get('_isEnabled') && !this.model.get('_isSubmitted')) {\n                this.toggleItemSelected(selectedItemObject, event);\n            }\n\n        },\n\n        setupQuestion: function() {\n            // if only one answer is selectable, we should display radio buttons not checkboxes\n            this.model.set(\"_isRadio\", (this.model.get(\"_selectable\") == 1) );\n\n            this.model.set('_selectedItems', []);\n\n            this.setupQuestionItemIndexes();\n\n            this.setupRandomisation();\n\n            this.restoreUserAnswers();\n\n            this.listenTo(Adapt, {\n                'device:changed': this.resizeImage,\n                'device:resize': this.onDeviceResize\n            });\n\n        },\n\n        onQuestionRendered: function() {\n\n            this.resizeImage(Adapt.device.screenSize);\n            this.setUpColumns();\n\n            this.$('label').imageready(_.bind(function() {\n                this.setReadyStatus();\n            }, this));\n\n        },\n        \n        onDeviceResize: function() {\n            this.setUpColumns();\n        },\n\n        resizeImage: function(width) {\n\n            var imageWidth = width === 'medium' ? 'small' : width;\n\n            this.$('label').each(function(index) {\n                var src = $(this).find('img').attr('data-' + imageWidth);\n                $(this).find('img').attr('src', src);\n            });\n\n        },\n\n        setUpColumns: function() {\n            var columns = this.model.get('_columns');\n\n            if (!columns) return;\n\n            if (Adapt.device.screenSize === 'large') {\n                this.$el.addClass('gmcq-column-layout');\n                this.$('.gmcq-item').css('width', (100 / columns) + '%');\n            } else {\n                this.$el.removeClass('gmcq-column-layout');\n                this.$('.gmcq-item').css('width', '');\n            }\n        },\n\n        // hack for IE8\n        forceChangeEvent: function(event) {\n\n            $(\"#\" + $(event.currentTarget).closest(\"label\").attr(\"for\")).change();\n\n        }\n\n    }, {\n        template: 'gmcq'\n    });\n\n    Adapt.register(\"gmcq\", Gmcq);\n\n    return Gmcq;\n\n});\n\n","define('components/adapt-contrib-graphic/js/adapt-contrib-graphic',['require','coreViews/componentView','coreJS/adapt'],function(require) {\n\n    var ComponentView = require('coreViews/componentView');\n    var Adapt = require('coreJS/adapt');\n\n    var Graphic = ComponentView.extend({\n\n        preRender: function() {\n            this.listenTo(Adapt, 'device:changed', this.resizeImage);\n\n            // Checks to see if the graphic should be reset on revisit\n            this.checkIfResetOnRevisit();\n        },\n\n        postRender: function() {\n            this.resizeImage(Adapt.device.screenSize, true);\n        },\n\n        // Used to check if the graphic should reset on revisit\n        checkIfResetOnRevisit: function() {\n            var isResetOnRevisit = this.model.get('_isResetOnRevisit');\n\n            // If reset is enabled set defaults\n            if (isResetOnRevisit) {\n                this.model.reset(isResetOnRevisit);\n            }\n        },\n\n        inview: function(event, visible, visiblePartX, visiblePartY) {\n            if (visible) {\n                if (visiblePartY === 'top') {\n                    this._isVisibleTop = true;\n                } else if (visiblePartY === 'bottom') {\n                    this._isVisibleBottom = true;\n                } else {\n                    this._isVisibleTop = true;\n                    this._isVisibleBottom = true;\n                }\n\n                if (this._isVisibleTop && this._isVisibleBottom) {\n                    this.$('.component-widget').off('inview');\n                    this.setCompletionStatus();\n                }\n\n            }\n        },\n\n        remove: function() {\n          // Remove any 'inview' listener attached.\n          this.$('.component-widget').off('inview');\n\n          ComponentView.prototype.remove.apply(this, arguments);\n        },\n\n        resizeImage: function(width, setupInView) {\n            var imageWidth = width === 'medium' ? 'small' : width;\n            var imageSrc = (this.model.get('_graphic')) ? this.model.get('_graphic')[imageWidth] : '';\n            this.$('.graphic-widget img').attr('src', imageSrc);\n\n            this.$('.graphic-widget').imageready(_.bind(function() {\n                this.setReadyStatus();\n\n                if (setupInView) {\n                    // Bind 'inview' once the image is ready.\n                    this.$('.component-widget').on('inview', _.bind(this.inview, this));\n                }\n            }, this));\n        }\n    });\n\n    Adapt.register('graphic', Graphic);\n\n    return Graphic;\n\n});\n\n","define('components/adapt-contrib-hotgraphic/js/adapt-contrib-hotgraphic',['require','coreViews/componentView','coreJS/adapt'],function(require) {\n\n    var ComponentView = require('coreViews/componentView');\n    var Adapt = require('coreJS/adapt');\n\n    var HotGraphic = ComponentView.extend({\n\n        isPopupOpen: false,\n        \n        initialize: function() {\n            this.listenTo(Adapt, 'remove', this.remove);\n            this.listenTo(this.model, 'change:_isVisible', this.toggleVisibility);\n            this.listenTo(Adapt, 'accessibility:toggle', this.onAccessibilityToggle);\n            \n            this.model.set('_globals', Adapt.course.get('_globals'));\n            \n            _.bindAll(this, 'onKeyUp');\n            \n            this.preRender();\n            \n            if (this.model.get('_canCycleThroughPagination') === undefined) {\n                this.model.set('_canCycleThroughPagination', false);\n            }\n            if (Adapt.device.screenSize == 'large') {\n                this.render();\n            } else {\n                this.reRender();\n            }\n        },\n\n        events: function() {\n            return {\n                'click .hotgraphic-graphic-pin': 'onPinClicked',\n                'click .hotgraphic-popup-done': 'closePopup',\n                'click .hotgraphic-popup-nav .back': 'previousHotGraphic',\n                'click .hotgraphic-popup-nav .next': 'nextHotGraphic'\n            }\n        },\n\n        preRender: function() {\n            this.listenTo(Adapt, 'device:changed', this.reRender, this);\n\n            // Checks to see if the hotgraphic should be reset on revisit\n            this.checkIfResetOnRevisit();\n        },\n\n        postRender: function() {\n            this.renderState();\n            this.$('.hotgraphic-widget').imageready(_.bind(function() {\n                this.setReadyStatus();\n            }, this));\n\n            this.setupEventListeners();\n        },\n\n        // Used to check if the hotgraphic should reset on revisit\n        checkIfResetOnRevisit: function() {\n            var isResetOnRevisit = this.model.get('_isResetOnRevisit');\n\n            // If reset is enabled set defaults\n            if (isResetOnRevisit) {\n                this.model.reset(isResetOnRevisit);\n\n                _.each(this.model.get('_items'), function(item) {\n                    item._isVisited = false;\n                });\n            }\n        },\n\n        reRender: function() {\n            if (Adapt.device.screenSize != 'large') {\n                this.replaceWithNarrative();\n            }\n        },\n\n        inview: function(event, visible, visiblePartX, visiblePartY) {\n            if (visible) {\n                if (visiblePartY === 'top') {\n                    this._isVisibleTop = true;\n                } else if (visiblePartY === 'bottom') {\n                    this._isVisibleBottom = true;\n                } else {\n                    this._isVisibleTop = true;\n                    this._isVisibleBottom = true;\n                }\n\n                if (this._isVisibleTop && this._isVisibleBottom) {\n                    this.$('.component-inner').off('inview');\n                    this.setCompletionStatus();\n                }\n            }\n        },\n\n        replaceWithNarrative: function() {\n            if (!Adapt.componentStore.narrative) throw \"Narrative not included in build\";\n            var Narrative = Adapt.componentStore.narrative;\n\n            var model = this.prepareNarrativeModel();\n            var newNarrative = new Narrative({ model: model });\n            var $container = $(\".component-container\", $(\".\" + this.model.get(\"_parentId\")));\n\n            newNarrative.reRender();\n            newNarrative.setupNarrative();\n            $container.append(newNarrative.$el);\n            Adapt.trigger('device:resize');\n            _.defer(_.bind(function () {\n                this.remove();\n            }, this));\n        },\n\n        prepareNarrativeModel: function() {\n            var model = this.model;\n            model.set('_component', 'narrative');\n            model.set('_wasHotgraphic', true);\n            model.set('originalBody', model.get('body'));\n            model.set('originalInstruction', model.get('instruction'));\n            if (model.get('mobileBody')) {\n                model.set('body', model.get('mobileBody'));\n            }\n            if (model.get('mobileInstruction')) {\n                model.set('instruction', model.get('mobileInstruction'));\n            }\n\n            return model;\n        },\n\n        applyNavigationClasses: function (index) {\n            var $nav = this.$('.hotgraphic-popup-nav'),\n                itemCount = this.$('.hotgraphic-item').length;\n\n            $nav.removeClass('first').removeClass('last');\n            this.$('.hotgraphic-popup-done').a11y_cntrl_enabled(true);\n            if(index <= 0 && !this.model.get('_canCycleThroughPagination')) {\n                this.$('.hotgraphic-popup-nav').addClass('first');\n                this.$('.hotgraphic-popup-controls.back').a11y_cntrl_enabled(false);\n                this.$('.hotgraphic-popup-controls.next').a11y_cntrl_enabled(true);\n            } else if (index >= itemCount-1 && !this.model.get('_canCycleThroughPagination')) {\n                this.$('.hotgraphic-popup-nav').addClass('last');\n                this.$('.hotgraphic-popup-controls.back').a11y_cntrl_enabled(true);\n                this.$('.hotgraphic-popup-controls.next').a11y_cntrl_enabled(false);\n            } else {\n                this.$('.hotgraphic-popup-controls.back').a11y_cntrl_enabled(true);\n                this.$('.hotgraphic-popup-controls.next').a11y_cntrl_enabled(true);\n            }\n            var classes = this.model.get(\"_items\")[index]._classes \n                ? this.model.get(\"_items\")[index]._classes\n                : '';  // _classes has not been defined\n      \n            this.$('.hotgraphic-popup').attr('class', 'hotgraphic-popup ' + 'item-' + index + ' ' + classes);\n\n        },\n\n        onPinClicked: function (event) {\n            if(event) event.preventDefault();\n            \n            this.$('.hotgraphic-popup-inner').a11y_on(false);\n            this.$('.hotgraphic-item').hide().removeClass('active');\n            \n            var $currentHotSpot = this.$('.' + $(event.currentTarget).data('id'));\n            $currentHotSpot.show().addClass('active');\n            \n            var currentIndex = this.$('.hotgraphic-item.active').index();\n            this.setVisited(currentIndex);\n            \n            this.openPopup();\n           \n            this.applyNavigationClasses(currentIndex);\n        },\n        \n        openPopup: function() {\n            var currentIndex = this.$('.hotgraphic-item.active').index();\n            this.$('.hotgraphic-popup-count .current').html(currentIndex + 1);\n            this.$('.hotgraphic-popup-count .total').html(this.$('.hotgraphic-item').length);\n            this.$('.hotgraphic-popup').attr('class', 'hotgraphic-popup item-' + currentIndex).show();\n            this.$('.hotgraphic-popup-inner .active').a11y_on(true);\n            \n            this.isPopupOpen = true;\n              \n            Adapt.trigger('popup:opened',  this.$('.hotgraphic-popup-inner'));\n\n            this.$('.hotgraphic-popup-inner .active').a11y_focus();\n            \n            this.setupEscapeKey();\n        },\n\n        closePopup: function(event) {\n            if(event) event.preventDefault();\n            \n            this.$('.hotgraphic-popup').hide();\n            \n            this.isPopupOpen = false;\n            \n            Adapt.trigger('popup:closed',  this.$('.hotgraphic-popup-inner'));\n        },\n\n        previousHotGraphic: function (event) {\n            event.preventDefault();\n            var currentIndex = this.$('.hotgraphic-item.active').index();\n\n            if (currentIndex === 0 && !this.model.get('_canCycleThroughPagination')) {\n                return;\n            } else if (currentIndex === 0 && this.model.get('_canCycleThroughPagination')) {\n                currentIndex = this.model.get('_items').length;\n            }\n\n            this.$('.hotgraphic-item.active').hide().removeClass('active');\n            this.$('.hotgraphic-item').eq(currentIndex-1).show().addClass('active');\n            this.setVisited(currentIndex-1);\n            this.$('.hotgraphic-popup-count .current').html(currentIndex);\n            this.$('.hotgraphic-popup-inner').a11y_on(false);\n\n            this.applyNavigationClasses(currentIndex-1);\n            this.$('.hotgraphic-popup-inner .active').a11y_on(true);\n            this.$('.hotgraphic-popup-inner .active').a11y_focus();\n        },\n\n        nextHotGraphic: function (event) {\n            event.preventDefault();\n            var currentIndex = this.$('.hotgraphic-item.active').index();\n            if (currentIndex === (this.model.get('_items').length-1) && !this.model.get('_canCycleThroughPagination')) {\n                return;\n            } else if (currentIndex === (this.model.get('_items').length-1) && this.model.get('_canCycleThroughPagination')) {\n                currentIndex = -1;\n            }\n            this.$('.hotgraphic-item.active').hide().removeClass('active');\n            this.$('.hotgraphic-item').eq(currentIndex+1).show().addClass('active');\n            this.setVisited(currentIndex+1);\n            this.$('.hotgraphic-popup-count .current').html(currentIndex+2);\n            this.$('.hotgraphic-popup-inner').a11y_on(false);\n\n            this.applyNavigationClasses(currentIndex+1);\n            this.$('.hotgraphic-popup-inner .active').a11y_on(true);\n            this.$('.hotgraphic-popup-inner .active').a11y_focus();\n        },\n\n        setVisited: function(index) {\n            var item = this.model.get('_items')[index];\n            item._isVisited = true;\n\n            var $pin = this.$('.hotgraphic-graphic-pin').eq(index);\n            $pin.addClass('visited');\n            // append the word 'visited.' to the pin's aria-label\n            var visitedLabel = this.model.get('_globals')._accessibility._ariaLabels.visited + \".\";\n            $pin.attr('aria-label', function(index, val) {return val + \" \" + visitedLabel});\n\n            $.a11y_alert(\"visited\");\n\n            this.checkCompletionStatus();\n        },\n\n        getVisitedItems: function() {\n            return _.filter(this.model.get('_items'), function(item) {\n                return item._isVisited;\n            });\n        },\n\n        checkCompletionStatus: function() {\n            if (this.getVisitedItems().length == this.model.get('_items').length) {\n                this.trigger('allItems');\n            }\n        },\n\n        onCompletion: function() {\n            this.setCompletionStatus();\n            if (this.completionEvent && this.completionEvent != 'inview') {\n                this.off(this.completionEvent, this);\n            }\n        },\n\n        setupEventListeners: function() {\n            this.completionEvent = (!this.model.get('_setCompletionOn')) ? 'allItems' : this.model.get('_setCompletionOn');\n            if (this.completionEvent !== 'inview') {\n                this.on(this.completionEvent, _.bind(this.onCompletion, this));\n            } else {\n                this.$('.component-widget').on('inview', _.bind(this.inview, this));\n            }\n        },\n        \n        setupEscapeKey: function() {\n            var hasAccessibility = Adapt.config.has('_accessibility') && Adapt.config.get('_accessibility')._isActive;\n\n            if (!hasAccessibility && this.isPopupOpen) {\n                $(window).on(\"keyup\", this.onKeyUp);\n            } else {\n                $(window).off(\"keyup\", this.onKeyUp);\n            }\n        },\n\n        onAccessibilityToggle: function() {\n            this.setupEscapeKey();\n        },\n\n        onKeyUp: function(event) {\n            if (event.which != 27) return;\n            \n            event.preventDefault();\n\n            this.closePopup();\n        }\n\n    });\n\n    Adapt.register('hotgraphic', HotGraphic);\n\n    return HotGraphic;\n\n});\n","define('components/adapt-contrib-matching/js/adapt-contrib-matching',[\n    'core/js/adapt',\n    'core/js/views/questionView',\n    'libraries/select2'\n],function(Adapt, QuestionView) {\n\n    var Matching = QuestionView.extend({\n\n        // Used by questionView to disable the question during submit and complete stages\n        disableQuestion: function() {\n            this.$('select').prop(\"disabled\", true).select2();\n        },\n\n        setupSelect2: function() {\n            this.enableQuestion();\n            if (this.model.get('_isEnabled') !== true) {\n                // select2 ignores disabled property applied to <select> in the template \n                this.disableQuestion();\n            }\n        },\n\n        // Used by questionView to enable the question during interactions\n        enableQuestion: function() {\n            this.$('select').prop(\"disabled\", false).select2({\n                minimumResultsForSearch: Infinity,\n                dir: Adapt.config.get('_defaultDirection')\n            });\n        },\n\n        // Used by questionView to reset the question when revisiting the component\n        resetQuestionOnRevisit: function() {\n            this.resetQuestion();\n        },\n\n        setupQuestion: function() {\n            this.listenToOnce(Adapt, 'preRemove', this.onPreRemove);\n\n            this.setupItemIndexes();\n            \n            this.restoreUserAnswers();\n\n            this.setupRandomisation();\n        },\n\n        onPreRemove: function() {\n            this.$('select').select2('destroy');\n        },\n\n        setupItemIndexes: function() {\n\n            _.each(this.model.get(\"_items\"), function(item, index) {\n                if (item._index === undefined) {\n                    item._index = index;\n                    item._selected = false;\n                }\n                _.each(item._options, function(option, index) {\n                    if (option._index === undefined) {\n                        option._index = index;\n                        option._isSelected = false;\n                    }\n                });\n            });\n\n        },\n\n        restoreUserAnswers: function() {\n            if (!this.model.get(\"_isSubmitted\")) return;\n\n            var userAnswer = this.model.get(\"_userAnswer\");\n\n            _.each(this.model.get(\"_items\"), function(item, index) {\n                _.each(item._options, function(option, index) {\n                    if (option._index == userAnswer[item._index]) {\n                        option._isSelected = true;\n                        item._selected = option;\n                    }\n                });\n            });\n\n            this.setQuestionAsSubmitted();\n            this.markQuestion();\n            this.setScore();\n            this.showMarking();\n            this.setupFeedback();\n        },\n\n        setupRandomisation: function() {\n            if (this.model.get('_isRandom') && this.model.get('_isEnabled')) {\n                _.each(this.model.get('_items'), function(item) {\n                    item._options = _.shuffle(item._options);\n                });\n            }\n        },\n\n        onQuestionRendered: function() {\n            this.setReadyStatus();\n            this.setupSelect2();\n        },\n\n        canSubmit: function() {\n\n            var canSubmit = true;\n\n            $('.matching-select option:selected', this.el).each(_.bind(function(index, element) {\n\n                var $element = $(element);\n\n                if ($element.index() === 0) {\n                    canSubmit = false;\n                    $element.parent('.matching-select').addClass('error');\n                }\n            }, this));\n\n            return canSubmit;\n        },\n\n        // Blank method for question to fill out when the question cannot be submitted\n        onCannotSubmit: function() {\n            //TODO have this highlight all the drop-downs the user has yet to select.\n            //Currently it just highlights the first one, even if that one has been selected\n        },\n\n        storeUserAnswer: function() {\n\n            var userAnswer = new Array(this.model.get('_items').length);\n            var tempUserAnswer = new Array(this.model.get('_items').length);\n\n            _.each(this.model.get('_items'), function(item, index) {\n\n                var $selectedOption = this.$('.matching-select option:selected').eq(index);\n                var optionIndex = $selectedOption.index() - 1;\n\n                item._options[optionIndex]._isSelected = true;\n                item._selected = item._options[optionIndex];\n\n                tempUserAnswer[item._index] = optionIndex;\n                userAnswer[item._index] = item._options[optionIndex]._index;\n            }, this);\n\n            this.model.set('_userAnswer', userAnswer);\n            this.model.set('_tempUserAnswer', tempUserAnswer);\n        },\n\n        isCorrect: function() {\n\n            var numberOfCorrectAnswers = 0;\n\n            _.each(this.model.get('_items'), function(item, index) {\n\n                if (item._selected && item._selected._isCorrect) {\n                    numberOfCorrectAnswers++;\n                    item._isCorrect = true;\n                    this.model.set('_numberOfCorrectAnswers', numberOfCorrectAnswers);\n                    this.model.set('_isAtLeastOneCorrectSelection', true);\n                } else {\n                    item._isCorrect = false;\n                }\n\n            }, this);\n\n            this.model.set('_numberOfCorrectAnswers', numberOfCorrectAnswers);\n\n            if (numberOfCorrectAnswers === this.model.get('_items').length) {\n                return true;\n            } else {\n                return false;\n            }\n\n        },\n\n        setScore: function() {\n            var questionWeight = this.model.get(\"_questionWeight\");\n\n            if (this.model.get('_isCorrect')) {\n                this.model.set('_score', questionWeight);\n                return;\n            }\n\n            var numberOfCorrectAnswers = this.model.get('_numberOfCorrectAnswers');\n            var itemLength = this.model.get('_items').length;\n\n            var score = questionWeight * numberOfCorrectAnswers / itemLength;\n\n            this.model.set('_score', score);\n        },\n\n        // This is important and should give the user feedback on how they answered the question\n        // Normally done through ticks and crosses by adding classes\n        showMarking: function() {\n            if (!this.model.get('_canShowMarking')) return;\n\n            _.each(this.model.get('_items'), function(item, i) {\n\n                var $item = this.$('.matching-item').eq(i);\n                $item.removeClass('correct incorrect').addClass(item._isCorrect ? 'correct' : 'incorrect');\n            }, this);\n        },\n\n        // Used by the question to determine if the question is incorrect or partly correct\n        // Should return a boolean\n        isPartlyCorrect: function() {\n            return this.model.get('_isAtLeastOneCorrectSelection');\n        },\n\n        resetUserAnswer: function() {\n            this.model.set({_userAnswer: []});\n        },\n\n        // Used by the question view to reset the look and feel of the component.\n        resetQuestion: function() {\n            this.$('.matching-select option').prop('selected', false);\n            \n            this.$(\".matching-item\").removeClass(\"correct\").removeClass(\"incorrect\");\n            \n            this.model.set('_isAtLeastOneCorrectSelection', false);\n            \n            var placeholder = this.model.get('placeholder');\n            \n            _.each(this.model.get(\"_items\"), function(item, index) {\n                this.selectValue(index, placeholder);\n                _.each(item._options, function(option, index) {\n                    option._isSelected = false;\n                });\n            }, this);\n        },\n\n        showCorrectAnswer: function() {\n            var items = this.model.get('_items');\n\n            for (var i = 0; i < items.length; i++) {\n                var item = items[i];\n                var correctOption = _.findWhere(item._options, {_isCorrect: true});\n                this.selectValue(i, correctOption.text);\n            }\n        },\n\n        hideCorrectAnswer: function() {\n            var items = this.model.get('_items');\n            for (var i = 0, count = items.length; i < count; i++) {\n                var index = this.model.has('_tempUserAnswer')\n                  ? this.model.get('_tempUserAnswer')[i]\n                  : this.model.get('_userAnswer')[i];\n\n                var item = items[i];\n                var value = item._options[index].text;\n\n                this.selectValue(i, value);\n            }\n        },\n\n        selectValue: function(i, value) {\n            this.$('select').eq(i).val(value).trigger('change');\n        },\n\n        /**\n        * Used by adapt-contrib-spoor to get the user's answers in the format required by the cmi.interactions.n.student_response data field\n        * Returns the user's answers as a string in the format \"1.1#2.3#3.2\" assuming user selected option 1 in drop-down 1, option 3 in drop-down 2\n        * and option 2 in drop-down 3. The '#' character will be changed to either ',' or '[,]' by adapt-contrib-spoor, depending on which SCORM version is being used.\n        */\n        getResponse: function() {\n\n            var userAnswer = this.model.get('_userAnswer');\n            var responses = [];\n\n            for(var i = 0, count = userAnswer.length; i < count; i++) {\n                responses.push((i + 1) + \".\" + (userAnswer[i] + 1));// convert from 0-based to 1-based counting\n            }\n            \n            return responses.join('#');\n        },\n\n        /**\n        * Used by adapt-contrib-spoor to get the type of this question in the format required by the cmi.interactions.n.type data field\n        */\n        getResponseType: function() {\n            return \"matching\";\n        }\n\n    });\n\n    Adapt.register(\"matching\", Matching);\n\n    return Matching;\n\n});\n\n","define('components/adapt-contrib-media/js/adapt-contrib-media',[\n    'core/js/adapt',\n    'core/js/views/componentView',\n    'libraries/mediaelement-and-player',\n    'libraries/mediaelement-and-player-accessible-captions'\n], function(Adapt, ComponentView) {\n\n    var froogaloopAdded = false;\n    \n    // The following function is used to to prevent a memory leak in Internet Explorer \n    // See: http://javascript.crockford.com/memory/leak.html\n    function purge(d) {\n        var a = d.attributes, i, l, n;\n        if (a) {\n            for (i = a.length - 1; i >= 0; i -= 1) {\n                n = a[i].name;\n                if (typeof d[n] === 'function') {\n                    d[n] = null;\n                }\n            }\n        }\n        a = d.childNodes;\n        if (a) {\n            l = a.length;\n            for (i = 0; i < l; i += 1) {\n                purge(d.childNodes[i]);\n            }\n        }\n    }\n\n    var Media = ComponentView.extend({\n\n        events: {\n            \"click .media-inline-transcript-button\": \"onToggleInlineTranscript\"\n        },\n\n        preRender: function() {\n            this.listenTo(Adapt, 'device:resize', this.onScreenSizeChanged);\n            this.listenTo(Adapt, 'device:changed', this.onDeviceChanged);\n            this.listenTo(Adapt, 'accessibility:toggle', this.onAccessibilityToggle);\n\n            _.bindAll(this, 'onMediaElementPlay', 'onMediaElementPause', 'onMediaElementEnded');\n\n            // set initial player state attributes\n            this.model.set({\n                '_isMediaEnded': false,\n                '_isMediaPlaying': false\n            });\n\n            if (this.model.get('_media').source) {\n                // Remove the protocol for streaming service.\n                // This prevents conflicts with HTTP/HTTPS\n                var media = this.model.get('_media');\n\n                media.source = media.source.replace(/^https?\\:/, \"\");\n\n                this.model.set('_media', media); \n            }\n\n            this.checkIfResetOnRevisit();\n        },\n\n        postRender: function() {\n            this.setupPlayer();\n        },\n\n        setupPlayer: function() {\n            if (!this.model.get('_playerOptions')) this.model.set('_playerOptions', {});\n\n            var modelOptions = this.model.get('_playerOptions');\n\n            if (modelOptions.pluginPath === undefined) modelOptions.pluginPath = 'assets/';\n            if(modelOptions.features === undefined) {\n                modelOptions.features = ['playpause','progress','current','duration'];\n                if (this.model.get('_useClosedCaptions')) {\n                    modelOptions.features.unshift('tracks');\n                }\n                if (this.model.get(\"_allowFullScreen\") && !$(\"html\").is(\".ie9\")) {\n                    modelOptions.features.push('fullscreen');\n                }\n            }\n\n            modelOptions.success = _.bind(this.onPlayerReady, this);\n\n            if (this.model.get('_useClosedCaptions')) {\n                modelOptions.startLanguage = this.model.get('_startLanguage') === undefined ? 'en' : this.model.get('_startLanguage');\n            }\n\n            var hasAccessibility = Adapt.config.has('_accessibility') && Adapt.config.get('_accessibility')._isActive\n                ? true\n                : false;\n\n            if (hasAccessibility) {\n                modelOptions.alwaysShowControls = true;\n                modelOptions.hideVideoControlsOnLoad = false;\n            }\n\n            if (modelOptions.alwaysShowControls === undefined) {\n                modelOptions.alwaysShowControls = false;\n            }\n            if (modelOptions.hideVideoControlsOnLoad === undefined) {\n                modelOptions.hideVideoControlsOnLoad = true;\n            }\n\n            this.addMediaTypeClass();\n\n            this.addThirdPartyFixes(modelOptions, _.bind(function createPlayer() {\n                // create the player\n                this.$('audio, video').mediaelementplayer(modelOptions);\n\n                // We're streaming - set ready now, as success won't be called above\n                try {\n                    if (this.model.get('_media').source) {\n                        this.$('.media-widget').addClass('external-source');\n                    }\n                } catch (e) {\n                    console.log(\"ERROR! No _media property found in components.json for component \" + this.model.get('_id'));\n                } finally {\n                    this.setReadyStatus();\n                }\n            }, this));\n        },\n\n        addMediaTypeClass: function() {\n            var media = this.model.get(\"_media\");\n            if (media && media.type) {\n                var typeClass = media.type.replace(/\\//, \"-\");\n                this.$(\".media-widget\").addClass(typeClass);\n            }\n        },\n\n        addThirdPartyFixes: function(modelOptions, callback) {\n            var media = this.model.get(\"_media\");\n            if (!media) return callback();\n\n            switch (media.type) {\n                case \"video/vimeo\":\n                    modelOptions.alwaysShowControls = false;\n                    modelOptions.hideVideoControlsOnLoad = true;\n                    modelOptions.features = [];\n                    if (froogaloopAdded) return callback();\n                    Modernizr.load({\n                        load: \"assets/froogaloop.js\",\n                        complete: function() {\n                            froogaloopAdded = true;\n                            callback();\n                        }\n                    });\n                    break;\n                default:\n                    callback();\n            }\n        },\n\n        setupEventListeners: function() {\n            this.completionEvent = (!this.model.get('_setCompletionOn')) ? 'play' : this.model.get('_setCompletionOn');\n\n            if (this.completionEvent === 'inview') {\n                this.$('.component-widget').on('inview', _.bind(this.inview, this));\n            }\n\n            // handle other completion events in the event Listeners \n            $(this.mediaElement).on({\n            \t'play': this.onMediaElementPlay,\n            \t'pause': this.onMediaElementPause,\n            \t'ended': this.onMediaElementEnded\n            });\n        },\n\n        onMediaElementPlay: function(event) {\n            this.model.set({\n                '_isMediaPlaying': true,\n                '_isMediaEnded': false\n            });\n            \n            if (this.completionEvent === 'play') {\n                this.setCompletionStatus();\n            }\n        },\n\n        onMediaElementPause: function(event) {\n            this.model.set('_isMediaPlaying', false);\n        },\n\n        onMediaElementEnded: function(event) {\n            this.model.set('_isMediaEnded', true);\n\n            if (this.completionEvent === 'ended') {\n                this.setCompletionStatus();\n            }\n        },\n\n        // Overrides the default play/pause functionality to stop accidental playing on touch devices\n        setupPlayPauseToggle: function() {\n            // bit sneaky, but we don't have a this.mediaElement.player ref on iOS devices\n            var player = this.mediaElement.player;\n\n            if (!player) {\n                console.log(\"Media.setupPlayPauseToggle: OOPS! there's no player reference.\");\n                return;\n            }\n\n            // stop the player dealing with this, we'll do it ourselves\n            player.options.clickToPlayPause = false;\n\n            this.onOverlayClick = _.bind(this.onOverlayClick, this);\n            this.onMediaElementClick = _.bind(this.onMediaElementClick, this);\n\n            // play on 'big button' click\n            this.$('.mejs-overlay-button').on(\"click\", this.onOverlayClick);\n\n            // pause on player click\n            this.$('.mejs-mediaelement').on(\"click\", this.onMediaElementClick);\n        },\n\n        onOverlayClick: function() {\n            var player = this.mediaElement.player;\n            if (!player) return;\n\n            player.play();\n        },\n\n        onMediaElementClick: function(event) {\n            var player = this.mediaElement.player;\n            if (!player) return;\n\n            var isPaused = player.media.paused;\n            if(!isPaused) player.pause();\n        },\n\n        checkIfResetOnRevisit: function() {\n            var isResetOnRevisit = this.model.get('_isResetOnRevisit');\n\n            // If reset is enabled set defaults\n            if (isResetOnRevisit) {\n                this.model.reset(isResetOnRevisit);\n            }\n        },\n\n        inview: function(event, visible, visiblePartX, visiblePartY) {\n            if (visible) {\n                if (visiblePartY === 'top') {\n                    this._isVisibleTop = true;\n                } else if (visiblePartY === 'bottom') {\n                    this._isVisibleBottom = true;\n                } else {\n                    this._isVisibleTop = true;\n                    this._isVisibleBottom = true;\n                }\n\n                if (this._isVisibleTop && this._isVisibleBottom) {\n                    this.$('.component-inner').off('inview');\n                    this.setCompletionStatus();\n                }\n            }\n        },\n\n        remove: function() {\n            this.$('.mejs-overlay-button').off(\"click\", this.onOverlayClick);\n            this.$('.mejs-mediaelement').off(\"click\", this.onMediaElementClick);\n\n            var modelOptions = this.model.get('_playerOptions');\n            delete modelOptions.success;\n\n            var media = this.model.get(\"_media\");\n            if (media) {\n                switch (media.type) {\n                case \"video/vimeo\":\n                    this.$(\"iframe\")[0].isRemoved = true;\n                }\n            }\n\n            if ($(\"html\").is(\".ie8\")) {\n                var obj = this.$(\"object\")[0];\n                if (obj) {\n                    obj.style.display = \"none\";\n                }\n            }\n            if (this.mediaElement && this.mediaElement.player) {\n                var player_id = this.mediaElement.player.id;\n\n                purge(this.$el[0]);\n                this.mediaElement.player.remove();\n\n                if (mejs.players[player_id]) {\n                    delete mejs.players[player_id];\n                }\n            }\n\n            if (this.mediaElement) {\n                $(this.mediaElement).off({\n                \t'play': this.onMediaElementPlay,\n                \t'pause': this.onMediaElementPause,\n                \t'ended': this.onMediaElementEnded\n                });\n\n                this.mediaElement.src = \"\";\n                $(this.mediaElement.pluginElement).remove();\n                delete this.mediaElement;\n            }\n\n            ComponentView.prototype.remove.call(this);\n        },\n\n        onDeviceChanged: function() {\n            if (this.model.get('_media').source) {\n                this.$('.mejs-container').width(this.$('.component-widget').width());\n            }\n        },\n\n        onPlayerReady: function (mediaElement, domObject) {\n            this.mediaElement = mediaElement;\n\n            if (!this.mediaElement.player) {\n                this.mediaElement.player =  mejs.players[this.$('.mejs-container').attr('id')];\n            }\n\n            var hasTouch = mejs.MediaFeatures.hasTouch;\n            if (hasTouch) {\n                this.setupPlayPauseToggle();\n            }\n\n            this.addThirdPartyAfterFixes();\n\n            this.setReadyStatus();\n            this.setupEventListeners();\n        },\n\n        addThirdPartyAfterFixes: function() {\n            var media = this.model.get(\"_media\");\n            switch (media.type) {\n            case \"video/vimeo\":\n                this.$(\".mejs-container\").attr(\"tabindex\", 0);\n            }\n        },\n\n        onScreenSizeChanged: function() {\n            this.$('audio, video').width(this.$('.component-widget').width());\n        },\n\n        onAccessibilityToggle: function() {\n           this.showControls();\n        },\n\n        onToggleInlineTranscript: function(event) {\n            if (event) event.preventDefault();\n            var $transcriptBodyContainer = this.$(\".media-inline-transcript-body-container\");\n            var $button = this.$(\".media-inline-transcript-button\");\n\n            if ($transcriptBodyContainer.hasClass(\"inline-transcript-open\")) {\n                $transcriptBodyContainer.slideUp(function() {\n                    $(window).resize();\n                });\n                $transcriptBodyContainer.removeClass(\"inline-transcript-open\");\n                $button.html(this.model.get(\"_transcript\").inlineTranscriptButton);\n            } else {\n                $transcriptBodyContainer.slideDown(function() {\n                    $(window).resize();\n                }).a11y_focus();\n                $transcriptBodyContainer.addClass(\"inline-transcript-open\");\n                $button.html(this.model.get(\"_transcript\").inlineTranscriptCloseButton);\n                if (this.model.get('_transcript')._setCompletionOnView !== false) {\n                    this.setCompletionStatus();\n                }\n            }\n        },\n\n        showControls: function() {\n            var hasAccessibility = Adapt.config.has('_accessibility') && Adapt.config.get('_accessibility')._isActive\n                ? true\n                : false;\n\n            if (hasAccessibility) {\n                if (!this.mediaElement.player) return;\n\n                var player = this.mediaElement.player;\n\n                player.options.alwaysShowControls = true;\n                player.options.hideVideoControlsOnLoad = false;\n                player.enableControls();\n                player.showControls();\n\n                this.$('.mejs-playpause-button button').attr({\n                    \"role\": \"button\"\n                });\n                var screenReaderVideoTagFix = $(\"<div role='region' aria-label='.'>\");\n                this.$('.mejs-playpause-button').prepend(screenReaderVideoTagFix);\n\n                this.$('.mejs-time, .mejs-time-rail').attr({\n                    \"aria-hidden\": \"true\"\n                });\n            }\n        }\n    });\n\n    Adapt.register('media', Media);\n\n    return Media;\n\n});\n\n","define('components/adapt-contrib-narrative/js/adapt-contrib-narrative',['require','coreViews/componentView','coreJS/adapt'],function(require) {\n\n    var ComponentView = require('coreViews/componentView');\n    var Adapt = require('coreJS/adapt');\n\n    var Narrative = ComponentView.extend({\n\n        events: {\n            'click .narrative-strapline-title': 'openPopup',\n            'click .narrative-controls': 'onNavigationClicked',\n            'click .narrative-indicators .narrative-progress': 'onProgressClicked'\n        },\n\n        preRender: function() {\n            this.listenTo(Adapt, 'device:changed', this.reRender, this);\n            this.listenTo(Adapt, 'device:resize', this.resizeControl, this);\n            this.listenTo(Adapt, 'notify:closed', this.closeNotify, this);\n            this.setDeviceSize();\n\n            // Checks to see if the narrative should be reset on revisit\n            this.checkIfResetOnRevisit();\n        },\n\n        setDeviceSize: function() {\n            if (Adapt.device.screenSize === 'large') {\n                this.$el.addClass('desktop').removeClass('mobile');\n                this.model.set('_isDesktop', true);\n            } else {\n                this.$el.addClass('mobile').removeClass('desktop');\n                this.model.set('_isDesktop', false)\n            }\n        },\n\n        postRender: function() {\n            this.renderState();\n            this.$('.narrative-slider').imageready(_.bind(function() {\n                this.setReadyStatus();\n            }, this));\n            this.setupNarrative();\n        },\n\n        // Used to check if the narrative should reset on revisit\n        checkIfResetOnRevisit: function() {\n            var isResetOnRevisit = this.model.get('_isResetOnRevisit');\n\n            // If reset is enabled set defaults\n            if (isResetOnRevisit) {\n                this.model.reset(isResetOnRevisit);\n                this.model.set({_stage: 0});\n\n                _.each(this.model.get('_items'), function(item) {\n                    item._isVisited = false;\n                });\n            }\n        },\n\n        setupNarrative: function() {\n            this.setDeviceSize();\n            if(!this.model.has('_items') || !this.model.get('_items').length) return;\n            this.model.set('_marginDir', 'left');\n            if (Adapt.config.get('_defaultDirection') == 'rtl') {\n                this.model.set('_marginDir', 'right');\n            }\n            this.model.set('_itemCount', this.model.get('_items').length);\n\n            this.model.set('_active', true);\n\n            if (this.model.get('_stage')) {\n                this.setStage(this.model.get('_stage'), true);\n            } else {\n                this.setStage(0, true);\n            }\n            this.calculateWidths();\n\n            if (Adapt.device.screenSize !== 'large' && !this.model.get('_wasHotgraphic')) {\n                this.replaceInstructions();\n            }\n            this.setupEventListeners();\n            \n            // if hasNavigationInTextArea set margin left \n            var hasNavigationInTextArea = this.model.get('_hasNavigationInTextArea');\n            if (hasNavigationInTextArea == true) {\n                var indicatorWidth = this.$('.narrative-indicators').width();\n                var marginLeft = indicatorWidth / 2;\n                \n                this.$('.narrative-indicators').css({\n                    marginLeft: '-' + marginLeft + 'px'\n                });\n            }\n        },\n\n        calculateWidths: function() {\n            var slideWidth = this.$('.narrative-slide-container').width();\n            var slideCount = this.model.get('_itemCount');\n            var marginRight = this.$('.narrative-slider-graphic').css('margin-right');\n            var extraMargin = marginRight === '' ? 0 : parseInt(marginRight);\n            var fullSlideWidth = (slideWidth + extraMargin) * slideCount;\n\n            this.$('.narrative-slider-graphic').width(slideWidth);\n            this.$('.narrative-strapline-header').width(slideWidth);\n            this.$('.narrative-strapline-title').width(slideWidth);\n\n            this.$('.narrative-slider').width(fullSlideWidth);\n            this.$('.narrative-strapline-header-inner').width(fullSlideWidth);\n\n            var stage = this.model.get('_stage');\n            var margin = -(stage * slideWidth);\n\n            this.$('.narrative-slider').css(('margin-' + this.model.get('_marginDir')), margin);\n            this.$('.narrative-strapline-header-inner').css(('margin-' + this.model.get('_marginDir')), margin);\n\n            this.model.set('_finalItemLeft', fullSlideWidth - slideWidth);\n        },\n\n        resizeControl: function() {\n            var wasDesktop = this.model.get('_isDesktop');\n            this.setDeviceSize();\n            if (wasDesktop != this.model.get('_isDesktop')) this.replaceInstructions();\n            this.calculateWidths();\n            this.evaluateNavigation();\n        },\n\n        reRender: function() {\n            if (this.model.get('_wasHotgraphic') && Adapt.device.screenSize == 'large') {\n                this.replaceWithHotgraphic();\n            } else {\n                this.resizeControl();\n            }\n        },\n\n        closeNotify: function() {\n            this.evaluateCompletion()\n        },\n\n        replaceInstructions: function() {\n            if (Adapt.device.screenSize === 'large') {\n                this.$('.narrative-instruction-inner').html(this.model.get('instruction')).a11y_text();\n            } else if (this.model.get('mobileInstruction') && !this.model.get('_wasHotgraphic')) {\n                this.$('.narrative-instruction-inner').html(this.model.get('mobileInstruction')).a11y_text();\n            }\n        },\n\n        replaceWithHotgraphic: function() {\n            if (!Adapt.componentStore.hotgraphic) throw \"Hotgraphic not included in build\";\n            var Hotgraphic = Adapt.componentStore.hotgraphic;\n            \n            var model = this.prepareHotgraphicModel();\n            var newHotgraphic = new Hotgraphic({ model: model });\n            var $container = $(\".component-container\", $(\".\" + this.model.get(\"_parentId\")));\n\n            $container.append(newHotgraphic.$el);\n            this.remove();\n            $.a11y_update();\n            _.defer(function() {\n                Adapt.trigger('device:resize');\n            });\n        },\n\n        prepareHotgraphicModel: function() {\n            var model = this.model;\n            model.set('_component', 'hotgraphic');\n            model.set('body', model.get('originalBody'));\n            model.set('instruction', model.get('originalInstruction'));\n            return model;\n        },\n\n        moveSliderToIndex: function(itemIndex, animate, callback) {\n            var extraMargin = parseInt(this.$('.narrative-slider-graphic').css('margin-right'));\n            var movementSize = this.$('.narrative-slide-container').width() + extraMargin;\n            var marginDir = {};\n            if (animate && !Adapt.config.get('_disableAnimation')) {\n                marginDir['margin-' + this.model.get('_marginDir')] = -(movementSize * itemIndex);\n                this.$('.narrative-slider').velocity(\"stop\", true).velocity(marginDir);\n                this.$('.narrative-strapline-header-inner').velocity(\"stop\", true).velocity(marginDir, {complete:callback});\n            } else {\n                marginDir['margin-' + this.model.get('_marginDir')] = -(movementSize * itemIndex);\n                this.$('.narrative-slider').css(marginDir);\n                this.$('.narrative-strapline-header-inner').css(marginDir);\n                callback();\n            }\n        },\n\n        setStage: function(stage, initial) {\n            this.model.set('_stage', stage);\n            if (this.model.get('_isDesktop')) {\n                // Set the visited attribute for large screen devices\n                var currentItem = this.getCurrentItem(stage);\n                currentItem._isVisited = true;\n            }\n\n            this.$('.narrative-progress:visible').removeClass('selected').eq(stage).addClass('selected');\n            this.$('.narrative-slider-graphic').children('.controls').a11y_cntrl_enabled(false);\n            this.$('.narrative-slider-graphic').eq(stage).children('.controls').a11y_cntrl_enabled(true);\n            this.$('.narrative-content-item').addClass('narrative-hidden').a11y_on(false).eq(stage).removeClass('narrative-hidden').a11y_on(true);\n            this.$('.narrative-strapline-title').a11y_cntrl_enabled(false).eq(stage).a11y_cntrl_enabled(true);\n\n            this.evaluateNavigation();\n            this.evaluateCompletion();\n\n            this.moveSliderToIndex(stage, !initial, _.bind(function() {\n                if (this.model.get('_isDesktop')) {\n                    if (!initial) this.$('.narrative-content-item').eq(stage).a11y_focus();\n                } else {\n                    if (!initial) this.$('.narrative-strapline-title').a11y_focus();\n                }\n            }, this));\n        },\n\n        constrainStage: function(stage) {\n            if (stage > this.model.get('_items').length - 1) {\n                stage = this.model.get('_items').length - 1;\n            } else if (stage < 0) {\n                stage = 0;\n            }\n            return stage;\n        },\n\n        constrainXPosition: function(previousLeft, newLeft, deltaX) {\n            if (newLeft > 0 && deltaX > 0) {\n                newLeft = previousLeft + (deltaX / (newLeft * 0.1));\n            }\n            var finalItemLeft = this.model.get('_finalItemLeft');\n            if (newLeft < -finalItemLeft && deltaX < 0) {\n                var distance = Math.abs(newLeft + finalItemLeft);\n                newLeft = previousLeft + (deltaX / (distance * 0.1));\n            }\n            return newLeft;\n        },\n\n        evaluateNavigation: function() {\n            var currentStage = this.model.get('_stage');\n            var itemCount = this.model.get('_itemCount');\n            if (currentStage == 0) {\n                this.$('.narrative-controls').addClass('narrative-hidden');\n\n                if (itemCount > 1) {\n                    this.$('.narrative-control-right').removeClass('narrative-hidden');\n                }\n            } else {\n                this.$('.narrative-control-left').removeClass('narrative-hidden');\n\n                if (currentStage == itemCount - 1) {\n                    this.$('.narrative-control-right').addClass('narrative-hidden');\n                } else {\n                    this.$('.narrative-control-right').removeClass('narrative-hidden');\n                }\n            }\n\n        },\n\n        getNearestItemIndex: function() {\n            var currentPosition = parseInt(this.$('.narrative-slider').css('margin-left'));\n            var graphicWidth = this.$('.narrative-slider-graphic').width();\n            var absolutePosition = currentPosition / graphicWidth;\n            var stage = this.model.get('_stage');\n            var relativePosition = stage - Math.abs(absolutePosition);\n\n            if (relativePosition < -0.3) {\n                stage++;\n            } else if (relativePosition > 0.3) {\n                stage--;\n            }\n\n            return this.constrainStage(stage);\n        },\n\n        getCurrentItem: function(index) {\n            return this.model.get('_items')[index];\n        },\n\n        getVisitedItems: function() {\n            return _.filter(this.model.get('_items'), function(item) {\n                return item._isVisited;\n            });\n        },\n\n        evaluateCompletion: function() {\n            if (this.getVisitedItems().length === this.model.get('_items').length) {\n                this.trigger('allItems');\n            } \n        },\n\n        moveElement: function($element, deltaX) {\n            var previousLeft = parseInt($element.css('margin-left'));\n            var newLeft = previousLeft + deltaX;\n\n            newLeft = this.constrainXPosition(previousLeft, newLeft, deltaX);\n            $element.css(('margin-' + this.model.get('_marginDir')), newLeft + 'px');\n        },\n\n        openPopup: function(event) {\n            event.preventDefault();\n            var currentItem = this.getCurrentItem(this.model.get('_stage'));\n            var popupObject = {\n                title: currentItem.title,\n                body: currentItem.body\n            };\n\n            // Set the visited attribute for small and medium screen devices\n            currentItem._isVisited = true;\n\n            Adapt.trigger('notify:popup', popupObject);\n        },\n\n        onNavigationClicked: function(event) {\n\n            if (!this.model.get('_active')) return;\n\n            var stage = this.model.get('_stage');\n            var numberOfItems = this.model.get('_itemCount');\n\n            if ($(event.currentTarget).hasClass('narrative-control-right')) {\n                stage++;\n            } else if ($(event.currentTarget).hasClass('narrative-control-left')) {\n                stage--;\n            }\n            stage = (stage + numberOfItems) % numberOfItems;\n            this.setStage(stage);\n        },\n        \n        onProgressClicked: function(event) {\n            event.preventDefault();\n            var clickedIndex = $(event.target).index();\n            this.setStage(clickedIndex);\n        },\n\n        inview: function(event, visible, visiblePartX, visiblePartY) {\n            if (visible) {\n                if (visiblePartY === 'top') {\n                    this._isVisibleTop = true;\n                } else if (visiblePartY === 'bottom') {\n                    this._isVisibleBottom = true;\n                } else {\n                    this._isVisibleTop = true;\n                    this._isVisibleBottom = true;\n                }\n\n                if (this._isVisibleTop && this._isVisibleBottom) {\n                    this.$('.component-inner').off('inview');\n                    this.setCompletionStatus();\n                }\n            }\n        },\n\n        onCompletion: function() {\n            this.setCompletionStatus();\n            if (this.completionEvent && this.completionEvent != 'inview') {\n                this.off(this.completionEvent, this);\n            }\n        },\n\n        setupEventListeners: function() {\n            this.completionEvent = (!this.model.get('_setCompletionOn')) ? 'allItems' : this.model.get('_setCompletionOn');\n            if (this.completionEvent !== 'inview' && this.model.get('_items').length > 1) {\n                this.on(this.completionEvent, _.bind(this.onCompletion, this));\n            } else {\n                this.$('.component-widget').on('inview', _.bind(this.inview, this));\n            }\n        }\n\n    });\n\n    Adapt.register('narrative', Narrative);\n\n    return Narrative;\n\n});\n\n","define('components/adapt-contrib-text/js/adapt-contrib-text',['require','coreViews/componentView','coreJS/adapt'],function(require) {\n\n    var ComponentView = require('coreViews/componentView');\n    var Adapt = require('coreJS/adapt');\n\n    var Text = ComponentView.extend({\n\n        events: {\n            'click .audio-controls .icon':'onAudioCtrlsClick'\n        },\n\n        preRender: function() {\n            this.checkIfResetOnRevisit();\n        },\n\n        postRender: function() {\n            this.setReadyStatus();\n\n            this.setupInview();\n        },\n\n        setupInview: function() {\n            var selector = this.getInviewElementSelector();\n\n            if (!selector) {\n                this.setCompletionStatus();\n            } else {\n                this.model.set('inviewElementSelector', selector);\n                this.$(selector).on('inview', _.bind(this.inview, this));\n            }\n        },\n\n        /**\n         * determines which element should be used for inview logic - body, instruction or title - and returns the selector for that element\n         */\n        getInviewElementSelector: function() {\n            if(this.model.get('body')) return '.component-body';\n\n            if(this.model.get('instruction')) return '.component-instruction';\n            \n            if(this.model.get('displayTitle')) return '.component-title';\n\n            return null;\n        },\n\n        checkIfResetOnRevisit: function() {\n            var isResetOnRevisit = this.model.get('_isResetOnRevisit');\n\n            // If reset is enabled set defaults\n            if (isResetOnRevisit) {\n                this.model.reset(isResetOnRevisit);\n            }\n        },\n\n        inview: function(event, visible, visiblePartX, visiblePartY) {\n            if (visible) {\n                if (visiblePartY === 'top') {\n                    this._isVisibleTop = true;\n                } else if (visiblePartY === 'bottom') {\n                    this._isVisibleBottom = true;\n                } else {\n                    this._isVisibleTop = true;\n                    this._isVisibleBottom = true;\n                }\n\n                if (this._isVisibleTop && this._isVisibleBottom) {\n                    this.$(this.model.get('inviewElementSelector')).off('inview');\n                    this.setCompletionStatus();\n                }\n            }\n        },\n\n        remove: function() {\n            if(this.model.has('inviewElementSelector')) {\n                this.$(this.model.get('inviewElementSelector')).off('inview');\n            }\n            \n            ComponentView.prototype.remove.call(this);\n        },\n\n        onAudioCtrlsClick: function(event) {\n            if (event) event.preventDefault();\n            Adapt.trigger('audio', event.currentTarget);\n        }\n    },\n    {\n        template: 'text'\n    });\n\n    Adapt.register('text', Text);\n\n    return Text;\n});\n\n","define('components/adapt-contrib-textInput/js/adapt-contrib-textInput',['require','coreViews/questionView','coreJS/adapt'],function(require) {\n    var QuestionView = require('coreViews/questionView');\n    var Adapt = require('coreJS/adapt');\n\n    var genericAnswerIndexOffset = 65536;\n\n    var TextInput = QuestionView.extend({\n        events: {\n            \"focus input\":\"clearValidationError\"\n        },\n\n        resetQuestionOnRevisit: function() {\n            this.setAllItemsEnabled(false);\n            this.resetQuestion();\n        },\n\n        setupQuestion: function() {\n            this.model.set( '_genericAnswerIndexOffset', genericAnswerIndexOffset );\n            this.setupItemIndexes();\n            this.restoreUserAnswer();\n\n            this.setupRandomisation();\n        },\n\n        setupRandomisation: function() {\n            if (this.model.get('_isRandom') && this.model.get('_isEnabled')) {\n                this.model.set(\"_items\", _.shuffle(this.model.get(\"_items\")));\n            }\n        },\n\n        setupItemIndexes: function() {\n            \n            _.each(this.model.get('_items'), function(item, index) {\n\n                if (item._index === undefined) item._index = index;\n                if (item._answerIndex === undefined) item._answerIndex = -1;\n\n            });\n\n        },\n\n        restoreUserAnswer: function() {\n            if (!this.model.get(\"_isSubmitted\")) return;\n\n            var userAnswer = this.model.get(\"_userAnswer\");\n            var genericAnswers = this.model.get(\"_answers\");\n            _.each(this.model.get(\"_items\"), function(item) {\n                var answerIndex = userAnswer[item._index];\n                if (answerIndex >= genericAnswerIndexOffset) {\n                    item.userAnswer = genericAnswers[answerIndex - genericAnswerIndexOffset];\n                    item._answerIndex = answerIndex;\n                } else if (answerIndex > -1) {\n                    item.userAnswer = item._answers[answerIndex];\n                    item._answerIndex = answerIndex;\n                } else {\n                    if (item.userAnswer === undefined) item.userAnswer = \"******\";\n                    item._answerIndex = -1;\n                }\n                if (item.userAnswer instanceof Array) item.userAnswer = item.userAnswer[0];\n            });\n\n            this.setQuestionAsSubmitted();\n            this.markQuestion();\n            this.setScore();\n            this.showMarking();\n            this.setupFeedback();\n        },  \n\n        disableQuestion: function() {\n            this.setAllItemsEnabled(false);\n        },\n\n        enableQuestion: function() {\n            this.setAllItemsEnabled(true);\n        },\n\n        setAllItemsEnabled: function(isEnabled) {\n            _.each(this.model.get('_items'), function(item, index) {\n                var $itemInput = this.$('input').eq(index);\n\n                if (isEnabled) {\n                    $itemInput.prop('disabled', false);\n                } else {\n                    $itemInput.prop('disabled', true);\n                }\n            }, this);\n        },\n\n        onQuestionRendered: function() {\n            this.setReadyStatus();\n        },\n\n        clearValidationError: function() {\n            this.$(\".textinput-item-textbox\").removeClass(\"textinput-validation-error\");\n        },\n\n        // Use to check if the user is allowed to submit the question\n        canSubmit: function() {\n            var canSubmit = true;\n            this.$(\".textinput-item-textbox\").each(function() {\n                if ($(this).val() == \"\") {\n                    canSubmit = false;\n                }\n            });\n            return canSubmit;\n        },\n\n        // Blank method for question to fill out when the question cannot be submitted\n        onCannotSubmit: function() {\n            this.showValidationError();\n        },\n\n        showValidationError: function() {\n            this.$(\".textinput-item-textbox\").addClass(\"textinput-validation-error\");\n        },\n\n        //This preserve the state of the users answers for returning or showing the users answer\n        storeUserAnswer: function() {\n            var items = this.model.get('_items');\n            _.each(items, function(item, index) {\n                item.userAnswer = this.$('.textinput-item-textbox').eq(index).val();\n            }, this);\n\n            this.isCorrect();\n\n            var userAnswer = new Array( items.length );\n            _.each(items, function(item, index) {\n                userAnswer[ item._index ] = item._answerIndex;\n            });\n            this.model.set(\"_userAnswer\", userAnswer);\n        },\n\n        isCorrect: function() {\n            if(this.model.get('_answers')) this.markGenericAnswers();\n            else this.markSpecificAnswers();\n            // do we have any _isCorrect == false?\n            return !_.contains(_.pluck(this.model.get(\"_items\"),\"_isCorrect\"), false);\n        },\n\n        // Allows the learner to give answers into any input, ignoring the order.\n        // (this excludes any inputs which have their own specific answers).\n        markGenericAnswers: function() {\n            var numberOfCorrectAnswers = 0;\n            var correctAnswers = this.model.get('_answers').slice();\n            var usedAnswerIndexes = [];\n            _.each(this.model.get('_items'), function(item, itemIndex) {\n                _.each(correctAnswers, function(answerGroup, answerIndex) {\n                    if(this.checkAnswerIsCorrect(answerGroup, item.userAnswer)) {\n                        if (_.indexOf(usedAnswerIndexes, answerIndex) > -1) return;\n                        usedAnswerIndexes.push(answerIndex);\n                        item._isCorrect = true;\n                        item._answerIndex = answerIndex + genericAnswerIndexOffset;\n                        numberOfCorrectAnswers++;\n                        this.model.set('_numberOfCorrectAnswers', numberOfCorrectAnswers);\n                        this.model.set('_isAtLeastOneCorrectSelection', true);\n                    }\n                }, this);\n                if(!item._isCorrect) item._isCorrect = false;\n            }, this);\n        },\n\n        // Marks any items which have answers specific to it\n        // (i.e. item has a _answers array)\n        markSpecificAnswers: function() {\n            var numberOfCorrectAnswers = 0;\n            var numberOfSpecificAnswers = 0;\n            _.each(this.model.get('_items'), function(item, index) {\n                if(!item._answers) return;\n                var userAnswer = item.userAnswer || \"\"; \n                if (this.checkAnswerIsCorrect(item[\"_answers\"], userAnswer)) {\n                    numberOfCorrectAnswers++;\n                    item._isCorrect = true;\n                    item._answerIndex = _.indexOf(item[\"_answers\"], this.cleanupUserAnswer(userAnswer));\n                    this.model.set('_numberOfCorrectAnswers', numberOfCorrectAnswers);\n                    this.model.set('_isAtLeastOneCorrectSelection', true);\n                } else {\n                    item._isCorrect = false;\n                    item._answerIndex = -1;\n                }\n                numberOfSpecificAnswers++;\n            }, this);\n        },\n\n        checkAnswerIsCorrect: function(possibleAnswers, userAnswer) {\n            var uAnswer = this.cleanupUserAnswer(userAnswer);\n            var matched = _.filter(possibleAnswers, function(cAnswer){\n                return this.cleanupUserAnswer(cAnswer) == uAnswer;\n            }, this);\n            \n            var answerIsCorrect = matched && matched.length > 0;\n            if (answerIsCorrect) this.model.set('_hasAtLeastOneCorrectSelection', true);\n            return answerIsCorrect;\n        },\n\n        cleanupUserAnswer: function(userAnswer) {\n            if (this.model.get('_allowsAnyCase')) {\n                userAnswer = userAnswer.toLowerCase();\n            }\n            if (this.model.get('_allowsPunctuation')) {\n                userAnswer = userAnswer.replace(/[\\.,-\\/#!$£%\\^&\\*;:{}=\\-_`~()]/g, \"\");\n                //remove any orphan double spaces and replace with single space (B & Q)->(B  Q)->(B Q)\n                userAnswer = userAnswer.replace(/(  +)+/g, \" \");\n            }\n            // removes whitespace from beginning/end (leave any in the middle)\n            return $.trim(userAnswer);\n        },\n\n        // Used to set the score based upon the _questionWeight\n        setScore: function() {\n            var numberOfCorrectAnswers = this.model.get('_numberOfCorrectAnswers');\n            var questionWeight = this.model.get(\"_questionWeight\");\n            var itemLength = this.model.get('_items').length;\n\n            var score = questionWeight * numberOfCorrectAnswers / itemLength;\n\n            this.model.set('_score', score);\n        },\n\n        // This is important and should give the user feedback on how they answered the question\n        // Normally done through ticks and crosses by adding classes\n        showMarking: function() {\n            if (!this.model.get('_canShowMarking')) return;\n\n            _.each(this.model.get('_items'), function(item, i) {\n                var $item = this.$('.textinput-item').eq(i);\n                $item.removeClass('correct incorrect').addClass(item._isCorrect ? 'correct' : 'incorrect');\n            }, this);\n        },\n\n        isPartlyCorrect: function() {\n            return this.model.get('_isAtLeastOneCorrectSelection');\n        },\n\n        resetUserAnswer: function() {\n            _.each(this.model.get('_items'), function(item) {\n                item[\"_isCorrect\"] = false;\n                item[\"userAnswer\"] = \"\";\n            }, this);\n        },\n\n        // Used by the question view to reset the look and feel of the component.\n        resetQuestion: function() {\n            this.$('.textinput-item-textbox').prop('disabled', !this.model.get('_isEnabled')).val('');\n\n            this.model.set({\n                _isAtLeastOneCorrectSelection: false,\n                _isCorrect: undefined\n            });\n        },\n\n        showCorrectAnswer: function() {\n            \n            if(this.model.get('_answers'))  {\n                \n                var correctAnswers = this.model.get('_answers');\n                _.each(this.model.get('_items'), function(item, index) {\n                    this.$(\".textinput-item-textbox\").eq(index).val(correctAnswers[index][0]);\n                }, this);\n                \n            } else {\n                _.each(this.model.get('_items'), function(item, index) {\n                    this.$(\".textinput-item-textbox\").eq(index).val(item._answers[0]);\n                }, this);\n            }\n            \n        },\n\n        hideCorrectAnswer: function() {\n            _.each(this.model.get('_items'), function(item, index) {\n                this.$(\".textinput-item-textbox\").eq(index).val(item.userAnswer);\n            }, this);\n        },\n\n        /**\n        * used by adapt-contrib-spoor to get the user's answers in the format required by the cmi.interactions.n.student_response data field\n        * returns the user's answers as a string in the format \"answer1[,]answer2[,]answer3\"\n        * the use of [,] as an answer delimiter is from the SCORM 2004 specification for the fill-in interaction type\n        */\n        getResponse: function() {\n            return _.pluck(this.model.get('_items'), 'userAnswer').join('[,]');\n        },\n\n        /**\n        * used by adapt-contrib-spoor to get the type of this question in the format required by the cmi.interactions.n.type data field\n        */\n        getResponseType: function() {\n            return \"fill-in\";\n        }\n    });\n\n    Adapt.register(\"textinput\", TextInput);\n\n    return TextInput;\n});\n\n","define('components/adapt-expose/js/adapt-expose',['require','coreViews/componentView','coreJS/adapt'],function(require) {\r\n\r\n\tfunction toHyphenCase(str) {\r\n\t\tif (!str) return false;\r\n\t\treturn str.replace(/([A-Z])/g, \"-$1\").toLowerCase();\r\n\t}\r\n\r\n\tvar ComponentView = require('coreViews/componentView');\r\n\tvar Adapt = require('coreJS/adapt');\r\n\r\n\tvar Expose = ComponentView.extend({\r\n\t\tevents: {\r\n\t\t\t\"click .expose-item-cover\": \"toggleItem\",\r\n\t\t\t\"click .expose-item-content\": \"toggleItem\",\r\n\t\t\t\"click .expose-item-button\": \"toggleItem\"\r\n\t\t},\r\n\r\n\t\tonDeviceResize: function() {\r\n\t\t\tthis.setupColumns();\r\n\t\t\tthis.setEqualHeights();\r\n\t\t},\r\n\r\n\t\tpreRender: function() {\r\n\t\t\tthis.animationType = toHyphenCase(this.model.get(\"_animationType\")) || \"fade\";\r\n\t\t},\r\n\r\n\t\tpostRender: function() {\r\n\t\t\tthis.$(\".expose-item\").children().addClass(this.animationType);\r\n\t\t\tthis.setupColumns();\r\n\t\t\tthis.setEqualHeights();\r\n\t\t\tthis.setReadyStatus();\r\n\t\t\tthis.setupEventListeners();\r\n\t\t},\r\n\r\n\t\tsetupColumns: function() {\r\n\t\t\tif (this.model.get(\"_columns\") && $(window).width() > 760) {\r\n\t\t\t\tvar w = 100 / this.model.get(\"_columns\") + \"%\";\r\n\t\t\t\tthis.$(\".expose-items\").addClass(\"expose-columns\");\r\n\t\t\t\tthis.$(\".expose-item\").width(w).addClass(\"expose-column\");\r\n\t\t\t} else {\r\n\t\t\t\tthis.$(\".expose-items\").removeClass(\"expose-columns\");\r\n\t\t\t\tthis.$(\".expose-item\").width(\"auto\").removeClass(\"expose-column\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tsetEqualHeights: function () {\r\n\t\t\tif (this.model.get(\"_equalHeights\") === false) return;\r\n\t\t\tvar $contentElements = this.$(\".expose-item-content\");\r\n\t\t\tvar hMax = 0;\r\n\t\t\t_.each($contentElements, function(el) {\r\n\t\t\t\tvar h = $(el).outerHeight();\r\n\t\t\t\tif (h > hMax) hMax = h;\r\n\t\t\t});\r\n\t\t\t$contentElements.height(hMax);\r\n\t\t},\r\n\t\t\r\n\t\tsetupEventListeners: function() {\r\n\t\t\tthis.listenTo(Adapt, {'device:resize': this.onDeviceResize});\r\n\t\t},\r\n\r\n\t\ttoggleItem: function(e) {\r\n\t\t\tif (e.target.tagName === \"A\") return;\r\n\t\t\tvar $parent = $(e.currentTarget).parent();\r\n\t\t\tvar $cover = $parent.children(\".expose-item-cover\");\r\n\t\t\t$cover.toggleClass(this.animationType);\r\n\t\t\tif (!$cover.is(\".visited\")) {\r\n\t\t\t\t$cover.addClass(\"visited\");\r\n\t\t\t\tvar i = $cover.parents(\".expose-item\").index();\r\n\t\t\t\tthis.model.get(\"_items\")[i]._isVisited = true;\r\n\t\t\t\tthis.evaluateCompletion();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tevaluateCompletion: function() {\r\n\t\t\tvar incompleteItems = _.filter(this.model.get(\"_items\"), function(item) {\r\n\t\t\t\treturn !item._isVisited;\r\n\t\t\t});\r\n\t\t\t!incompleteItems.length && this.onComplete();\r\n\t\t},\r\n\r\n\t\tonComplete: function() {\r\n\t\t\tthis.setCompletionStatus();\r\n\r\n\t\t}\r\n\r\n\t});\r\n\r\n\tAdapt.register('expose', Expose);\r\n\r\n\treturn Expose;\r\n\r\n});\r\n\n","\r\ndefine('components/adapt-hotgrid/js/adapt-hotgrid',['require','coreViews/componentView','coreJS/adapt'],function(require) {\r\n\r\n    var ComponentView = require(\"coreViews/componentView\");\r\n    var Adapt = require(\"coreJS/adapt\");\r\n\r\n    var Hotgrid = ComponentView.extend({\r\n \r\n        events: {\r\n            \"click .hotgrid-item-image\":\"onItemClicked\"\r\n        },\r\n        \r\n        isPopupOpen: false,\r\n        \r\n        preRender: function () {\r\n            var items = this.model.get('_items');\r\n            _.each(items, function(item) {\r\n                if (item._graphic.srcHover && item._graphic.srcVisited) {\r\n                    item._graphic.hasImageStates = true;\r\n                }\r\n            }, this);\r\n            \r\n            this.listenTo(Adapt, 'device:changed', this.resizeControl);\r\n            \r\n            this.setDeviceSize();\r\n        },\r\n\r\n        setDeviceSize: function() {\r\n            if (Adapt.device.screenSize === 'large') {\r\n                this.$el.addClass('desktop').removeClass('mobile');\r\n                this.model.set('_isDesktop', true);\r\n            } else {\r\n                this.$el.addClass('mobile').removeClass('desktop');\r\n                this.model.set('_isDesktop', false)\r\n            }\r\n        },\r\n\r\n        postRender: function() {\r\n            this.setUpColumns();\r\n            this.$('.hotgrid-widget').imageready(_.bind(function() {\r\n                this.setReadyStatus();\r\n            }, this));\r\n        },\r\n\r\n        resizeControl: function() {\r\n            this.setDeviceSize();\r\n            this.render();\r\n        },\r\n\r\n        setUpColumns: function() {\r\n            var columns = this.model.get('_columns');\r\n\r\n            if (columns && Adapt.device.screenSize === 'large') {\r\n                this.$('.hotgrid-grid-item').css('width', (100 / columns) + '%');\r\n            }\r\n        },\r\n\r\n        onItemClicked: function(event) {\r\n            if (event) event.preventDefault();\r\n\r\n            var $link = $(event.currentTarget);\r\n            var $item = $link.parent();\r\n            var itemModel = this.model.get('_items')[$item.index()];\r\n\r\n            if(!itemModel.visited) {\r\n                $item.addClass(\"visited\");\r\n                itemModel.visited = true;\r\n                // append the word 'visited.' to the link's aria-label\r\n                var visitedLabel = this.model.get('_globals')._accessibility._ariaLabels.visited + \".\";\r\n                $link.attr('aria-label', function(index,val) {return val + \" \" + visitedLabel});\r\n            }\r\n\r\n            this.showItemContent(itemModel);\r\n\r\n        },\r\n\r\n        showItemContent: function(itemModel) {\r\n            if(this.isPopupOpen) return;// ensure multiple clicks don't open multiple notify popups\r\n\r\n            Adapt.trigger(\"notify:popup\", {\r\n                title: itemModel.title,\r\n                body: \"<div class='hotgrid-notify-container'><div class='hotgrid-notify-body'>\" + itemModel.body + \"</div>\" +\r\n\t\t\t\t\t\"<img class='hotgrid-notify-graphic' src='\" +\r\n                    itemModel._itemGraphic.src + \"' alt='\" +\r\n                    itemModel._itemGraphic.alt + \"'/></div>\"\r\n            });\r\n\r\n            this.isPopupOpen = true;\r\n\r\n            Adapt.once(\"notify:closed\", _.bind(function() {\r\n                this.isPopupOpen = false;\r\n                this.evaluateCompletion();\r\n            }, this));\r\n        },\r\n        \r\n        getVisitedItems: function() {\r\n            return _.filter(this.model.get('_items'), function(item) {\r\n                return item.visited;\r\n            });\r\n        },\r\n\r\n        evaluateCompletion: function() {\r\n            if (this.getVisitedItems().length == this.model.get('_items').length) {\r\n                this.setCompletionStatus();\r\n            }\r\n        }\r\n        \r\n    },{\r\n        template: \"hotgrid\"\r\n    });\r\n    \r\n    Adapt.register(\"hotgrid\", Hotgrid);\r\n    \r\n    return Hotgrid;\r\n\r\n});\r\n\n","define('components/adapt-narrativeStrip/js/adapt-narrativeStrip',[ \"coreJS/adapt\", \"coreViews/componentView\" ], function(Adapt, ComponentView) {\r\n\r\n    var Narrative = ComponentView.extend({\r\n\r\n        events: {\r\n            'click .ns-controls':'onNavigationClicked'\r\n        },\r\n\r\n        preRender: function () {\r\n            this.listenTo(Adapt, 'device:resize', this.resizeControl, this);\r\n            this.setDeviceSize();            \r\n        },\r\n\r\n        setDeviceSize: function() {\r\n            if (Adapt.device.screenSize === 'large') {\r\n                this.$el.addClass('desktop').removeClass('mobile');\r\n                this.model.set('_isDesktop', true);\r\n            } else {\r\n                this.$el.addClass('mobile').removeClass('desktop');\r\n                this.model.set('_isDesktop', false)\r\n            }\r\n        },\r\n\r\n        postRender: function() {\r\n            this.setupImages();\r\n            this.setupNarrative();\r\n        },\r\n\r\n        setupImages: function() {\r\n            var _items = this.model.get(\"_items\");\r\n            var _images = this.model.get(\"_images\");\r\n\r\n            var splitHeight = _items.length;\r\n            var images = _images.length;\r\n            var imagesSplit = 0;\r\n\r\n            var thisHandle = this;\r\n\r\n            var height = undefined;\r\n            var width = undefined;\r\n\r\n            var imagesToLoadCount = 0;\r\n            var imagesLoadedCount = 0;\r\n\r\n            _.each(_images, function(image) {\r\n                var imageObj = new Image();\r\n                $(imageObj).bind(\"load\", function(event) {\r\n                    imagesSplit++;\r\n\r\n                    var imgHeight = imageObj.naturalHeight;\r\n                    var imgWidth = imageObj.naturalWidth;\r\n\r\n                    height = height || imageObj.naturalHeight;\r\n                    width = width || imageObj.naturalWidth;\r\n\r\n                    var finalHeight = height / splitHeight;\r\n\r\n                    var offsetTop = 0;\r\n                    var offsetLeft = 0;\r\n                    var newHeight = height;\r\n\r\n                    if (imgWidth != width) newHeight = (width/imgWidth) * imgHeight;\r\n\r\n                    var canvas = document.createElement(\"canvas\");\r\n                    if (typeof G_vmlCanvasManager != 'undefined') G_vmlCanvasManager.initElement(canvas);\r\n                    canvas.width = width; \r\n                    canvas.style.width = \"100%\"; \r\n                    canvas.height = finalHeight; \r\n\r\n                    var ctx = canvas.getContext(\"2d\");\r\n\r\n                    for (var s = 0; s < splitHeight; s++) {\r\n                        ctx.drawImage(imageObj, 0, 0, imgWidth, imgHeight, 0 + offsetLeft, -(s * finalHeight) + offsetTop, width, newHeight);\r\n                        var imageURL = canvas.toDataURL();\r\n\r\n                        var img = document.createElement(\"img\");\r\n                        thisHandle.$('.item-'+s+'.ns-slide-container .i'+image._id).append(img);\r\n                        imagesToLoadCount++;\r\n                        $(img).bind(\"load\", function() {\r\n                            imagesLoadedCount++;\r\n\r\n                            if (imagesToLoadCount == imagesLoadedCount) {\r\n                                thisHandle.setReadyStatus();\r\n                                $(window).resize();\r\n                            }\r\n                        });\r\n                        img.src = imageURL;\r\n\r\n                    }\r\n\r\n                    if (imagesSplit == images) {\r\n                        thisHandle.calculateWidths();\r\n                    }\r\n\r\n                });\r\n                imageObj.src = image.src;\r\n            });\r\n        },\r\n\r\n        setupNarrative: function() {\r\n\r\n        \tthis.completionEvent = this.model.get('_setCompletionOn') || false; \r\n\r\n            if(this.completionEvent === 'inview'){\r\n                this.$('.component-widget').on('inview', _.bind(this.inview, this));\r\n            }\r\n\r\n            this.setDeviceSize();\r\n            \r\n            var _items = this.model.get(\"_items\");\r\n            var thisHandle = this;\r\n            _.each(_items, function(item, index) {\r\n                item._itemCount = item._subItems.length;\r\n                if (item._stage) {\r\n                    thisHandle.setStage(index, item._stage, true);\r\n                } else {\r\n                    thisHandle.setStage(index, (item._initialItemIndex || 0) );\r\n                }\r\n            });\r\n            \r\n            this.model.set('_active', true);\r\n\r\n        },\r\n\r\n        calculateWidths: function() {\r\n            //calc widths for each item\r\n            var _items = this.model.get(\"_items\");\r\n            _.each(_items, function(item, index) {\r\n                var slideWidth = this.$('.ns-slide-container').width();\r\n                var slideCount = item._itemCount;\r\n                var marginRight = this.$('.ns-slider-graphic').css('margin-right');\r\n\r\n                var extraMargin = marginRight === \"\" ? 0 : parseInt(marginRight);\r\n                var fullSlideWidth = (slideWidth + extraMargin) * slideCount;\r\n                var iconWidth = this.$('.ns-popup-open').outerWidth();\r\n                var $headerInner = this.$(\".item-\" + index)\r\n                    .find(\".ns-strapline-header-inner\");\r\n\r\n                this.$('.item-'+index+'.ns-slide-container .ns-slider-graphic').width(slideWidth)\r\n                this.$('.ns-strapline-header').width(slideWidth);\r\n                this.$('.ns-strapline-title').width(slideWidth);\r\n\r\n                this.$('.item-'+index+'.ns-slide-container .ns-slider').width(fullSlideWidth);\r\n                $headerInner.width(fullSlideWidth);\r\n\r\n                var stage = item._stage;//this.model.get('_stage');\r\n                var margin = -(stage * slideWidth);\r\n\r\n                this.$('.item-'+index+'.ns-slide-container .ns-slider').css('margin-left', margin);\r\n                $headerInner.css(\"margin-left\", margin);\r\n\r\n                item._finalItemLeft = fullSlideWidth - slideWidth;\r\n            });\r\n\r\n            _.each(this.$('.ns-slider-graphic'), function(item) {\r\n                $(item).attr(\"height\",\"\").css(\"height\",\"\");\r\n            });\r\n        },\r\n\r\n        resizeControl: function() {\r\n            this.setDeviceSize();\r\n            this.calculateWidths();\r\n            var _items = this.model.get(\"_items\");\r\n            var thisHandle = this;\r\n            _.each(_items, function(item, index) {\r\n                thisHandle.evaluateNavigation(index);\r\n            });\r\n        },\r\n\r\n        moveSliderToIndex: function(itemIndex, stage, animate) {\r\n            var extraMargin = parseInt(this.$('.item-'+itemIndex+'.ns-slide-container .ns-slider-graphic').css('margin-right')),\r\n                movementSize = this.$('.item-'+itemIndex+'.ns-slide-container').width()+extraMargin;\r\n\r\n            if(animate) {\r\n                this.$('.item-'+itemIndex+'.ns-slide-container .ns-slider').stop().animate({'margin-left': -(movementSize * stage)});\r\n                this.$('.item-'+itemIndex+' .ns-strapline-header .ns-strapline-header-inner').stop(true, true).animate({'margin-left': -(movementSize * stage)});\r\n            } else {\r\n                this.$('.item-'+itemIndex+'.ns-slide-container .ns-slider').css({'margin-left': -(movementSize * stage)});\r\n                this.$('.item-'+itemIndex+' .ns-strapline-header .ns-strapline-header-inner').css({'margin-left': -(movementSize * stage)});\r\n            }\r\n        },\r\n\r\n        setStage: function(itemIndex, stage, initial) {\r\n            var item = this.model.get('_items')[itemIndex];\r\n\r\n            item._stage = stage;\r\n            item._subItems[stage].isComplete = true;\r\n\r\n            this.$('.ns-progress').removeClass('selected').eq(stage).addClass('selected');\r\n            this.$('.item-'+itemIndex+'.ns-slide-container .ns-slider-graphic').children('.controls').attr('tabindex', -1);\r\n            this.$('.item-'+itemIndex+'.ns-slide-container .ns-slider-graphic').eq(stage).children('.controls').attr('tabindex', 0);\r\n\r\n            this.evaluateNavigation(itemIndex);\r\n            this.evaluateCompletion();\r\n\r\n            this.moveSliderToIndex(itemIndex, stage, !initial);\r\n        },\r\n\r\n        evaluateNavigation: function(itemIndex) {\r\n            var item = this.model.get('_items')[itemIndex];\r\n            var currentStage = item._stage;\r\n            var itemCount = item._itemCount;\r\n\r\n            if (currentStage == 0) {\r\n                this.$('.item-'+itemIndex+'.ns-slide-container .ns-control-left').addClass('ns-hidden');\r\n\r\n                if (itemCount > 1) {\r\n                    this.$('.item-'+itemIndex+'.ns-slide-container .ns-control-right').removeClass('ns-hidden');\r\n                }\r\n            } else {\r\n                this.$('.item-'+itemIndex+'.ns-slide-container .ns-control-left').removeClass('ns-hidden');\r\n\r\n                if (currentStage == itemCount - 1) {\r\n                    this.$('.item-'+itemIndex+'.ns-slide-container .ns-control-right').addClass('ns-hidden');\r\n                } else {\r\n                    this.$('.item-'+itemIndex+'.ns-slide-container .ns-control-right').removeClass('ns-hidden');\r\n                }\r\n            }\r\n        },\r\n\r\n        evaluateCompletion: function() {\r\n            if(this.completionEvent === 'inview') return;\r\n\r\n            var items = this.model.get('_items');\r\n            var isComplete = true;\r\n\r\n            for(var i=0,item=null;item=items[i];i++){\r\n\r\n                for(var j=0,subItem=null;subItem=item._subItems[j];j++){\r\n                    if(!subItem.isComplete){\r\n                        isComplete = false;\r\n                        break;\r\n                    }\r\n                }\r\n                \r\n                if(!isComplete) break;                \r\n            }\r\n\r\n            if(isComplete) this.setCompletionStatus();\r\n        },\r\n\r\n        onNavigationClicked: function(event) {\r\n            event.preventDefault();\r\n\r\n            var $target = $(event.currentTarget);\r\n\r\n            if ($target.hasClass('disabled')) return;\r\n\r\n            if (!this.model.get('_active')) return;\r\n\r\n\t\t\tvar selectedItemIndex = $target.parent('.component-item').index();\r\n            var selectedItemObject = this.model.get('_items')[selectedItemIndex];\r\n\r\n            var stage = selectedItemObject._stage,\r\n                numberOfItems = selectedItemObject._itemCount;\r\n\r\n            if ($target.hasClass('ns-control-right')) {\r\n                stage++;\r\n                if (stage == numberOfItems-1) {\r\n                    $('.ns-control-left').focus();\r\n                }\r\n            } else if ($target.hasClass('ns-control-left')) {\r\n                stage--;\r\n                if (stage == 0) {\r\n                    $('.ns-control-right').focus();\r\n                }\r\n            }\r\n            stage = (stage + numberOfItems) % numberOfItems;\r\n            this.setStage(selectedItemIndex, stage);\r\n        },\r\n\r\n        inview: function(event, visible, visiblePartX, visiblePartY) {\r\n            if (visible) {\r\n                if (visiblePartY === 'top') {\r\n                    this._isVisibleTop = true;\r\n                } else if (visiblePartY === 'bottom') {\r\n                    this._isVisibleBottom = true;\r\n                } else {\r\n                    this._isVisibleTop = true;\r\n                    this._isVisibleBottom = true;\r\n                }\r\n\r\n                if (this._isVisibleTop && this._isVisibleBottom) {                    \r\n                    this.$('.component-inner').off('inview');\r\n                    this.setCompletionStatus();\r\n                }\r\n            }\r\n        }\r\n\r\n    });\r\n\r\n    Adapt.register(\"narrativeStrip\", Narrative);\r\n\r\n    return Narrative;\r\n\r\n});\r\n\n","define('components/adapt-native-media/js/adapt-native-media',['require','coreViews/componentView','coreJS/adapt'],function(require) {\r\n    var ComponentView = require('coreViews/componentView');\r\n    var Adapt = require('coreJS/adapt');\r\n\r\n    var NativeMedia = ComponentView.extend({\r\n\r\n        events: {\r\n            \"click .transcript-button\": \"toggleTranscript\"\r\n        },\r\n\r\n        postRender: function() {\r\n        \tthis.setCompletionOn();\r\n        \tthis.setReadyStatus();\r\n        },\r\n\r\n        setCompletionOn: function() {\r\n        \tvar $video = $(this.$(\"video\")[0]);\r\n        \tvar completionOn = this.model.get(\"_setCompletionOn\");\r\n        \tswitch(completionOn) {\r\n\t\t\t    case \"play\":\r\n\t\t\t        this.setCompletionOnPlay($video);\r\n\t\t\t        break;\r\n\t\t\t    case \"ended\":\r\n\t\t\t        this.setCompletionOnEnded($video);\r\n\t\t\t        break;\r\n\t\t\t    default:\r\n\t\t\t        this.setupCompletionOnInview();\r\n\t\t\t}\r\n        },\r\n\r\n        setupCompletionOnInview: function() {\r\n        \tthis.$(\".nativeMedia-widget\").on(\"inview\", _.bind(this.inview, this));\r\n        },\r\n\r\n        setCompletionOnPlay: function($video) {\r\n        \t$video.one(\"play\", _.bind(function() {\r\n        \t\tthis.setCompletionStatus();\r\n        \t}, this));\r\n        },\r\n\r\n        setCompletionOnEnded: function($video) {\r\n        \t$video.one(\"ended\", _.bind(function() {\r\n        \t\tthis.setCompletionStatus();\r\n        \t}, this));\r\n        },\r\n\r\n        inview: function(event, visible, visiblePartX, visiblePartY) {\r\n            if (visible) {\r\n                if (visiblePartY === 'top') {\r\n                    this._isVisibleTop = true;\r\n                } else if (visiblePartY === 'bottom') {\r\n                    this._isVisibleBottom = true;\r\n                } else {\r\n                    this._isVisibleTop = true;\r\n                    this._isVisibleBottom = true;\r\n                }\r\n\r\n                if (this._isVisibleTop && this._isVisibleBottom) {\r\n                \tthis.$(\".nativeMedia-widget\").off(\"inview\");\r\n                    this.setCompletionStatus();\r\n                }\r\n            }\r\n        },\r\n\r\n        toggleTranscript: function() {\r\n            var slideDirection = \"slideDown\";\r\n            if (this.transcriptOpen) {\r\n                slideDirection = \"slideUp\"\r\n                this.transcriptOpen = false;\r\n            } else {\r\n                this.transcriptOpen = true;\r\n            }\r\n            this.$(\".transcript-body\").velocity(slideDirection, {\r\n                duration: 500\r\n            });\r\n        }\r\n\r\n    });\r\n\r\n    Adapt.register(\"nativeMedia\", NativeMedia);\r\n\r\n});\n","/*!\r\n * Draggabilly PACKAGED v1.1.1\r\n * Make that shiz draggable\r\n * http://draggabilly.desandro.com\r\n * MIT license\r\n */\r\n\r\n/*!\r\n * classie - class helper functions\r\n * from bonzo https://github.com/ded/bonzo\r\n * \r\n * classie.has( elem, 'my-class' ) -> true/false\r\n * classie.add( elem, 'my-new-class' )\r\n * classie.remove( elem, 'my-unwanted-class' )\r\n * classie.toggle( elem, 'my-class' )\r\n */\r\n\r\n/*jshint browser: true, strict: true, undef: true */\r\n/*global define: false */\r\n\r\n( function( window ) {\r\n\r\n\r\n\r\n// class helper functions from bonzo https://github.com/ded/bonzo\r\n\r\nfunction classReg( className ) {\r\n  return new RegExp(\"(^|\\\\s+)\" + className + \"(\\\\s+|$)\");\r\n}\r\n\r\n// classList support for class management\r\n// altho to be fair, the api sucks because it won't accept multiple classes at once\r\nvar hasClass, addClass, removeClass;\r\n\r\nif ( 'classList' in document.documentElement ) {\r\n  hasClass = function( elem, c ) {\r\n    return elem.classList.contains( c );\r\n  };\r\n  addClass = function( elem, c ) {\r\n    elem.classList.add( c );\r\n  };\r\n  removeClass = function( elem, c ) {\r\n    elem.classList.remove( c );\r\n  };\r\n}\r\nelse {\r\n  hasClass = function( elem, c ) {\r\n    return classReg( c ).test( elem.className );\r\n  };\r\n  addClass = function( elem, c ) {\r\n    if ( !hasClass( elem, c ) ) {\r\n      elem.className = elem.className + ' ' + c;\r\n    }\r\n  };\r\n  removeClass = function( elem, c ) {\r\n    elem.className = elem.className.replace( classReg( c ), ' ' );\r\n  };\r\n}\r\n\r\nfunction toggleClass( elem, c ) {\r\n  var fn = hasClass( elem, c ) ? removeClass : addClass;\r\n  fn( elem, c );\r\n}\r\n\r\nvar classie = {\r\n  // full names\r\n  hasClass: hasClass,\r\n  addClass: addClass,\r\n  removeClass: removeClass,\r\n  toggleClass: toggleClass,\r\n  // short names\r\n  has: hasClass,\r\n  add: addClass,\r\n  remove: removeClass,\r\n  toggle: toggleClass\r\n};\r\n\r\n// transport\r\nif ( typeof define === 'function' && define.amd ) {\r\n  // AMD\r\n  define( 'classie/classie',classie );\r\n} else {\r\n  // browser global\r\n  window.classie = classie;\r\n}\r\n\r\n})( window );\r\n\r\n/*!\r\n * EventEmitter v4.2.2 - git.io/ee\r\n * Oliver Caldwell\r\n * MIT license\r\n * @preserve\r\n */\r\n\r\n(function () {\r\n\t\r\n\r\n\t/**\r\n\t * Class for managing events.\r\n\t * Can be extended to provide event functionality in other classes.\r\n\t *\r\n\t * @class EventEmitter Manages event registering and emitting.\r\n\t */\r\n\tfunction EventEmitter() {}\r\n\r\n\t// Shortcuts to improve speed and size\r\n\r\n\t// Easy access to the prototype\r\n\tvar proto = EventEmitter.prototype;\r\n\r\n\t/**\r\n\t * Finds the index of the listener for the event in it's storage array.\r\n\t *\r\n\t * @param {Function[]} listeners Array of listeners to search through.\r\n\t * @param {Function} listener Method to look for.\r\n\t * @return {Number} Index of the specified listener, -1 if not found\r\n\t * @api private\r\n\t */\r\n\tfunction indexOfListener(listeners, listener) {\r\n\t\tvar i = listeners.length;\r\n\t\twhile (i--) {\r\n\t\t\tif (listeners[i].listener === listener) {\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn -1;\r\n\t}\r\n\r\n\t/**\r\n\t * Alias a method while keeping the context correct, to allow for overwriting of target method.\r\n\t *\r\n\t * @param {String} name The name of the target method.\r\n\t * @return {Function} The aliased method\r\n\t * @api private\r\n\t */\r\n\tfunction alias(name) {\r\n\t\treturn function aliasClosure() {\r\n\t\t\treturn this[name].apply(this, arguments);\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the listener array for the specified event.\r\n\t * Will initialise the event object and listener arrays if required.\r\n\t * Will return an object if you use a regex search. The object contains keys for each matched event. So /ba[rz]/ might return an object containing bar and baz. But only if you have either defined them with defineEvent or added some listeners to them.\r\n\t * Each property in the object response is an array of listener functions.\r\n\t *\r\n\t * @param {String|RegExp} evt Name of the event to return the listeners from.\r\n\t * @return {Function[]|Object} All listener functions for the event.\r\n\t */\r\n\tproto.getListeners = function getListeners(evt) {\r\n\t\tvar events = this._getEvents();\r\n\t\tvar response;\r\n\t\tvar key;\r\n\r\n\t\t// Return a concatenated array of all matching events if\r\n\t\t// the selector is a regular expression.\r\n\t\tif (typeof evt === 'object') {\r\n\t\t\tresponse = {};\r\n\t\t\tfor (key in events) {\r\n\t\t\t\tif (events.hasOwnProperty(key) && evt.test(key)) {\r\n\t\t\t\t\tresponse[key] = events[key];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tresponse = events[evt] || (events[evt] = []);\r\n\t\t}\r\n\r\n\t\treturn response;\r\n\t};\r\n\r\n\t/**\r\n\t * Takes a list of listener objects and flattens it into a list of listener functions.\r\n\t *\r\n\t * @param {Object[]} listeners Raw listener objects.\r\n\t * @return {Function[]} Just the listener functions.\r\n\t */\r\n\tproto.flattenListeners = function flattenListeners(listeners) {\r\n\t\tvar flatListeners = [];\r\n\t\tvar i;\r\n\r\n\t\tfor (i = 0; i < listeners.length; i += 1) {\r\n\t\t\tflatListeners.push(listeners[i].listener);\r\n\t\t}\r\n\r\n\t\treturn flatListeners;\r\n\t};\r\n\r\n\t/**\r\n\t * Fetches the requested listeners via getListeners but will always return the results inside an object. This is mainly for internal use but others may find it useful.\r\n\t *\r\n\t * @param {String|RegExp} evt Name of the event to return the listeners from.\r\n\t * @return {Object} All listener functions for an event in an object.\r\n\t */\r\n\tproto.getListenersAsObject = function getListenersAsObject(evt) {\r\n\t\tvar listeners = this.getListeners(evt);\r\n\t\tvar response;\r\n\r\n\t\tif (listeners instanceof Array) {\r\n\t\t\tresponse = {};\r\n\t\t\tresponse[evt] = listeners;\r\n\t\t}\r\n\r\n\t\treturn response || listeners;\r\n\t};\r\n\r\n\t/**\r\n\t * Adds a listener function to the specified event.\r\n\t * The listener will not be added if it is a duplicate.\r\n\t * If the listener returns true then it will be removed after it is called.\r\n\t * If you pass a regular expression as the event name then the listener will be added to all events that match it.\r\n\t *\r\n\t * @param {String|RegExp} evt Name of the event to attach the listener to.\r\n\t * @param {Function} listener Method to be called when the event is emitted. If the function returns true then it will be removed after calling.\r\n\t * @return {Object} Current instance of EventEmitter for chaining.\r\n\t */\r\n\tproto.addListener = function addListener(evt, listener) {\r\n\t\tvar listeners = this.getListenersAsObject(evt);\r\n\t\tvar listenerIsWrapped = typeof listener === 'object';\r\n\t\tvar key;\r\n\r\n\t\tfor (key in listeners) {\r\n\t\t\tif (listeners.hasOwnProperty(key) && indexOfListener(listeners[key], listener) === -1) {\r\n\t\t\t\tlisteners[key].push(listenerIsWrapped ? listener : {\r\n\t\t\t\t\tlistener: listener,\r\n\t\t\t\t\tonce: false\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t/**\r\n\t * Alias of addListener\r\n\t */\r\n\tproto.on = alias('addListener');\r\n\r\n\t/**\r\n\t * Semi-alias of addListener. It will add a listener that will be\r\n\t * automatically removed after it's first execution.\r\n\t *\r\n\t * @param {String|RegExp} evt Name of the event to attach the listener to.\r\n\t * @param {Function} listener Method to be called when the event is emitted. If the function returns true then it will be removed after calling.\r\n\t * @return {Object} Current instance of EventEmitter for chaining.\r\n\t */\r\n\tproto.addOnceListener = function addOnceListener(evt, listener) {\r\n\t\treturn this.addListener(evt, {\r\n\t\t\tlistener: listener,\r\n\t\t\tonce: true\r\n\t\t});\r\n\t};\r\n\r\n\t/**\r\n\t * Alias of addOnceListener.\r\n\t */\r\n\tproto.once = alias('addOnceListener');\r\n\r\n\t/**\r\n\t * Defines an event name. This is required if you want to use a regex to add a listener to multiple events at once. If you don't do this then how do you expect it to know what event to add to? Should it just add to every possible match for a regex? No. That is scary and bad.\r\n\t * You need to tell it what event names should be matched by a regex.\r\n\t *\r\n\t * @param {String} evt Name of the event to create.\r\n\t * @return {Object} Current instance of EventEmitter for chaining.\r\n\t */\r\n\tproto.defineEvent = function defineEvent(evt) {\r\n\t\tthis.getListeners(evt);\r\n\t\treturn this;\r\n\t};\r\n\r\n\t/**\r\n\t * Uses defineEvent to define multiple events.\r\n\t *\r\n\t * @param {String[]} evts An array of event names to define.\r\n\t * @return {Object} Current instance of EventEmitter for chaining.\r\n\t */\r\n\tproto.defineEvents = function defineEvents(evts) {\r\n\t\tfor (var i = 0; i < evts.length; i += 1) {\r\n\t\t\tthis.defineEvent(evts[i]);\r\n\t\t}\r\n\t\treturn this;\r\n\t};\r\n\r\n\t/**\r\n\t * Removes a listener function from the specified event.\r\n\t * When passed a regular expression as the event name, it will remove the listener from all events that match it.\r\n\t *\r\n\t * @param {String|RegExp} evt Name of the event to remove the listener from.\r\n\t * @param {Function} listener Method to remove from the event.\r\n\t * @return {Object} Current instance of EventEmitter for chaining.\r\n\t */\r\n\tproto.removeListener = function removeListener(evt, listener) {\r\n\t\tvar listeners = this.getListenersAsObject(evt);\r\n\t\tvar index;\r\n\t\tvar key;\r\n\r\n\t\tfor (key in listeners) {\r\n\t\t\tif (listeners.hasOwnProperty(key)) {\r\n\t\t\t\tindex = indexOfListener(listeners[key], listener);\r\n\r\n\t\t\t\tif (index !== -1) {\r\n\t\t\t\t\tlisteners[key].splice(index, 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t/**\r\n\t * Alias of removeListener\r\n\t */\r\n\tproto.off = alias('removeListener');\r\n\r\n\t/**\r\n\t * Adds listeners in bulk using the manipulateListeners method.\r\n\t * If you pass an object as the second argument you can add to multiple events at once. The object should contain key value pairs of events and listeners or listener arrays. You can also pass it an event name and an array of listeners to be added.\r\n\t * You can also pass it a regular expression to add the array of listeners to all events that match it.\r\n\t * Yeah, this function does quite a bit. That's probably a bad thing.\r\n\t *\r\n\t * @param {String|Object|RegExp} evt An event name if you will pass an array of listeners next. An object if you wish to add to multiple events at once.\r\n\t * @param {Function[]} [listeners] An optional array of listener functions to add.\r\n\t * @return {Object} Current instance of EventEmitter for chaining.\r\n\t */\r\n\tproto.addListeners = function addListeners(evt, listeners) {\r\n\t\t// Pass through to manipulateListeners\r\n\t\treturn this.manipulateListeners(false, evt, listeners);\r\n\t};\r\n\r\n\t/**\r\n\t * Removes listeners in bulk using the manipulateListeners method.\r\n\t * If you pass an object as the second argument you can remove from multiple events at once. The object should contain key value pairs of events and listeners or listener arrays.\r\n\t * You can also pass it an event name and an array of listeners to be removed.\r\n\t * You can also pass it a regular expression to remove the listeners from all events that match it.\r\n\t *\r\n\t * @param {String|Object|RegExp} evt An event name if you will pass an array of listeners next. An object if you wish to remove from multiple events at once.\r\n\t * @param {Function[]} [listeners] An optional array of listener functions to remove.\r\n\t * @return {Object} Current instance of EventEmitter for chaining.\r\n\t */\r\n\tproto.removeListeners = function removeListeners(evt, listeners) {\r\n\t\t// Pass through to manipulateListeners\r\n\t\treturn this.manipulateListeners(true, evt, listeners);\r\n\t};\r\n\r\n\t/**\r\n\t * Edits listeners in bulk. The addListeners and removeListeners methods both use this to do their job. You should really use those instead, this is a little lower level.\r\n\t * The first argument will determine if the listeners are removed (true) or added (false).\r\n\t * If you pass an object as the second argument you can add/remove from multiple events at once. The object should contain key value pairs of events and listeners or listener arrays.\r\n\t * You can also pass it an event name and an array of listeners to be added/removed.\r\n\t * You can also pass it a regular expression to manipulate the listeners of all events that match it.\r\n\t *\r\n\t * @param {Boolean} remove True if you want to remove listeners, false if you want to add.\r\n\t * @param {String|Object|RegExp} evt An event name if you will pass an array of listeners next. An object if you wish to add/remove from multiple events at once.\r\n\t * @param {Function[]} [listeners] An optional array of listener functions to add/remove.\r\n\t * @return {Object} Current instance of EventEmitter for chaining.\r\n\t */\r\n\tproto.manipulateListeners = function manipulateListeners(remove, evt, listeners) {\r\n\t\tvar i;\r\n\t\tvar value;\r\n\t\tvar single = remove ? this.removeListener : this.addListener;\r\n\t\tvar multiple = remove ? this.removeListeners : this.addListeners;\r\n\r\n\t\t// If evt is an object then pass each of it's properties to this method\r\n\t\tif (typeof evt === 'object' && !(evt instanceof RegExp)) {\r\n\t\t\tfor (i in evt) {\r\n\t\t\t\tif (evt.hasOwnProperty(i) && (value = evt[i])) {\r\n\t\t\t\t\t// Pass the single listener straight through to the singular method\r\n\t\t\t\t\tif (typeof value === 'function') {\r\n\t\t\t\t\t\tsingle.call(this, i, value);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\t// Otherwise pass back to the multiple function\r\n\t\t\t\t\t\tmultiple.call(this, i, value);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\t// So evt must be a string\r\n\t\t\t// And listeners must be an array of listeners\r\n\t\t\t// Loop over it and pass each one to the multiple method\r\n\t\t\ti = listeners.length;\r\n\t\t\twhile (i--) {\r\n\t\t\t\tsingle.call(this, evt, listeners[i]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t/**\r\n\t * Removes all listeners from a specified event.\r\n\t * If you do not specify an event then all listeners will be removed.\r\n\t * That means every event will be emptied.\r\n\t * You can also pass a regex to remove all events that match it.\r\n\t *\r\n\t * @param {String|RegExp} [evt] Optional name of the event to remove all listeners for. Will remove from every event if not passed.\r\n\t * @return {Object} Current instance of EventEmitter for chaining.\r\n\t */\r\n\tproto.removeEvent = function removeEvent(evt) {\r\n\t\tvar type = typeof evt;\r\n\t\tvar events = this._getEvents();\r\n\t\tvar key;\r\n\r\n\t\t// Remove different things depending on the state of evt\r\n\t\tif (type === 'string') {\r\n\t\t\t// Remove all listeners for the specified event\r\n\t\t\tdelete events[evt];\r\n\t\t}\r\n\t\telse if (type === 'object') {\r\n\t\t\t// Remove all events matching the regex.\r\n\t\t\tfor (key in events) {\r\n\t\t\t\tif (events.hasOwnProperty(key) && evt.test(key)) {\r\n\t\t\t\t\tdelete events[key];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\t// Remove all listeners in all events\r\n\t\t\tdelete this._events;\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t/**\r\n\t * Emits an event of your choice.\r\n\t * When emitted, every listener attached to that event will be executed.\r\n\t * If you pass the optional argument array then those arguments will be passed to every listener upon execution.\r\n\t * Because it uses `apply`, your array of arguments will be passed as if you wrote them out separately.\r\n\t * So they will not arrive within the array on the other side, they will be separate.\r\n\t * You can also pass a regular expression to emit to all events that match it.\r\n\t *\r\n\t * @param {String|RegExp} evt Name of the event to emit and execute listeners for.\r\n\t * @param {Array} [args] Optional array of arguments to be passed to each listener.\r\n\t * @return {Object} Current instance of EventEmitter for chaining.\r\n\t */\r\n\tproto.emitEvent = function emitEvent(evt, args) {\r\n\t\tvar listeners = this.getListenersAsObject(evt);\r\n\t\tvar listener;\r\n\t\tvar i;\r\n\t\tvar key;\r\n\t\tvar response;\r\n\r\n\t\tfor (key in listeners) {\r\n\t\t\tif (listeners.hasOwnProperty(key)) {\r\n\t\t\t\ti = listeners[key].length;\r\n\r\n\t\t\t\twhile (i--) {\r\n\t\t\t\t\t// If the listener returns true then it shall be removed from the event\r\n\t\t\t\t\t// The function is executed either with a basic call or an apply if there is an args array\r\n\t\t\t\t\tlistener = listeners[key][i];\r\n\t\t\t\t\tresponse = listener.listener.apply(this, args || []);\r\n\t\t\t\t\tif (response === this._getOnceReturnValue() || listener.once === true) {\r\n\t\t\t\t\t\tthis.removeListener(evt, listener.listener);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t/**\r\n\t * Alias of emitEvent\r\n\t */\r\n\tproto.trigger = alias('emitEvent');\r\n\r\n\t/**\r\n\t * Subtly different from emitEvent in that it will pass its arguments on to the listeners, as opposed to taking a single array of arguments to pass on.\r\n\t * As with emitEvent, you can pass a regex in place of the event name to emit to all events that match it.\r\n\t *\r\n\t * @param {String|RegExp} evt Name of the event to emit and execute listeners for.\r\n\t * @param {...*} Optional additional arguments to be passed to each listener.\r\n\t * @return {Object} Current instance of EventEmitter for chaining.\r\n\t */\r\n\tproto.emit = function emit(evt) {\r\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\r\n\t\treturn this.emitEvent(evt, args);\r\n\t};\r\n\r\n\t/**\r\n\t * Sets the current value to check against when executing listeners. If a\r\n\t * listeners return value matches the one set here then it will be removed\r\n\t * after execution. This value defaults to true.\r\n\t *\r\n\t * @param {*} value The new value to check for when executing listeners.\r\n\t * @return {Object} Current instance of EventEmitter for chaining.\r\n\t */\r\n\tproto.setOnceReturnValue = function setOnceReturnValue(value) {\r\n\t\tthis._onceReturnValue = value;\r\n\t\treturn this;\r\n\t};\r\n\r\n\t/**\r\n\t * Fetches the current value to check against when executing listeners. If\r\n\t * the listeners return value matches this one then it should be removed\r\n\t * automatically. It will return true by default.\r\n\t *\r\n\t * @return {*|Boolean} The current value to check for or the default, true.\r\n\t * @api private\r\n\t */\r\n\tproto._getOnceReturnValue = function _getOnceReturnValue() {\r\n\t\tif (this.hasOwnProperty('_onceReturnValue')) {\r\n\t\t\treturn this._onceReturnValue;\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t};\r\n\r\n\t/**\r\n\t * Fetches the events object and creates one if required.\r\n\t *\r\n\t * @return {Object} The events storage object.\r\n\t * @api private\r\n\t */\r\n\tproto._getEvents = function _getEvents() {\r\n\t\treturn this._events || (this._events = {});\r\n\t};\r\n\r\n\t// Expose the class either via AMD, CommonJS or the global object\r\n\tif (typeof define === 'function' && define.amd) {\r\n\t\tdefine('eventEmitter/EventEmitter',[],function () {\r\n\t\t\treturn EventEmitter;\r\n\t\t});\r\n\t}\r\n\telse if (typeof module === 'object' && module.exports){\r\n\t\tmodule.exports = EventEmitter;\r\n\t}\r\n\telse {\r\n\t\tthis.EventEmitter = EventEmitter;\r\n\t}\r\n}.call(this));\r\n\r\n/*!\r\n * eventie v1.0.3\r\n * event binding helper\r\n *   eventie.bind( elem, 'click', myFn )\r\n *   eventie.unbind( elem, 'click', myFn )\r\n */\r\n\r\n/*jshint browser: true, undef: true, unused: true */\r\n/*global define: false */\r\n\r\n( function( window ) {\r\n\r\n\r\n\r\nvar docElem = document.documentElement;\r\n\r\nvar bind = function() {};\r\n\r\nif ( docElem.addEventListener ) {\r\n  bind = function( obj, type, fn ) {\r\n    obj.addEventListener( type, fn, false );\r\n  };\r\n} else if ( docElem.attachEvent ) {\r\n  bind = function( obj, type, fn ) {\r\n    obj[ type + fn ] = fn.handleEvent ?\r\n      function() {\r\n        var event = window.event;\r\n        // add event.target\r\n        event.target = event.target || event.srcElement;\r\n        fn.handleEvent.call( fn, event );\r\n      } :\r\n      function() {\r\n        var event = window.event;\r\n        // add event.target\r\n        event.target = event.target || event.srcElement;\r\n        fn.call( obj, event );\r\n      };\r\n    obj.attachEvent( \"on\" + type, obj[ type + fn ] );\r\n  };\r\n}\r\n\r\nvar unbind = function() {};\r\n\r\nif ( docElem.removeEventListener ) {\r\n  unbind = function( obj, type, fn ) {\r\n    obj.removeEventListener( type, fn, false );\r\n  };\r\n} else if ( docElem.detachEvent ) {\r\n  unbind = function( obj, type, fn ) {\r\n    obj.detachEvent( \"on\" + type, obj[ type + fn ] );\r\n    try {\r\n      delete obj[ type + fn ];\r\n    } catch ( err ) {\r\n      // can't delete window object properties\r\n      obj[ type + fn ] = undefined;\r\n    }\r\n  };\r\n}\r\n\r\nvar eventie = {\r\n  bind: bind,\r\n  unbind: unbind\r\n};\r\n\r\n// transport\r\nif ( typeof define === 'function' && define.amd ) {\r\n  // AMD\r\n  define( 'eventie/eventie',eventie );\r\n} else {\r\n  // browser global\r\n  window.eventie = eventie;\r\n}\r\n\r\n})( this );\r\n\r\n/*!\r\n * getStyleProperty by kangax\r\n * http://perfectionkills.com/feature-testing-css-properties/\r\n */\r\n\r\n/*jshint browser: true, strict: true, undef: true */\r\n/*globals define: false */\r\n\r\n( function( window ) {\r\n\r\n\r\n\r\nvar prefixes = 'Webkit Moz ms Ms O'.split(' ');\r\nvar docElemStyle = document.documentElement.style;\r\n\r\nfunction getStyleProperty( propName ) {\r\n  if ( !propName ) {\r\n    return;\r\n  }\r\n\r\n  // test standard property first\r\n  if ( typeof docElemStyle[ propName ] === 'string' ) {\r\n    return propName;\r\n  }\r\n\r\n  // capitalize\r\n  propName = propName.charAt(0).toUpperCase() + propName.slice(1);\r\n\r\n  // test vendor specific properties\r\n  var prefixed;\r\n  for ( var i=0, len = prefixes.length; i < len; i++ ) {\r\n    prefixed = prefixes[i] + propName;\r\n    if ( typeof docElemStyle[ prefixed ] === 'string' ) {\r\n      return prefixed;\r\n    }\r\n  }\r\n}\r\n\r\n// transport\r\nif ( typeof define === 'function' && define.amd ) {\r\n  // AMD\r\n  define( 'get-style-property/get-style-property',[],function() {\r\n    return getStyleProperty;\r\n  });\r\n} else {\r\n  // browser global\r\n  window.getStyleProperty = getStyleProperty;\r\n}\r\n\r\n})( window );\r\n\r\n/**\r\n * getSize v1.1.4\r\n * measure size of elements\r\n */\r\n\r\n/*jshint browser: true, strict: true, undef: true, unused: true */\r\n/*global define: false */\r\n\r\n( function( window, undefined ) {\r\n\r\n\r\n\r\n// -------------------------- helpers -------------------------- //\r\n\r\nvar defView = document.defaultView;\r\n\r\nvar getStyle = defView && defView.getComputedStyle ?\r\n  function( elem ) {\r\n    return defView.getComputedStyle( elem, null );\r\n  } :\r\n  function( elem ) {\r\n    return elem.currentStyle;\r\n  };\r\n\r\n// get a number from a string, not a percentage\r\nfunction getStyleSize( value ) {\r\n  var num = parseFloat( value );\r\n  // not a percent like '100%', and a number\r\n  var isValid = value.indexOf('%') === -1 && !isNaN( num );\r\n  return isValid && num;\r\n}\r\n\r\n// -------------------------- measurements -------------------------- //\r\n\r\nvar measurements = [\r\n  'paddingLeft',\r\n  'paddingRight',\r\n  'paddingTop',\r\n  'paddingBottom',\r\n  'marginLeft',\r\n  'marginRight',\r\n  'marginTop',\r\n  'marginBottom',\r\n  'borderLeftWidth',\r\n  'borderRightWidth',\r\n  'borderTopWidth',\r\n  'borderBottomWidth'\r\n];\r\n\r\nfunction getZeroSize() {\r\n  var size = {\r\n    width: 0,\r\n    height: 0,\r\n    innerWidth: 0,\r\n    innerHeight: 0,\r\n    outerWidth: 0,\r\n    outerHeight: 0\r\n  };\r\n  for ( var i=0, len = measurements.length; i < len; i++ ) {\r\n    var measurement = measurements[i];\r\n    size[ measurement ] = 0;\r\n  }\r\n  return size;\r\n}\r\n\r\n\r\n\r\nfunction defineGetSize( getStyleProperty ) {\r\n\r\n// -------------------------- box sizing -------------------------- //\r\n\r\nvar boxSizingProp = getStyleProperty('boxSizing');\r\nvar isBoxSizeOuter;\r\n\r\n/**\r\n * WebKit measures the outer-width on style.width on border-box elems\r\n * IE & Firefox measures the inner-width\r\n */\r\n( function() {\r\n  if ( !boxSizingProp ) {\r\n    return;\r\n  }\r\n\r\n  var div = document.createElement('div');\r\n  div.style.width = '200px';\r\n  div.style.padding = '1px 2px 3px 4px';\r\n  div.style.borderStyle = 'solid';\r\n  div.style.borderWidth = '1px 2px 3px 4px';\r\n  div.style[ boxSizingProp ] = 'border-box';\r\n\r\n  var body = document.body || document.documentElement;\r\n  body.appendChild( div );\r\n  var style = getStyle( div );\r\n\r\n  isBoxSizeOuter = getStyleSize( style.width ) === 200;\r\n  body.removeChild( div );\r\n})();\r\n\r\n\r\n// -------------------------- getSize -------------------------- //\r\n\r\nfunction getSize( elem ) {\r\n  // use querySeletor if elem is string\r\n  if ( typeof elem === 'string' ) {\r\n    elem = document.querySelector( elem );\r\n  }\r\n\r\n  // do not proceed on non-objects\r\n  if ( !elem || typeof elem !== 'object' || !elem.nodeType ) {\r\n    return;\r\n  }\r\n\r\n  var style = getStyle( elem );\r\n\r\n  // if hidden, everything is 0\r\n  if ( style.display === 'none' ) {\r\n    return getZeroSize();\r\n  }\r\n\r\n  var size = {};\r\n  size.width = elem.offsetWidth;\r\n  size.height = elem.offsetHeight;\r\n\r\n  var isBorderBox = size.isBorderBox = !!( boxSizingProp &&\r\n    style[ boxSizingProp ] && style[ boxSizingProp ] === 'border-box' );\r\n\r\n  // get all measurements\r\n  for ( var i=0, len = measurements.length; i < len; i++ ) {\r\n    var measurement = measurements[i];\r\n    var value = style[ measurement ];\r\n    var num = parseFloat( value );\r\n    // any 'auto', 'medium' value will be 0\r\n    size[ measurement ] = !isNaN( num ) ? num : 0;\r\n  }\r\n\r\n  var paddingWidth = size.paddingLeft + size.paddingRight;\r\n  var paddingHeight = size.paddingTop + size.paddingBottom;\r\n  var marginWidth = size.marginLeft + size.marginRight;\r\n  var marginHeight = size.marginTop + size.marginBottom;\r\n  var borderWidth = size.borderLeftWidth + size.borderRightWidth;\r\n  var borderHeight = size.borderTopWidth + size.borderBottomWidth;\r\n\r\n  var isBorderBoxSizeOuter = isBorderBox && isBoxSizeOuter;\r\n\r\n  // overwrite width and height if we can get it from style\r\n  var styleWidth = getStyleSize( style.width );\r\n  if ( styleWidth !== false ) {\r\n    size.width = styleWidth +\r\n      // add padding and border unless it's already including it\r\n      ( isBorderBoxSizeOuter ? 0 : paddingWidth + borderWidth );\r\n  }\r\n\r\n  var styleHeight = getStyleSize( style.height );\r\n  if ( styleHeight !== false ) {\r\n    size.height = styleHeight +\r\n      // add padding and border unless it's already including it\r\n      ( isBorderBoxSizeOuter ? 0 : paddingHeight + borderHeight );\r\n  }\r\n\r\n  size.innerWidth = size.width - ( paddingWidth + borderWidth );\r\n  size.innerHeight = size.height - ( paddingHeight + borderHeight );\r\n\r\n  size.outerWidth = size.width + marginWidth;\r\n  size.outerHeight = size.height + marginHeight;\r\n\r\n  return size;\r\n}\r\n\r\nreturn getSize;\r\n\r\n}\r\n\r\n// transport\r\nif ( typeof define === 'function' && define.amd ) {\r\n  // AMD\r\n  define( 'get-size/get-size',[ 'get-style-property/get-style-property' ], defineGetSize );\r\n} else {\r\n  // browser global\r\n  window.getSize = defineGetSize( window.getStyleProperty );\r\n}\r\n\r\n})( window );\r\n\r\n/*!\r\n * Draggabilly v1.1.1\r\n * Make that shiz draggable\r\n * http://draggabilly.desandro.com\r\n * MIT license\r\n */\r\n\r\n( function( window ) {\r\n\r\n\r\n\r\n// vars\r\nvar document = window.document;\r\n\r\n// -------------------------- helpers -------------------------- //\r\n\r\n// extend objects\r\nfunction extend( a, b ) {\r\n  for ( var prop in b ) {\r\n    a[ prop ] = b[ prop ];\r\n  }\r\n  return a;\r\n}\r\n\r\nfunction noop() {}\r\n\r\n// ----- get style ----- //\r\n\r\nvar defView = document.defaultView;\r\n\r\nvar getStyle = defView && defView.getComputedStyle ?\r\n  function( elem ) {\r\n    return defView.getComputedStyle( elem, null );\r\n  } :\r\n  function( elem ) {\r\n    return elem.currentStyle;\r\n  };\r\n\r\n\r\n// http://stackoverflow.com/a/384380/182183\r\nvar isElement = ( typeof HTMLElement === 'object' ) ?\r\n  function isElementDOM2( obj ) {\r\n    return obj instanceof HTMLElement;\r\n  } :\r\n  function isElementQuirky( obj ) {\r\n    return obj && typeof obj === 'object' &&\r\n      obj.nodeType === 1 && typeof obj.nodeName === 'string';\r\n  };\r\n\r\n// -------------------------- requestAnimationFrame -------------------------- //\r\n\r\n// https://gist.github.com/1866474\r\n\r\nvar lastTime = 0;\r\nvar prefixes = 'webkit moz ms o'.split(' ');\r\n// get unprefixed rAF and cAF, if present\r\nvar requestAnimationFrame = window.requestAnimationFrame;\r\nvar cancelAnimationFrame = window.cancelAnimationFrame;\r\n// loop through vendor prefixes and get prefixed rAF and cAF\r\nvar prefix;\r\nfor( var i = 0; i < prefixes.length; i++ ) {\r\n  if ( requestAnimationFrame && cancelAnimationFrame ) {\r\n    break;\r\n  }\r\n  prefix = prefixes[i];\r\n  requestAnimationFrame = requestAnimationFrame || window[ prefix + 'RequestAnimationFrame' ];\r\n  cancelAnimationFrame  = cancelAnimationFrame  || window[ prefix + 'CancelAnimationFrame' ] ||\r\n                            window[ prefix + 'CancelRequestAnimationFrame' ];\r\n}\r\n\r\n// fallback to setTimeout and clearTimeout if either request/cancel is not supported\r\nif ( !requestAnimationFrame || !cancelAnimationFrame )  {\r\n  requestAnimationFrame = function( callback ) {\r\n    var currTime = new Date().getTime();\r\n    var timeToCall = Math.max( 0, 16 - ( currTime - lastTime ) );\r\n    var id = window.setTimeout( function() {\r\n      callback( currTime + timeToCall );\r\n    }, timeToCall );\r\n    lastTime = currTime + timeToCall;\r\n    return id;\r\n  };\r\n\r\n  cancelAnimationFrame = function( id ) {\r\n    window.clearTimeout( id );\r\n  };\r\n}\r\n\r\n// -------------------------- definition -------------------------- //\r\n\r\nfunction draggabillyDefinition( classie, EventEmitter, eventie, getStyleProperty, getSize ) {\r\n\r\n// -------------------------- support -------------------------- //\r\n\r\nvar transformProperty = getStyleProperty('transform');\r\n// TODO fix quick & dirty check for 3D support\r\nvar is3d = !!getStyleProperty('perspective');\r\n\r\n// --------------------------  -------------------------- //\r\n\r\nfunction Draggabilly( element, options ) {\r\n  // querySelector if string\r\n  this.element = typeof element === 'string' ?\r\n    document.querySelector( element ) : element;\r\n\r\n  this.options = extend( {}, this.options );\r\n  extend( this.options, options );\r\n\r\n  this._create();\r\n}\r\n\r\n// inherit EventEmitter methods\r\nextend( Draggabilly.prototype, EventEmitter.prototype );\r\n\r\nDraggabilly.prototype.options = {\r\n};\r\n\r\nDraggabilly.prototype._create = function() {\r\n\r\n  // properties\r\n  this.position = {};\r\n  this._getPosition();\r\n\r\n  this.startPoint = { x: 0, y: 0 };\r\n  this.dragPoint = { x: 0, y: 0 };\r\n\r\n  this.startPosition = extend( {}, this.position );\r\n\r\n  // set relative positioning\r\n  var style = getStyle( this.element );\r\n  if ( style.position !== 'relative' && style.position !== 'absolute' ) {\r\n    this.element.style.position = 'relative';\r\n  }\r\n\r\n  this.enable();\r\n  this.setHandles();\r\n\r\n};\r\n\r\n/**\r\n * set this.handles and bind start events to 'em\r\n */\r\nDraggabilly.prototype.setHandles = function() {\r\n  this.handles = this.options.handle ?\r\n    this.element.querySelectorAll( this.options.handle ) : [ this.element ];\r\n\r\n  for ( var i=0, len = this.handles.length; i < len; i++ ) {\r\n    var handle = this.handles[i];\r\n    // bind pointer start event\r\n    if ( window.navigator.pointerEnabled ) {\r\n      // W3C Pointer Events, IE11. See https://coderwall.com/p/mfreca\r\n      eventie.bind( handle, 'pointerdown', this );\r\n      // disable scrolling on the element\r\n      handle.style.touchAction = 'none';\r\n    } else if ( window.navigator.msPointerEnabled ) {\r\n      // IE10 Pointer Events\r\n      eventie.bind( handle, 'MSPointerDown', this );\r\n      // disable scrolling on the element\r\n      handle.style.msTouchAction = 'none';\r\n    } else {\r\n      // listen for both, for devices like Chrome Pixel\r\n      //   which has touch and mouse events\r\n      eventie.bind( handle, 'mousedown', this );\r\n      eventie.bind( handle, 'touchstart', this );\r\n      disableImgOndragstart( handle );\r\n    }\r\n  }\r\n};\r\n\r\n// remove default dragging interaction on all images in IE8\r\n// IE8 does its own drag thing on images, which messes stuff up\r\n\r\nfunction noDragStart() {\r\n  return false;\r\n}\r\n\r\n// TODO replace this with a IE8 test\r\nvar isIE8 = 'attachEvent' in document.documentElement;\r\n\r\n// IE8 only\r\nvar disableImgOndragstart = !isIE8 ? noop : function( handle ) {\r\n\r\n  if ( handle.nodeName === 'IMG' ) {\r\n    handle.ondragstart = noDragStart;\r\n  }\r\n\r\n  var images = handle.querySelectorAll('img');\r\n  for ( var i=0, len = images.length; i < len; i++ ) {\r\n    var img = images[i];\r\n    img.ondragstart = noDragStart;\r\n  }\r\n};\r\n\r\n\r\n// get left/top position from style\r\nDraggabilly.prototype._getPosition = function() {\r\n  // properties\r\n  var style = getStyle( this.element );\r\n\r\n  var x = parseInt( style.left, 10 );\r\n  var y = parseInt( style.top, 10 );\r\n\r\n  // clean up 'auto' or other non-integer values\r\n  this.position.x = isNaN( x ) ? 0 : x;\r\n  this.position.y = isNaN( y ) ? 0 : y;\r\n\r\n  this._addTransformPosition( style );\r\n};\r\n\r\n// add transform: translate( x, y ) to position\r\nDraggabilly.prototype._addTransformPosition = function( style ) {\r\n  if ( !transformProperty ) {\r\n    return;\r\n  }\r\n  var transform = style[ transformProperty ];\r\n  // bail out if value is 'none'\r\n  if ( transform.indexOf('matrix') !== 0 ) {\r\n    return;\r\n  }\r\n  // split matrix(1, 0, 0, 1, x, y)\r\n  var matrixValues = transform.split(',');\r\n  // translate X value is in 12th or 4th position\r\n  var xIndex = transform.indexOf('matrix3d') === 0 ? 12 : 4;\r\n  var translateX = parseInt( matrixValues[ xIndex ], 10 );\r\n  // translate Y value is in 13th or 5th position\r\n  var translateY = parseInt( matrixValues[ xIndex + 1 ], 10 );\r\n  this.position.x += translateX;\r\n  this.position.y += translateY;\r\n};\r\n\r\n// -------------------------- events -------------------------- //\r\n\r\n// trigger handler methods for events\r\nDraggabilly.prototype.handleEvent = function( event ) {\r\n  var method = 'on' + event.type;\r\n  if ( this[ method ] ) {\r\n    this[ method ]( event );\r\n  }\r\n};\r\n\r\n// returns the touch that we're keeping track of\r\nDraggabilly.prototype.getTouch = function( touches ) {\r\n  for ( var i=0, len = touches.length; i < len; i++ ) {\r\n    var touch = touches[i];\r\n    if ( touch.identifier === this.pointerIdentifier ) {\r\n      return touch;\r\n    }\r\n  }\r\n};\r\n\r\n// ----- start event ----- //\r\n\r\nDraggabilly.prototype.onmousedown = function( event ) {\r\n  // dismiss clicks from right or middle buttons\r\n  var button = event.button;\r\n  if ( button && ( button !== 0 && button !== 1 ) ) {\r\n    return;\r\n  }\r\n  this.dragStart( event, event );\r\n};\r\n\r\nDraggabilly.prototype.ontouchstart = function( event ) {\r\n  // disregard additional touches\r\n  if ( this.isDragging ) {\r\n    return;\r\n  }\r\n\r\n  this.dragStart( event, event.changedTouches[0] );\r\n};\r\n\r\nDraggabilly.prototype.onMSPointerDown =\r\nDraggabilly.prototype.onpointerdown = function( event ) {\r\n  // disregard additional touches\r\n  if ( this.isDragging ) {\r\n    return;\r\n  }\r\n\r\n  this.dragStart( event, event );\r\n};\r\n\r\nfunction setPointerPoint( point, pointer ) {\r\n  point.x = pointer.pageX !== undefined ? pointer.pageX : pointer.clientX;\r\n  point.y = pointer.pageY !== undefined ? pointer.pageY : pointer.clientY;\r\n}\r\n\r\n// hash of events to be bound after start event\r\nvar postStartEvents = {\r\n  mousedown: [ 'mousemove', 'mouseup' ],\r\n  touchstart: [ 'touchmove', 'touchend', 'touchcancel' ],\r\n  pointerdown: [ 'pointermove', 'pointerup', 'pointercancel' ],\r\n  MSPointerDown: [ 'MSPointerMove', 'MSPointerUp', 'MSPointerCancel' ]\r\n};\r\n\r\n/**\r\n * drag start\r\n * @param {Event} event\r\n * @param {Event or Touch} pointer\r\n */\r\nDraggabilly.prototype.dragStart = function( event, pointer ) {\r\n  if ( !this.isEnabled ) {\r\n    return;\r\n  }\r\n\r\n  if ( event.preventDefault ) {\r\n    event.preventDefault();\r\n  } else {\r\n    event.returnValue = false;\r\n  }\r\n\r\n  // save pointer identifier to match up touch events\r\n  this.pointerIdentifier = pointer.pointerId !== undefined ?\r\n    // pointerId for pointer events, touch.indentifier for touch events\r\n    pointer.pointerId : pointer.identifier;\r\n\r\n  this._getPosition();\r\n\r\n  this.measureContainment();\r\n\r\n  // point where drag began\r\n  setPointerPoint( this.startPoint, pointer );\r\n  // position _when_ drag began\r\n  this.startPosition.x = this.position.x;\r\n  this.startPosition.y = this.position.y;\r\n\r\n  // reset left/top style\r\n  this.setLeftTop();\r\n\r\n  this.dragPoint.x = 0;\r\n  this.dragPoint.y = 0;\r\n\r\n  // bind move and end events\r\n  this._bindEvents({\r\n    // get proper events to match start event\r\n    events: postStartEvents[ event.type ],\r\n    // IE8 needs to be bound to document\r\n    node: event.preventDefault ? window : document\r\n  });\r\n\r\n  classie.add( this.element, 'is-dragging' );\r\n\r\n  // reset isDragging flag\r\n  this.isDragging = true;\r\n\r\n  this.emitEvent( 'dragStart', [ this, event, pointer ] );\r\n\r\n  // start animation\r\n  this.animate();\r\n};\r\n\r\nDraggabilly.prototype._bindEvents = function( args ) {\r\n  for ( var i=0, len = args.events.length; i < len; i++ ) {\r\n    var event = args.events[i];\r\n    eventie.bind( args.node, event, this );\r\n  }\r\n  // save these arguments\r\n  this._boundEvents = args;\r\n};\r\n\r\nDraggabilly.prototype._unbindEvents = function() {\r\n  var args = this._boundEvents;\r\n  // IE8 can trigger dragEnd twice, check for _boundEvents\r\n  if ( !args || !args.events ) {\r\n    return;\r\n  }\r\n\r\n  for ( var i=0, len = args.events.length; i < len; i++ ) {\r\n    var event = args.events[i];\r\n    eventie.unbind( args.node, event, this );\r\n  }\r\n  delete this._boundEvents;\r\n};\r\n\r\nDraggabilly.prototype.measureContainment = function() {\r\n  var containment = this.options.containment;\r\n  if ( !containment ) {\r\n    return;\r\n  }\r\n\r\n  this.size = getSize( this.element );\r\n  var elemRect = this.element.getBoundingClientRect();\r\n\r\n  // use element if element\r\n  var container = isElement( containment ) ? containment :\r\n    // fallback to querySelector if string\r\n    typeof containment === 'string' ? document.querySelector( containment ) :\r\n    // otherwise just `true`, use the parent\r\n    this.element.parentNode;\r\n\r\n  this.containerSize = getSize( container );\r\n  var containerRect = container.getBoundingClientRect();\r\n\r\n  this.relativeStartPosition = {\r\n    x: elemRect.left - containerRect.left,\r\n    y: elemRect.top  - containerRect.top\r\n  };\r\n};\r\n\r\n// ----- move event ----- //\r\n\r\nDraggabilly.prototype.onmousemove = function( event ) {\r\n  this.dragMove( event, event );\r\n};\r\n\r\nDraggabilly.prototype.onMSPointerMove =\r\nDraggabilly.prototype.onpointermove = function( event ) {\r\n  if ( event.pointerId === this.pointerIdentifier ) {\r\n    this.dragMove( event, event );\r\n  }\r\n};\r\n\r\nDraggabilly.prototype.ontouchmove = function( event ) {\r\n  var touch = this.getTouch( event.changedTouches );\r\n  if ( touch ) {\r\n    this.dragMove( event, touch );\r\n  }\r\n};\r\n\r\n/**\r\n * drag move\r\n * @param {Event} event\r\n * @param {Event or Touch} pointer\r\n */\r\nDraggabilly.prototype.dragMove = function( event, pointer ) {\r\n\r\n  setPointerPoint( this.dragPoint, pointer );\r\n  var dragX = this.dragPoint.x - this.startPoint.x;\r\n  var dragY = this.dragPoint.y - this.startPoint.y;\r\n\r\n  var grid = this.options.grid;\r\n  var gridX = grid && grid[0];\r\n  var gridY = grid && grid[1];\r\n\r\n  dragX = applyGrid( dragX, gridX );\r\n  dragY = applyGrid( dragY, gridY );\r\n\r\n  dragX = this.containDrag( 'x', dragX, gridX );\r\n  dragY = this.containDrag( 'y', dragY, gridY );\r\n\r\n  // constrain to axis\r\n  dragX = this.options.axis === 'y' ? 0 : dragX;\r\n  dragY = this.options.axis === 'x' ? 0 : dragY;\r\n\r\n  this.position.x = this.startPosition.x + dragX;\r\n  this.position.y = this.startPosition.y + dragY;\r\n  // set dragPoint properties\r\n  this.dragPoint.x = dragX;\r\n  this.dragPoint.y = dragY;\r\n\r\n  this.emitEvent( 'dragMove', [ this, event, pointer ] );\r\n};\r\n\r\nfunction applyGrid( value, grid, method ) {\r\n  method = method || 'round';\r\n  return grid ? Math[ method ]( value / grid ) * grid : value;\r\n}\r\n\r\nDraggabilly.prototype.containDrag = function( axis, drag, grid ) {\r\n  if ( !this.options.containment ) {\r\n    return drag;\r\n  }\r\n  var measure = axis === 'x' ? 'width' : 'height';\r\n\r\n  var rel = this.relativeStartPosition[ axis ];\r\n  var min = applyGrid( -rel, grid, 'ceil' );\r\n  var max = this.containerSize[ measure ] - rel - this.size[ measure ];\r\n  max = applyGrid( max, grid, 'floor' );\r\n  return  Math.min( max, Math.max( min, drag ) );\r\n};\r\n\r\n// ----- end event ----- //\r\n\r\nDraggabilly.prototype.onmouseup = function( event ) {\r\n  this.dragEnd( event, event );\r\n};\r\n\r\nDraggabilly.prototype.onMSPointerUp =\r\nDraggabilly.prototype.onpointerup = function( event ) {\r\n  if ( event.pointerId === this.pointerIdentifier ) {\r\n    this.dragEnd( event, event );\r\n  }\r\n};\r\n\r\nDraggabilly.prototype.ontouchend = function( event ) {\r\n  var touch = this.getTouch( event.changedTouches );\r\n  if ( touch ) {\r\n    this.dragEnd( event, touch );\r\n  }\r\n};\r\n\r\n/**\r\n * drag end\r\n * @param {Event} event\r\n * @param {Event or Touch} pointer\r\n */\r\nDraggabilly.prototype.dragEnd = function( event, pointer ) {\r\n  this.isDragging = false;\r\n\r\n  delete this.pointerIdentifier;\r\n\r\n  // use top left position when complete\r\n  if ( transformProperty ) {\r\n    this.element.style[ transformProperty ] = '';\r\n    this.setLeftTop();\r\n  }\r\n\r\n  // remove events\r\n  this._unbindEvents();\r\n\r\n  classie.remove( this.element, 'is-dragging' );\r\n\r\n  this.emitEvent( 'dragEnd', [ this, event, pointer ] );\r\n\r\n};\r\n\r\n// ----- cancel event ----- //\r\n\r\n// coerce to end event\r\n\r\nDraggabilly.prototype.onMSPointerCancel =\r\nDraggabilly.prototype.onpointercancel = function( event ) {\r\n  if ( event.pointerId === this.pointerIdentifier ) {\r\n    this.dragEnd( event, event );\r\n  }\r\n};\r\n\r\nDraggabilly.prototype.ontouchcancel = function( event ) {\r\n  var touch = this.getTouch( event.changedTouches );\r\n  this.dragEnd( event, touch );\r\n};\r\n\r\n// -------------------------- animation -------------------------- //\r\n\r\nDraggabilly.prototype.animate = function() {\r\n  // only render and animate if dragging\r\n  if ( !this.isDragging ) {\r\n    return;\r\n  }\r\n\r\n  this.positionDrag();\r\n\r\n  var _this = this;\r\n  requestAnimationFrame( function animateFrame() {\r\n    _this.animate();\r\n  });\r\n\r\n};\r\n\r\n// transform translate function\r\nvar translate = is3d ?\r\n  function( x, y, degs) {\r\n    return 'translate3d( ' + x + 'px, ' + y + 'px, 0) rotate(' + degs + 'deg)';\r\n  } :\r\n  function( x, y, degs ) {\r\n    return 'translate( ' + x + 'px, ' + y + 'px) rotate(' + degs + 'deg)';\r\n  };\r\n\r\n// left/top positioning\r\nDraggabilly.prototype.setLeftTop = function() {\r\n  this.element.style.left = this.position.x + 'px';\r\n  this.element.style.top  = this.position.y + 'px';\r\n  this.element.style[ transformProperty ] = 'rotate(' + (this.options.rotation || 0 )  + 'deg)';\r\n};\r\n\r\nDraggabilly.prototype.positionDrag = transformProperty ?\r\n  function() {\r\n    // position with transform\r\n    this.element.style[ transformProperty ] = translate( this.dragPoint.x, this.dragPoint.y, this.options.rotation || 0 );\r\n  } : Draggabilly.prototype.setLeftTop;\r\n\r\nDraggabilly.prototype.enable = function() {\r\n  this.isEnabled = true;\r\n};\r\n\r\nDraggabilly.prototype.disable = function() {\r\n  this.isEnabled = false;\r\n  if ( this.isDragging ) {\r\n    this.dragEnd();\r\n  }\r\n};\r\n\r\nreturn Draggabilly;\r\n\r\n} // end definition\r\n\r\n// -------------------------- transport -------------------------- //\r\n\r\nif ( typeof define === 'function' && define.amd ) {\r\n  // AMD\r\n  define( 'components/adapt-peelBackHotspot/js/draggabilly',[\r\n      'classie/classie',\r\n      'eventEmitter/EventEmitter',\r\n      'eventie/eventie',\r\n      'get-style-property/get-style-property',\r\n      'get-size/get-size'\r\n    ],\r\n    draggabillyDefinition );\r\n} else if ( typeof exports === 'object' ) {\r\n  // CommonJS\r\n  module.exports = draggabillyDefinition(\r\n    require('desandro-classie'),\r\n    require('wolfy87-eventemitter'),\r\n    require('eventie'),\r\n    require('desandro-get-style-property'),\r\n    require('get-size')\r\n  );\r\n} else {\r\n  // browser global\r\n  window.Draggabilly = draggabillyDefinition(\r\n    window.classie,\r\n    window.EventEmitter,\r\n    window.eventie,\r\n    window.getStyleProperty,\r\n    window.getSize\r\n  );\r\n}\r\n\r\n})( window );\r\n\n","/*\r\n* adapt-peelBackHotspot\r\n* Version - 0.0.0\r\n* License - http://github.com/adaptlearning/adapt_framework/LICENSE\r\n* Maintainers - Oliver Foster <oliver.foster@kineo.com>\r\n*/\r\ndefine('components/adapt-peelBackHotspot/js/adapt-peelBackHotspot',['require','coreViews/componentView','coreJS/adapt','components/adapt-peelBackHotspot/js/draggabilly','components/adapt-contrib-accordion/js/adapt-contrib-accordion'],function(require) {\r\n\r\n\tvar ComponentView = require('coreViews/componentView');\r\n\tvar Adapt = require('coreJS/adapt');\r\n\tvar Draggabilly = require('components/adapt-peelBackHotspot/js/draggabilly');\r\n\r\n    var peelbackhotspot = ComponentView.extend({\r\n        isAccordian: false,\r\n\r\n    \tevents: {\r\n    \t\t\"click .peelbackhotspot-button\": \"onButtonClick\",\r\n            \"touchend .peelbackhotspot-button\": \"onButtonClick\",\r\n            \"click .peelbackhotspot-hotspot\": \"onHotspotClick\",\r\n            \"touchend .peelbackhotspot-hotspot\": \"onHotspotClick\",\r\n            \"click .peelbackhotspot-infobox\": \"onHotspotClick\",\r\n            \"touchend .peelbackhotspot-infobox\": \"onHotspotClick\",\r\n    \t},\r\n\r\n        preRender: function() {\r\n\r\n        },\r\n\r\n        postRender: function() {\r\n        \tthis.$boundary = this.$('#peelbackhotspot-track');\r\n        \tthis.$el.imageready(_.bind(function() {\r\n\r\n                this.onResize();\r\n\r\n\t        \tthis.setReadyStatus();\r\n\t        \tvar item = this.$('.peelbackhotspot-button')[0];\r\n\t        \titem._dragger = new Draggabilly(item, {\r\n\t                containment: true,\r\n\t                axis: 'x'\r\n\t            });\r\n\t            item._dragger.on(\"dragStart\", _.bind(this.dragStart, this));\r\n\t            item._dragger.on(\"dragMove\", _.bind(this.dragMove, this));\r\n\t            item._dragger.on(\"dragEnd\", _.bind(this.dragEnd, this));\r\n\r\n                this.checkCompletion();\r\n\r\n\t        }, this));\r\n            this.listenTo(Adapt, \"device:resize\", this.onResize);\r\n        },\r\n\r\n        reRender: function() {\r\n            if (Adapt.device.screenSize != 'large' && this.model.get(\"_isAccordianOnMobile\")) {\r\n                if (!this.isAccordian) this.replaceWithAccordion();\r\n                return this.isAccordian = true;\r\n            } else {\r\n                if (this.isAccordian) this.replaceWithPeelBackHotspot();\r\n                return this.isAccordian = false;\r\n            }\r\n        },\r\n\r\n        replaceWithAccordion: function() {\r\n          var Accordion = require('components/adapt-contrib-accordion/js/adapt-contrib-accordion');\r\n          var model = this.prepareAccordionModel();\r\n          model.set('_component', 'accordion');\r\n          this.newAccordion = new Accordion({model:model, $parent: this.options.$parent});\r\n          this.newAccordion.preRender();\r\n          this.newAccordion.postRender();\r\n          model.set('_component', 'peelbackhotspot');\r\n          this.options.$parent.html(\"\");\r\n          this.options.$parent.append(this.newAccordion.$el);\r\n          this.stopListening(Adapt, 'device:resize');\r\n          Adapt.trigger('device:resize');\r\n          this.undelegateEvents();\r\n          this.listenTo(Adapt, \"device:resize\", this.onResize);\r\n\r\n        },\r\n\r\n        prepareAccordionModel: function() {\r\n          var model = this.model;\r\n          if (model.get('_wasPeelBackHotspot')) return model;\r\n          model.set('_wasPeelBackHotspot', true);\r\n          model.set('originalBody', model.get('body'));\r\n          model.set('originalTitle', model.get('displayTitle'));\r\n          if (model.get('mobileBody')) {\r\n            model.set('body', model.get('mobileBody'));\r\n          }\r\n          if (model.get('mobileTitle')) {\r\n            model.set('displayTitle', model.get('mobileTitle'));\r\n          }\r\n          return model;\r\n        },\r\n\r\n        replaceWithPeelBackHotspot: function() {\r\n          this.newAccordion.remove();\r\n          this.preparePeelBackHotspotModel();\r\n          this.render();\r\n          this.options.$parent.append(this.$el);\r\n          this.stopListening(Adapt, 'device:resize');\r\n          Adapt.trigger('device:resize');\r\n          this.listenTo(Adapt, \"device:resize\", this.onResize);\r\n          this.delegateEvents();\r\n        },\r\n\r\n        preparePeelBackHotspotModel: function() {\r\n            var model = this.model;\r\n            this.isRevealed = false;\r\n            if (!model.get('_wasPeelBackHotspot')) return;\r\n            model.set('_wasPeelBackHotspot', false);\r\n            if (model.get('mobileBody')) {\r\n                model.set('body', model.get('originalBody'));\r\n            }\r\n            if (model.get('mobileTitle')) {\r\n                model.set('displayTitle', model.get('originalTitle'));\r\n            }\r\n            return model;\r\n        },\r\n\r\n\r\n        onResize: function() {\r\n            if (this.reRender()) return;\r\n\r\n            var size = this.$('.peelbackhotspot-button').outerWidth();\r\n\r\n            this.$('.peelbackhotspot-foreground').css({\r\n                height: this.model.get(\"_reveal\")._maxHeight[Adapt.device.screenSize] \r\n            });\r\n            this.$('.peelbackhotspot-foreground').css({\r\n                left:  ((this.$('.peelbackhotspot-imageboard').width() / 2)  - (this.$('.peelbackhotspot-foreground').width() / 2)) + \"px\"\r\n            });\r\n            this.$('.peelbackhotspot-overlaycontainer').css({\r\n                width: this.$('.peelbackhotspot-imageboard').width() - size + \"px\",\r\n                left:  (size / 2) + \"px\"\r\n            });\r\n            this.$('.peelbackhotspot-background').css({\r\n                width: this.$('.peelbackhotspot-foreground').width() + \"px\",\r\n                left: ((this.$('.peelbackhotspot-imageboard').width() / 2)  - (this.$('.peelbackhotspot-foreground').width() / 2)) - (size / 2) + \"px\"\r\n            });\r\n            this.$('.peelbackhotspot-hotspots').css({\r\n                width: this.$('.peelbackhotspot-foreground').width() + \"px\",\r\n                left: ((this.$('.peelbackhotspot-imageboard').width() / 2)  - (this.$('.peelbackhotspot-foreground').width() / 2)) - (size / 2) + \"px\"\r\n            });\r\n            if (this.isRevealed) {\r\n                var offsetX = this.$('#peelbackhotspot-track').width() - (size + 1);\r\n                this.$('.peelbackhotspot-button, .peelbackhotspot-button-image').css({\r\n                    left: offsetX + \"px\"\r\n                });\r\n            } else {\r\n                var offsetX = this.$('#peelbackhotspot-track').width() - (size + 1);\r\n                this.$('.peelbackhotspot-button, .peelbackhotspot-button-image').css({\r\n                    left: \"0px\"\r\n                });\r\n            }\r\n        },\r\n\r\n        dragStart: function(instance, event) {\r\n            console.log(\"dragStart\");\r\n        \tthis.startState = this.isRevealed;\r\n        },\r\n\r\n        dragMove: function(instance, event) {\r\n            var size = this.$('.peelbackhotspot-button').outerWidth();\r\n\r\n            this.inDrag = true;\r\n        \tvar boundaryOffset = this.$boundary.offset();\r\n\r\n            var pagePoint;\r\n            var $ele = $(instance.element);\r\n\r\n            if (event.pageX !== 0) {\r\n                if (event.clientY < boundaryOffset.top) {\r\n                    event.pageX = event.clientX;\r\n                    event.pageY = event.clientY;\r\n                }\r\n                pagePoint = {\r\n                    left: event.pageX - size / 2,\r\n                    top: event.pageY\r\n                };\r\n            } else {\r\n                var $elePosition = $ele.position();\r\n                pagePoint = {\r\n                    left: $elePosition.left  + size / 2,\r\n                    top: $elePosition.top\r\n                };\r\n            }\r\n\r\n        \r\n            var pointAsPixel = {\r\n                left: ((pagePoint.left - boundaryOffset.left)),\r\n                top:  ((pagePoint.top - boundaryOffset.top))\r\n            };\r\n\r\n            var offsetX = this.$('#peelbackhotspot-track').width() - (size  + 1);\r\n\r\n            var pointAsPercent = {\r\n                left: ((100 / offsetX) * (pointAsPixel.left))\r\n            };\r\n\r\n            if (pointAsPercent.left > 100) pointAsPercent.left = 100;\r\n            if (pointAsPercent.left < 0) pointAsPercent.left = 0;\r\n\r\n            this.$('.peelbackhotspot-hider').css({\r\n            \twidth: pointAsPercent.left + '%'\r\n            });\r\n            this.$('.peelbackhotspot-button-image').css({\r\n                left: this.$('.peelbackhotspot-button').position().left + \"px\"\r\n            });\r\n\r\n\r\n            if (pointAsPercent.left < 50) {\r\n                if (!this.model.get(\"_reveal\")._button._img) this.$('.peelbackhotspot-button').html( this.model.get(\"_reveal\")._button.textRight);\r\n            } else {\r\n                if (!this.model.get(\"_reveal\")._button._img) this.$('.peelbackhotspot-button').html( this.model.get(\"_reveal\")._button.textLeft);\r\n            }\r\n\r\n        },\r\n\r\n        dragEnd: function(instance, event) {\r\n            if ( this.inAnimate) return\r\n\r\n            var size = this.$('.peelbackhotspot-button').outerWidth();\r\n\r\n            \r\n            _.defer(_.bind(function() {\r\n                console.log(\"dragEnd\");\r\n                this.inAnimate = true;\r\n\r\n                var offsetX = this.$('#peelbackhotspot-track').width() - (size  + 1);\r\n                var percentageLeft = (100/offsetX) * this.$('.peelbackhotspot-button').position().left;\r\n                var dragged = (percentageLeft > 98 && this.isRevealed ? false : percentageLeft < 2 && !this.isRevealed ? false : true);\r\n\r\n                this.animate(dragged);\r\n                this.inDrag = false;\r\n            }, this));\r\n        },\r\n\r\n\r\n        onButtonClick: function(event) {\r\n            if (event) event.preventDefault();\r\n            if (this.inDrag) return;\r\n            if ( this.inAnimate) return\r\n            this.inAnimate = true;\r\n            _.defer(_.bind(function() {\r\n                console.log(\"click\");\r\n                this.animate(false);\r\n            }, this));\r\n\r\n        },\r\n\r\n        animate: function(fromDrag) {\r\n            var size = this.$('.peelbackhotspot-button').outerWidth();\r\n\r\n            //this.$('.peelbackhotspot-button').attr(\"disabled\",\"disabled\");\r\n            var offsetX = this.$('#peelbackhotspot-track').width() - (size + 1);\r\n            var percentageLeft = (100/offsetX) * this.$('.peelbackhotspot-button').position().left;\r\n            percentageLeft = (percentageLeft > 100 ? 100 : percentageLeft < 0 ? 0 : percentageLeft);\r\n\r\n            // hidden: pickup and drop before halfway || isRevealed: drag over halfway left || isRevealed: click\r\n            var inLeftHalf = (percentageLeft >= 0 && percentageLeft < 50);\r\n            var inRightHalf = (percentageLeft <= 100 && percentageLeft > 50);\r\n\r\n            var revealedClicked = ( fromDrag === false && this.isRevealed);\r\n            var hiddenClicked = ( fromDrag === false && !this.isRevealed);\r\n            \r\n            var revealedClicked, hiddenClicked, fullDragLeft, fullDragRight;\r\n\r\n            var size = this.$('.peelbackhotspot-button').outerWidth();\r\n\r\n            if ( (inRightHalf && revealedClicked) || (inLeftHalf && fromDrag) ) {\r\n                \r\n                //this.$('.peelbackhotspot-hider').velocity({ width: \"0%\" }, \"easeInSine\");\r\n                this.$('.peelbackhotspot-button').velocity({ left: \"0px\" } , { \r\n                    progress:  _.bind(function(elements, percentComplete) {\r\n\r\n                        var offsetX = this.$('#peelbackhotspot-track').width() - (size  + 1);\r\n\r\n                        var pointAsPercent = {\r\n                            left: ((100 / offsetX) * ( $(elements).position().left ))\r\n                        };\r\n\r\n                        if (pointAsPercent.left > 100) pointAsPercent.left = 100;\r\n                        if (pointAsPercent.left < 0) pointAsPercent.left = 0;\r\n\r\n                        this.$('.peelbackhotspot-hider').css({\r\n                            width: pointAsPercent.left + '%'\r\n                        });\r\n                        this.$('.peelbackhotspot-button-image').css({\r\n                            left: $(elements).position().left + \"px\"\r\n                        });\r\n\r\n                        this.$('.peelbackhotspot-foreground').css('opacity','.98');\r\n                        setTimeout(_.bind(function() {\r\n                            this.$('.peelbackhotspot-foreground').css('opacity','1');\r\n                            this.inAnimate = false;\r\n                        }, this), 0);\r\n\r\n                    },this),\r\n                    complete: _.bind(function() {\r\n                        if (!this.model.get(\"_reveal\")._button._img) this.$('.peelbackhotspot-button').html(this.model.get(\"_reveal\")._button.textLeft);\r\n                        this.$('.peelbackhotspot-foreground').css('opacity','.98');\r\n                        setTimeout(_.bind(function() {\r\n                            this.$('.peelbackhotspot-foreground').css('opacity','1');\r\n                        }, this), 0);\r\n                        this.onRevealed(false);\r\n                },this)}, \"easeInSine\");\r\n                this.isRevealed = false;\r\n            } else if ( (inLeftHalf && hiddenClicked) || (inRightHalf && fromDrag) ) {\r\n                //this.$('.peelbackhotspot-hider').velocity({ width: \"100%\" }, \"easeInSine\");\r\n                this.$('.peelbackhotspot-button').velocity({ left: offsetX + \"px\" } , { \r\n                    progress: _.bind(function(elements, percentComplete) {\r\n                       \r\n                        var offsetX = this.$('#peelbackhotspot-track').width() - (size  + 1);\r\n\r\n                        var pointAsPercent = {\r\n                            left: ((100 / offsetX) * ( $(elements).position().left ))\r\n                        };\r\n\r\n                        if (pointAsPercent.left > 100) pointAsPercent.left = 100;\r\n                        if (pointAsPercent.left < 0) pointAsPercent.left = 0;\r\n\r\n                        this.$('.peelbackhotspot-hider').css({\r\n                            width: pointAsPercent.left + '%'\r\n                        });\r\n\r\n                        this.$('.peelbackhotspot-button-image').css({\r\n                            left: $(elements).position().left + \"px\"\r\n                        });\r\n\r\n\r\n\r\n                    }, this),\r\n                    complete: _.bind(function() {\r\n                        if (!this.model.get(\"_reveal\")._button._img) this.$('.peelbackhotspot-button').html(this.model.get(\"_reveal\")._button.textRight);\r\n                        this.inAnimate = false;\r\n                        this.onRevealed(true);\r\n                },this)}, \"easeInSine\");\r\n                this.isRevealed = true;\r\n            }\r\n\r\n            this.dragTick = false;\r\n        },\r\n\r\n        checkCompletion: function() {\r\n            var items = this.model.get(\"_items\");\r\n            var visited = _.reduce(items, function(memo, item) {\r\n                return memo + (item._isVisited ? 1 : 0);\r\n            }, 0);\r\n            if (visited === items.length) this.setCompletionStatus();\r\n        },\r\n\r\n        onHotspotClick: function(event) {\r\n            event.preventDefault();\r\n            var $ele = $(event.currentTarget);\r\n            var index = $ele.attr(\"data-id\");\r\n            var items = this.model.get(\"_items\");\r\n           \r\n            items[index]._isVisited = true;\r\n\r\n            if (items[index]._infoType === undefined) items[index]._infoType = \"notify\";\r\n\r\n            switch (items[index]._infoType) {\r\n            case \"notify\":\r\n                this.showNotify(index);\r\n                break;            \r\n            case \"infobox\":\r\n                this.toggleInfoBox(index);\r\n                break;\r\n            }\r\n\r\n            this.checkCompletion();\r\n            $ele.addClass(\"visited\");\r\n\r\n        },\r\n        showNotify: function(index) {\r\n            var items = this.model.get(\"_items\");\r\n            var popupObject = {\r\n                title: items[index].title,\r\n                body: items[index].body\r\n            };\r\n            Adapt.trigger('notify:popup', popupObject);\r\n        },\r\n        toggleInfoBox: function(index, force){\r\n            var items = this.model.get(\"_items\");\r\n            var paddingPixels = this.model.get(\"_reveal\")._infoboxPaddingPixels;\r\n            if (paddingPixels === undefined) paddingPixels = {top:10,left:10};\r\n\r\n            var infobox = this.$('#item-'+index+'.peelbackhotspot-infobox');\r\n            if ((infobox.css(\"display\") === \"none\" && force === undefined) || force === \"reveal\") {\r\n                var html = '<div><div class=\"peelbackhotspot-infobox-title\" role=\"heading\"></div><div class=\"peelbackhotspot-infobox-body\"></div></div>';\r\n                var div = $(html);\r\n                div.find('.peelbackhotspot-infobox-title').html(items[index].title);\r\n                div.find('.peelbackhotspot-infobox-body').html(items[index].body);\r\n                infobox.html(\"\").append(div);\r\n                infobox.fadeIn(1000);\r\n                \r\n\r\n                var img = this.$('.peelbackhotspot-background');\r\n                var height = img.height();\r\n                var width = img.width();\r\n\r\n                var padding = {\r\n                    top:10, \r\n                    left:10\r\n                };\r\n                padding.top = (100/height) * paddingPixels.top;\r\n                padding.left = (100/width) * paddingPixels.left;\r\n\r\n                var $pin = this.$('.peelbackhotspot-hotspot[data-id=\"'+index+'\"]');\r\n                var top = (((100/height) * ($pin.height() / 2)) + parseInt(items[index]._top)) - ((100/height) * infobox.outerHeight());\r\n                if (top < padding.top) top = padding.top;\r\n\r\n                var left;\r\n\r\n                var pinleft = (100/width) * $pin.position().left;\r\n\r\n                if (pinleft > 50) {\r\n                    if (( pinleft + (100/width) * (infobox.width() / 2) ) > (100 - (padding.left*2)) ) left = ((100 - (padding.left*2)) - (((100/width) * (infobox.width())))) + padding.left;\r\n                    else left = ( pinleft - (100/width) * (infobox.width() / 2) );\r\n                } else {\r\n                    if (( pinleft - (100/width) * (infobox.width() / 2) ) < padding.left ) left = padding.left;\r\n                    else left = ( pinleft - (100/width) * (infobox.width() / 2) );\r\n                }\r\n\r\n                infobox.css({\r\n                    top: top + \"%\",\r\n                    left: left + \"%\"\r\n                });\r\n\r\n                items[index]._isVisited = true;\r\n\r\n            } else if ((infobox.css(\"display\") !== \"none\" && force === undefined) || force === \"hide\")  {\r\n                infobox.css(\"display\", \"none\");\r\n                infobox.html(\"\")\r\n            }\r\n        },\r\n        onRevealed: function(isRevealed) {\r\n            var items = this.model.get(\"_items\");\r\n            //this.$('.peelbackhotspot-button').removeAttr(\"disabled\").focusNoScroll();\r\n            if (isRevealed) {\r\n                if (this.model.get(\"_reveal\") && this.model.get(\"_reveal\")._isInfoBoxAriaOnly !== true) {\r\n                    this.$('.peelbackhotspot-hotspot').attr(\"tabindex\", 0);\r\n                }\r\n                _.each(items, _.bind(function(item, index) {\r\n                    if (item._infoType === undefined) item._infoType = \"notify\";\r\n                    switch (item._infoType) {\r\n                    case \"notify\":\r\n                        break;\r\n                    case \"infobox\":\r\n                        if (item._isInfoBoxShown) {\r\n                            this.toggleInfoBox(index, \"reveal\");\r\n                        }\r\n                    }\r\n                }, this));\r\n                this.checkCompletion();\r\n            } else {\r\n                this.$('.peelbackhotspot-hotspot').attr(\"tabindex\", -1);\r\n                _.each(items, _.bind(function(item, index) {\r\n                    if (item._infoType === undefined) item._infoType = \"notify\";\r\n                    switch (item._infoType) {\r\n                    case \"notify\":\r\n                        break;\r\n                    case \"infobox\":\r\n                        if (item._isInfoBoxShown) {\r\n                            this.toggleInfoBox(index, \"hide\");\r\n                        }\r\n                    }\r\n                }, this));\r\n            }\r\n        }\r\n\r\n        \r\n    });\r\n    \r\n    Adapt.register(\"peelbackhotspot\", peelbackhotspot );\r\n\r\n    if ($.fn.focusNoScroll === undefined) $.fn.focusNoScroll = function(){\r\n      var y = $(window).scrollTop();\r\n      this[0].focus();\r\n      window.scrollTo(null, y);\r\n      return this; //chainability\r\n    };\r\n\r\n    \r\n});\n","/*!\r\n * Draggabilly PACKAGED v1.1.2\r\n * Make that shiz draggable\r\n * http://draggabilly.desandro.com\r\n * MIT license\r\n */\r\n\r\n/*!\r\n * classie - class helper functions\r\n * from bonzo https://github.com/ded/bonzo\r\n * \r\n * classie.has( elem, 'my-class' ) -> true/false\r\n * classie.add( elem, 'my-new-class' )\r\n * classie.remove( elem, 'my-unwanted-class' )\r\n * classie.toggle( elem, 'my-class' )\r\n */\r\n\r\n/*jshint browser: true, strict: true, undef: true */\r\n/*global define: false */\r\n\r\n( function( window ) {\r\n\r\n\r\n\r\n// class helper functions from bonzo https://github.com/ded/bonzo\r\n\r\nfunction classReg( className ) {\r\n  return new RegExp(\"(^|\\\\s+)\" + className + \"(\\\\s+|$)\");\r\n}\r\n\r\n// classList support for class management\r\n// altho to be fair, the api sucks because it won't accept multiple classes at once\r\nvar hasClass, addClass, removeClass;\r\n\r\nif ( 'classList' in document.documentElement ) {\r\n  hasClass = function( elem, c ) {\r\n    return elem.classList.contains( c );\r\n  };\r\n  addClass = function( elem, c ) {\r\n    elem.classList.add( c );\r\n  };\r\n  removeClass = function( elem, c ) {\r\n    elem.classList.remove( c );\r\n  };\r\n}\r\nelse {\r\n  hasClass = function( elem, c ) {\r\n    return classReg( c ).test( elem.className );\r\n  };\r\n  addClass = function( elem, c ) {\r\n    if ( !hasClass( elem, c ) ) {\r\n      elem.className = elem.className + ' ' + c;\r\n    }\r\n  };\r\n  removeClass = function( elem, c ) {\r\n    elem.className = elem.className.replace( classReg( c ), ' ' );\r\n  };\r\n}\r\n\r\nfunction toggleClass( elem, c ) {\r\n  var fn = hasClass( elem, c ) ? removeClass : addClass;\r\n  fn( elem, c );\r\n}\r\n\r\nvar classie = {\r\n  // full names\r\n  hasClass: hasClass,\r\n  addClass: addClass,\r\n  removeClass: removeClass,\r\n  toggleClass: toggleClass,\r\n  // short names\r\n  has: hasClass,\r\n  add: addClass,\r\n  remove: removeClass,\r\n  toggle: toggleClass\r\n};\r\n\r\n// transport\r\nif ( typeof define === 'function' && define.amd ) {\r\n  // AMD\r\n  define( 'classie/classie',classie );\r\n} else {\r\n  // browser global\r\n  window.classie = classie;\r\n}\r\n\r\n})( window );\r\n\r\n/*!\r\n * EventEmitter v4.2.2 - git.io/ee\r\n * Oliver Caldwell\r\n * MIT license\r\n * @preserve\r\n */\r\n\r\n(function () {\r\n\t\r\n\r\n\t/**\r\n\t * Class for managing events.\r\n\t * Can be extended to provide event functionality in other classes.\r\n\t *\r\n\t * @class EventEmitter Manages event registering and emitting.\r\n\t */\r\n\tfunction EventEmitter() {}\r\n\r\n\t// Shortcuts to improve speed and size\r\n\r\n\t// Easy access to the prototype\r\n\tvar proto = EventEmitter.prototype;\r\n\r\n\t/**\r\n\t * Finds the index of the listener for the event in it's storage array.\r\n\t *\r\n\t * @param {Function[]} listeners Array of listeners to search through.\r\n\t * @param {Function} listener Method to look for.\r\n\t * @return {Number} Index of the specified listener, -1 if not found\r\n\t * @api private\r\n\t */\r\n\tfunction indexOfListener(listeners, listener) {\r\n\t\tvar i = listeners.length;\r\n\t\twhile (i--) {\r\n\t\t\tif (listeners[i].listener === listener) {\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn -1;\r\n\t}\r\n\r\n\t/**\r\n\t * Alias a method while keeping the context correct, to allow for overwriting of target method.\r\n\t *\r\n\t * @param {String} name The name of the target method.\r\n\t * @return {Function} The aliased method\r\n\t * @api private\r\n\t */\r\n\tfunction alias(name) {\r\n\t\treturn function aliasClosure() {\r\n\t\t\treturn this[name].apply(this, arguments);\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the listener array for the specified event.\r\n\t * Will initialise the event object and listener arrays if required.\r\n\t * Will return an object if you use a regex search. The object contains keys for each matched event. So /ba[rz]/ might return an object containing bar and baz. But only if you have either defined them with defineEvent or added some listeners to them.\r\n\t * Each property in the object response is an array of listener functions.\r\n\t *\r\n\t * @param {String|RegExp} evt Name of the event to return the listeners from.\r\n\t * @return {Function[]|Object} All listener functions for the event.\r\n\t */\r\n\tproto.getListeners = function getListeners(evt) {\r\n\t\tvar events = this._getEvents();\r\n\t\tvar response;\r\n\t\tvar key;\r\n\r\n\t\t// Return a concatenated array of all matching events if\r\n\t\t// the selector is a regular expression.\r\n\t\tif (typeof evt === 'object') {\r\n\t\t\tresponse = {};\r\n\t\t\tfor (key in events) {\r\n\t\t\t\tif (events.hasOwnProperty(key) && evt.test(key)) {\r\n\t\t\t\t\tresponse[key] = events[key];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tresponse = events[evt] || (events[evt] = []);\r\n\t\t}\r\n\r\n\t\treturn response;\r\n\t};\r\n\r\n\t/**\r\n\t * Takes a list of listener objects and flattens it into a list of listener functions.\r\n\t *\r\n\t * @param {Object[]} listeners Raw listener objects.\r\n\t * @return {Function[]} Just the listener functions.\r\n\t */\r\n\tproto.flattenListeners = function flattenListeners(listeners) {\r\n\t\tvar flatListeners = [];\r\n\t\tvar i;\r\n\r\n\t\tfor (i = 0; i < listeners.length; i += 1) {\r\n\t\t\tflatListeners.push(listeners[i].listener);\r\n\t\t}\r\n\r\n\t\treturn flatListeners;\r\n\t};\r\n\r\n\t/**\r\n\t * Fetches the requested listeners via getListeners but will always return the results inside an object. This is mainly for internal use but others may find it useful.\r\n\t *\r\n\t * @param {String|RegExp} evt Name of the event to return the listeners from.\r\n\t * @return {Object} All listener functions for an event in an object.\r\n\t */\r\n\tproto.getListenersAsObject = function getListenersAsObject(evt) {\r\n\t\tvar listeners = this.getListeners(evt);\r\n\t\tvar response;\r\n\r\n\t\tif (listeners instanceof Array) {\r\n\t\t\tresponse = {};\r\n\t\t\tresponse[evt] = listeners;\r\n\t\t}\r\n\r\n\t\treturn response || listeners;\r\n\t};\r\n\r\n\t/**\r\n\t * Adds a listener function to the specified event.\r\n\t * The listener will not be added if it is a duplicate.\r\n\t * If the listener returns true then it will be removed after it is called.\r\n\t * If you pass a regular expression as the event name then the listener will be added to all events that match it.\r\n\t *\r\n\t * @param {String|RegExp} evt Name of the event to attach the listener to.\r\n\t * @param {Function} listener Method to be called when the event is emitted. If the function returns true then it will be removed after calling.\r\n\t * @return {Object} Current instance of EventEmitter for chaining.\r\n\t */\r\n\tproto.addListener = function addListener(evt, listener) {\r\n\t\tvar listeners = this.getListenersAsObject(evt);\r\n\t\tvar listenerIsWrapped = typeof listener === 'object';\r\n\t\tvar key;\r\n\r\n\t\tfor (key in listeners) {\r\n\t\t\tif (listeners.hasOwnProperty(key) && indexOfListener(listeners[key], listener) === -1) {\r\n\t\t\t\tlisteners[key].push(listenerIsWrapped ? listener : {\r\n\t\t\t\t\tlistener: listener,\r\n\t\t\t\t\tonce: false\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t/**\r\n\t * Alias of addListener\r\n\t */\r\n\tproto.on = alias('addListener');\r\n\r\n\t/**\r\n\t * Semi-alias of addListener. It will add a listener that will be\r\n\t * automatically removed after it's first execution.\r\n\t *\r\n\t * @param {String|RegExp} evt Name of the event to attach the listener to.\r\n\t * @param {Function} listener Method to be called when the event is emitted. If the function returns true then it will be removed after calling.\r\n\t * @return {Object} Current instance of EventEmitter for chaining.\r\n\t */\r\n\tproto.addOnceListener = function addOnceListener(evt, listener) {\r\n\t\treturn this.addListener(evt, {\r\n\t\t\tlistener: listener,\r\n\t\t\tonce: true\r\n\t\t});\r\n\t};\r\n\r\n\t/**\r\n\t * Alias of addOnceListener.\r\n\t */\r\n\tproto.once = alias('addOnceListener');\r\n\r\n\t/**\r\n\t * Defines an event name. This is required if you want to use a regex to add a listener to multiple events at once. If you don't do this then how do you expect it to know what event to add to? Should it just add to every possible match for a regex? No. That is scary and bad.\r\n\t * You need to tell it what event names should be matched by a regex.\r\n\t *\r\n\t * @param {String} evt Name of the event to create.\r\n\t * @return {Object} Current instance of EventEmitter for chaining.\r\n\t */\r\n\tproto.defineEvent = function defineEvent(evt) {\r\n\t\tthis.getListeners(evt);\r\n\t\treturn this;\r\n\t};\r\n\r\n\t/**\r\n\t * Uses defineEvent to define multiple events.\r\n\t *\r\n\t * @param {String[]} evts An array of event names to define.\r\n\t * @return {Object} Current instance of EventEmitter for chaining.\r\n\t */\r\n\tproto.defineEvents = function defineEvents(evts) {\r\n\t\tfor (var i = 0; i < evts.length; i += 1) {\r\n\t\t\tthis.defineEvent(evts[i]);\r\n\t\t}\r\n\t\treturn this;\r\n\t};\r\n\r\n\t/**\r\n\t * Removes a listener function from the specified event.\r\n\t * When passed a regular expression as the event name, it will remove the listener from all events that match it.\r\n\t *\r\n\t * @param {String|RegExp} evt Name of the event to remove the listener from.\r\n\t * @param {Function} listener Method to remove from the event.\r\n\t * @return {Object} Current instance of EventEmitter for chaining.\r\n\t */\r\n\tproto.removeListener = function removeListener(evt, listener) {\r\n\t\tvar listeners = this.getListenersAsObject(evt);\r\n\t\tvar index;\r\n\t\tvar key;\r\n\r\n\t\tfor (key in listeners) {\r\n\t\t\tif (listeners.hasOwnProperty(key)) {\r\n\t\t\t\tindex = indexOfListener(listeners[key], listener);\r\n\r\n\t\t\t\tif (index !== -1) {\r\n\t\t\t\t\tlisteners[key].splice(index, 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t/**\r\n\t * Alias of removeListener\r\n\t */\r\n\tproto.off = alias('removeListener');\r\n\r\n\t/**\r\n\t * Adds listeners in bulk using the manipulateListeners method.\r\n\t * If you pass an object as the second argument you can add to multiple events at once. The object should contain key value pairs of events and listeners or listener arrays. You can also pass it an event name and an array of listeners to be added.\r\n\t * You can also pass it a regular expression to add the array of listeners to all events that match it.\r\n\t * Yeah, this function does quite a bit. That's probably a bad thing.\r\n\t *\r\n\t * @param {String|Object|RegExp} evt An event name if you will pass an array of listeners next. An object if you wish to add to multiple events at once.\r\n\t * @param {Function[]} [listeners] An optional array of listener functions to add.\r\n\t * @return {Object} Current instance of EventEmitter for chaining.\r\n\t */\r\n\tproto.addListeners = function addListeners(evt, listeners) {\r\n\t\t// Pass through to manipulateListeners\r\n\t\treturn this.manipulateListeners(false, evt, listeners);\r\n\t};\r\n\r\n\t/**\r\n\t * Removes listeners in bulk using the manipulateListeners method.\r\n\t * If you pass an object as the second argument you can remove from multiple events at once. The object should contain key value pairs of events and listeners or listener arrays.\r\n\t * You can also pass it an event name and an array of listeners to be removed.\r\n\t * You can also pass it a regular expression to remove the listeners from all events that match it.\r\n\t *\r\n\t * @param {String|Object|RegExp} evt An event name if you will pass an array of listeners next. An object if you wish to remove from multiple events at once.\r\n\t * @param {Function[]} [listeners] An optional array of listener functions to remove.\r\n\t * @return {Object} Current instance of EventEmitter for chaining.\r\n\t */\r\n\tproto.removeListeners = function removeListeners(evt, listeners) {\r\n\t\t// Pass through to manipulateListeners\r\n\t\treturn this.manipulateListeners(true, evt, listeners);\r\n\t};\r\n\r\n\t/**\r\n\t * Edits listeners in bulk. The addListeners and removeListeners methods both use this to do their job. You should really use those instead, this is a little lower level.\r\n\t * The first argument will determine if the listeners are removed (true) or added (false).\r\n\t * If you pass an object as the second argument you can add/remove from multiple events at once. The object should contain key value pairs of events and listeners or listener arrays.\r\n\t * You can also pass it an event name and an array of listeners to be added/removed.\r\n\t * You can also pass it a regular expression to manipulate the listeners of all events that match it.\r\n\t *\r\n\t * @param {Boolean} remove True if you want to remove listeners, false if you want to add.\r\n\t * @param {String|Object|RegExp} evt An event name if you will pass an array of listeners next. An object if you wish to add/remove from multiple events at once.\r\n\t * @param {Function[]} [listeners] An optional array of listener functions to add/remove.\r\n\t * @return {Object} Current instance of EventEmitter for chaining.\r\n\t */\r\n\tproto.manipulateListeners = function manipulateListeners(remove, evt, listeners) {\r\n\t\tvar i;\r\n\t\tvar value;\r\n\t\tvar single = remove ? this.removeListener : this.addListener;\r\n\t\tvar multiple = remove ? this.removeListeners : this.addListeners;\r\n\r\n\t\t// If evt is an object then pass each of it's properties to this method\r\n\t\tif (typeof evt === 'object' && !(evt instanceof RegExp)) {\r\n\t\t\tfor (i in evt) {\r\n\t\t\t\tif (evt.hasOwnProperty(i) && (value = evt[i])) {\r\n\t\t\t\t\t// Pass the single listener straight through to the singular method\r\n\t\t\t\t\tif (typeof value === 'function') {\r\n\t\t\t\t\t\tsingle.call(this, i, value);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\t// Otherwise pass back to the multiple function\r\n\t\t\t\t\t\tmultiple.call(this, i, value);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\t// So evt must be a string\r\n\t\t\t// And listeners must be an array of listeners\r\n\t\t\t// Loop over it and pass each one to the multiple method\r\n\t\t\ti = listeners.length;\r\n\t\t\twhile (i--) {\r\n\t\t\t\tsingle.call(this, evt, listeners[i]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t/**\r\n\t * Removes all listeners from a specified event.\r\n\t * If you do not specify an event then all listeners will be removed.\r\n\t * That means every event will be emptied.\r\n\t * You can also pass a regex to remove all events that match it.\r\n\t *\r\n\t * @param {String|RegExp} [evt] Optional name of the event to remove all listeners for. Will remove from every event if not passed.\r\n\t * @return {Object} Current instance of EventEmitter for chaining.\r\n\t */\r\n\tproto.removeEvent = function removeEvent(evt) {\r\n\t\tvar type = typeof evt;\r\n\t\tvar events = this._getEvents();\r\n\t\tvar key;\r\n\r\n\t\t// Remove different things depending on the state of evt\r\n\t\tif (type === 'string') {\r\n\t\t\t// Remove all listeners for the specified event\r\n\t\t\tdelete events[evt];\r\n\t\t}\r\n\t\telse if (type === 'object') {\r\n\t\t\t// Remove all events matching the regex.\r\n\t\t\tfor (key in events) {\r\n\t\t\t\tif (events.hasOwnProperty(key) && evt.test(key)) {\r\n\t\t\t\t\tdelete events[key];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\t// Remove all listeners in all events\r\n\t\t\tdelete this._events;\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t/**\r\n\t * Emits an event of your choice.\r\n\t * When emitted, every listener attached to that event will be executed.\r\n\t * If you pass the optional argument array then those arguments will be passed to every listener upon execution.\r\n\t * Because it uses `apply`, your array of arguments will be passed as if you wrote them out separately.\r\n\t * So they will not arrive within the array on the other side, they will be separate.\r\n\t * You can also pass a regular expression to emit to all events that match it.\r\n\t *\r\n\t * @param {String|RegExp} evt Name of the event to emit and execute listeners for.\r\n\t * @param {Array} [args] Optional array of arguments to be passed to each listener.\r\n\t * @return {Object} Current instance of EventEmitter for chaining.\r\n\t */\r\n\tproto.emitEvent = function emitEvent(evt, args) {\r\n\t\tvar listeners = this.getListenersAsObject(evt);\r\n\t\tvar listener;\r\n\t\tvar i;\r\n\t\tvar key;\r\n\t\tvar response;\r\n\r\n\t\tfor (key in listeners) {\r\n\t\t\tif (listeners.hasOwnProperty(key)) {\r\n\t\t\t\ti = listeners[key].length;\r\n\r\n\t\t\t\twhile (i--) {\r\n\t\t\t\t\t// If the listener returns true then it shall be removed from the event\r\n\t\t\t\t\t// The function is executed either with a basic call or an apply if there is an args array\r\n\t\t\t\t\tlistener = listeners[key][i];\r\n\t\t\t\t\tresponse = listener.listener.apply(this, args || []);\r\n\t\t\t\t\tif (response === this._getOnceReturnValue() || listener.once === true) {\r\n\t\t\t\t\t\tthis.removeListener(evt, listener.listener);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t/**\r\n\t * Alias of emitEvent\r\n\t */\r\n\tproto.trigger = alias('emitEvent');\r\n\r\n\t/**\r\n\t * Subtly different from emitEvent in that it will pass its arguments on to the listeners, as opposed to taking a single array of arguments to pass on.\r\n\t * As with emitEvent, you can pass a regex in place of the event name to emit to all events that match it.\r\n\t *\r\n\t * @param {String|RegExp} evt Name of the event to emit and execute listeners for.\r\n\t * @param {...*} Optional additional arguments to be passed to each listener.\r\n\t * @return {Object} Current instance of EventEmitter for chaining.\r\n\t */\r\n\tproto.emit = function emit(evt) {\r\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\r\n\t\treturn this.emitEvent(evt, args);\r\n\t};\r\n\r\n\t/**\r\n\t * Sets the current value to check against when executing listeners. If a\r\n\t * listeners return value matches the one set here then it will be removed\r\n\t * after execution. This value defaults to true.\r\n\t *\r\n\t * @param {*} value The new value to check for when executing listeners.\r\n\t * @return {Object} Current instance of EventEmitter for chaining.\r\n\t */\r\n\tproto.setOnceReturnValue = function setOnceReturnValue(value) {\r\n\t\tthis._onceReturnValue = value;\r\n\t\treturn this;\r\n\t};\r\n\r\n\t/**\r\n\t * Fetches the current value to check against when executing listeners. If\r\n\t * the listeners return value matches this one then it should be removed\r\n\t * automatically. It will return true by default.\r\n\t *\r\n\t * @return {*|Boolean} The current value to check for or the default, true.\r\n\t * @api private\r\n\t */\r\n\tproto._getOnceReturnValue = function _getOnceReturnValue() {\r\n\t\tif (this.hasOwnProperty('_onceReturnValue')) {\r\n\t\t\treturn this._onceReturnValue;\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t};\r\n\r\n\t/**\r\n\t * Fetches the events object and creates one if required.\r\n\t *\r\n\t * @return {Object} The events storage object.\r\n\t * @api private\r\n\t */\r\n\tproto._getEvents = function _getEvents() {\r\n\t\treturn this._events || (this._events = {});\r\n\t};\r\n\r\n\t// Expose the class either via AMD, CommonJS or the global object\r\n\tif (typeof define === 'function' && define.amd) {\r\n\t\tdefine('eventEmitter/EventEmitter',[],function () {\r\n\t\t\treturn EventEmitter;\r\n\t\t});\r\n\t}\r\n\telse if (typeof module === 'object' && module.exports){\r\n\t\tmodule.exports = EventEmitter;\r\n\t}\r\n\telse {\r\n\t\tthis.EventEmitter = EventEmitter;\r\n\t}\r\n}.call(this));\r\n\r\n/*!\r\n * eventie v1.0.3\r\n * event binding helper\r\n *   eventie.bind( elem, 'click', myFn )\r\n *   eventie.unbind( elem, 'click', myFn )\r\n */\r\n\r\n/*jshint browser: true, undef: true, unused: true */\r\n/*global define: false */\r\n\r\n( function( window ) {\r\n\r\n\r\n\r\nvar docElem = document.documentElement;\r\n\r\nvar bind = function() {};\r\n\r\nif ( docElem.addEventListener ) {\r\n  bind = function( obj, type, fn ) {\r\n    obj.addEventListener( type, fn, false );\r\n  };\r\n} else if ( docElem.attachEvent ) {\r\n  bind = function( obj, type, fn ) {\r\n    obj[ type + fn ] = fn.handleEvent ?\r\n      function() {\r\n        var event = window.event;\r\n        // add event.target\r\n        event.target = event.target || event.srcElement;\r\n        fn.handleEvent.call( fn, event );\r\n      } :\r\n      function() {\r\n        var event = window.event;\r\n        // add event.target\r\n        event.target = event.target || event.srcElement;\r\n        fn.call( obj, event );\r\n      };\r\n    obj.attachEvent( \"on\" + type, obj[ type + fn ] );\r\n  };\r\n}\r\n\r\nvar unbind = function() {};\r\n\r\nif ( docElem.removeEventListener ) {\r\n  unbind = function( obj, type, fn ) {\r\n    obj.removeEventListener( type, fn, false );\r\n  };\r\n} else if ( docElem.detachEvent ) {\r\n  unbind = function( obj, type, fn ) {\r\n    obj.detachEvent( \"on\" + type, obj[ type + fn ] );\r\n    try {\r\n      delete obj[ type + fn ];\r\n    } catch ( err ) {\r\n      // can't delete window object properties\r\n      obj[ type + fn ] = undefined;\r\n    }\r\n  };\r\n}\r\n\r\nvar eventie = {\r\n  bind: bind,\r\n  unbind: unbind\r\n};\r\n\r\n// transport\r\nif ( typeof define === 'function' && define.amd ) {\r\n  // AMD\r\n  define( 'eventie/eventie',eventie );\r\n} else {\r\n  // browser global\r\n  window.eventie = eventie;\r\n}\r\n\r\n})( this );\r\n\r\n/*!\r\n * getStyleProperty by kangax\r\n * http://perfectionkills.com/feature-testing-css-properties/\r\n */\r\n\r\n/*jshint browser: true, strict: true, undef: true */\r\n/*globals define: false */\r\n\r\n( function( window ) {\r\n\r\n\r\n\r\nvar prefixes = 'Webkit Moz ms Ms O'.split(' ');\r\nvar docElemStyle = document.documentElement.style;\r\n\r\nfunction getStyleProperty( propName ) {\r\n  if ( !propName ) {\r\n    return;\r\n  }\r\n\r\n  // test standard property first\r\n  if ( typeof docElemStyle[ propName ] === 'string' ) {\r\n    return propName;\r\n  }\r\n\r\n  // capitalize\r\n  propName = propName.charAt(0).toUpperCase() + propName.slice(1);\r\n\r\n  // test vendor specific properties\r\n  var prefixed;\r\n  for ( var i=0, len = prefixes.length; i < len; i++ ) {\r\n    prefixed = prefixes[i] + propName;\r\n    if ( typeof docElemStyle[ prefixed ] === 'string' ) {\r\n      return prefixed;\r\n    }\r\n  }\r\n}\r\n\r\n// transport\r\nif ( typeof define === 'function' && define.amd ) {\r\n  // AMD\r\n  define( 'get-style-property/get-style-property',[],function() {\r\n    return getStyleProperty;\r\n  });\r\n} else {\r\n  // browser global\r\n  window.getStyleProperty = getStyleProperty;\r\n}\r\n\r\n})( window );\r\n\r\n/**\r\n * getSize v1.1.4\r\n * measure size of elements\r\n */\r\n\r\n/*jshint browser: true, strict: true, undef: true, unused: true */\r\n/*global define: false */\r\n\r\n( function( window, undefined ) {\r\n\r\n\r\n\r\n// -------------------------- helpers -------------------------- //\r\n\r\nvar defView = document.defaultView;\r\n\r\nvar getStyle = defView && defView.getComputedStyle ?\r\n  function( elem ) {\r\n    return defView.getComputedStyle( elem, null );\r\n  } :\r\n  function( elem ) {\r\n    return elem.currentStyle;\r\n  };\r\n\r\n// get a number from a string, not a percentage\r\nfunction getStyleSize( value ) {\r\n  var num = parseFloat( value );\r\n  // not a percent like '100%', and a number\r\n  var isValid = value.indexOf('%') === -1 && !isNaN( num );\r\n  return isValid && num;\r\n}\r\n\r\n// -------------------------- measurements -------------------------- //\r\n\r\nvar measurements = [\r\n  'paddingLeft',\r\n  'paddingRight',\r\n  'paddingTop',\r\n  'paddingBottom',\r\n  'marginLeft',\r\n  'marginRight',\r\n  'marginTop',\r\n  'marginBottom',\r\n  'borderLeftWidth',\r\n  'borderRightWidth',\r\n  'borderTopWidth',\r\n  'borderBottomWidth'\r\n];\r\n\r\nfunction getZeroSize() {\r\n  var size = {\r\n    width: 0,\r\n    height: 0,\r\n    innerWidth: 0,\r\n    innerHeight: 0,\r\n    outerWidth: 0,\r\n    outerHeight: 0\r\n  };\r\n  for ( var i=0, len = measurements.length; i < len; i++ ) {\r\n    var measurement = measurements[i];\r\n    size[ measurement ] = 0;\r\n  }\r\n  return size;\r\n}\r\n\r\n\r\n\r\nfunction defineGetSize( getStyleProperty ) {\r\n\r\n// -------------------------- box sizing -------------------------- //\r\n\r\nvar boxSizingProp = getStyleProperty('boxSizing');\r\nvar isBoxSizeOuter;\r\n\r\n/**\r\n * WebKit measures the outer-width on style.width on border-box elems\r\n * IE & Firefox measures the inner-width\r\n */\r\n( function() {\r\n  if ( !boxSizingProp ) {\r\n    return;\r\n  }\r\n\r\n  var div = document.createElement('div');\r\n  div.style.width = '200px';\r\n  div.style.padding = '1px 2px 3px 4px';\r\n  div.style.borderStyle = 'solid';\r\n  div.style.borderWidth = '1px 2px 3px 4px';\r\n  div.style[ boxSizingProp ] = 'border-box';\r\n\r\n  var body = document.body || document.documentElement;\r\n  body.appendChild( div );\r\n  var style = getStyle( div );\r\n\r\n  isBoxSizeOuter = getStyleSize( style.width ) === 200;\r\n  body.removeChild( div );\r\n})();\r\n\r\n\r\n// -------------------------- getSize -------------------------- //\r\n\r\nfunction getSize( elem ) {\r\n  // use querySeletor if elem is string\r\n  if ( typeof elem === 'string' ) {\r\n    elem = document.querySelector( elem );\r\n  }\r\n\r\n  // do not proceed on non-objects\r\n  if ( !elem || typeof elem !== 'object' || !elem.nodeType ) {\r\n    return;\r\n  }\r\n\r\n  var style = getStyle( elem );\r\n\r\n  // if hidden, everything is 0\r\n  if ( style.display === 'none' ) {\r\n    return getZeroSize();\r\n  }\r\n\r\n  var size = {};\r\n  size.width = elem.offsetWidth;\r\n  size.height = elem.offsetHeight;\r\n\r\n  var isBorderBox = size.isBorderBox = !!( boxSizingProp &&\r\n    style[ boxSizingProp ] && style[ boxSizingProp ] === 'border-box' );\r\n\r\n  // get all measurements\r\n  for ( var i=0, len = measurements.length; i < len; i++ ) {\r\n    var measurement = measurements[i];\r\n    var value = style[ measurement ];\r\n    var num = parseFloat( value );\r\n    // any 'auto', 'medium' value will be 0\r\n    size[ measurement ] = !isNaN( num ) ? num : 0;\r\n  }\r\n\r\n  var paddingWidth = size.paddingLeft + size.paddingRight;\r\n  var paddingHeight = size.paddingTop + size.paddingBottom;\r\n  var marginWidth = size.marginLeft + size.marginRight;\r\n  var marginHeight = size.marginTop + size.marginBottom;\r\n  var borderWidth = size.borderLeftWidth + size.borderRightWidth;\r\n  var borderHeight = size.borderTopWidth + size.borderBottomWidth;\r\n\r\n  var isBorderBoxSizeOuter = isBorderBox && isBoxSizeOuter;\r\n\r\n  // overwrite width and height if we can get it from style\r\n  var styleWidth = getStyleSize( style.width );\r\n  if ( styleWidth !== false ) {\r\n    size.width = styleWidth +\r\n      // add padding and border unless it's already including it\r\n      ( isBorderBoxSizeOuter ? 0 : paddingWidth + borderWidth );\r\n  }\r\n\r\n  var styleHeight = getStyleSize( style.height );\r\n  if ( styleHeight !== false ) {\r\n    size.height = styleHeight +\r\n      // add padding and border unless it's already including it\r\n      ( isBorderBoxSizeOuter ? 0 : paddingHeight + borderHeight );\r\n  }\r\n\r\n  size.innerWidth = size.width - ( paddingWidth + borderWidth );\r\n  size.innerHeight = size.height - ( paddingHeight + borderHeight );\r\n\r\n  size.outerWidth = size.width + marginWidth;\r\n  size.outerHeight = size.height + marginHeight;\r\n\r\n  return size;\r\n}\r\n\r\nreturn getSize;\r\n\r\n}\r\n\r\n// transport\r\nif ( typeof define === 'function' && define.amd ) {\r\n  // AMD\r\n  define( 'get-size/get-size',[ 'get-style-property/get-style-property' ], defineGetSize );\r\n} else {\r\n  // browser global\r\n  window.getSize = defineGetSize( window.getStyleProperty );\r\n}\r\n\r\n})( window );\r\n\r\n/*!\r\n * Draggabilly v1.1.2\r\n * Make that shiz draggable\r\n * http://draggabilly.desandro.com\r\n * MIT license\r\n */\r\n\r\n( function( window ) {\r\n\r\n\r\n\r\n// vars\r\nvar document = window.document;\r\n\r\n// -------------------------- helpers -------------------------- //\r\n\r\n// extend objects\r\nfunction extend( a, b ) {\r\n  for ( var prop in b ) {\r\n    a[ prop ] = b[ prop ];\r\n  }\r\n  return a;\r\n}\r\n\r\nfunction noop() {}\r\n\r\n// ----- get style ----- //\r\n\r\nvar defView = document.defaultView;\r\n\r\nvar getStyle = defView && defView.getComputedStyle ?\r\n  function( elem ) {\r\n    return defView.getComputedStyle( elem, null );\r\n  } :\r\n  function( elem ) {\r\n    return elem.currentStyle;\r\n  };\r\n\r\n\r\n// http://stackoverflow.com/a/384380/182183\r\nvar isElement = ( typeof HTMLElement === 'object' ) ?\r\n  function isElementDOM2( obj ) {\r\n    return obj instanceof HTMLElement;\r\n  } :\r\n  function isElementQuirky( obj ) {\r\n    return obj && typeof obj === 'object' &&\r\n      obj.nodeType === 1 && typeof obj.nodeName === 'string';\r\n  };\r\n\r\n// -------------------------- requestAnimationFrame -------------------------- //\r\n\r\n// https://gist.github.com/1866474\r\n\r\nvar lastTime = 0;\r\nvar prefixes = 'webkit moz ms o'.split(' ');\r\n// get unprefixed rAF and cAF, if present\r\nvar requestAnimationFrame = window.requestAnimationFrame;\r\nvar cancelAnimationFrame = window.cancelAnimationFrame;\r\n// loop through vendor prefixes and get prefixed rAF and cAF\r\nvar prefix;\r\nfor( var i = 0; i < prefixes.length; i++ ) {\r\n  if ( requestAnimationFrame && cancelAnimationFrame ) {\r\n    break;\r\n  }\r\n  prefix = prefixes[i];\r\n  requestAnimationFrame = requestAnimationFrame || window[ prefix + 'RequestAnimationFrame' ];\r\n  cancelAnimationFrame  = cancelAnimationFrame  || window[ prefix + 'CancelAnimationFrame' ] ||\r\n                            window[ prefix + 'CancelRequestAnimationFrame' ];\r\n}\r\n\r\n// fallback to setTimeout and clearTimeout if either request/cancel is not supported\r\nif ( !requestAnimationFrame || !cancelAnimationFrame )  {\r\n  requestAnimationFrame = function( callback ) {\r\n    var currTime = new Date().getTime();\r\n    var timeToCall = Math.max( 0, 16 - ( currTime - lastTime ) );\r\n    var id = window.setTimeout( function() {\r\n      callback( currTime + timeToCall );\r\n    }, timeToCall );\r\n    lastTime = currTime + timeToCall;\r\n    return id;\r\n  };\r\n\r\n  cancelAnimationFrame = function( id ) {\r\n    window.clearTimeout( id );\r\n  };\r\n}\r\n\r\n// -------------------------- definition -------------------------- //\r\n\r\nfunction draggabillyDefinition( classie, EventEmitter, eventie, getStyleProperty, getSize ) {\r\n\r\n// -------------------------- support -------------------------- //\r\n\r\nvar transformProperty = getStyleProperty('transform');\r\n// TODO fix quick & dirty check for 3D support\r\nvar is3d = !!getStyleProperty('perspective');\r\n\r\n// --------------------------  -------------------------- //\r\n\r\nfunction Draggabilly( element, options ) {\r\n  // querySelector if string\r\n  this.element = typeof element === 'string' ?\r\n    document.querySelector( element ) : element;\r\n\r\n  this.options = extend( {}, this.options );\r\n  extend( this.options, options );\r\n\r\n  this._create();\r\n}\r\n\r\n// inherit EventEmitter methods\r\nextend( Draggabilly.prototype, EventEmitter.prototype );\r\n\r\nDraggabilly.prototype.options = {\r\n};\r\n\r\nDraggabilly.prototype._create = function() {\r\n\r\n  // properties\r\n  this.position = {};\r\n  this._getPosition();\r\n\r\n  this.startPoint = { x: 0, y: 0 };\r\n  this.dragPoint = { x: 0, y: 0 };\r\n\r\n  this.startPosition = extend( {}, this.position );\r\n\r\n  // set relative positioning\r\n  var style = getStyle( this.element );\r\n  if ( style.position !== 'relative' && style.position !== 'absolute' ) {\r\n    this.element.style.position = 'relative';\r\n  }\r\n\r\n  this.enable();\r\n  this.setHandles();\r\n\r\n};\r\n\r\n/**\r\n * set this.handles and bind start events to 'em\r\n */\r\nDraggabilly.prototype.setHandles = function() {\r\n  this.handles = this.options.handle ?\r\n    this.element.querySelectorAll( this.options.handle ) : [ this.element ];\r\n\r\n  this.bindHandles( true );\r\n};\r\n\r\n// -------------------------- bind -------------------------- //\r\n\r\n/**\r\n * @param {Boolean} isBind - will unbind if falsey\r\n */\r\nDraggabilly.prototype.bindHandles = function( isBind ) {\r\n  var binder;\r\n  if ( window.navigator.pointerEnabled ) {\r\n    binder = this.bindPointer;\r\n  } else if ( window.navigator.msPointerEnabled ) {\r\n    binder = this.bindMSPointer;\r\n  } else {\r\n    binder = this.bindMouseTouch;\r\n  }\r\n  // munge isBind, default to true\r\n  isBind = isBind === undefined ? true : !!isBind;\r\n  for ( var i=0, len = this.handles.length; i < len; i++ ) {\r\n    var handle = this.handles[i];\r\n    binder.call( this, handle, isBind );\r\n  }\r\n};\r\n\r\nDraggabilly.prototype.bindPointer = function( handle, isBind ) {\r\n  // W3C Pointer Events, IE11. See https://coderwall.com/p/mfreca\r\n  var bindMethod = isBind ? 'bind' : 'unbind';\r\n  eventie[ bindMethod ]( handle, 'pointerdown', this );\r\n  // disable scrolling on the element\r\n  handle.style.touchAction = isBind ? 'none' : '';\r\n};\r\n\r\nDraggabilly.prototype.bindMSPointer = function( handle, isBind ) {\r\n  // IE10 Pointer Events\r\n  var bindMethod = isBind ? 'bind' : 'unbind';\r\n  eventie[ bindMethod ]( handle, 'MSPointerDown', this );\r\n  // disable scrolling on the element\r\n  handle.style.msTouchAction = isBind ? 'none' : '';\r\n};\r\n\r\nDraggabilly.prototype.bindMouseTouch = function( handle, isBind ) {\r\n  // listen for both, for devices like Chrome Pixel\r\n  //   which has touch and mouse events\r\n  var bindMethod = isBind ? 'bind' : 'unbind';\r\n  eventie[ bindMethod ]( handle, 'mousedown', this );\r\n  eventie[ bindMethod ]( handle, 'touchstart', this );\r\n  // TODO re-enable img.ondragstart when unbinding\r\n  if ( isBind ) {\r\n    disableImgOndragstart( handle );\r\n  }\r\n};\r\n\r\n// remove default dragging interaction on all images in IE8\r\n// IE8 does its own drag thing on images, which messes stuff up\r\n\r\nfunction noDragStart() {\r\n  return false;\r\n}\r\n\r\n// TODO replace this with a IE8 test\r\nvar isIE8 = 'attachEvent' in document.documentElement;\r\n\r\n// IE8 only\r\nvar disableImgOndragstart = !isIE8 ? noop : function( handle ) {\r\n\r\n  if ( handle.nodeName === 'IMG' ) {\r\n    handle.ondragstart = noDragStart;\r\n  }\r\n\r\n  var images = handle.querySelectorAll('img');\r\n  for ( var i=0, len = images.length; i < len; i++ ) {\r\n    var img = images[i];\r\n    img.ondragstart = noDragStart;\r\n  }\r\n};\r\n\r\n// -------------------------- position -------------------------- //\r\n\r\n// get left/top position from style\r\nDraggabilly.prototype._getPosition = function() {\r\n  // properties\r\n  var style = getStyle( this.element );\r\n\r\n  var x = parseInt( style.left, 10 );\r\n  var y = parseInt( style.top, 10 );\r\n\r\n  // clean up 'auto' or other non-integer values\r\n  this.position.x = isNaN( x ) ? 0 : x;\r\n  this.position.y = isNaN( y ) ? 0 : y;\r\n\r\n  this._addTransformPosition( style );\r\n};\r\n\r\n// add transform: translate( x, y ) to position\r\nDraggabilly.prototype._addTransformPosition = function( style ) {\r\n  if ( !transformProperty ) {\r\n    return;\r\n  }\r\n  var transform = style[ transformProperty ];\r\n  // bail out if value is 'none'\r\n  if ( transform.indexOf('matrix') !== 0 ) {\r\n    return;\r\n  }\r\n  // split matrix(1, 0, 0, 1, x, y)\r\n  var matrixValues = transform.split(',');\r\n  // translate X value is in 12th or 4th position\r\n  var xIndex = transform.indexOf('matrix3d') === 0 ? 12 : 4;\r\n  var translateX = parseInt( matrixValues[ xIndex ], 10 );\r\n  // translate Y value is in 13th or 5th position\r\n  var translateY = parseInt( matrixValues[ xIndex + 1 ], 10 );\r\n  this.position.x += translateX;\r\n  this.position.y += translateY;\r\n};\r\n\r\n// -------------------------- events -------------------------- //\r\n\r\n// trigger handler methods for events\r\nDraggabilly.prototype.handleEvent = function( event ) {\r\n  var method = 'on' + event.type;\r\n  if ( this[ method ] ) {\r\n    this[ method ]( event );\r\n  }\r\n};\r\n\r\n// returns the touch that we're keeping track of\r\nDraggabilly.prototype.getTouch = function( touches ) {\r\n  for ( var i=0, len = touches.length; i < len; i++ ) {\r\n    var touch = touches[i];\r\n    if ( touch.identifier === this.pointerIdentifier ) {\r\n      return touch;\r\n    }\r\n  }\r\n};\r\n\r\n// ----- start event ----- //\r\n\r\nDraggabilly.prototype.onmousedown = function( event ) {\r\n  // dismiss clicks from right or middle buttons\r\n  var button = event.button;\r\n  if ( button && ( button !== 0 && button !== 1 ) ) {\r\n    return;\r\n  }\r\n  this.dragStart( event, event );\r\n};\r\n\r\nDraggabilly.prototype.ontouchstart = function( event ) {\r\n  // disregard additional touches\r\n  if ( this.isDragging ) {\r\n    return;\r\n  }\r\n\r\n  this.dragStart( event, event.changedTouches[0] );\r\n};\r\n\r\nDraggabilly.prototype.onMSPointerDown =\r\nDraggabilly.prototype.onpointerdown = function( event ) {\r\n  // disregard additional touches\r\n  if ( this.isDragging ) {\r\n    return;\r\n  }\r\n\r\n  this.dragStart( event, event );\r\n};\r\n\r\nfunction setPointerPoint( point, pointer ) {\r\n  point.x = pointer.pageX !== undefined ? pointer.pageX : pointer.clientX;\r\n  point.y = pointer.pageY !== undefined ? pointer.pageY : pointer.clientY;\r\n}\r\n\r\n// hash of events to be bound after start event\r\nvar postStartEvents = {\r\n  mousedown: [ 'mousemove', 'mouseup' ],\r\n  touchstart: [ 'touchmove', 'touchend', 'touchcancel' ],\r\n  pointerdown: [ 'pointermove', 'pointerup', 'pointercancel' ],\r\n  MSPointerDown: [ 'MSPointerMove', 'MSPointerUp', 'MSPointerCancel' ]\r\n};\r\n\r\n/**\r\n * drag start\r\n * @param {Event} event\r\n * @param {Event or Touch} pointer\r\n */\r\nDraggabilly.prototype.dragStart = function( event, pointer ) {\r\n  if ( !this.isEnabled ) {\r\n    return;\r\n  }\r\n\r\n  if ( event.preventDefault ) {\r\n    event.preventDefault();\r\n  } else {\r\n    event.returnValue = false;\r\n  }\r\n\r\n  // save pointer identifier to match up touch events\r\n  this.pointerIdentifier = pointer.pointerId !== undefined ?\r\n    // pointerId for pointer events, touch.indentifier for touch events\r\n    pointer.pointerId : pointer.identifier;\r\n\r\n  this._getPosition();\r\n\r\n  this.measureContainment();\r\n\r\n  // point where drag began\r\n  setPointerPoint( this.startPoint, pointer );\r\n  // position _when_ drag began\r\n  this.startPosition.x = this.position.x;\r\n  this.startPosition.y = this.position.y;\r\n\r\n  // reset left/top style\r\n  this.setLeftTop();\r\n\r\n  this.dragPoint.x = 0;\r\n  this.dragPoint.y = 0;\r\n\r\n  // bind move and end events\r\n  this._bindEvents({\r\n    // get proper events to match start event\r\n    events: postStartEvents[ event.type ],\r\n    // IE8 needs to be bound to document\r\n    node: event.preventDefault ? window : document\r\n  });\r\n\r\n  classie.add( this.element, 'is-dragging' );\r\n\r\n  // reset isDragging flag\r\n  this.isDragging = true;\r\n\r\n  this.emitEvent( 'dragStart', [ this, event, pointer ] );\r\n\r\n  // start animation\r\n  this.animate();\r\n};\r\n\r\nDraggabilly.prototype._bindEvents = function( args ) {\r\n  for ( var i=0, len = args.events.length; i < len; i++ ) {\r\n    var event = args.events[i];\r\n    eventie.bind( args.node, event, this );\r\n  }\r\n  // save these arguments\r\n  this._boundEvents = args;\r\n};\r\n\r\nDraggabilly.prototype._unbindEvents = function() {\r\n  var args = this._boundEvents;\r\n  // IE8 can trigger dragEnd twice, check for _boundEvents\r\n  if ( !args || !args.events ) {\r\n    return;\r\n  }\r\n\r\n  for ( var i=0, len = args.events.length; i < len; i++ ) {\r\n    var event = args.events[i];\r\n    eventie.unbind( args.node, event, this );\r\n  }\r\n  delete this._boundEvents;\r\n};\r\n\r\nDraggabilly.prototype.measureContainment = function() {\r\n  var containment = this.options.containment;\r\n  if ( !containment ) {\r\n    return;\r\n  }\r\n\r\n  this.size = getSize( this.element );\r\n  var elemRect = this.element.getBoundingClientRect();\r\n\r\n  // use element if element\r\n  var container = isElement( containment ) ? containment :\r\n    // fallback to querySelector if string\r\n    typeof containment === 'string' ? document.querySelector( containment ) :\r\n    // otherwise just `true`, use the parent\r\n    this.element.parentNode;\r\n\r\n  this.containerSize = getSize( container );\r\n  var containerRect = container.getBoundingClientRect();\r\n\r\n  this.relativeStartPosition = {\r\n    x: elemRect.left - containerRect.left,\r\n    y: elemRect.top  - containerRect.top\r\n  };\r\n};\r\n\r\n// ----- move event ----- //\r\n\r\nDraggabilly.prototype.onmousemove = function( event ) {\r\n  this.dragMove( event, event );\r\n};\r\n\r\nDraggabilly.prototype.onMSPointerMove =\r\nDraggabilly.prototype.onpointermove = function( event ) {\r\n  if ( event.pointerId === this.pointerIdentifier ) {\r\n    this.dragMove( event, event );\r\n  }\r\n};\r\n\r\nDraggabilly.prototype.ontouchmove = function( event ) {\r\n  var touch = this.getTouch( event.changedTouches );\r\n  if ( touch ) {\r\n    this.dragMove( event, touch );\r\n  }\r\n};\r\n\r\n/**\r\n * drag move\r\n * @param {Event} event\r\n * @param {Event or Touch} pointer\r\n */\r\nDraggabilly.prototype.dragMove = function( event, pointer ) {\r\n\r\n  setPointerPoint( this.dragPoint, pointer );\r\n  var dragX = this.dragPoint.x - this.startPoint.x;\r\n  var dragY = this.dragPoint.y - this.startPoint.y;\r\n\r\n  var grid = this.options.grid;\r\n  var gridX = grid && grid[0];\r\n  var gridY = grid && grid[1];\r\n\r\n  dragX = applyGrid( dragX, gridX );\r\n  dragY = applyGrid( dragY, gridY );\r\n\r\n  dragX = this.containDrag( 'x', dragX, gridX );\r\n  dragY = this.containDrag( 'y', dragY, gridY );\r\n\r\n  // constrain to axis\r\n  dragX = this.options.axis === 'y' ? 0 : dragX;\r\n  dragY = this.options.axis === 'x' ? 0 : dragY;\r\n\r\n  this.position.x = this.startPosition.x + dragX;\r\n  this.position.y = this.startPosition.y + dragY;\r\n  // set dragPoint properties\r\n  this.dragPoint.x = dragX;\r\n  this.dragPoint.y = dragY;\r\n\r\n  this.emitEvent( 'dragMove', [ this, event, pointer ] );\r\n};\r\n\r\nfunction applyGrid( value, grid, method ) {\r\n  method = method || 'round';\r\n  return grid ? Math[ method ]( value / grid ) * grid : value;\r\n}\r\n\r\nDraggabilly.prototype.containDrag = function( axis, drag, grid ) {\r\n  if ( !this.options.containment ) {\r\n    return drag;\r\n  }\r\n  var measure = axis === 'x' ? 'width' : 'height';\r\n\r\n  var rel = this.relativeStartPosition[ axis ];\r\n  var min = applyGrid( -rel, grid, 'ceil' );\r\n  var max = this.containerSize[ measure ] - rel - this.size[ measure ];\r\n  max = applyGrid( max, grid, 'floor' );\r\n  return  Math.min( max, Math.max( min, drag ) );\r\n};\r\n\r\n// ----- end event ----- //\r\n\r\nDraggabilly.prototype.onmouseup = function( event ) {\r\n  this.dragEnd( event, event );\r\n};\r\n\r\nDraggabilly.prototype.onMSPointerUp =\r\nDraggabilly.prototype.onpointerup = function( event ) {\r\n  if ( event.pointerId === this.pointerIdentifier ) {\r\n    this.dragEnd( event, event );\r\n  }\r\n};\r\n\r\nDraggabilly.prototype.ontouchend = function( event ) {\r\n  var touch = this.getTouch( event.changedTouches );\r\n  if ( touch ) {\r\n    this.dragEnd( event, touch );\r\n  }\r\n};\r\n\r\n/**\r\n * drag end\r\n * @param {Event} event\r\n * @param {Event or Touch} pointer\r\n */\r\nDraggabilly.prototype.dragEnd = function( event, pointer ) {\r\n  this.isDragging = false;\r\n\r\n  delete this.pointerIdentifier;\r\n\r\n  // use top left position when complete\r\n  if ( transformProperty ) {\r\n    this.element.style[ transformProperty ] = '';\r\n    this.setLeftTop();\r\n  }\r\n\r\n  // remove events\r\n  this._unbindEvents();\r\n\r\n  classie.remove( this.element, 'is-dragging' );\r\n\r\n  this.emitEvent( 'dragEnd', [ this, event, pointer ] );\r\n\r\n};\r\n\r\n// ----- cancel event ----- //\r\n\r\n// coerce to end event\r\n\r\nDraggabilly.prototype.onMSPointerCancel =\r\nDraggabilly.prototype.onpointercancel = function( event ) {\r\n  if ( event.pointerId === this.pointerIdentifier ) {\r\n    this.dragEnd( event, event );\r\n  }\r\n};\r\n\r\nDraggabilly.prototype.ontouchcancel = function( event ) {\r\n  var touch = this.getTouch( event.changedTouches );\r\n  this.dragEnd( event, touch );\r\n};\r\n\r\n// -------------------------- animation -------------------------- //\r\n\r\nDraggabilly.prototype.animate = function() {\r\n  // only render and animate if dragging\r\n  if ( !this.isDragging ) {\r\n    return;\r\n  }\r\n\r\n  this.positionDrag();\r\n\r\n  var _this = this;\r\n  requestAnimationFrame( function animateFrame() {\r\n    _this.animate();\r\n  });\r\n\r\n};\r\n\r\n// transform translate function\r\nvar translate = is3d ?\r\n  function( x, y ) {\r\n    return 'translate3d( ' + x + 'px, ' + y + 'px, 0)';\r\n  } :\r\n  function( x, y ) {\r\n    return 'translate( ' + x + 'px, ' + y + 'px)';\r\n  };\r\n\r\n// left/top positioning\r\nDraggabilly.prototype.setLeftTop = function() {\r\n  this.element.style.left = this.position.x + 'px';\r\n  this.element.style.top  = this.position.y + 'px';\r\n};\r\n\r\nDraggabilly.prototype.positionDrag = transformProperty ?\r\n  function() {\r\n    // position with transform\r\n    this.element.style[ transformProperty ] = translate( this.dragPoint.x, this.dragPoint.y );\r\n  } : Draggabilly.prototype.setLeftTop;\r\n\r\n// -----  ----- //\r\n\r\nDraggabilly.prototype.enable = function() {\r\n  this.isEnabled = true;\r\n};\r\n\r\nDraggabilly.prototype.disable = function() {\r\n  this.isEnabled = false;\r\n  if ( this.isDragging ) {\r\n    this.dragEnd();\r\n  }\r\n};\r\n\r\nDraggabilly.prototype.destroy = function() {\r\n  this.disable();\r\n  // reset styles\r\n  if ( transformProperty ) {\r\n    this.element.style[ transformProperty ] = '';\r\n  }\r\n  this.element.style.left = '';\r\n  this.element.style.top = '';\r\n  this.element.style.position = '';\r\n  // unbind handles\r\n  this.bindHandles( false );\r\n};\r\n\r\n// -----  ----- //\r\n\r\nreturn Draggabilly;\r\n\r\n} // end definition\r\n\r\n// -------------------------- transport -------------------------- //\r\n\r\nif ( typeof define === 'function' && define.amd ) {\r\n  // AMD\r\n  define( 'components/adapt-ppq/js/draggabilly',[\r\n      'classie/classie',\r\n      'eventEmitter/EventEmitter',\r\n      'eventie/eventie',\r\n      'get-style-property/get-style-property',\r\n      'get-size/get-size'\r\n    ],\r\n    draggabillyDefinition );\r\n} else if ( typeof exports === 'object' ) {\r\n  // CommonJS\r\n  module.exports = draggabillyDefinition(\r\n    require('desandro-classie'),\r\n    require('wolfy87-eventemitter'),\r\n    require('eventie'),\r\n    require('desandro-get-style-property'),\r\n    require('get-size')\r\n  );\r\n} else {\r\n  // browser global\r\n  window.Draggabilly = draggabillyDefinition(\r\n    window.classie,\r\n    window.EventEmitter,\r\n    window.eventie,\r\n    window.getStyleProperty,\r\n    window.getSize\r\n  );\r\n}\r\n\r\n})( window );\r\n\r\n\n","define('components/adapt-ppq/js/adapt-ppq',['require','coreViews/questionView','coreJS/adapt','components/adapt-ppq/js/draggabilly'],function(require) {\r\n\r\n\tvar QuestionView = require('coreViews/questionView');\r\n\tvar Adapt = require('coreJS/adapt');\r\n    var Draggabilly = require('components/adapt-ppq/js/draggabilly');\r\n\r\n    var PPQ = QuestionView.extend({\r\n\r\n        componentDimensions: {\r\n            height: 0,\r\n            width: 0\r\n        },\r\n\r\n        events: {\r\n            \"click .ppq-pinboard\":\"placePin\",\r\n            \"click .ppq-icon\": \"preventDefault\"\r\n        },\r\n\r\n        preventDefault: function(event) {\r\n            event.preventDefault();\r\n        },\r\n\r\n        preRender:function(){\r\n            QuestionView.prototype.preRender.apply(this);\r\n            if (this.model.get(\"_selectable\")) {\r\n                var selectors = [];\r\n                for (var i = 0, l = parseInt(this.model.get(\"_selectable\")); i < l; i++) {\r\n                    selectors.push(i)\r\n                }\r\n                this.model.set(\"_selectors\", selectors);\r\n            }\r\n            this.setLayout();\r\n            this.listenTo(Adapt, 'device:changed', this.handleDeviceChanged);\r\n            this.listenTo(Adapt, 'device:resize', this.handleDeviceResize);\r\n        },\r\n\r\n        postRender: function() {\r\n            QuestionView.prototype.postRender.apply(this);\r\n\r\n            var thisHandle = this;\r\n            //Wait for pinboard image to load then set ready. If already complete show completed state.\r\n            this.$('.ppq-pinboard-container-inner').imageready(_.bind(function() {\r\n\r\n                var $pins = this.$el.find('.ppq-pin');\r\n                $pins.each(function(index, item) {\r\n                    item.dragObj = new Draggabilly(item, {\r\n                        containment: true\r\n                    });\r\n                    if (thisHandle.model.get(\"_isSubmitted\")) {\r\n                        item.dragObj.disable();\r\n                    } else {\r\n                        item.dragObj.on('dragStart', _.bind(thisHandle.onDragStart, thisHandle));\r\n                        item.dragObj.on('dragEnd',  _.bind(thisHandle.onDragEnd, thisHandle));\r\n                    }\r\n                });\r\n\r\n                _.extend(this.componentDimensions, {\r\n                    height: this.$(\"#ppq-boundary\").height(),\r\n                    width: this.$(\"#ppq-boundary\").width()\r\n                });\r\n\r\n                this.setReadyStatus();\r\n                if (this.model.get(\"_isComplete\") && this.model.get(\"_isInteractionsComplete\")) {\r\n                    this.showCompletedState();\r\n                }\r\n            }, this));\r\n        },\r\n\r\n        updateButtons: function() {\r\n            QuestionView.prototype.updateButtons.apply(this);\r\n\r\n            if (this.model.get(\"_isSubmitted\")) {\r\n                 var $pins = this.$el.find('.ppq-pin');\r\n                $pins.each(function(index, item) {\r\n                    item.dragObj.disable();\r\n                });\r\n                this.model.set(\"_countCorrect\",this.$(\".item-correct\").length);\r\n            }\r\n\r\n            //this.model.get('_buttonState') == 'submit' ? this.$('.ppq-reset-pins').show() : this.$('.ppq-reset-pins').hide();\r\n        },\r\n\r\n        showCompletedState: function() {\r\n\r\n            //show the user answer then apply classes to set the view to a completed state\r\n            this.hideCorrectAnswer();\r\n            this.$(\".ppq-pin\").addClass(\"in-use\");\r\n            this.$(\".ppq-widget\").addClass(\"submitted disabled show-user-answer\");\r\n            if (this.model.get(\"_isCorrect\")) {\r\n                this.$(\".ppq-widget\").addClass(\"correct\");\r\n            }\r\n        },\r\n\r\n        handleDeviceChanged: function() {\r\n\r\n            var componentDimensions = {\r\n                height: this.$(\"#ppq-boundary\").height(),\r\n                width: this.$(\"#ppq-boundary\").width()\r\n            };\r\n            if (this.componentDimensions.height == componentDimensions.height && this.componentDimensions.width == componentDimensions.width) {\r\n                this.componentDimensions = componentDimensions;\r\n                return;\r\n            }\r\n\r\n            this.$el.css(\"display:block\");\r\n            \r\n            //Currently causes layout to change from desktop to mobile even if completed.\r\n            this.setLayout();\r\n\r\n            var props, isDesktop = this.model.get('desktopLayout');\r\n\r\n            _.each(this.model.get('_items'), function(item, index) {\r\n                props = isDesktop ? item.desktop : item.mobile;\r\n                this.$('.ppq-correct-zone').eq(index).css({left:props.left+'%', top:props.top+'%', width:props.width+'%', height:props.height+'%'});\r\n            }, this);\r\n\r\n            props = isDesktop ? this.model.get('_pinboardDesktop') : this.model.get('_pinboardMobile');\r\n\r\n            this.$('.ppq-pinboard').attr({src:props.src, title:props.title, alt:props.alt});\r\n\r\n            this.handleDeviceResize();\r\n\r\n            if (this.model.get(\"_isComplete\")) {\r\n                var width = parseInt(this.$('.ppq-pinboard').width(),10),\r\n                height = parseInt(this.$('.ppq-pinboard').height(),10);\r\n\r\n                var $pins = this.$(\".ppq-pin\");\r\n                var countCorrect = this.model.get(\"_countCorrect\");\r\n                var currentLayoutItems = this.getItemsForCurrentLayout(this.model.get(\"_items\"));\r\n\r\n                var moved = 0;\r\n                var uas = this.model.get(\"_userAnswer\");\r\n                _.each(currentLayoutItems, _.bind(function(item) {\r\n                    var $pin = $($pins[moved]);\r\n                    var top = 0;\r\n                    var left = 0;\r\n                    var uaObj;\r\n                    if (moved < countCorrect) {\r\n                        top = ((height/ 100) * (item.top + (item.height/2))) - ($pin.height() / 1.05);\r\n                        left = ((width / 100) * (item.left + (item.width / 2))) - ($pin.width() / 1.05);\r\n                        $pin.css({\r\n                            top: top + 'px',\r\n                            left: left + 'px'\r\n                        });\r\n\r\n                    } else {\r\n                        \r\n                        var inpos = true;\r\n                        while(inpos == true) {\r\n                            inpos = false;\r\n                            top = (Math.random() * 80) + 10;\r\n                            left = (Math.random() * 80) + 10;\r\n                            top = ((height/ 100) * top) - ($pin.height() / 1.05);\r\n                            left = ((width/ 100) * left) - ($pin.width() / 1.05);\r\n\r\n                            var atop = top - ($pin.height());\r\n                            var aleft = left - ($pin.width() /2);\r\n\r\n                            $pin.css({\r\n                                top: top + 'px',\r\n                                left: left + 'px'\r\n                            });\r\n\r\n                            inpos = this.isInCorrectZone($pin, undefined, currentLayoutItems);\r\n                        }\r\n\r\n                    }\r\n\r\n                    uaObj = {\r\n                            top: (100/height) * top,\r\n                            left: (100/width) * left\r\n                        };\r\n                    uas[moved] = uaObj;\r\n\r\n                    moved++;\r\n                }, this))\r\n                this.model.set(\"_userAnswer\", uas);\r\n            }\r\n\r\n            this.handleDeviceResize();\r\n        },\r\n\r\n        handleDeviceResize: function() {\r\n\r\n            var componentDimensions = {\r\n                height: this.$(\"#ppq-boundary\").height(),\r\n                width: this.$(\"#ppq-boundary\").width()\r\n            };\r\n            if (this.componentDimensions.height == componentDimensions.height && this.componentDimensions.width == componentDimensions.width) {\r\n                this.componentDimensions = componentDimensions;\r\n                return;\r\n            }\r\n\r\n\r\n            this.$el.css(\"display:block\");\r\n            // Calls resetPins then if complete adds back classes that are required to show the completed state.\r\n            this.resetPins();\r\n            if (this.model.get(\"_isComplete\")) {\r\n                this.$(\".ppq-pin\").addClass(\"in-use\");\r\n                if (this.$(\".ppq-widget\").hasClass(\"show-user-answer\")) {\r\n                    this.hideCorrectAnswer();\r\n                } else {\r\n                    this.showCorrectAnswer();\r\n                }\r\n            }\r\n        },\r\n\r\n        setLayout: function() {\r\n\r\n            //Setlayout for view. This is also called when device changes.\r\n            console.log(Adapt.device.screenSize);\r\n            if (Adapt.device.screenSize == \"large\") {\r\n                this.model.set({\r\n                    desktopLayout:true\r\n                });\r\n            } else if (Adapt.device.screenSize == \"medium\" || Adapt.device.screenSize == \"small\") {\r\n                this.model.set({\r\n                    desktopLayout:false\r\n                });\r\n            }\r\n            \r\n        },\r\n\r\n        placePin: function(event) {\r\n\r\n            event.preventDefault();\r\n\r\n            //Handles click event on the pinboard image to place pins\r\n            var $pin = this.$('.ppq-pin:not(.in-use):first');\r\n            if ($pin.length === 0) return;\r\n\r\n            var offset = this.$('.ppq-pinboard').offset();\r\n\r\n            var clickY = ( event.clientY < offset.top ? event.pageY : event.clientY );\r\n            var clickX = ( event.clientX < offset.left ? event.pageX : event.clientX );\r\n\r\n            var relX = (clickX - offset.left) - ($pin.width() / 2);\r\n            var relY = ((clickY - offset.top)) - $pin.height();\r\n\r\n            $pin.css({\r\n                top:relY + 'px',\r\n                left:relX + 'px'\r\n            }).addClass('in-use');\r\n            $pin.addClass('in-use');\r\n\r\n            var isDuplicate = this.isDuplicatePin($pin);\r\n            if (isDuplicate) {\r\n                $pin.removeClass('in-use');\r\n                $pin.css({\r\n                    top: \"initial\",\r\n                    left: \"initial\"\r\n                });\r\n            }\r\n        },\r\n\r\n        resetQuestion: function() {\r\n            this.resetPins();\r\n            this.model.set({\r\n                _isAtLeastOneCorrectSelection: false\r\n            });\r\n\r\n            var $pins = this.$el.find('.ppq-pin');\r\n            $pins.each(function(index, item) {\r\n                if (item.dragObj) item.dragObj.enable();\r\n            });\r\n        },\r\n\r\n        resetPins: function(event) {\r\n\r\n            //the class \"in-use\" is what makes the pins visible\r\n            if (event) event.preventDefault();\r\n            this.$(\".ppq-pin\").removeClass(\"in-use item-correct item-incorrect\");\r\n        },\r\n\r\n        canSubmit: function() {\r\n            if (this.model.get(\"_selectable\")) {\r\n                if(this.$(\".ppq-pin.in-use\").length == this.model.get(\"_selectors\").length) {\r\n                    return true;\r\n                } else {\r\n                    return false;\r\n                }\r\n            } else {\r\n                if(this.$(\".ppq-pin.in-use\").length == this.model.get(\"_items\").length) {\r\n                    return true;\r\n                } else {\r\n                    return false;\r\n                }\r\n            }\r\n        },\r\n\r\n        storeUserAnswer:function()\r\n        {\r\n            var pins = this.$(\".ppq-pin\");\r\n\r\n            // User answers aren't stored in the items array. Instead we create a new array with userAnswer objects.\r\n            var userAnswers = [];\r\n\r\n            _.each(pins, function(pin) {\r\n               // userAnswer stores the return value from getUserAnswer and adds that to the userAnswers array.\r\n               var userAnswer = this.getUserAnswer($(pin));\r\n               userAnswers.push(userAnswer);\r\n            }, this);\r\n\r\n            this.model.set('_userAnswer', userAnswers);\r\n        },\r\n\r\n        isCorrect: function() {\r\n            var correctCount = 0;\r\n            var pins = this.$(\".ppq-pin\");\r\n\r\n            // There are both desktop and mobile items but nested in the same items object.\r\n            // So we need to store the currentLayoutItems locally to check answers against the current layout.\r\n            var currentLayoutItems = this.getItemsForCurrentLayout(this.model.get(\"_items\"));\r\n\r\n            // Loop through the currentLayoutItems and check each answer\r\n            _.each(currentLayoutItems, function(item, index) {\r\n                _.each(pins, function(pin, pIndex) {\r\n                    var $pin = $(pin);\r\n                    var isCorrect = this.isInCorrectZone($pin, item);\r\n                    if (isCorrect) {\r\n                        item._isPlacementCorrect = true;\r\n                        correctCount++;\r\n                        this.model.set('_isAtLeastOneCorrectSelection', true);\r\n                   } else {\r\n                        item._isPlacementCorrect = false;\r\n                   }\r\n                }, this);\r\n            }, this);\r\n\r\n            if (this.model.get(\"_selectable\")) {\r\n                return correctCount == this.model.get(\"_selectors\").length;\r\n            } else {\r\n                return correctCount == currentLayoutItems.length;\r\n            }\r\n        },\r\n\r\n        isPartlyCorrect: function() {\r\n            return this.model.get('_isAtLeastOneCorrectSelection');\r\n        },\r\n\r\n        getItemsForCurrentLayout: function(items) {\r\n\r\n            // Returns an array of items based on current layout\r\n            var currentLayoutItems = [];\r\n            _.each(items, function(item) {\r\n                var newItem;\r\n                if (this.model.get(\"desktopLayout\")) {\r\n                    newItem = item.desktop;\r\n                } else {\r\n                    newItem = item.mobile;\r\n                }\r\n                newItem._isCorrect = item._isCorrect;\r\n                currentLayoutItems.push(newItem);\r\n            }, this);\r\n            return currentLayoutItems;\r\n        },\r\n\r\n        isInCorrectZone: function($pin, item, items){\r\n\r\n            var width = parseInt(this.$('.ppq-pinboard').width(),10),\r\n                height = parseInt(this.$('.ppq-pinboard').height(),10),\r\n                pinLeft = parseFloat($pin.css(\"left\")) + (parseFloat($pin.css(\"width\")) / 2),\r\n                pinTop = parseFloat($pin.css(\"top\")) + parseFloat($pin.css(\"height\")),\r\n                inCorrectZone = false;\r\n            var pinId = $pin.attr(\"data-id\");\r\n\r\n            if(item) {\r\n                var top = (item.top/100)*height,\r\n                    left = (item.left/100)*width,\r\n                    bottom = top + (item.height/100)*height,\r\n                    right = left + (item.width/100)*width;\r\n                inCorrectZone = pinLeft > left && pinLeft < right && pinTop < bottom && pinTop > top;\r\n                inCorrectZone = inCorrectZone  && item._isCorrect !== false;\r\n                return inCorrectZone;\r\n            } else {\r\n                for (var i = 0; i < items.length; i++) {\r\n                    var item = items[i],\r\n                        top = (item.top/100)*height,\r\n                        left = (item.left/100)*width,\r\n                        bottom = top + (item.height/100)*height,\r\n                        right = left + (item.width/100)*width;\r\n                    inCorrectZone = pinLeft > left && pinLeft < right && pinTop < bottom && pinTop > top;\r\n                    inCorrectZone = inCorrectZone  && item._isCorrect !== false;\r\n                    if(inCorrectZone) break;\r\n                }\r\n                return inCorrectZone;\r\n            }\r\n        },\r\n\r\n        getPinZone: function($pin, items){\r\n\r\n            var width = parseInt(this.$('.ppq-pinboard').width(),10),\r\n                height = parseInt(this.$('.ppq-pinboard').height(),10),\r\n                pinLeft = parseFloat($pin.css(\"left\")) + (parseFloat($pin.css(\"width\")) / 2),\r\n                pinTop = parseFloat($pin.css(\"top\")) + parseFloat($pin.css(\"height\")),\r\n                inCorrectZone = false;\r\n            var pinId = $pin.attr(\"data-id\");\r\n\r\n            for (var i = 0; i < items.length; i++) {\r\n                var item = items[i],\r\n                    top = (item.top/100)*height,\r\n                    left = (item.left/100)*width,\r\n                    bottom = top + (item.height/100)*height,\r\n                    right = left + (item.width/100)*width;\r\n                inCorrectZone = pinLeft > left && pinLeft < right && pinTop < bottom && pinTop > top;\r\n                if(inCorrectZone) return i;\r\n            }\r\n            return -1;\r\n        },\r\n\r\n        getUserAnswer: function($pin) {\r\n\r\n            // Returns a user answer object that gets added to a userAnswers array\r\n            var left = parseFloat($pin.css(\"left\")),\r\n                top = parseFloat($pin.css(\"top\")),\r\n                width = parseInt(this.$('.ppq-pinboard').width(),10),\r\n                height = parseInt(this.$('.ppq-pinboard').height(),10);\r\n            return {\r\n                left: (100/width) * left,\r\n                top: (100/height) * top\r\n            }\r\n        },\r\n\r\n        showMarking:function()\r\n        {\r\n            this.hideCorrectAnswer();\r\n        },\r\n\r\n        hideCorrectAnswer: function() {\r\n            var width = parseInt(this.$('.ppq-pinboard').width(),10),\r\n                height = parseInt(this.$('.ppq-pinboard').height(),10);\r\n            var pins = this.$(\".ppq-pin\");\r\n            var userAnswers = this.model.get(\"_userAnswer\");\r\n            var currentLayoutItems = this.getItemsForCurrentLayout(this.model.get(\"_items\"));\r\n\r\n            _.each(userAnswers, function(userAnswer, index) {\r\n                var $pin = $(pins[index])\r\n                $pin.css({\r\n                    top:(height/100) * userAnswer.top + \"px\",\r\n                    left:(width/100) *userAnswer.left + \"px\"\r\n                });\r\n\r\n                // Reset classes then apply correct incorrect\r\n                $pin.removeClass(\"item-correct item-incorrect\");\r\n                if (this.isInCorrectZone($pin, null, currentLayoutItems)) {\r\n                    $pin.addClass(\"item-correct\");\r\n                } else {\r\n                    $pin.addClass(\"item-incorrect\");\r\n                }\r\n            }, this);\r\n        },\r\n\r\n        showCorrectAnswer: function() {\r\n            var width = parseInt(this.$('.ppq-pinboard').width(),10),\r\n                height = parseInt(this.$('.ppq-pinboard').height(),10);\r\n            var pins = this.$(\".ppq-pin\"),\r\n                answers = this.getItemsForCurrentLayout(this.model.get(\"_items\"));\r\n            _.each(answers, function(item, index) {\r\n                var $pin = $(pins[index]);\r\n                $pin.css({\r\n                    top: ((height/ 100) * (item.top + (item.height/2))) - ($pin.height() / 2 ) + 'px',\r\n                    left: ((width / 100) * (item.left + (item.width / 2))) - ($pin.width() / 2) + 'px'\r\n                });\r\n                $pin.removeClass(\"item-incorrect\").addClass(\"item-correct\");\r\n            });\r\n        },\r\n\r\n        onDragStart: function(event) {\r\n            console.log(\"Drag Start\");\r\n            var $pin = $(event.element);\r\n            var pos = {\r\n                top: $pin.css(\"top\"),\r\n                left: $pin.css(\"left\")\r\n            };\r\n            $pin.attr(\"data-prev\", JSON.stringify(pos));\r\n        },\r\n\r\n        onDragEnd: function(event) {\r\n            console.log(\"Drag End\");\r\n\r\n            var $pin = $(event.element);\r\n\r\n            var isDuplicate = this.isDuplicatePin($pin);\r\n            if (isDuplicate) {\r\n                console.log(\"Duplicate!\")\r\n                var pos = JSON.parse($pin.attr(\"data-prev\"));\r\n                $pin.css(pos);\r\n            }\r\n        },\r\n\r\n        isDuplicatePin: function($pin) {\r\n            var pins = this.$(\".ppq-pin\");\r\n            var currentLayoutItems = this.getItemsForCurrentLayout(this.model.get(\"_items\"));\r\n\r\n            var pinZone = this.getPinZone($pin, currentLayoutItems);\r\n            var pinDataId = $pin.attr(\"data-id\");\r\n\r\n            var populatedZones = {};\r\n            for (var i = 0, l = pins.length; i < l; i++) {\r\n                var $curPin = $(pins[i]);\r\n                var curPinDataId = $curPin.attr(\"data-id\");\r\n                //if (curPinDataId === pinDataId ) continue;\r\n                var zone = this.getPinZone($curPin, currentLayoutItems);\r\n                if (populatedZones[zone] === undefined) populatedZones[zone] = [];\r\n                populatedZones[zone].push(curPinDataId);\r\n            }\r\n\r\n            if (populatedZones[pinZone].length > 1 && pinZone > -1) return true;\r\n            return false;\r\n            \r\n        }\r\n\r\n    });\r\n\r\n    Adapt.register(\"ppq\", PPQ);\r\n\r\n    return PPQ;\r\n\r\n});\r\n\n","define('components/adapt-questionStrip/js/adapt-questionStrip',[ \"coreJS/adapt\", \"coreViews/questionView\" ], function(Adapt, QuestionView) {\r\n\r\n    var QuestionStrip = QuestionView.extend({\r\n\r\n        events: function() {\r\n            return _.extend({}, QuestionView.prototype.events, {\r\n                'click .qs-controls':'onNavigationClicked'\r\n            });\r\n        },\r\n\r\n        setDeviceSize: function() {\r\n            if (Adapt.device.screenSize === 'large') {\r\n                this.$el.addClass('desktop').removeClass('mobile');\r\n                this.model.set('_isDesktop', true);\r\n            } else {\r\n                this.$el.addClass('mobile').removeClass('desktop');\r\n                this.model.set('_isDesktop', false)\r\n            }\r\n        },\r\n\r\n        // Used by question to disable the question during submit and complete stages\r\n        disableQuestion: function() {\r\n            this.$('.qs-controls').addClass('disabled');\r\n        },\r\n\r\n        // Used by question to enable the question during interactions\r\n        enableQuestion: function() {\r\n            this.$('.qs-controls').removeClass('disabled');\r\n        },\r\n\r\n        // Used by the question to reset the question when revisiting the component\r\n        resetQuestionOnRevisit: function() {\r\n            this.resetQuestion();\r\n        },\r\n\r\n        setupQuestion: function() {\r\n            this.listenTo(Adapt, 'device:resize', this.resizeControl, this);\r\n            this.setDeviceSize();\r\n            this.restoreUserAnswers();\r\n        },\r\n\r\n        restoreUserAnswers: function() {\r\n            if (!this.model.get(\"_isSubmitted\")) return;\r\n\r\n            var userAnswer = this.model.get(\"_userAnswer\");\r\n\r\n            _.each(this.model.get(\"_items\"), function(item, index) {\r\n                item._stage = userAnswer[index];\r\n            });\r\n\r\n            this.setQuestionAsSubmitted();\r\n            this.markQuestion();\r\n            this.setScore();\r\n            this.showMarking();\r\n            this.setupFeedback();\r\n        },\r\n\r\n        storeUserAnswer: function() {\r\n\r\n            var userAnswer = new Array(this.model.get('_items').length);\r\n\r\n            _.each(this.model.get('_items'), function(item, index) {\r\n                userAnswer[index] = item._stage;\r\n            }, this);\r\n            \r\n            this.model.set('_userAnswer', userAnswer);\r\n\r\n        },\r\n\r\n        onQuestionRendered: function() {\r\n            this.setupImages();\r\n            this.setupNarrative();\r\n        },\r\n\r\n        canSubmit: function() {\r\n            return true;\r\n        },\r\n\r\n        isCorrect: function() {\r\n\r\n            var numberOfCorrectAnswers = 0;\r\n\r\n            _.each(this.model.get('_items'), function(item, index) {\r\n\r\n                if (item.hasOwnProperty('_stage') && item._subItems[item._stage]._isCorrect) {\r\n                    numberOfCorrectAnswers ++;\r\n                    item._isCorrect = true;\r\n                    this.model.set('_numberOfCorrectAnswers', numberOfCorrectAnswers);\r\n                    this.model.set('_isAtLeastOneCorrectSelection', true);\r\n                } else {\r\n                    item._isCorrect = false;\r\n                }\r\n\r\n            }, this);\r\n\r\n            this.model.set('_numberOfCorrectAnswers', numberOfCorrectAnswers);\r\n\r\n            if (numberOfCorrectAnswers === this.model.get('_items').length) {\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n\r\n        },\r\n\r\n        setScore: function() {\r\n            var questionWeight = this.model.get(\"_questionWeight\");\r\n\r\n            if (this.model.get('_isCorrect')) {\r\n                this.model.set('_score', questionWeight);\r\n                return;\r\n            }\r\n            \r\n            var numberOfCorrectAnswers = this.model.get('_numberOfCorrectAnswers');\r\n            var itemLength = this.model.get('_items').length;\r\n\r\n            var score = questionWeight * numberOfCorrectAnswers / itemLength;\r\n\r\n            this.model.set('_score', score);\r\n        },\r\n\r\n        showMarking: function() {\r\n\r\n            _.each(this.model.get('_items'), function(item, i) {\r\n\r\n                var $item = this.$('.component-item').eq(i);\r\n                $item.removeClass('correct incorrect').addClass(item._isCorrect ? 'correct' : 'incorrect');\r\n\r\n            }, this);\r\n\r\n        },\r\n\r\n        isPartlyCorrect: function() {\r\n            return this.model.get('_isAtLeastOneCorrectSelection');\r\n        },\r\n\r\n        resetUserAnswer: function() {\r\n            this.model.set({_userAnswer: []});\r\n        },\r\n\r\n        resetQuestion: function() {\r\n            this.$(\".component-item\").removeClass(\"correct\").removeClass(\"incorrect\");\r\n            this.model.set('_isAtLeastOneCorrectSelection', false);\r\n            _.each(this.model.get(\"_items\"), function(item, index) {\r\n                this.setStage(index, item.hasOwnProperty('_initialItemIndex') ? item._initialItemIndex : 0);\r\n            }, this);\r\n        },\r\n\r\n        showCorrectAnswer: function() {\r\n\r\n            _.each(this.model.get('_items'), function(item, index) {\r\n\r\n                _.each(item._subItems, function(option, optionIndex) {\r\n                    if (option._isCorrect) {\r\n                        this.setStage(index, optionIndex);\r\n                    }\r\n                }, this);\r\n\r\n            }, this);\r\n\r\n        },\r\n\r\n        hideCorrectAnswer: function() {\r\n            \r\n            _.each(this.model.get('_items'), function(item, index) {\r\n                this.setStage(index, this.model.get('_userAnswer')[index]);\r\n            }, this);\r\n        },\r\n\r\n        setupImages: function() {\r\n            var _items = this.model.get(\"_items\");\r\n            var _images = this.model.get(\"_images\");\r\n\r\n            var splitHeight = _items.length;\r\n            var images = _images.length;\r\n            var imagesSplit = 0;\r\n\r\n            var thisHandle = this;\r\n\r\n            var height = undefined;\r\n            var width = undefined;\r\n            \r\n            var imagesToLoadCount = 0;\r\n            var imagesLoadedCount = 0;\r\n\r\n            _.each(_images, function(image) {\r\n                var imageObj = new Image();\r\n                $(imageObj).bind(\"load\", function(event) {\r\n                    imagesSplit++;\r\n\r\n                    var imgHeight = imageObj.naturalHeight;\r\n                    var imgWidth = imageObj.naturalWidth;\r\n\r\n                    height = height || imageObj.naturalHeight;\r\n                    width = width || imageObj.naturalWidth;\r\n\r\n                    var finalHeight = height / splitHeight;\r\n\r\n                    var offsetTop = 0;\r\n                    var offsetLeft = 0;\r\n                    var newHeight = height;\r\n\r\n                    if (imgWidth != width) newHeight = (width/imgWidth) * imgHeight;\r\n\r\n                    var canvas = document.createElement(\"canvas\");\r\n                    if (typeof G_vmlCanvasManager != 'undefined') G_vmlCanvasManager.initElement(canvas);\r\n                    canvas.width = width; \r\n                    canvas.style.width = \"100%\"; \r\n                    canvas.height = finalHeight; \r\n\r\n                    var ctx = canvas.getContext(\"2d\");\r\n\r\n                    for (var s = 0; s < splitHeight; s++) {\r\n                        ctx.drawImage(imageObj, 0, 0, imgWidth, imgHeight, 0 + offsetLeft, -(s * finalHeight) + offsetTop, width, newHeight);\r\n                        var imageURL = canvas.toDataURL();\r\n\r\n                        var img = document.createElement(\"img\");\r\n                        thisHandle.$('.item-'+s+'.qs-slide-container .i'+image._id).append(img);\r\n                        imagesToLoadCount++;\r\n                        $(img).bind(\"load\", function() {\r\n                            imagesLoadedCount++;\r\n\r\n                            if (imagesToLoadCount == imagesLoadedCount) {\r\n                                thisHandle.setReadyStatus();\r\n                                $(window).resize();\r\n                            }\r\n                        });\r\n                        img.src = imageURL;\r\n\r\n                    }\r\n\r\n                    if (imagesSplit == images) {\r\n                        thisHandle.calculateWidths();\r\n                    }\r\n\r\n                });\r\n                imageObj.src = image.src;\r\n            });\r\n        },\r\n\r\n        setupNarrative: function() {\r\n            this.setDeviceSize();\r\n            \r\n            var _items = this.model.get(\"_items\");\r\n            var thisHandle = this;\r\n            _.each(_items, function(item, index) {\r\n                item._itemCount = item._subItems.length;\r\n                if (item.hasOwnProperty('_stage')) {\r\n                    thisHandle.setStage(index, item._stage, true);\r\n                } else {\r\n                    thisHandle.setStage(index, item.hasOwnProperty('_initialItemIndex') ? item._initialItemIndex : 0);\r\n                }\r\n            });\r\n            \r\n            this.model.set('_active', true);\r\n\r\n        },\r\n\r\n        calculateWidths: function() {\r\n            //calc widths for each item\r\n            var _items = this.model.get(\"_items\");\r\n            _.each(_items, function(item, index) {\r\n                var slideWidth = this.$('.qs-slide-container').width();\r\n                var slideCount = item._itemCount;\r\n                var marginRight = this.$('.qs-slider-graphic').css('margin-right');\r\n\r\n                var extraMargin = marginRight === \"\" ? 0 : parseInt(marginRight);\r\n                var fullSlideWidth = (slideWidth + extraMargin) * slideCount;\r\n                var iconWidth = this.$('.qs-popup-open').outerWidth();\r\n                var $headerInner = this.$(\".item-\" + index)\r\n                    .find(\".qs-strapline-header-inner\");\r\n\r\n                this.$('.item-'+index+'.qs-slide-container .qs-slider-graphic').width(slideWidth)\r\n                this.$('.qs-strapline-header').width(slideWidth);\r\n                this.$('.qs-strapline-title').width(slideWidth);\r\n\r\n                this.$('.item-'+index+'.qs-slide-container .qs-slider').width(fullSlideWidth);\r\n                $headerInner.width(fullSlideWidth);\r\n\r\n                var stage = item._stage;//this.model.get('_stage');\r\n                var margin = -(stage * slideWidth);\r\n\r\n                this.$('.item-'+index+'.qs-slide-container .qs-slider').css('margin-left', margin);\r\n                $headerInner.css(\"margin-left\", margin);\r\n\r\n                item._finalItemLeft = fullSlideWidth - slideWidth;\r\n            });\r\n\r\n            _.each(this.$('.qs-slider-graphic'), function(item) {\r\n                $(item).attr(\"height\",\"\").css(\"height\",\"\");\r\n            });\r\n        },\r\n\r\n        resizeControl: function() {\r\n            this.setDeviceSize();\r\n            this.calculateWidths();\r\n            var _items = this.model.get(\"_items\");\r\n            var thisHandle = this;\r\n            _.each(_items, function(item, index) {\r\n                thisHandle.evaluateNavigation(index);\r\n            });\r\n        },\r\n\r\n        moveSliderToIndex: function(itemIndex, stage, animate) {\r\n            var extraMargin = parseInt(this.$('.item-'+itemIndex+'.qs-slide-container .qs-slider-graphic').css('margin-right')),\r\n                movementSize = this.$('.item-'+itemIndex+'.qs-slide-container').width()+extraMargin;\r\n\r\n            if(animate) {\r\n                this.$('.item-'+itemIndex+'.qs-slide-container .qs-slider').stop().animate({'margin-left': -(movementSize * stage)});\r\n                this.$('.item-'+itemIndex+' .qs-strapline-header .qs-strapline-header-inner').stop(true, true).animate({'margin-left': -(movementSize * stage)});\r\n            } else {\r\n                this.$('.item-'+itemIndex+'.qs-slide-container .qs-slider').css({'margin-left': -(movementSize * stage)});\r\n                this.$('.item-'+itemIndex+' .qs-strapline-header .qs-strapline-header-inner').css({'margin-left': -(movementSize * stage)});\r\n            }\r\n        },\r\n\r\n        setStage: function(itemIndex, stage, initial) {\r\n            var item = this.model.get('_items')[itemIndex];\r\n            item._stage = stage;\r\n            item.visited = true;\r\n\r\n            this.$('.qs-progress').removeClass('selected').eq(stage).addClass('selected');\r\n            this.$('.item-'+itemIndex+'.qs-slide-container .qs-slider-graphic').children('.controls').attr('tabindex', -1);\r\n            this.$('.item-'+itemIndex+'.qs-slide-container .qs-slider-graphic').eq(stage).children('.controls').attr('tabindex', 0);\r\n\r\n            this.evaluateNavigation(itemIndex);\r\n\r\n            this.moveSliderToIndex(itemIndex, stage, !initial);\r\n        },\r\n\r\n        evaluateNavigation: function(itemIndex) {\r\n            var item = this.model.get('_items')[itemIndex];\r\n            var currentStage = item._stage;\r\n            var itemCount = item._itemCount;\r\n            if (currentStage == 0) {\r\n                this.$('.item-'+itemIndex+'.qs-slide-container .qs-control-left').addClass('qs-hidden');\r\n\r\n                if (itemCount > 1) {\r\n                    this.$('.item-'+itemIndex+'.qs-slide-container .qs-control-right').removeClass('qs-hidden');\r\n                }\r\n            } else {\r\n                this.$('.item-'+itemIndex+'.qs-slide-container .qs-control-left').removeClass('qs-hidden');\r\n\r\n                if (currentStage == itemCount - 1) {\r\n                    this.$('.item-'+itemIndex+'.qs-slide-container .qs-control-right').addClass('qs-hidden');\r\n                } else {\r\n                    this.$('.item-'+itemIndex+'.qs-slide-container .qs-control-right').removeClass('qs-hidden');\r\n                }\r\n            }\r\n\r\n        },\r\n\r\n        getVisitedItems: function() {\r\n          return _.filter(this.model.get('_items'), function(item) {\r\n                return item.visited;\r\n          });\r\n        },\r\n\r\n        onNavigationClicked: function(event) {\r\n            event.preventDefault();\r\n\r\n            var $target = $(event.currentTarget);\r\n\r\n            if ($target.hasClass('disabled')) return;\r\n\r\n            if (!this.model.get('_active')) return;\r\n\r\n            var selectedItemIndex = $target.parent('.component-item').index();\r\n            var selectedItemObject = this.model.get('_items')[selectedItemIndex];\r\n\r\n            var stage = selectedItemObject._stage,\r\n                numberOfItems = selectedItemObject._itemCount;\r\n\r\n            if ($target.hasClass('qs-control-right')) {\r\n                stage++;\r\n                if (stage == numberOfItems-1) {\r\n                    $('.qs-control-left').focus();\r\n                }\r\n            } else if ($target.hasClass('qs-control-left')) {\r\n                stage--;\r\n                if (stage == 0) {\r\n                    $('.qs-control-right').focus();\r\n                }\r\n            }\r\n            stage = (stage + numberOfItems) % numberOfItems;\r\n            this.setStage(selectedItemIndex, stage);\r\n        }\r\n\r\n    });\r\n\r\n    Adapt.register(\"questionStrip\", QuestionStrip);\r\n\r\n    return QuestionStrip;\r\n\r\n});\r\n\n","/*\r\n* adapt-slidingPuzzle\r\n* License - http://github.com/adaptlearning/adapt_framework/LICENSE\r\n* Maintainers - Dennis Heaney <dennis@learningpool.com>\r\n*/\r\ndefine('components/adapt-slidingPuzzle/js/adapt-slidingPuzzle',['require','coreViews/componentView','coreJS/adapt'],function(require) {\r\n\r\n  var ComponentView = require(\"coreViews/componentView\");\r\n  var Adapt = require('coreJS/adapt');\r\n\r\n  // sliding tile object\r\n  function SlidingTile (options) {\r\n    return _.extend({\r\n        className: 'slidingPuzzle-tile',\r\n        src: null, // the image to use in the source\r\n        el: null,\r\n        x: 0, // actual x position on puzzle\r\n        y: 0, // actual y position on puzzle\r\n        srcX: 0, // x position on image of this tile\r\n        srcY: 0, // y position on image of this tile\r\n        width: 0,\r\n        height: 0,\r\n        column: -1, // correct column of this tile\r\n        row: -1, // correct row of this tile\r\n        visible: true, // if true, draw this tile\r\n        target: {},\r\n\r\n        /**\r\n         * returns a comma separated rect spec suitable for\r\n         * use in a css clip style\r\n         */\r\n        getRect: function () {\r\n          return [\r\n            this.srcY + 'px',\r\n            this.srcX + this.width + 'px',\r\n            this.srcY + this.height + 'px',\r\n            this.srcX + 'px'\r\n          ].join(',');\r\n        },\r\n\r\n        /**\r\n         * builds the img element for this tile and returns it\r\n         * ready for use in $.append\r\n         */\r\n        renderElement: function (container) {\r\n          // remove img if already rendered\r\n          if (this.el) {\r\n            this.el.remove();\r\n          }\r\n\r\n          // create image element\r\n          var img = $('<img>');\r\n          img.attr('src', this.src);\r\n          img.css('clip', 'rect(' + this.getRect() + ')');\r\n          img.css('left', -this.srcX + 'px');\r\n          img.css('top', -this.srcY + 'px');\r\n\r\n          // create element (the tile)\r\n          var el = $('<div>');\r\n          el.attr('class', this.className);\r\n          el.css('left', this.x);\r\n          el.css('top', this.y);\r\n          this.el = el;\r\n\r\n          this.el.append(img);\r\n          this.setVisible(this.visible);\r\n\r\n          container.append(this.el);\r\n\r\n          return this.el;\r\n        },\r\n\r\n        /**\r\n         * toggles display of the tile\r\n         */\r\n        setVisible: function (visible) {\r\n          this.visible = visible;\r\n          if (this.el) {\r\n            this.el.css('opacity', (this.visible ? '100' : '0'));\r\n          }\r\n        },\r\n\r\n        /**\r\n         * sets the target x and y for this tile\r\n         *\r\n         */\r\n        setTarget: function (target) {\r\n          this.target.x = target.x;\r\n          this.target.y = target.y;\r\n\r\n          // immediately set to position\r\n          if (this.el) {\r\n            this.el.css('left', this.target.x);\r\n            this.el.css('top', this.target.y);\r\n          }\r\n        }\r\n      }, options);\r\n  }\r\n\r\n  var SlidingPuzzle = ComponentView.extend({\r\n\r\n    events: {\r\n      'click .slidingPuzzle-puzzle': 'attemptMove',\r\n      'click .slidingPuzzle-widget .button.reset': 'onResetClicked',\r\n      'click .slidingPuzzle-widget .button.model': 'onShowSolutionClicked'\r\n    },\r\n\r\n    _columns: 1,\r\n\r\n    _rows: 1,\r\n\r\n    _tiles: [],\r\n\r\n    img: false,\r\n\r\n    context: false,\r\n\r\n    _debounceTime: 250,\r\n\r\n    _debouncing: false,\r\n\r\n    preRender: function () {\r\n      this.listenTo(Adapt, 'device:changed', this.resizePuzzle);\r\n    },\r\n\r\n    postRender: function () {\r\n      this.resizePuzzle(Adapt.device.screenSize);\r\n    },\r\n\r\n    resizePuzzle: function (width) {\r\n      var img = this.$('.slidingPuzzle-widget img');\r\n      img.attr('src', img.attr('data-' + width));\r\n\r\n      this.$('.slidingPuzzle-widget').imageready(_.bind(function (imgEl) {\r\n        this.resetPuzzle(imgEl);\r\n      }, this, img.get(0)));\r\n    },\r\n\r\n    resetPuzzle: function (img) {\r\n      var graphic = this.model.get('graphic');\r\n      var puzzle = this.$('.slidingPuzzle-puzzle');\r\n      puzzle.html('');\r\n      this.img = img;\r\n\r\n      // set up the puzzle board\r\n      puzzle.css('width', this.img.width + 'px');\r\n      puzzle.css('height', this.img.height + 'px');\r\n      this._columns = this.model.get('dimension') || this._columns;\r\n      this._rows = this.model.get('dimension') || this._rows;\r\n      this._tiles = this.fetchTiles(this.img, this._columns, this._rows);\r\n\r\n      // show/hide buttons\r\n      this.$('.slidingPuzzle-widget .button.reset').hide();\r\n      if (this.model.get('allowSkip')) {\r\n        this.$('.slidingPuzzle-widget .button.model').show();\r\n      }\r\n\r\n      this.renderTiles(puzzle);\r\n\r\n      // get debounce time from transition time\r\n      var transTime = parseFloat(this.$('.slidingPuzzle-tile').first().css('transition-duration'), 10);\r\n      this._debounceTime = transTime ? transTime * 1000 : this._debounceTime;\r\n\r\n\r\n      this.setReadyStatus();\r\n    },\r\n\r\n    showAll: function () {\r\n      for (var row = 0; row < this._tiles.length; ++row) {\r\n        for (var col = 0; col < this._tiles[row].length; ++col) {\r\n          var tile = this._tiles[row][col];\r\n          tile.setTarget({x:tile.srcX, y:tile.srcY});\r\n          tile.setVisible(true);\r\n        }\r\n      }\r\n    },\r\n\r\n    renderTiles: function (el) {\r\n      for (var row = 0; row < this._tiles.length; ++row) {\r\n        for (var col = 0; col < this._tiles[row].length; ++col) {\r\n          this._tiles[col][row].renderElement(el);\r\n        }\r\n      }\r\n    },\r\n\r\n    fetchTiles: function (img, dimensionX, dimensionY) {\r\n      var tiles = [];\r\n      var tileWidth = Math.floor(img.width / (dimensionX || 1));\r\n      var tileHeight = Math.floor(img.height / (dimensionY || 1));\r\n      var col = 0;\r\n      var row = 0;\r\n      for (col = 0; col < dimensionX; ++col) {\r\n        for (row = 0; row < dimensionY; ++row) {\r\n          tiles.push(new SlidingTile({ src: img.src, srcX: col*tileWidth, srcY: row*tileHeight, width: tileWidth, height: tileHeight, column: col, row: row }));\r\n        }\r\n      }\r\n\r\n      var randomTiles = [];\r\n      var index = 0;\r\n      while (tiles.length > 0) {\r\n        if (index % dimensionX === 0) {\r\n          randomTiles.push([]);\r\n        }\r\n        var t = tiles.splice(Math.floor(Math.random()*tiles.length), 1)[0];\r\n        col = index % dimensionX;\r\n        row = Math.floor(index / dimensionY);\r\n        if (tiles.length !== 0) {\r\n          t.x = col * t.width;\r\n          t.y = row * t.height;\r\n          t.setVisible(true);\r\n        } else {\r\n          t.setVisible(false); // make the last tile invisible\r\n        }\r\n        randomTiles[row].push(t);\r\n        ++index;\r\n      }\r\n\r\n      return randomTiles;\r\n    },\r\n\r\n    attemptMove: function (e) {\r\n      if (this._debouncing) {\r\n        return;\r\n      }\r\n      var puzzlePos = this.$('.slidingPuzzle-puzzle').offset();\r\n      var mouseX = e.pageX - Math.round(puzzlePos.left);\r\n      var mouseY = e.pageY - Math.round(puzzlePos.top);\r\n      var cellX = Math.floor(mouseX/this.img.width * this._columns);\r\n      var cellY = Math.floor(mouseY/this.img.height * this._rows);\r\n      if (this._tiles[cellY][cellX]) {\r\n        var freeCell = false;\r\n        // check if we can move to any postion\r\n        // up or down?\r\n        for (var row = 0; row < this._rows; ++row) {\r\n          if (row === cellY) { // ignore self\r\n            continue;\r\n          }\r\n\r\n          if (!this._tiles[row][cellX].visible) {\r\n            // boom, found a free cell\r\n            freeCell = {col: cellX, row: row};\r\n            break\r\n          }\r\n        }\r\n\r\n        if (!freeCell) {\r\n          // check left and right\r\n          for (var col = 0; col < this._columns; ++col) {\r\n            if (col === cellX) { // ignore self\r\n              continue;\r\n            }\r\n\r\n            if (!this._tiles[cellY][col].visible) {\r\n              // boom, found a free cell\r\n              freeCell = {col: col, row: cellY};\r\n              break;\r\n            }\r\n          }\r\n        }\r\n\r\n        if (freeCell) {\r\n          var tile = false;\r\n          // move multiple tiles if we can\r\n          if (freeCell.col === cellX) { // same column\r\n            var direction = freeCell.row > cellY ? -1 : 1;\r\n            for (; freeCell.row >= 0 && freeCell.row != this._rows; freeCell.row += direction) {\r\n              var currentRow = freeCell.row + direction;\r\n              tile = this._tiles[currentRow][cellX];\r\n              tile.setTarget({x: cellX * tile.width, y: freeCell.row * tile.height});\r\n              // swap tiles\r\n              this.swapTiles(currentRow, cellX, freeCell.row, cellX);\r\n              // stop when we reach the clicked cell\r\n              if (currentRow === cellY) {\r\n                break;\r\n              }\r\n            }\r\n          } else { // same row\r\n            var direction = freeCell.col > cellX ? -1 : 1;\r\n            for (; freeCell.col >= 0 && freeCell.col != this._columns; freeCell.col += direction) {\r\n              var currentCol = freeCell.col + direction;\r\n              tile = this._tiles[cellY][currentCol];\r\n              tile.setTarget({x: freeCell.col * tile.width, y: cellY * tile.height});\r\n              // swap tiles\r\n              this.swapTiles(cellY, currentCol, cellY, freeCell.col);\r\n              // stop when we reach the clicked cell\r\n              if ((freeCell.col + direction) === cellX) {\r\n                break;\r\n              }\r\n            }\r\n          }\r\n          this.debounce();\r\n        }\r\n\r\n        // assess completion!\r\n        if (this.checkPuzzle()) {\r\n          // w00t! player got skillz\r\n          this.solve();\r\n        }\r\n      }\r\n    },\r\n\r\n    debounce: function () {\r\n      this._debouncing = true;\r\n      setTimeout(_.bind(function () { this._debouncing = false; }, this), this._debounceTime);\r\n    },\r\n\r\n    solve: function () {\r\n      this.$('.slidingPuzzle-widget .button.model').hide();\r\n      this.$('.slidingPuzzle-widget .button.reset').show();\r\n      this.showAll();\r\n      this.puzzleComplete();\r\n    },\r\n\r\n    onResetClicked: function (e) {\r\n      e.preventDefault();\r\n      this.resetPuzzle(this.img);\r\n    },\r\n\r\n    onShowSolutionClicked: function (e) {\r\n      e.preventDefault();\r\n      this.solve();\r\n    },\r\n\r\n    swapTiles: function (row1, col1, row2, col2) {\r\n      var temp = this._tiles[row1][col1];\r\n      this._tiles[row1][col1] = this._tiles[row2][col2];\r\n      this._tiles[row2][col2] = temp;\r\n    },\r\n\r\n    checkPuzzle: function () {\r\n      for (var row = 0; row < this._tiles.length; ++row) {\r\n        for (var col = 0; col < this._tiles[row].length; ++col) {\r\n          var tile = this._tiles[row][col];\r\n          if (tile.column !== col || tile.row !== row) {\r\n            // not in order\r\n            return false;\r\n          }\r\n        }\r\n      }\r\n      return true;\r\n    },\r\n\r\n    puzzleComplete: function () {\r\n      this.setCompletionStatus();\r\n    }\r\n\r\n  });\r\n\r\n  Adapt.register('slidingPuzzle', SlidingPuzzle);\r\n\r\n  return SlidingPuzzle;\r\n\r\n});\r\n\n","define('components/adapt-tabs/js/adapt-tabs',['require','coreViews/componentView','coreJS/adapt'],function(require) {\r\n\r\n\tvar ComponentView = require('coreViews/componentView');\r\n\tvar Adapt = require('coreJS/adapt');\r\n\r\n\tvar Tabs = ComponentView.extend({\r\n\r\n\t\tevents: {\r\n\t\t\t'click .tabs-navigation-item': 'onTabItemClicked'\r\n\t\t},\r\n\t\t\r\n\t\tpreRender: function() {\r\n\t\t},\r\n\r\n\t\tpostRender: function() {\r\n\t\t\tthis.setReadyStatus();\r\n\t\t\tthis.setLayout();\r\n\t\t\tthis.listenTo(Adapt, 'device:resize', this.setLayout);\r\n\t\t\tthis.showContentItemAtIndex(0, true);\r\n\t\t\tthis.setTabSelectedAtIndex(0);\r\n\t\t},\r\n\r\n\t\tsetLayout: function() {\r\n\t\t\tthis.$el.removeClass(\"tab-layout-left tab-layout-top\");\r\n\t\t\tif (Adapt.device.screenSize == 'large') {\r\n\t\t\t\tvar tabLayout = this.model.get('_tabLayout');\r\n\t\t\t\tthis.$el.addClass(\"tab-layout-\" + tabLayout);\r\n\t\t\t\tif (tabLayout === 'top') {\r\n\t\t\t\t\tthis.setTabLayoutTop();\r\n\t\t\t\t} else if (tabLayout === 'left') {\r\n\t\t\t\t\tthis.setTabLayoutLeft();\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.$el.addClass(\"tab-layout-left\");\r\n\t\t\t\tthis.setTabLayoutLeft();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tsetTabLayoutTop: function() {\r\n\t\t\tvar itemsLength = this.model.get('_items').length;\r\n\t\t\tvar itemWidth = 100 / itemsLength;\r\n\r\n\t\t\tthis.$('.tabs-navigation-item').css({\r\n\t\t\t\twidth: itemWidth + '%'\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tsetTabLayoutLeft: function() {\r\n\t\t\tthis.$('.tabs-navigation-item').css({\r\n\t\t\t\twidth: 100 + '%'\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tonTabItemClicked: function(event) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tvar index = $(event.currentTarget).index();\r\n\t\t\tthis.showContentItemAtIndex(index);\r\n\t\t\tthis.setTabSelectedAtIndex(index);\r\n\t\t\tthis.setVisited($(event.currentTarget).index());\r\n\t\t},\r\n\r\n\t\tshowContentItemAtIndex: function(index, skipFocus) {\r\n\t\t\tvar $contentItems = this.$('.tab-content');\r\n\r\n\t\t\t$contentItems.removeClass('active').velocity({\r\n\t\t\t\topacity: 0,\r\n\t\t\t\ttranslateY: '20px'\r\n\t\t\t}, {\r\n\t\t\t\tduration: 0,\r\n\t\t\t\tdisplay: 'none'\r\n\t\t\t});\r\n\r\n\t\t\tvar $contentItem = $contentItems.eq(index);\r\n\t\t\t$contentItem.velocity({\r\n\t\t\t\topacity: 1,\r\n\t\t\t\ttranslateY: '0'\r\n\t\t\t}, {\r\n\t\t\t\tduration: 300,\r\n\t\t\t\tdisplay: 'block',\r\n\t\t\t\tcomplete: _.bind(complete,this)\r\n\t\t\t});\r\n\r\n\t\t\tfunction complete() {\r\n\t\t\t\tif (skipFocus) return;\r\n\t            $contentItem.addClass('active').a11y_focus();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tsetTabSelectedAtIndex: function(index) {\r\n\t\t\tvar $navigationItem = this.$('.tabs-navigation-item-inner');\r\n\t\t\t$navigationItem.removeClass('selected').eq(index).addClass('selected visited').attr('aria-label', this.model.get(\"_items\")[index].tabTitle + \". Visited\");\r\n\t\t\tthis.setVisited(index);\r\n\t\t},\r\n\r\n\t\tsetVisited: function(index) {\r\n\t\t\tvar item = this.model.get('_items')[index];\r\n\t\t\titem._isVisited = true;\r\n\t\t\tthis.checkCompletionStatus();\r\n\t\t},\r\n\r\n\t\tgetVisitedItems: function() {\r\n\t\t\treturn _.filter(this.model.get('_items'), function(item) {\r\n\t\t\t\treturn item._isVisited;\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tcheckCompletionStatus: function() {\r\n\t\t\tif (this.getVisitedItems().length == this.model.get('_items').length) {\r\n\t\t\t\tthis.setCompletionStatus();\r\n\t\t\t}\r\n\t\t}\r\n\t},{\r\n      template: 'tabs'\r\n   });\r\n\t\r\n\tAdapt.register(\"tabs\", Tabs);\r\n\r\n\treturn Tabs;\r\n\t\r\n});\r\n\n","define('components/adapt-timedSequence/js/adapt-timed-sequence',['require','coreViews/questionView','coreJS/adapt'],function(require) {\r\n\r\n\tvar QuestionView = require(\"coreViews/questionView\");\r\n\tvar Adapt = require(\"coreJS/adapt\");\r\n\r\n\tvar TimedSequence = QuestionView.extend({\r\n\r\n\t\tevents: {\r\n\t\t\t\"click .sequence-start-button\":\"onStartClicked\",\r\n\t\t\t\"click .sequence-answer-button\":\"onAnswerClicked\"\r\n\t\t},\r\n\r\n\t\tpreRender:function(){\r\n\t\t\tQuestionView.prototype.preRender.apply(this);\r\n\r\n\t\t\t_.bindAll(this, \"onWidgetImageReady\", \"onTimerInterval\", \"onQuestionComplete\", \"updateSequence\");\r\n\r\n\t\t\tthis.listenTo(Adapt, \"device:changed device:resize\", this.setupLayout);\r\n\t\t},\r\n\r\n\t\tpostRender: function() {\r\n\t\t\tQuestionView.prototype.postRender.apply(this);\r\n\t\t\tthis.$(\".timed-sequence-widget\").imageready(this.onWidgetImageReady);\r\n\t\t},\r\n\r\n\t\tsetupLayout: function() {\r\n\t\t\tthis.width = this.$(\".sequence-container\").width();\r\n\t\t\tthis.$(\".sequence-container-inner\").css(\"width\", this.width * this.model.get(\"_items\").length);\r\n\t\t\tthis.$(\".sequence-image\").css(\"width\", this.width);\r\n\t\t},\r\n\r\n\t\tsetupSequenceIndicators: function() {\r\n\t\t\tvar itemsLength = this.model.get(\"_items\").length;\r\n\t\t\tthis.$(\".sequence-indicator\").css(\"width\", (100/itemsLength) + \"%\");\r\n\t\t},\r\n\r\n\t\tresetData: function() {\r\n\t\t\tthis.model.set({\r\n\t\t\t\t_userAnswers: [],\r\n\t\t\t\t_currentStageIndex: 0,\r\n\t\t\t\t_lastStageAnswered: -1,\r\n\t\t\t\t_correctAnswers: 0,\r\n\t\t\t\t_incorrectAnswers: 0\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tstartTimer: function() {\r\n\t\t\tvar timerInterval = this.model.get(\"_timerInterval\")*1000;\r\n\t\t\tthis.timer = setInterval(this.onTimerInterval, timerInterval);\r\n\t\t},\r\n\r\n\t\tstopTimer: function() {\r\n\t\t\tclearInterval(this.timer);\r\n\t\t\tthis.timer = -1;\r\n\t\t},\r\n\r\n\t\tupdateSequence: function() {\r\n\t\t\tthis.markAnswer(this.model.get(\"_currentStageIndex\"));\r\n\r\n\t\t\tif (this.atLastStage()) this.endSequence();\r\n\t\t\telse this.showNextImage();\r\n\t\t},\r\n\r\n\t\tshowNextImage: function() {\r\n\t\t\tthis.model.set(\"_currentStageIndex\", this.model.get(\"_currentStageIndex\")+1);\r\n\t\t\tvar leftMarg = -(this.model.get(\"_currentStageIndex\") * this.width);\r\n\t\t\tthis.$(\".sequence-container-inner\").velocity({ marginLeft: leftMarg + \"px\" });\r\n\t\t\tthis.updateIndicator();\r\n\r\n\t\t\tif(this.timer === -1) this.startTimer();\r\n\t\t},\r\n\r\n\t\tendCurrentStage: function() {\r\n\t\t\tvar $indicator = this.$(\".sequence-indicator\").eq(this.model.get(\"_currentStageIndex\"));\r\n\t\t\t$indicator.children(\".sequence-indicator-inner\").stop().animate({ width:\"100%\" }, 500, this.updateSequence);\r\n\t\t},\r\n\r\n\t\tendSequence: function() {\r\n\t\t\tthis.stopTimer();\r\n\t\t\tthis.$(\".sequence-state-container\").addClass(\"complete\");\r\n\t\t\tthis.$(\".sequence-answer-button\").removeClass(\"show\");\r\n\t\t\tthis.$(\".sequence-complete-button\").addClass(\"show\");\r\n\t\t\tthis.$(\".sequence-state-container\").velocity(\"reverse\", this.onQuestionComplete);\r\n\t\t},\r\n\r\n\t\tmarkAnswer: function(index) {\r\n\t\t\tvar userDidInteract = this.userDidInteract();\r\n\t\t\tvar shouldBeSelected = this.model.get(\"_items\")[index]._shouldBeSelected;\r\n\t\t\tvar correctInteraction = (userDidInteract && shouldBeSelected) || (!userDidInteract && !shouldBeSelected);\r\n\r\n\t\t\tthis.model.get(\"_userAnswers\").push({\r\n\t\t\t\t_stageID: index,\r\n\t\t\t\t_isCorrect:correctInteraction\r\n\t\t\t});\r\n\r\n\t\t\tif(correctInteraction) this.model.set(\"_correctAnswers\", this.model.get(\"_correctAnswers\")+1);\r\n\t\t\telse this.model.set(\"_incorrectAnswers\", this.model.get(\"_incorrectAnswers\")+1);\r\n\r\n\t\t\tthis.showIndicatorMarking();\r\n\t\t\tthis.showSequenceFeedback(this.model.get(\"_userAnswers\")[index]);\r\n\t\t},\r\n\r\n\t\tupdateIndicator: function() {\r\n\t\t\tvar timerInterval = this.model.get(\"_timerInterval\")*1000;\r\n\t\t\tvar $indicator = this.$(\".sequence-indicator\").eq(this.model.get(\"_currentStageIndex\"));\r\n\t\t\tvar $indicatorInner = $indicator.children(\".sequence-indicator-inner\");\r\n\t\t\t$indicatorInner.animate({ width:\"100%\" }, timerInterval);\r\n\t\t},\r\n\r\n\t\tshowIndicatorMarking: function() {\r\n\t\t\t_.each(this.model.get(\"_userAnswers\"), _.bind(function(item, index) {\r\n\t\t\t\tvar $indicator = this.$(\".sequence-indicator\").eq(index);\r\n\t\t\t\tvar iconClass = (item._isCorrect) ? \".icon-tick\" : \".icon-cross\";\r\n\t\t\t\t$indicator.children(iconClass).addClass(\"show\");\r\n\t\t\t}, this));\r\n\t\t},\r\n\r\n\t\tshowSequenceFeedback: function(userAnswer) {\r\n\t\t\tvar $feedbackContainer = this.$(\".sequence-feedback-container\");\r\n\t\t\tvar iconClass = (userAnswer._isCorrect) ? \".icon-tick\" : \".icon-cross\";\r\n\t\t\tthis.animateFeedbackIcon($feedbackContainer.children(iconClass));\r\n\t\t},\r\n\r\n\t\tanimateFeedbackIcon: function($element) {\r\n\t\t\t// quickly fade in, then fade out immediately\r\n\t\t\t$element.velocity({ opacity: 1 }, 50, function() {\r\n\t\t\t\t$element.velocity({ opacity: 0 }, 500);\r\n\t\t\t});\r\n\t\t},\r\n\t\t\r\n\t\tisCorrect: function() {\r\n\t\t\treturn this.model.get(\"_correctAnswers\") === this.model.get(\"_items\").length;\r\n\t\t},\r\n\r\n\t\tisPartlyCorrect: function() {\r\n\t\t\treturn this.model.get(\"_incorrectAnswers\") <= this.model.get(\"_answerLeniency\");\r\n\t\t},\r\n\r\n\t\tuserDidInteract: function() {\r\n\t\t\treturn this.model.get(\"_lastStageAnswered\") === this.model.get(\"_currentStageIndex\");\r\n\t\t},\r\n\r\n\t\tatLastStage: function() {\r\n\t\t\treturn this.model.get(\"_currentStageIndex\") == this.model.get(\"_items\").length-1;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t* Event handling\r\n\t\t*/\r\n\t\tonWidgetImageReady: function() {\r\n\t\t\tthis.resetData();\r\n\t\t\tthis.setupLayout();\r\n\t\t\tthis.setupSequenceIndicators();\r\n\t\t\tthis.setReadyStatus();\r\n\t\t},\r\n\r\n\t\tonStartClicked: function(event) {\r\n\t\t\tif (event) event.preventDefault();\r\n\r\n\t\t\tthis.$(\".sequence-state-container\").velocity({ top:\"-100%\" },{ duration:800, easing:\"swing\" });\r\n\t\t\tthis.$(\".sequence-start-button\").removeClass(\"show\");\r\n\t\t\tthis.$(\".sequence-answer-button\").addClass(\"show\");\r\n\r\n\t\t\tthis.startTimer();\r\n\t\t\tthis.updateIndicator();\r\n\t\t},\r\n\r\n\t\tonAnswerClicked: function(event) {\r\n\t\t\tif (event) event.preventDefault();\r\n\r\n\t\t\tif (this.model.get(\"_lastStageAnswered\") == this.model.get(\"_currentStageIndex\")) return;\r\n\t\t\tthis.model.set(\"_lastStageAnswered\", this.model.get(\"_currentStageIndex\"));\r\n\t\t\tthis.stopTimer();\r\n\t\t\tthis.endCurrentStage();\r\n\t\t},\r\n\r\n\t\tonQuestionComplete: function() {\r\n\t\t\tthis.setCompletionStatus();\r\n\t\t\tthis.updateAttempts();\r\n\t\t\tthis.setQuestionAsSubmitted();\r\n\t\t\tthis.markQuestion();\r\n\t\t\tthis.setScore();\r\n\t\t\tthis.setupFeedback();\r\n\t\t\tthis.showFeedback();\r\n\t\t},\r\n\r\n\t\tonTimerInterval: function() {\r\n\t\t\tthis.updateSequence();\r\n\t\t}\r\n\t},{\r\n\t\ttemplate: \"timed-sequence\"\r\n\t});\r\n\r\n\tAdapt.register(\"timed-sequence\", TimedSequence);\r\n\r\n\treturn TimedSequence;\r\n});\n","/*\r\n* adapt-youtube\r\n* License - http://github.com/adaptlearning/adapt_framework/LICENSE\r\n* Maintainers - Oliver Foster <oliver.foster@kineo.com>, Matt Leathes <matt.leathes@kineo.com>\r\n*/\r\ndefine('components/adapt-youtube/js/adapt-youtube',['require','coreViews/componentView','coreJS/adapt'],function(require) {\r\n\r\n    var ComponentView = require('coreViews/componentView');\r\n    var Adapt = require('coreJS/adapt');\r\n\r\n    var youtube = ComponentView.extend({\r\n        defaults:function() {\r\n            return {\r\n                player:null\r\n            }\r\n        },\r\n\r\n        initialize: function() {\r\n            ComponentView.prototype.initialize.apply(this);\r\n\r\n            _.bindAll(this, 'onPlayerStateChange', 'onPlayerReady', 'onInview');\r\n\r\n            if (window.onYouTubeIframeAPIReady === undefined) {\r\n                window.onYouTubeIframeAPIReady = function() {\r\n                    console.info('YouTube iframe API loaded');\r\n                    Adapt.youTubeIframeAPIReady = true;\r\n                    Adapt.trigger('youTubeIframeAPIReady');\r\n                };\r\n                $.getScript('//www.youtube.com/iframe_api');\r\n            }\r\n        },\r\n\r\n        preRender: function() {\r\n            this.listenTo(Adapt, 'device:resize', this.setIFrameSize);\r\n            this.listenTo(Adapt, 'device:changed', this.setIFrameSize);\r\n        },\r\n\r\n        setIFrameSize: function () {\r\n            this.$('iframe').width(this.$('.component-widget').width());\r\n            \r\n            var aspectRatio = (this.model.get(\"_media\")._aspectRatio ? parseFloat(this.model.get(\"_media\")._aspectRatio) : 1.778);//default to 16:9 if not specified\r\n            if (!isNaN(aspectRatio)) {\r\n                this.$('iframe').height(this.$('.component-widget').width() / aspectRatio);\r\n            }\r\n        },\r\n\r\n        postRender: function() {\r\n            //FOR HTML/HBS Paramenters: https://developers.google.com/youtube/player_parameters\r\n            if (Adapt.youTubeIframeAPIReady === true) {\r\n                this.onYouTubeIframeAPIReady();\r\n            } else {\r\n                Adapt.once('youTubeIframeAPIReady', this.onYouTubeIframeAPIReady, this)\r\n            }\r\n        },\r\n\r\n        remove: function() {\r\n            if(this.player != null) {\r\n                this.player.destroy();\r\n            }\r\n\r\n            ComponentView.prototype.remove.call(this);\r\n        },\r\n    \r\n        setupEventListeners: function() {\r\n            this.completionEvent = (!this.model.get('_setCompletionOn')) ? 'play' : this.model.get('_setCompletionOn');\r\n            if (this.completionEvent === \"inview\") {\r\n                this.$('.component-widget').on('inview', this.onInview);\r\n            }\r\n\r\n            // add listener for other youtube components on the page, so that we can prevent multiple video playback\r\n            this.listenTo(Adapt, 'adapt-youtube:playbackstart', this.onYouTubePlaybackStart)\r\n        },\r\n\r\n        onInview: function(event, visible, visiblePartX, visiblePartY) {\r\n            if (visible) {\r\n                if (visiblePartY === 'top') {\r\n                    this._isVisibleTop = true;\r\n                } else if (visiblePartY === 'bottom') {\r\n                    this._isVisibleBottom = true;\r\n                } else {\r\n                    this._isVisibleTop = true;\r\n                    this._isVisibleBottom = true;\r\n                }\r\n\r\n                if (this._isVisibleTop && this._isVisibleBottom) {\r\n                    this.$('.component-inner').off('inview');\r\n                    this.setCompletionStatus();\r\n                }\r\n            }\r\n        },\r\n\r\n        onYouTubeIframeAPIReady: function() {\r\n            //console.info('onYouTubeIframeAPIReady');\r\n\t    this.player = new YT.Player(this.$('iframe').get(0), {\r\n                events: {\r\n                    'onStateChange': this.onPlayerStateChange,\r\n                    'onReady': this.onPlayerReady\r\n                }\r\n            });\r\n\r\n            this.isPlaying = false;\r\n            \r\n            this.setReadyStatus();\r\n            \r\n            this.setupEventListeners();\r\n            \r\n            this.setIFrameSize();\r\n        },\r\n\r\n        /**\r\n        * if another YouTube video starts playback whilst this one is playing, pause this one.\r\n        * prevents user from playing multiple videos on the page at the same time\r\n        */\r\n        onYouTubePlaybackStart: function(component) {\r\n            if(component != this && this.isPlaying) {\r\n                this.player.pauseVideo();\r\n            }\r\n        },\r\n\r\n        onPlayerReady: function() {\r\n            if (this.model.get(\"_media\")._playbackQuality) {\r\n                this.player.setPlaybackQuality(this.model.get(\"_media\")._playbackQuality);\r\n            }\r\n        },\r\n\r\n        /**\r\n        * this seems to have issues in Chrome if the user is logged into YouTube (possibly any Google account) - the API just doesn't broadcast the events\r\n        * but instead throws the error:\r\n        * Failed to execute 'postMessage' on 'DOMWindow': The target origin provided ('https://www.youtube.com') does not match the recipient window's origin ('http://www.youtube.com').\r\n        * This is documented here:\r\n        *   https://code.google.com/p/gdata-issues/issues/detail?id=5788\r\n        * but I haven't managed to get any of the workarounds to work... :-(\r\n        */\r\n        onPlayerStateChange: function(event) {\r\n            switch(event.data) {\r\n                case YT.PlayerState.PLAYING:\r\n                    Adapt.trigger('adapt-youtube:playbackstart', this);\r\n                    \r\n                    this.isPlaying = true;\r\n\r\n                    if(this.model.get('_setCompletionOn') && this.model.get('_setCompletionOn') === \"play\") {\r\n                        this.setCompletionStatus();\r\n                    }\r\n                break;\r\n                case YT.PlayerState.PAUSED:\r\n                    this.isPlaying = false;\r\n                break;\r\n                case YT.PlayerState.ENDED:\r\n                    if(this.model.get('_setCompletionOn') && this.model.get('_setCompletionOn') === \"ended\") {\r\n                        this.setCompletionStatus();\r\n                    }\r\n                break;\r\n            }\r\n            //console.log(\"this.onPlayerStateChange: \" + this.isPlaying);\r\n        }\r\n    },\r\n    {\r\n        template: 'youtube'\r\n    });\r\n    \r\n    Adapt.register(\"youtube\", youtube );\r\n\r\n    return youtube;\r\n});\r\n\n","define('menu/adapt-contrib-boxMenu/js/adapt-contrib-boxmenu',[\n    'coreJS/adapt',\n    'coreViews/menuView'\n], function(Adapt, MenuView) {\n\n    var BoxMenuView = MenuView.extend({\n\n        postRender: function() {\n            var nthChild = 0;\n            this.model.getChildren().each(function(item) {\n                if (item.get('_isAvailable')) {\n                    nthChild++;\n                    item.set(\"_nthChild\", nthChild);\n                    this.$('.menu-container-inner').append(new BoxMenuItemView({model: item}).$el);\n                }\n            });\n        }\n\n    }, {\n        template: 'boxmenu'\n    });\n\n    var BoxMenuItemView = MenuView.extend({\n\n        events: {\n            'click button' : 'onClickMenuItemButton'\n        },\n\n        className: function() {\n            var nthChild = this.model.get(\"_nthChild\");\n            return [\n                'menu-item',\n                'menu-item-' + this.model.get('_id') ,\n                this.model.get('_classes'),\n                this.model.get('_isVisited') ? 'visited' : '',\n                this.model.get('_isComplete') ? 'completed' : '',\n                this.model.get('_isLocked') ? 'locked' : '',\n                'nth-child-' + nthChild,\n                nthChild % 2 === 0 ? 'nth-child-even' : 'nth-child-odd'\n            ].join(' ');\n        },\n\n        preRender: function() {\n            this.model.checkCompletionStatus();\n            this.model.checkInteractionCompletionStatus();\n        },\n\n        postRender: function() {\n            var graphic = this.model.get('_graphic');\n            if (graphic && graphic.src && graphic.src.length > 0) {\n                this.$el.imageready(_.bind(function() {\n                    this.setReadyStatus();\n                }, this));\n            } else {\n                this.setReadyStatus();\n            }\n        },\n\n        onClickMenuItemButton: function(event) {\n            if(event && event.preventDefault) event.preventDefault();\n            if(this.model.get('_isLocked')) return;\n            Backbone.history.navigate('#/id/' + this.model.get('_id'), {trigger: true});\n        }\n\n    }, {\n        template: 'boxmenu-item'\n    });\n\n    Adapt.on('router:menu', function(model) {\n\n        $('#wrapper').append(new BoxMenuView({model: model}).$el);\n\n    });\n\n});\n\n","define('theme/adapt-contrib-vanilla/js/theme-block',['require','coreJS/adapt','backbone'],function(require) {\n\t\n\tvar Adapt = require('coreJS/adapt');\n\tvar Backbone = require('backbone');\n\n\tvar ThemeBlockView = Backbone.View.extend({\n\n\t\tinitialize: function() {\n\t\t\tthis.setStyles();\n\t\t\tthis.listenTo(Adapt, 'device:resize', this.setStyles);\n\t\t\tthis.listenTo(Adapt, 'remove', this.remove);\n\t\t},\n\n\t\tsetStyles: function() {\n\t\t\tthis.setBackground();\n\t\t\tthis.setMinHeight();\n\t\t\tthis.setDividerBlock();\n\t\t},\n\n\t\tsetBackground: function() {\n\t\t\tvar backgroundColor = this.model.get('_themeBlockConfig')._backgroundColor;\n\t\t\t\n\t\t\tif (backgroundColor) {\n\t\t\t\tthis.$el.addClass(backgroundColor);\n\t\t\t}\n\t\t},\n\n\t\tsetMinHeight: function() {\n\t\t\tvar minHeight = 0;\n\t\t\tvar minHeights = this.model.get('_themeBlockConfig')._minimumHeights;\n\n\t\t\tif (minHeights) {\n\n\t\t\t\tif(Adapt.device.screenSize == 'large') {\n\t\t\t\t\tminHeight = minHeights._large;\n\t\t\t\t} else if (Adapt.device.screenSize == 'medium') {\n\t\t\t\t\tminHeight = minHeights._medium;\n\t\t\t\t} else {\n\t\t\t\t\tminHeight = minHeights._small;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.$el.css({\n\t\t\t\tminHeight: minHeight + \"px\"\n\t\t\t});\n\t\t},\n\n\t\tsetDividerBlock: function() {\n\t\t\tvar dividerBlock = this.model.get('_themeBlockConfig')._isDividerBlock;\n\n\t\t\tif (dividerBlock) {\n\t\t\t\tthis.$el.addClass('divider-block');\n\t\t\t}\n\t\t}\n\t});\n\n\treturn ThemeBlockView;\n\t\n});\n\n","define('theme/adapt-contrib-vanilla/js/vanilla',['require','coreJS/adapt','backbone','theme/adapt-contrib-vanilla/js/theme-block'],function(require) {\n\t\n\tvar Adapt = require('coreJS/adapt');\n\tvar Backbone = require('backbone');\n\tvar ThemeBlock = require('theme/adapt-contrib-vanilla/js/theme-block');\n\n\t// Block View\n\t// ==========\n\n\tAdapt.on('blockView:postRender', function(view) {\n\t\tvar theme = view.model.get('_theme');\n\t\t\n\t\tif (theme) {\n\t\t\tnew ThemeBlock({\n\t\t\t\tmodel: new Backbone.Model({\n\t\t\t\t\t_themeBlockConfig: theme\n\t\t\t\t}),\n\t\t\t\tel: view.$el\n\t\t\t});\n\t\t}\n\t});\n});\n\n","define('plugins',[\n\t\"extensions/adapt-article-reveal/js/adapt-article-reveal\",\n\t\"extensions/adapt-audio/js/adapt-audio\",\n\t\"extensions/adapt-background-video/js/adapt-background-video\",\n\t\"extensions/adapt-backgroundVideo/js/adapt-backgroundVideo\",\n\t\"extensions/adapt-component-animate/js/adapt-component-animate\",\n\t\"extensions/adapt-contrib-assessment/js/adapt-assessmentArticleExtension\",\n\t\"extensions/adapt-contrib-bookmarking/js/adapt-contrib-bookmarking\",\n\t\"extensions/adapt-contrib-languagePicker/js/adapt-languagePicker\",\n\t\"extensions/adapt-contrib-pageLevelProgress/js/adapt-contrib-pageLevelProgress\",\n\t\"extensions/adapt-contrib-resources/js/adapt-contrib-resources\",\n\t\"extensions/adapt-contrib-spoor/js/adapt-contrib-spoor\",\n\t\"extensions/adapt-contrib-trickle/js/adapt-contrib-trickle\",\n\t\"extensions/adapt-contrib-tutor/js/adapt-contrib-tutor\",\n\t\"extensions/adapt-devtools/js/adapt-devtools\",\n\t\"extensions/adapt-editorial/js/adapt-editorialArticleExtension\",\n\t\"extensions/adapt-forceLoad/js/adapt-forceLoad\",\n\t\"extensions/adapt-hide-navigation-bar/js/adapt-hide-navigation-bar\",\n\t\"extensions/adapt-inspector/js/adapt-inspector\",\n\t\"extensions/adapt-ios-fastclick/js/adapt-ios\",\n\t\"extensions/adapt-lightbox/js/adapt-lightbox\",\n\t\"extensions/adapt-menu-controller/js/adapt-menu-controller\",\n\t\"extensions/adapt-navigation-title/js/adapt-navigation-title\",\n\t\"extensions/adapt-pageIncompletePrompt/js/adapt-pageIncompletePrompt\",\n\t\"extensions/adapt-speedtest/js/adapt-speedtest\",\n\t\"extensions/adapt-tutor/js/adapt-tutor\",\n\t\"components/adapt-article-reveal/js/adapt-article-reveal\",\n\t\"components/adapt-articleBlockSlider/js/articleBlockSlider\",\n\t\"components/adapt-audio/js/adapt-audio\",\n\t\"components/adapt-backgroundScroll/js/adapt-backgroundScroll\",\n\t\"components/adapt-blinds/js/adapt-blinds\",\n\t\"components/adapt-contrib-accordion/js/adapt-contrib-accordion\",\n\t\"components/adapt-contrib-assessmentResults/js/adapt-contrib-assessmentResults\",\n\t\"components/adapt-contrib-blank/js/adapt-contrib-blank\",\n\t\"components/adapt-contrib-confidenceSlider/js/adapt-contrib-confidenceSlider\",\n\t\"components/adapt-contrib-flipcard/js/adapt-contrib-flipcard\",\n\t\"components/adapt-contrib-gmcq/js/adapt-contrib-gmcq\",\n\t\"components/adapt-contrib-graphic/js/adapt-contrib-graphic\",\n\t\"components/adapt-contrib-hotgraphic/js/adapt-contrib-hotgraphic\",\n\t\"components/adapt-contrib-matching/js/adapt-contrib-matching\",\n\t\"components/adapt-contrib-mcq/js/adapt-contrib-mcq\",\n\t\"components/adapt-contrib-media/js/adapt-contrib-media\",\n\t\"components/adapt-contrib-narrative/js/adapt-contrib-narrative\",\n\t\"components/adapt-contrib-slider/js/adapt-contrib-slider\",\n\t\"components/adapt-contrib-text/js/adapt-contrib-text\",\n\t\"components/adapt-contrib-textInput/js/adapt-contrib-textInput\",\n\t\"components/adapt-expose/js/adapt-expose\",\n\t\"components/adapt-hotgrid/js/adapt-hotgrid\",\n\t\"components/adapt-narrativeStrip/js/adapt-narrativeStrip\",\n\t\"components/adapt-native-media/js/adapt-native-media\",\n\t\"components/adapt-peelBackHotspot/js/adapt-peelBackHotspot\",\n\t\"components/adapt-ppq/js/adapt-ppq\",\n\t\"components/adapt-questionStrip/js/adapt-questionStrip\",\n\t\"components/adapt-slidingPuzzle/js/adapt-slidingPuzzle\",\n\t\"components/adapt-tabs/js/adapt-tabs\",\n\t\"components/adapt-timedSequence/js/adapt-timed-sequence\",\n\t\"components/adapt-youtube/js/adapt-youtube\",\n\t\"menu/adapt-contrib-boxMenu/js/adapt-contrib-boxmenu\",\n\t\"theme/adapt-contrib-vanilla/js/vanilla\"\n],function(){});\n"]}